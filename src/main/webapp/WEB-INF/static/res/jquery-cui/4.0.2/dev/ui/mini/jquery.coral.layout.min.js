(function(a){a.component("coral.layout",{version:"4.1.4",options:{onCreate:null,fit:false},layoutPanelDefault:{region:null,split:false,collapsedSize:28,minWidth:10,minHeight:10,maxWidth:10000,maxHeight:10000},resizing:false,_resizeLayout:function(){var g=this,b=this.element,k=g.options,f=g.panels,c=a(b);if(b[0].tagName.toLowerCase()=="body"){this._fit()}else{k.fit?c.css(this._fit()):this._fit(false)}var h={top:0,left:0,width:c.width(),height:c.height()};i(this._isPanelVisible(f.expandNorth)?f.expandNorth:f.north,"n");i(this._isPanelVisible(f.expandSouth)?f.expandSouth:f.south,"s");e(this._isPanelVisible(f.expandEast)?f.expandEast:f.east,"e");e(this._isPanelVisible(f.expandWest)?f.expandWest:f.west,"w");f.center.panel("resize",h);function d(l){var m=l.panel("getOptions");return Math.min(Math.max(m.height,m.minHeight),m.maxHeight)}function j(m){var l=m.panel("getOptions");return Math.min(Math.max(l.width,l.minWidth),l.maxWidth)}function i(l,n){if(!l.length||!g._isPanelVisible(l)){return}var m=l.panel("getOptions");var o=d(l);l.panel("resize",{width:c.width(),height:o,left:0,top:(n=="n"?0:c.height()-o)});h.height-=o;if(n=="n"){h.top+=o;if(!m.split&&m.border){h.top--}}if(!m.split&&m.border){h.height++}}function e(m,o){if(!m.length||!g._isPanelVisible(m)){return}var n=m.panel("getOptions");var l=j(m);m.panel("resize",{width:l,height:h.height,left:(o=="e"?c.width()-l:0),top:h.top});h.width-=l;if(o=="w"){h.left+=l;if(!n.split&&n.border){h.left--}}if(!n.split&&n.border){h.width++}}},_splitLayout:function(f,d){var e=a(this.element).layout("panel",f);e.panel("options").split=d;var b="layout-split-"+f;var c=e.panel("panel").removeClass(b);if(d){c.addClass(b)}c.resizable({disabled:(!d)});this._resizeLayout()},_create:function(){this.panels={center:a(),north:a(),south:a(),east:a(),west:a()};var c=this;var b=this.element;var e=a(b);e.addClass("coral-layout");function d(f){f.children("div").each(function(){var g=a.parser.parseOptions(this,[]);if("north,south,east,west,center".indexOf(g.region)>=0){c._addPanel(b,g,this)
}})}e.children("form").length?d(e.children("form")):d(e);e.append('<div class="coral-layout-split-proxy-h"></div><div class="coral-layout-split-proxy-v"></div>');this._resizeLayout();this._initCollapse()},_addPanel:function(b,l,k){var f=this;l.region=l.region||"center";var g=this.panels;var d=a(b);var e=l.region;if(g[e].length){return}var c=a(k);if(!c.length){c=a("<div></div>").appendTo(d)}var j=a.extend({},this.layoutPanelDefault,{width:(c.length?parseInt(c[0].style.width)||c.outerWidth():"auto"),height:(c.length?parseInt(c[0].style.height)||c.outerHeight():"auto"),doSize:false,collapsible:true,componentCls:("coral-layout-panel coral-layout-panel-"+e),bodyCls:"coral-layout-body",onOpen:function(){var p=a(this).panel("header").children("div.coral-panel-tool");p.children("a.coral-panel-tool-collapse").hide();var m={north:"up3",south:"down3",east:"right3",west:"left3"};if(!m[e]){return}var o="cui-icon-arrow-"+m[e];var n=p.children("a."+o);if(!n.length){n=a('<a href="javascript:void(0)"></a>').addClass("icon "+o).appendTo(p)}n.unbind("click").bind("click",{dir:e},function(q){f._collapse(q.data.dir);return false});a(this).panel("getOptions").collapsible?n.show():n.hide()}},l);if(j.region==="center"){j.split=false}c.panel(j);g[e]=c;var i=c.panel("component");var h={north:"s",south:"n",east:"w",west:"e"};if(c.panel("option").split){i.addClass("coral-layout-split-"+e);i.resizable(a.extend({handles:(h[e]||""),disabled:(!c.panel("option").split),start:function(o){f.resizing=true;if(e=="north"||e=="south"){var m=a(">div.coral-layout-split-proxy-v",b)}else{var m=a(">div.coral-layout-split-proxy-h",b)}var n=0,p={display:"block"};if(e=="north"){p.top=parseInt(i.css("top"))+i.outerHeight()-m.height();p.left=parseInt(i.css("left"));p.width=i.outerWidth();p.height=m.height()}else{if(e=="south"){p.top=parseInt(i.css("top"));p.left=parseInt(i.css("left"));p.width=i.outerWidth();p.height=m.height()}else{if(e=="east"){p.top=parseInt(i.css("top"))||0;p.left=parseInt(i.css("left"))||0;p.width=m.width();
p.height=i.outerHeight()}else{if(e=="west"){p.top=parseInt(i.css("top"))||0;p.left=i.outerWidth()-m.width();p.width=m.width();p.height=i.outerHeight()}}}}m.css(p);a('<div class="coral-layout-mask"></div>').css({left:0,top:0,width:d.width(),height:d.height()}).appendTo(d)},resize:function(n){if(e=="north"||e=="south"){var m=a(">div.coral-layout-split-proxy-v",b);m.css("top",n.pageY-a(b).offset().top-m.height()/2)}else{var m=a(">div.coral-layout-split-proxy-h",b);m.css("left",n.pageX-a(b).offset().left-m.width()/2)}return false},helper:"coral-resizable-helper",stop:function(n,m){d.children("div.coral-layout-split-proxy-v,div.coral-layout-split-proxy-h").hide();c.panel("resize",m.size);f._resizeLayout();f.resizing=false;d.find(">div.coral-layout-mask").remove()}},l))}},_remove:function(c){var b=this.panels;if(b[c].length){b[c].panel("destroy");a(b[c]).remove();b[c]=a();var d="expand"+c.substring(0,1).toUpperCase()+c.substring(1);if(b[d]){b[d].panel("destroy");a(b[c]).remove();b[d]=undefined}}},_collapse:function(k,f){var i=this,d=this.element;if(f==undefined){f="normal"}var j=this.panels;var c=j[k];var l=c.panel("getOptions");if(l.beforeCollapse.call(c)==false){return}var g="expand"+k.substring(0,1).toUpperCase()+k.substring(1);if(!j[g]){j[g]=e(k);j[g].panel("component").bind("click",function(){var m=h();c.panel("expand",false).panel("open").panel("resize",m.collapse);c.panel("component").animate(m.expand,function(){a(this).unbind(".layout").bind("mouseleave.layout",{region:k},function(n){if(i.resizing==true){return}i._collapse(n.data.region)})});return false})}var b=h();if(!this._isPanelVisible(j[g])){j.center.panel("resize",b.resizeC)}c.panel("component").animate(b.collapse,f,function(){c.panel("collapse",false).panel("close");j[g].panel("open").panel("resize",b.expandP);a(this).unbind(".layout")});function e(n){var m;if(n=="east"){m="cui-icon-arrow-left3"}else{if(n=="west"){m="cui-icon-arrow-right3"}else{if(n=="north"){m="cui-icon-arrow-down3"}else{if(n=="south"){m="cui-icon-arrow-up3"
}}}}var o=a("<div></div>").appendTo(d);o.panel(a.extend({},i.layoutPanelDefault,{componentCls:("coral-layout-expand coral-layout-expand-"+n),title:"&nbsp;",closed:true,minWidth:0,minHeight:0,doSize:false,tools:[{iconCls:m,handler:function(){i._expand(k);return false}}]}));o.panel("component").hover(function(){a(this).addClass("coral-layout-expand-over")},function(){a(this).removeClass("coral-layout-expand-over")});return o}function h(){var q=a(d);var n=j.center.panel("getOptions");var m=l.collapsedSize;if(k=="east"){var p=n.width+l.width-m;if(l.split||!l.border){p++}return{resizeC:{width:p},expand:{left:q.width()-l.width},expandP:{top:n.top,left:q.width()-m,width:m,height:n.height},collapse:{left:q.width(),top:n.top,height:n.height}}}else{if(k=="west"){var p=n.width+l.width-m;if(l.split||!l.border){p++}return{resizeC:{width:p,left:m-1},expand:{left:0},expandP:{left:0,top:n.top,width:m,height:n.height},collapse:{left:-l.width,top:n.top,height:n.height}}}else{if(k=="north"){var o=n.height;if(!i._isPanelVisible(j.expandNorth)){o+=l.height-m+((l.split||!l.border)?1:0)}j.east.add(j.west).add(j.expandEast).add(j.expandWest).panel("resize",{top:m-1,height:o});return{resizeC:{top:m-1,height:o},expand:{top:0},expandP:{top:0,left:0,width:q.width(),height:m},collapse:{top:-l.height,width:q.width()}}}else{if(k=="south"){var o=n.height;if(!i._isPanelVisible(j.expandSouth)){o+=l.height-m+((l.split||!l.border)?1:0)}j.east.add(j.west).add(j.expandEast).add(j.expandWest).panel("resize",{height:o});return{resizeC:{height:o},expand:{top:q.height()-l.height},expandP:{top:q.height()-m,left:0,width:q.width(),height:m},collapse:{top:q.height(),width:q.width()}}}}}}}},_expand:function(h){var f=this,c=this.element,g=this.panels,b=g[h],i=b.panel("getOptions");if(i.beforeExpand.call(b)==false){return}var j=e();var d="expand"+h.substring(0,1).toUpperCase()+h.substring(1);if(g[d]){g[d].panel("close");b.panel("component").stop(true,true);b.panel("expand",false).panel("open").panel("resize",j.collapse);
b.panel("component").animate(j.expand,function(){f._resizeLayout()})}function e(){var l=a(c);var k=g.center.panel("getOptions");if(h=="east"&&g.expandEast){return{collapse:{left:l.width(),top:k.top,height:k.height},expand:{left:l.width()-g.east.panel("getOptions").width}}}else{if(h=="west"&&g.expandWest){return{collapse:{left:-g.west.panel("getOptions").width,top:k.top,height:k.height},expand:{left:0}}}else{if(h=="north"&&g.expandNorth){return{collapse:{top:-g.north.panel("getOptions").height,width:l.width()},expand:{top:0}}}else{if(h=="south"&&g.expandSouth){return{collapse:{top:l.height(),width:l.width()},expand:{top:l.height()-g.south.panel("getOptions").height}}}}}}}},_isPanelVisible:function(b){if(!b){return false}if(b.length){return b.panel("component").is(":visible")}else{return false}},_initCollapse:function(){var b=this.panels;if(b.east.length&&b.east.panel("getOptions").collapsed){this._collapse("east",0)}if(b.west.length&&b.west.panel("getOptions").collapsed){this._collapse("west",0)}if(b.north.length&&b.north.panel("getOptions").collapsed){this._collapse("north",0)}if(b.south.length&&b.south.panel("getOptions").collapsed){this._collapse("south",0)}},_fit:function(b){return a.coral.panel.fit(this.element,b)},_destroy:function(){this.element.children().remove();this.element.detach()},refresh:function(){this._resizeLayout()},panel:function(b){return this.panels[b]},collapse:function(b){this._collapse(b)},expand:function(b){this._expand(b)},add:function(b){this._addPanel(this.element,b);this._resizeLayout();if(this.panels[b.region].panel("getOptions").collapsed){this._collapse(b.region,0)}},remove:function(b){this._remove(b);this._resizeLayout()},split:function(b){this._splitLayout(b,true)},unsplit:function(b){this._splitLayout(b,false)},resize:function(h,i){var g=h;var c=this.element;if(i!==undefined){var d=this.panels[i];var j=d.panel("component").outerHeight();var e=d.panel("component").outerWidth();d.panel("resize",h);var b=d.panel("component").outerHeight();
var f=d.panel("component").outerWidth();g.height=a(c).height()+b-j;g.width=a(c).width()+f-e}a(c).css(g);this._resizeLayout()}})})(jQuery);