/*!
 * jQuery coral Selectable 4.0.1
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.component.js
 */
(function(a,b){a.component("coral.selectable",a.coral.mouse,{version:"4.0.1",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var d,c=this;this.element.addClass("coral-selectable");this.dragged=false;this.refresh=function(){d=a(c.options.filter,c.element[0]);d.addClass("coral-selectee");d.each(function(){var e=a(this),f=e.offset();a.data(this,"selectable-item",{element:this,$element:e,left:f.left,top:f.top,right:f.left+e.outerWidth(),bottom:f.top+e.outerHeight(),startselected:false,selected:e.hasClass("coral-selected"),selecting:e.hasClass("coral-selecting"),unselecting:e.hasClass("coral-unselecting")})})};this.refresh();this.selectees=d.addClass("coral-selectee");this._mouseInit();this.helper=a("<div class='coral-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("coral-selectee").removeData("selectable-item");this.element.removeClass("coral-selectable coral-selectable-disabled");this._mouseDestroy()},_mouseStart:function(e){var d=this,c=this.options;this.opos=[e.pageX,e.pageY];if(this.options.disabled){return}this.selectees=a(c.filter,this.element[0]);this._trigger("start",e);a(c.appendTo).append(this.helper);this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0});if(c.autoRefresh){this.refresh()}this.selectees.filter(".coral-selected").each(function(){var f=a.data(this,"selectable-item");f.startselected=true;if(!e.metaKey&&!e.ctrlKey){f.$element.removeClass("coral-selected");f.selected=false;f.$element.addClass("coral-unselecting");f.unselecting=true;d._trigger("unselecting",e,{unselecting:f.element})}});a(e.target).parents().addBack().each(function(){var f,g=a.data(this,"selectable-item");if(g){f=(!e.metaKey&&!e.ctrlKey)||!g.$element.hasClass("coral-selected");g.$element.removeClass(f?"coral-unselecting":"coral-selected").addClass(f?"coral-selecting":"coral-unselecting");
g.unselecting=!f;g.selecting=f;g.selected=f;if(f){d._trigger("selecting",e,{selecting:g.element})}else{d._trigger("unselecting",e,{unselecting:g.element})}return false}})},_mouseDrag:function(j){this.dragged=true;if(this.options.disabled){return}var g,i=this,e=this.options,d=this.opos[0],h=this.opos[1],c=j.pageX,f=j.pageY;if(d>c){g=c;c=d;d=g}if(h>f){g=f;f=h;h=g}this.helper.css({left:d,top:h,width:c-d,height:f-h});this.selectees.each(function(){var k=a.data(this,"selectable-item"),l=false;if(!k||k.element===i.element[0]){return}if(e.tolerance==="touch"){l=(!(k.left>c||k.right<d||k.top>f||k.bottom<h))}else{if(e.tolerance==="fit"){l=(k.left>d&&k.right<c&&k.top>h&&k.bottom<f)}}if(l){if(k.selected){k.$element.removeClass("coral-selected");k.selected=false}if(k.unselecting){k.$element.removeClass("coral-unselecting");k.unselecting=false}if(!k.selecting){k.$element.addClass("coral-selecting");k.selecting=true;i._trigger("selecting",j,{selecting:k.element})}}else{if(k.selecting){if((j.metaKey||j.ctrlKey)&&k.startselected){k.$element.removeClass("coral-selecting");k.selecting=false;k.$element.addClass("coral-selected");k.selected=true}else{k.$element.removeClass("coral-selecting");k.selecting=false;if(k.startselected){k.$element.addClass("coral-unselecting");k.unselecting=true}i._trigger("unselecting",j,{unselecting:k.element})}}if(k.selected){if(!j.metaKey&&!j.ctrlKey&&!k.startselected){k.$element.removeClass("coral-selected");k.selected=false;k.$element.addClass("coral-unselecting");k.unselecting=true;i._trigger("unselecting",j,{unselecting:k.element})}}}});return false},_mouseStop:function(d){var c=this;this.dragged=false;a(".coral-unselecting",this.element[0]).each(function(){var e=a.data(this,"selectable-item");e.$element.removeClass("coral-unselecting");e.unselecting=false;e.startselected=false;c._trigger("unselected",d,{unselected:e.element})});a(".coral-selecting",this.element[0]).each(function(){var e=a.data(this,"selectable-item");e.$element.removeClass("coral-selecting").addClass("coral-selected");
e.selecting=false;e.selected=true;e.startselected=true;c._trigger("selected",d,{selected:e.element})});this._trigger("stop",d);this.helper.remove();return false}})})(jQuery);