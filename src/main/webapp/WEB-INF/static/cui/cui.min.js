(function( factory ) {
	if ( typeof define === 'function' && define.amd ) {
		define([ 'jquery' ], factory );
} else {
	factory( jQuery );
	}
}(function( $ ) {
/**
 * jqGrid Chinese Translation for v3.6
 * waiting 2010.01.18
 * http://waiting.javaeye.com/
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 * 
 * update 2010.05.04
 *		add double u3000 SPACE for search:odata to fix SEARCH box display err when narrow width from only use of eq/ne/cn/in/lt/gt operator under IE6/7
**/
$.grid = {
	defaults : {
		recordtext: "{0} - {1}\u3000共 {2} 条",	// 共字前是全角空格
		pagetext:"共 {0} 页",
		emptyrecords: "无数据显示",
		loadtext: "数据加载中...",
		pgtext : " {0} 共 {1} 页"
	},
	search : {
		caption: "搜索...",
		Find: "查找",
		Reset: "重置",
		odata : ['等于\u3000\u3000', '不等\u3000\u3000', '小于\u3000\u3000', '小于等于','大于\u3000\u3000','大于等于', 
			'开始于','不开始于','属于\u3000\u3000','不属于','结束于','不结束于','包含\u3000\u3000','不包含'],
		groupOps: [	{ op: "AND", text: "所有" },	{ op: "OR",  text: "任一" }	],
		matchText: " 匹配",
		rulesText: " 规则"
	},
	edit : {
		bUpdate:'更新',
		addCaption: "添加记录",
		editCaption: "编辑记录",
		bSubmit: "提交",
		bCancel: "取消",
		bClose: "关闭",
		saveData: "数据已改变，是否保存？",
		bYes : "是",
		bNo : "否",
		bExit : "取消",
		msg: {
			required:"此字段必需",
			number:"请输入有效数字",
			minValue:"输值必须大于等于 ",
			maxValue:"输值必须小于等于 ",
			email: "这不是有效的e-mail地址",
			integer: "请输入有效整数",
			date: "请输入有效时间",
			url: "无效网址。前缀必须为 ('http://' 或 'https://')",
			nodefined : " 未定义！",
			novalue : " 需要返回值！",
			customarray : "自定义函数需要返回数组！",
			customfcheck : "Custom function should be present in case of custom checking!"
			
		}
	},
	view : {
		caption: "查看记录",
		bClose: "关闭"
	},
	del : {
		caption: "删除",
		msg: "删除所选记录？",
		bSubmit: "删除",
		bCancel: "取消"
	},
	nav : {
		edittext: "",
		edittitle: "编辑所选记录",
		addtext:"",
		addtitle: "添加新记录",
		deltext: "",
		deltitle: "删除所选记录",
		searchtext: "",
		searchtitle: "查找",
		refreshtext: "",
		refreshtitle: "刷新表格",
		alertcap: "注意",
		alerttext: "请选择记录",
		viewtext: "",
		viewtitle: "查看所选记录"
	},
	col : {
		caption: "选择列",
		bSubmit: "确定",
		bCancel: "取消"
	},
	errors : {
		errcap : "错误",
		nourl : "没有设置url",
		norecords: "没有要处理的记录",
		model : "colNames 和 colModel 长度不等！"
	},
	formatter : {
		integer : {thousandsSeparator: ",", defaultValue: '0'},
		number : {decimalSeparator:".", thousandsSeparator: " ", decimalPlaces: 2, defaultValue: '0.00'},
		currency : {decimalSeparator:".", thousandsSeparator: " ", decimalPlaces: 2, prefix: "", suffix:"", defaultValue: '0.00'},
		date : {
			dayNames:   [
				"Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat",
		         "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"
			],
			monthNames: [
				"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",
				"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
			],
			AmPm : ["am","pm","AM","PM"],
			S: function (j) {return j < 11 || j > 13 ? ['st', 'nd', 'rd', 'th'][Math.min((j - 1) % 10, 3)] : 'th'},
			srcformat: 'Y-m-d',
			newformat: 'm-d-Y',
			masks : {
				ISO8601Long:"Y-m-d H:i:s",
				ISO8601Short:"Y-m-d",
				ShortDate: "Y/j/n",
				LongDate: "l, F d, Y",
				FullDateTime: "l, F d, Y g:i:s A",
				MonthDay: "F d",
				ShortTime: "g:i A",
				LongTime: "g:i:s A",
				SortableDateTime: "Y-m-d\\TH:i:s",
				UniversalSortableDateTime: "Y-m-d H:i:sO",
				YearMonth: "F, Y"
			},
			reformatAfterEdit : false
		},
		baseLinkUrl: '',
		showAction: '',
		target: '',
		checkbox : {/*disabled:true*/},
		idName : 'id'
	}
};

/*!
 * jQuery coral Core 4.0.1
 */
if(document.documentMode!==undefined){if(document.documentMode<=5){alert("CoralUI can not be used in this ('quirks') mode!")}}var CoralUIVersion="4.1.5";window.Coral={cc:function(a,b){$.parser.component.push({componentName:a,id:b})}};var validAction=false,timer=false,resizable=true;(function(){$.controller=function(controllerName,obj){if(obj){window[controllerName]=window[controllerName]||{};return $.extend(true,window[controllerName],obj)}else{return window[controllerName]}};$.coral=$.coral||{};$.coral.openTag=true;$.coral.strictLayout=false;$(document).unbind(".clearTips").bind("click.clearTips",function(e){if(validAction){validAction=false;e.stopPropagation();return}$(".coral-validate-state-error").slideUp(100,function(e){$(this).remove()});validAction=false});$(document).unbind("mousewheel").bind("mousewheel",function(e){var validateSuffix=$.validate.validateSuffix();setTimeout(function(){$.each($(".coral-validate-state-error"),function(idx,item){var className=$(item).attr("class");var componentId=className.substring(0,className.indexOf(validateSuffix));var $field=$("#"+componentId).find(".ctrl-init");var $validator=$field.parents(".coral-validate");$(item).remove();$validator.validate("validItem",$field,null,true)})},0)});$.coral.getStyles=function(el){if(window.getComputedStyle){var styles=window.getComputedStyle(el,null);return styles}else{if(document.documentElement.currentStyle){var styles=el.currentStyle;return styles}}};$.coral.fitParent=function($ele,fit){fit=(fit==undefined?true:fit);var parent=$ele.parent().closest(".ctrl-fit-element")[0];parent=$(parent);if(fit){if(!parent.hasClass("coral-noscroll")){parent.addClass("coral-noscroll");if(parent.attr("tagName")=="BODY"){$("html").addClass("coral-panel-fit")}}}else{if(parent.hasClass("coral-noscroll")){parent.removeClass("coral-noscroll");if(parent.attr("tagName")=="BODY"){$("html").removeClass("coral-panel-fit")}}}return{width:parent.width(),height:parent.height()}};$.coral.getLeft=function(my,of){var left=of.offset().left;
if(left+my.outerWidth()>$(window).outerWidth()+$(document).scrollLeft()){left=$(window).outerWidth()+$(document).scrollLeft()-my.outerWidth()}if(left<0){left=0}return left};$.coral.getTop=function(my,of,direction){var top=of.offset().top+of.outerHeight();if(direction=="up"){top=of.offset().top-my.outerHeight()}else{if(top+my.outerHeight()>$(window).outerHeight()+$(document).scrollTop()){top=of.offset().top-my.outerHeight()}if(top<$(document).scrollTop()){top=of.offset().top+of.outerHeight()}}return top};$.coral.findComponent=function(selector,context){var component=[];if(!selector){selector=".ctrl-init"}var init=$(selector,context);var rclass=/[\t\r\n]/g;if(init.length){$.each(init,function(){var name="",className=this.className.replace(rclass," ").split(" "),i=0,l=className.length;for(;i<l;i++){name=$(this).attr("component-role");if(name=="datepicker"){component.push([{element:$(this),name:name}])}else{component.push($(this)[name]("instance"))}break}})}return component};$.coral.setIsLabel=function(isSet,context){var fields=$.coral.findComponent(".ctrl-form-element",context),i=0,l=fields.length;for(i;i<l;i++){var c=fields[i];if(c instanceof Array){$(c[0].element)[c[0].name]("option","isLabel",isSet)}else{c._setOption("isLabel",isSet);if(c.element.hasClass("hasTooltip")){if(isSet==false){c.element.tooltip("enable")}else{c.element.tooltip("disable")}}}}};$.coral.setReadOnly=function(isSet,context){var fields=$.coral.findComponent(".ctrl-form-element",context),i=0,l=fields.length;for(i;i<l;i++){var c=fields[i];if(c instanceof Array){$(c[0].element)[c[0].name]("option","readonly",isSet)}else{c._setOption("readonly",isSet);if(c.element.hasClass("hasTooltip")){if(isSet==false){c.element.tooltip("enable")}else{c.element.tooltip("disable")}}}}};$.coral.renderComponent=function(context){var component=[];var selector=".coral-no-rendered";if(!context){context="body"}var init=$(selector,context);var rclass=/[\t\r\n]/g;if(init.length){$.each(init,function(){var name="",className=this.className.replace(rclass," ").split(" "),i=0,l=className.length;
for(;i<l;i++){name=$(this).attr("component-role");rendered=$(this).prop("rendered");if(!rendered){$(this).removeClass("coral-no-rendered");var ins=$(this)[name]("instance");$(this).addClass("ctrl-init ctrl-init-"+this.componentName);ins._create();ins._renderComponent()}break}})}return component};$.coral.valid={};$.coral.valid=function(element){validAction=true;var count=0,excluded=$.data(element,"excluded"),validElements=element.find($("[class*='coral-validation-']")),errTipsType=null,hasErrorTips=true;if(excluded&&"string"===typeof excluded){excluded=$.map(excluded.split(","),function(item){return $.trim(item)})}if("form"===element[0].tagName.toLowerCase()){errTipsType=element.form("option","errTipsType")}validElements.each(function(){var className=this.className,coralType="",clsArray=className.split(" ");for(var item in clsArray){if(clsArray[item].indexOf("coral-validation-")>=0){coralType=clsArray[item].substr(clsArray[item].indexOf("coral-validation-")+17);break}}if(_isExclud($(this)[coralType]("component"),excluded)){return}if("none"===errTipsType){hasErrorTips=false}if(!_valid($(this),coralType,hasErrorTips)){if("first"===errTipsType){hasErrorTips=false}++count}});if(count>0){return false}else{return true}function _isExclud($component,excluded){if(!excluded){return false}var length=excluded.length;for(var i=0;i<length;i++){if("string"===typeof excluded[i]&&$component.is(excluded[i])){return true}}return false}function _valid($element,coralType,hasErrorTips){if("datepicker"==coralType){return $element[coralType]("valid",$element,hasErrorTips)}if($.inArray(coralType,["textbox","combobox","combotree","radio","radiolist","checkbox","checkboxlist"])>-1){return $element[coralType]("valid",hasErrorTips)}}};jQuery.support.placeholder=(function(){var i=document.createElement("input");return"placeholder" in i})();var uuid=0,runiqueId=/^coral-id-\d+$/;$.extend($.coral,{version:"4.0.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},zindex:1000});
var timer=false;$.fn.extend({scrollParent:function(includeHidden){var position=this.css("position"),excludeStaticParent=position==="absolute",overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);if(excludeStaticParent&&parent.css("position")==="static"){return false}return overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return position==="fixed"||!scrollParent.length?$(this[0].ownerDocument||document):scrollParent},uniqueId:function(prefix){return this.each(function(){if(!this.id){if(prefix){prefix+="-"}else{prefix=""}this.id=prefix+"coral-id-"+(++uuid)}})},removeUniqueId:function(){return this.each(function(){if(runiqueId.test(this.id)){$(this).removeAttr("id")}})},closestComponent:function(selector){return this.each(function(){$(this).closest(".ctrl-init-"+selector)})}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap='#"+mapName+"']")[0];return !!img&&visible(img)}return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden"}).length}$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return !!$.data(elem,dataName)}}):function(elem,i,match){return !!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)
}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0}if(margin){size-=parseFloat($.css(elem,"margin"+this))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}})}if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key))}else{return removeData.call(this)}}})($.fn.removeData)}$.coral.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.fn.extend({focus:(function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):orig.apply(this,arguments)}})($.fn.focus),disableSelection:(function(){var eventType="onselectstart" in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(eventType+".coral-disableSelection",function(event){event.preventDefault()})}})(),enableSelection:function(){return this.unbind(".coral-disableSelection")},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;
while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0}});$.extend($.coral,{plugin:{add:function(module,option,set){var i,proto=$.coral[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(!set){return}if(!allowDisconnected&&(!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11)){return}for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}},toFunction:function(fn){var ns=null,i=0,_fn=null;if($.isFunction(fn)){return fn}if(typeof fn==="string"){if($.isFunction(window[fn])){return window[fn]}try{_fn=eval("("+fn+")");if($.isFunction(_fn)){return _fn}}catch(e){}if(fn.indexOf(".")>0){ns=fn.split(".");_fn=window[ns[0]];if(!_fn){return null}for(i=1;i<ns.length;i++){_fn=_fn[ns[i]];if(!_fn){return null}}}return _fn}return fn}});$.extend({loadJson:function(url,params){var data=null;$.ajax({url:url,type:"get",dataType:"json",async:false,data:params,success:function(rlt){data=rlt},error:function(req,error,errThrow){$.error("function load json error: "+error)}});return data},isCoral:function(elem,type){if(arguments.length<2||!elem){return false}if(elem.jquery){elem=elem.get(0)}return !!$.data(elem,"coral-"+type)}});$.extend($.coral,{scriptPath:function(){var scripts=document.getElementsByTagName("script");var script=scripts[scripts.length-1];var path=script.src.substring(0,script.src.lastIndexOf("/")+1);return path}(),contextPathFun:function(){var curWwwPath=window.document.location.href;var pathName=window.document.location.pathname;var pos=curWwwPath.indexOf(pathName);var localhostPaht=curWwwPath.substring(0,pos);var projectName=pathName.substring(0,pathName.substr(1).indexOf("/")+1);
return projectName},adjusted:function(element){var maxHeight,$element=$(element),parent=$element.parent();maxHeight=parent.height();$element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return}maxHeight-=elem.outerHeight(true)});$element.height(Math.max(0,maxHeight-$element.innerHeight()+$element.height())).addClass("coral-scroll");$.coral.refreshAllComponent(element);$.coral.fitParent(parent,true)},beforeDoOverflow:function(element){},doOverflow:function(element){},isFit:function(com,pCom){var closestPCom=$(com).parent().closest(".ctrl-fit-element");if(!closestPCom.length){closestPCom=$("body")}var isBestFit=closestPCom.length&&(closestPCom[0]===$(pCom)[0]||closestPCom.find(pCom).length);return isBestFit},refreshAllComponent:function(parentComponent){$.coral.beforeDoOverflow();if(typeof(parentComponent)=="undefined"){parentComponent="body"}var layoutSet=null,layoutSetKey="find",comStrictLayout=false,pType=$(parentComponent).attr("component-role");var t;if(!pType){t=$(parentComponent).prop("strictLayout")}else{t=$(parentComponent)[pType]("option","strictLayout")}if(typeof t==="undefined"||t===null){if($.coral.strictLayout){comStrictLayout=true}else{comStrictLayout=false}}if(typeof t==="boolean"){comStrictLayout=t}if(comStrictLayout&&$.coral.strictLayout){layoutSetKey="children"}if(!comStrictLayout){layoutSetKey="find"}layoutSet=$(parentComponent)[layoutSetKey](".fill:visible, .ctrl-fit-element:visible, .coral-adjusted:visible");layoutSet.each(function(){if($(this).hasClass("coral-adjusted")||$(this).hasClass("fill")){$(this).addClass("ctrl-fit-element coral-scroll")}var componentId=$(this).attr("component-id"),$ele=$("#"+componentId),type=$ele.attr("component-role");if(!type){if($(this).hasClass("coral-adjusted")||$(this).hasClass("fill")){$.coral.adjusted(this)}}else{if($.coral.isFit($ele[type]("component"),parentComponent)){if(type=="panel"){$ele[type]("resizePanel")}else{$ele[type]("refresh")
}}}});$.coral.doOverflow()}});$.coral.contextPath=$.coral.contextPathFun.apply()})();(function(a){a.fn.caret=function(h){var g=this[0];var d=g.contentEditable==="true";if(arguments.length==0){if(window.getSelection){if(d){g.focus();var c=window.getSelection().getRangeAt(0),b=c.cloneRange();b.selectNodeContents(g);b.setEnd(c.endContainer,c.endOffset);return b.toString().length}return g.selectionStart}if(document.selection){g.focus();if(d){var c=document.selection.createRange(),b=document.body.createTextRange();b.moveToElementText(g);b.setEndPoint("EndToEnd",c);return b.text.length}var h=0,e=g.createTextRange(),b=document.selection.createRange().duplicate(),f=b.getBookmark();e.moveToBookmark(f);while(e.moveStart("character",-1)!==0){h++}return h}if(g.selectionStart){return g.selectionStart}return 0}if(h==-1){h=this[d?"text":"val"]().length}if(window.getSelection){if(d){g.focus();window.getSelection().collapse(g.firstChild,h)}else{g.setSelectionRange(h,h)}}else{if(document.body.createTextRange){if(d){var e=document.body.createTextRange();e.moveToElementText(g);e.moveStart("character",h);e.collapse(true);e.select()}else{var e=g.createTextRange();e.move("character",h);e.select()}}}if(!d){g.focus()}return h}})(jQuery);

/*!
 * jQuery coral component 4.0.1
 */
(function(){var a=0,b=Array.prototype.slice;$.cleanData=(function(c){return function(d){var g,h,f;for(f=0;(h=d[f])!=null;f++){try{g=$._data(h,"events");if(g&&g.remove){$(h).triggerHandler("remove")}}catch(j){}}c(d)}})($.cleanData);$.component=function(c,d,k){var h,i,f,j,e={},g=c.split(".")[0];c=c.split(".")[1];h=g+"-"+c;if(!k){k=d;d=$.Component}$.expr[":"][h.toLowerCase()]=function(l){return !!$.data(l,h)};$[g]=$[g]||{};i=$[g][c];f=$[g][c]=function(l,m){if(!this._createComponent){return new f(l,m)}if(arguments.length){l=$.component.extend({},$.fn[c].defaults||{},this._parseOptions(m),l);this._createComponent(l,m)}};$.extend(f,i,{version:k.version,_proto:$.extend({},k),_childConstructors:[]});j=new d();j.options=$.component.extend({},j.options);$.each(k,function(m,l){if(!$.isFunction(l)){e[m]=l;return}e[m]=(function(){var n=function(){return d.prototype[m].apply(this,arguments)},o=function(p){return d.prototype[m].apply(this,p)};return function(){var r=this._super,p=this._superApply,q;this._super=n;this._superApply=o;q=l.apply(this,arguments);this._super=r;this._superApply=p;return q}})()});f.prototype=$.component.extend(j,{componentEventPrefix:i?(j.componentEventPrefix||c):c},e,{constructor:f,namespace:g,componentName:c,componentFullName:h});if(i){$.each(i._childConstructors,function(m,n){var l=n.prototype;$.component(l.namespace+"."+l.componentName,f,n._proto)});delete i._childConstructors}else{d._childConstructors.push(f)}$.component.bridge(c,f);return f};$.component.extend=function(h){var d=b.call(arguments,1),g=0,c=d.length,e,f;for(;g<c;g++){for(e in d[g]){f=d[g][e];if(d[g].hasOwnProperty(e)&&f!==undefined){if($.isPlainObject(f)){h[e]=$.isPlainObject(h[e])?$.component.extend({},h[e],f):$.component.extend({},f)}else{h[e]=f}}}}return h};$.component.bridge=function(d,c){var e=c.prototype.componentFullName||d;$.fn[d]=function(h){var f=typeof h==="string",g=b.call(arguments,1),i=this;h=!f&&g.length?$.component.extend.apply(null,[h].concat(g)):h;
if(f){this.each(function(){var k,j=$.data(this,e);if(!j){return $.error("cannot call methods on "+d+" prior to initialization; attempted to call method '"+h+"'")}if(h==="instance"){i=j;return false}if(!$.isFunction(j[h])||h.charAt(0)==="_"){return $.error("no such method '"+h+"' for "+d+" component instance")}k=j[h].apply(j,g);if(k!==j&&k!==undefined){i=k&&k.jquery?i.pushStack(k.get()):k;return false}})}else{this.each(function(){var j=$.data(this,e);if(j){j.option(h||{});if(j._init){j._init()}}else{$.data(this,e,new c(h,this))}})}return i}};$.Component=function(){};$.Component._childConstructors=[];$.Component.prototype={componentName:"component",componentEventPrefix:"",defaultElement:"<div>",castProperties:null,options:{disabled:false,authorized:true,rendered:true,onCreate:null},formFieldArray:["autocomplete","autocompletetree","combobox","combotree","combogrid","checkbox","checkboxlist","datepicker","radio","radiolist","spinner","textbox","fileuploader"],panelArray:["accordion","dialog","form","grid","layout","panel","tabs","toolbar","splitcontainer","view"],_createComponent:function(c,d){var e=this;d=$(d||this.defaultElement||this)[0];this.element=$(d);this.uuid=a++;this.eventNamespace="."+this.componentName+this.uuid;if(!this.element.attr("component-role")){this.element.attr("component-role",this.componentName)}this.options=$.component.extend({},this.options,this._getCreateOptions(),c);if(!this.options.authorized||this.options.authorized==="false"){this.element.remove()}this.bindings=$();this.hoverable=$();this.focusable=$();if(d!==this){$.data(d,this.componentFullName,this);this._on(true,this.element,{remove:function(f){if(f.target===d){this.destroy()}}});this.document=$(d.style?d.ownerDocument:d.document||d);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this.element.prop("rendered",!!this.options.rendered);if(!this.options.rendered){this.element.addClass("coral-no-rendered");return}else{this.element.addClass("ctrl-init ctrl-init-"+this.componentName);
this._create()}this._renderComponent()},_renderComponent:function(){if(this.options.componentCls){this.component().addClass(this.options.componentCls)}if(this.options.cls){this.element.addClass(this.options.cls)}if($.inArray(this.componentName,this.formFieldArray)>-1){this.element.addClass("ctrl-form-element coral-validation-"+this.componentName);$.validate.addField(this.element,this.options)}if($.inArray(this.componentName,this.panelArray)>-1){this.component().addClass("ctrl-fit-element")}if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}else{this.options.id=this.element.uniqueId(this.componentName).attr("id")}}this.component().attr("component-id",this.options.id);this._trigger("onCreate",null,this._getCreateEventData());this._init()},_parseOptions:function(d){var c=$(d);return $.extend({},$.parser.parseOptions(d,[],this.castProperties))},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,valid:function(){var c={hasTips:false,element:this.element};return($.validate.validateField(null,c).length>0?false:true)},isValid:function(){},destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.componentName).removeData(this.componentFullName).removeData($.camelCase(this.componentFullName));this.element.removeClass("ctrl-form-element ctrl-init ctrl-init-"+this.componentName);this.component().unbind(this.eventNamespace).removeAttr("aria-disabled").removeAttr("component-role").removeClass(this.componentFullName+"-disabled coral-state-disabled");this.element.removeAttr("component-role");this.element.removeAttr("data-options");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("coral-state-hover");this.focusable.removeClass("coral-state-focus")},_destroy:$.noop,component:function(){return this.element},option:function(f,g){var c=f,h,e,d;if(arguments.length===0){return $.component.extend({},this.options)
}if(typeof f==="string"){c={};h=f.split(".");f=h.shift();if(h.length){e=c[f]=$.component.extend({},this.options[f]);for(d=0;d<h.length-1;d++){e[h[d]]=e[h[d]]||{};e=e[h[d]]}f=h.pop();if(arguments.length===1){return e[f]===undefined?null:e[f]}e[f]=g}else{if(arguments.length===1){return this.options[f]===undefined?null:this.options[f]}c[f]=g}}this._setOptions(c);return this},_setOptions:function(c){var d;for(d in c){this._setOption(d,c[d]);this.element.trigger("onOptionChange",{key:d,value:c[d]})}return this},_setOption:function(c,d){this.options[c]=d;if(c==="disabled"){this.component().toggleClass(this.componentFullName+"-disabled coral-state-disabled",!!d).attr("aria-disabled",d);if(d){this.hoverable.removeClass("coral-state-hover");this.focusable.removeClass("coral-state-focus")}}return this},enable:function(){return this._setOptions({disabled:false})},disable:function(){return this._setOptions({disabled:true})},show:function(){this.component().removeClass("coral-state-hidden").show()},hide:function(){this.component().addClass("coral-state-hidden").hide()},_pinyinEngine:function(){return new pinyinEngine()},_pinyinSetCache:function(f,d,e){for(var c in e){f.setCache([e[c][d]],e[c])}return f},_pinyinSearch:function(e,d,f){var c=[];e.search(d,function(g){c.push(g)});f(c)},_on:function(f,e,d){var g,c=this;if(typeof f!=="boolean"){d=e;e=f;f=false}if(!d){d=e;e=this.element;g=this.component()}else{e=g=$(e);this.bindings=this.bindings.add(e)}$.each(d,function(m,l){function j(){if(!f&&(c.options.disabled===true||$(this).hasClass("coral-state-disabled"))){return}return(typeof l==="string"?c[l]:l).apply(c,arguments)}if(typeof l!=="string"){j.guid=l.guid=l.guid||j.guid||$.guid++}var k=m.match(/^([\w:-]*)\s*(.*)$/),i=k[1]+c.eventNamespace,h=k[2];if(h){g.delegate(h,i,j)}else{e.bind(i,j)}})},_off:function(d,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;d.unbind(c).undelegate(c)},_delay:function(f,e){function d(){return(typeof f==="string"?c[f]:f).apply(c,arguments)
}var c=this;return setTimeout(d,e||0)},_hoverable:function(c){this.hoverable=this.hoverable.add(c);this._on(c,{mouseenter:function(d){$(d.currentTarget).addClass("coral-state-hover")},mouseleave:function(d){$(d.currentTarget).removeClass("coral-state-hover")}})},_focusable:function(c){this.focusable=this.focusable.add(c);this._on(c,{focusin:function(d){$(d.currentTarget).addClass("coral-state-focus")},focusout:function(d){$(d.currentTarget).removeClass("coral-state-focus")}})},addNoTrigger:function(c){this.options.noTriggerEvent.push(c)},_trigger:function(j,d,f){var g=this.options.noTriggerEvent||[];if(g.length){for(var h=0;h<g.length;h++){if(j==g[h]){g.splice(h,1);return}}}var e=this.options[j];if(this.options.controllerName&&typeof e==="string"){e=this.options.controllerName+"."+e}var c,l,k=$.isFunction(j)?j:$.coral.toFunction(e),m={};f=f||{};d=$.Event(d);d.type=(j===this.componentEventPrefix?j:this.componentEventPrefix+j).toLowerCase();d.target=this.element[0];l=d.originalEvent;if(l){for(c in l){if(!(c in d)){d[c]=l[c]}}}this.element.trigger(d,f);d.data=d.data||{};$.extend(d.data,this.options.dataCustom);$.extend(d.data,{controllerName:this.options.controllerName});var n;n=$.controller(this.options.controllerName);if(this.options.controllerName&&!$.isFunction(this.options[j])&&n){$.extend(d.data,{element:this.element[0]})}else{n=this.element[0]}return !($.isFunction(k)&&k.apply(n,[d].concat(f))===false||d.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(d,c){$.Component.prototype["_"+d]=function(g,f,i){if(typeof f==="string"){f={effect:f}}var h,e=!f?d:f===true||typeof f==="number"?c:f.effect||c;f=f||{};if(typeof f==="number"){f={duration:f}}h=!$.isEmptyObject(f);f.complete=i;if(f.delay){g.delay(f.delay)}if(h&&$.effects&&$.effects.effect[e]){g[d](f)}else{if(e!==d&&g[e]){g[e](f.duration,f.easing,i)}else{g.queue(function(j){$(this)[d]();if(i){i.call(g[0])}j()})}}}})})();

$.component("coral.formelement",{version:"4.0.2",options:{},getValidateValue:function(){return this.getValue()},clearError:function(){this.component().removeClass("hasErrorIcon coral-validate-error");this.component().find(".coral-errorIcon").remove();this.element.prop("isError",false)}});

$.component("coral.inputbase",$.coral.formelement,{version:"4.0.2",options:{inputButtonGutter:5},_setOption:function(a,c){var b=this;this._super(a,c);this.component().find(".button").each(function(){var g=$(this).attr("data-pos");var d=g.split("_");if(a==="isLabel"){if(c){$(this).hide();if(d[0]=="outer"){b.component().css("padding-"+d[1],0)}else{b.component().find(".coral-textbox-border").css("padding-"+d[1],0)}}else{$(this).show();var f=$(this).outerWidth();if(d[0]=="outer"){b.component().css("padding-"+d[1],f+b.options.inputButtonGutter)}else{b.component().find(".coral-textbox-border").css("padding-"+d[1],f)}}}if(a==="readonly"||a==="disable"||a==="isLabel"){var e=$(this).find(".ctrl-init-button");if(c){e.button("disable")}else{e.button("enable")}}})},_outerButtons:function(){this.uiDialogOuterButtonPanel=$("<span class='coral-outerbuttonset coral-outer coral-corner-all'></span>");this.component().append(this.uiDialogOuterButtonPanel);this._createtoolPanelItems(this.options.buttonOptions,null,this.uiDialogOuterButtonPanel,null,"button");this.component().css("padding-right",this.uiDialogOuterButtonPanel.outerWidth()+8)},_createButtonPanel:function(){var f=false,d,g="right",h="inner",c="innerRight",a="prepend",e=this.options.buttons;for(d=0;d<this.options.buttons.length;d++){if(e[d]["innerLeft"]){c="innerLeft";g="left";f=true}if(e[d]["innerRight"]){c="innerRight";g="right";a="append";f=true}if(e[d]["outerRight"]){c="outerRight";g="right";h="outer";a="append";f=true}if(e[d]["outerLeft"]){c="outerLeft";g="left";h="outer";f=true}if(e[d]["floatRight"]){c="floatRight";h="float";a="append";f=true}if(e[d]["floatLeft"]){c="floatLeft";g="left";h="float";f=true}var b=e[d][c]?e[d][c][0]:e[d];if(b.type&&b.type=="combobox"){this._initToolPanel(h,c,g,a,d,"combobox")}else{if(f){this._initToolPanel(h,c,g,a,d,"button")}}}if(!f){this.uiDialogButtonPanel=$("<span class='"+c+" coral-textbox-btn-icons coral-buttonset coral-corner-"+g+" '></span>");this._createtoolPanelItems(this.options.buttons,g,this.uiDialogButtonPanel,h,"button");
this.elementBorder.append(this.uiDialogButtonPanel);this.elementBorder.css("padding-right",this.uiDialogButtonPanel.outerWidth());this.uiDialogButtonPanel.css("right",0);this.rightPos=this.uiDialogButtonPanel.outerWidth()}},_initToolPanel:function(g,c,f,a,b,e){var d=this;if(g=="inner"){this.uiButtonPanel=$("<span class='button "+c+" coral-buttonset coral-inner coral-corner-"+f+"' data-pos="+g+"_"+f+"></span>");this.buttonPanelWraper=this.elementBorder}else{this.uiButtonPanel=$("<span class='button "+c+" coral-outerbuttonset coral-outer coral-corner-all' data-pos="+g+"_"+f+"></span>");this.buttonPanelWraper=this.component()}this.buttonPanelWraper[a](this.uiButtonPanel);this._createtoolPanelItems(this.options.buttons[b][c],f,this.uiButtonPanel,g,e);this._positionToolPanel(g,f)},_positionToolPanel:function(c,b){var a=this.uiButtonPanel.outerWidth()+1;if(c==="inner"){this.elementBorder.css("padding-"+b,a);this.uiButtonPanel.css(b,0)}else{if(c==="float"){this.uiButtonPanel.css(b,-(a+this.options.inputButtonGutter))}else{if(c==="outer"){this.component().css("padding-"+b,a+this.options.inputButtonGutter);this.uiButtonPanel.css(b,0)}}}if(b==="left"){this.uiButtonPanel.css("width",a)}if(c+b==="innerright"){this.rightPos=this.uiButtonPanel.outerWidth()}},_createtoolPanelItems:function(a,d,b,f,e){var c=this;if($.isEmptyObject(a)){a={}}if(a instanceof Array==false){a=[a]}$.each(a,function(l){var k="",h="coral-corner-all";if(f=="inner"&&d=="left"){if(l==0){k="coral-corner-left"}}else{if(f=="inner"&&d=="right"){if(l==(a.length-1)){k="coral-corner-right"}}else{h=""}}if(e==="button"){var n,m=$.extend({type:"button"},{click:this.click});this.click=this.onClick||this.click;delete this.onClick;n=this.click||$.noop;m.click=function(){n.apply(c.element[0],arguments)};delete this.click;var j=$("<button></button>",m).button(this);j.button("component").addClass(k).removeClass(h).appendTo(b);this.click=n}else{if(e==="combobox"){delete this.type;this.width="item";var g=$("<input type='text'/>").appendTo("body");
g.off(".changeLength").on("comboboxonload.changeLength",{target:g},function(i){c.resizeCombo.apply(i.data.target.combobox("instance"))}).on("comboboxonchange.changeLength",{target:g},function(i){c.resizeCombo.apply(i.data.target.combobox("instance"))}).combobox(this);g.combobox("component").addClass(k).removeClass(h).appendTo(b).addClass("coral-DropDownButton")}}})},resizeCombo:function(){var d=this,c=this.options,a=0;function e(i,h){var g=d.options.inputButtonGutter,f=0;if(i==="outer"){$(".coral-outer").children(".coral-DropDownButton").each(function(){f+=$(this).width()});d.component().closest(".coral-outer").css("width",f);d.component().closest(".coral-outer").closest(".coral-textbox").css("padding-"+h,f+g)}if(i==="inner"){if(d.component().hasClass("coral-inner-left")){$(".coral-inner").find(".coral-inner-left").each(function(){f+=$(this).width()});d.component().closest(".coral-textbox-border").css("padding-left",f)}}}if(this.component().closest(".coral-inner").length){e("inner","left")}var b=this.component().closest(".coral-outer");if(b.length){if(b.attr("data-pos")=="outer_right"){e("outer","right")}if(b.attr("data-pos")=="outer_left"){e("outer","left")}}}});

$.parser={auto:true,doneArr:[],component:[],onComplete:function(a){},onInit:function(a){},plugins:["tabs","layout","grid","panel","button","menubutton","treebutton","splitbutton","accordion","textbox","autocomplete","uploader","radio","radiolist","checkbox","checkboxlist","spinner","slider","combo","combobox","combotree","combogrid","datepicker","form","picgrid","tree","toolbar","progressbar","menu","menubar","contextmenu","slidemenu","tieredmenu","navigatemenu","dialog","subfield","splitcontainer","view"],parse:function(context){$.parser.onInit.call($.parser,context);var aa=[];var htmlParse=function(){$.each($.parser.component,function(i){var c=$.parser.component.shift();if(c){var ele=$("#"+c.id);if(ele.length){if(c.id&&typeof(c.id)=="string"){var $Script=$("#"+c.id+"_s");if($Script.length>0){$Script.remove()}}if(ele[c.componentName]){ele[c.componentName]()}else{aa.push({name:c.componentName,jq:ele})}}}})};htmlParse();$.each($("script.coralscript",context),function(i){eval("( function() { "+this.innerHTML+" } )();");$(this).remove()});htmlParse();for(var i=0;i<$.parser.plugins.length;i++){var name=$.parser.plugins[i];var r=$(".coralui-"+name,context);r.removeClass("coralui-"+name);if(r.length){if(r[name]){r[name]()}else{aa.push({name:name,jq:r})}}}if(aa.length){var names=[];for(var i=0;i<aa.length;i++){names.push(aa[i].name)}easyloader.load(names,function(){for(var i=0;i<aa.length;i++){var name=aa[i].name;var jq=aa[i].jq;jq[name]()}$.parser.onComplete.call($.parser,context);$.each($.parser.doneArr,function(i){var fun=$.parser.doneArr.shift();if($.isFunction(fun)){fun.call($.parser,context)}});$.coral.refreshAllComponent(context);$.parser.onComplete.call($.parser,context);bb={}})}else{$.parser.onComplete.call($.parser,context);$.each($.parser.doneArr,function(i){var fun=$.parser.doneArr.shift();if($.isFunction(fun)){fun.call($.parser)}else{if(fun){var o=fun;if($.isFunction(o.fun)){o.fun.call(o.context,o.args)}}}});$.coral.refreshAllComponent(context);$.parser.onComplete.call($.parser,context);
bb={}}},parseOptions:function(f,g,c){var l=$(f),n=$.trim(l.attr("data-options")),e=null,k=null,a=null,d=0,b=null,j=null,h=null,m={};if(n){e=n.substring(0,1);k=n.substring(n.length-1,1);if(e!="{"){n="{"+n}if(k!="}"){n=n+"}"}m=(new Function("return "+n))()}if(g){a={};for(var d=0;d<g.length;d++){j=g[d];if(typeof j=="string"){if(j=="width"||j=="height"||j=="left"||j=="top"){a[j]=parseInt(f.style[j])||undefined}else{a[j]=l.attr(j)}}else{for(b in j){h=j[b];if(h=="boolean"){a[b]=l.attr(b)?(l.attr(b)=="true"):undefined}else{if(h=="number"){a[b]=l.attr(b)=="0"?0:parseFloat(l.attr(b))||undefined}}}}}$.extend(m,a);a=null}if(c instanceof Array){for(d=0;d<c.length;d++){b=c[d];if(m.controllerName&&typeof m[b]=="string"){m[b]=m.controllerName+"."+m[b]}change2object(m,b.split("."),m.controllerName)}}return m}};$(function(){if(!window.easyloader&&$.parser.auto){$.parser.parse()}});function change2object(d,b){var a=b.shift();if(b.length==0){if(d&&d[a]&&typeof d[a]==="string"){try{d[a]=(new Function("return "+d[a]))()}catch(c){}}}else{change2object(d[a],b)}}$.parseDone=function(a){$.parser.doneArr.push(a)};

var validate_uuid=0,validateSuffix="coralForm",validatePrefix="validate";$.validate={options:{onStatus:"onstatus",errorMode:1,errMsgPosition:"leftBottom",requiredMsg:"*必输项",triggers:{textbox:["onchange","onblur","onkeyup"],radio:["onchange","onblur"],checkbox:["onchange","onblur"],radiolist:["onchange","onblur"],checkboxlist:["onchange","onblur"],combobox:["onchange","onblur"],combotree:["onchange","onblur"],combogrid:["onchange","onblur"],datepicker:["onchange","onblur"],autocomplete:["onchange","onblur"],spinner:["onchange","onblur"],textboxlist:["onchange","onblur"],autocompletetree:["onchange","onblur"],fileuploader:["onchange"]}},validateSuffix:function(){return validateSuffix},_validate:function(c){var d=c.validType,b=c.validValue,g=c.elementValue,h=c.optionValue,f=c.field,a=c.requiredMsg,e=c.errMsg;if(typeof b=="undefined"){return""}switch(d){case"required":return this._checkRequired(b,g,a);case"minlength":return this._checkMinlength(b,g,e);case"maxlength":return this._checkMaxlength(b,g,e);case"pattern":return this._checkPattern(b,g,e);case"validType":return this._checkValidType(b,g,h,e);case"valid":return this._checkValid(b,g,e,f);default:return""}},getFieldType:function(a){return $(a).attr("component-role")},validTypeNames:["required","minlength","maxlength","pattern","validType","valid"],validTypeOptions:{maxlength:{restrictInput:false,showTooltip:false},number:{restrictInput:false},naturalnumber:{restrictInput:false},integer:{restrictInput:false},"float":{restrictInput:false},zh:{restrictInput:false},letter:{restrictInput:false},uppercase:{restrictInput:false},lowercase:{restrictInput:false},zhOrNumOrLett:{restrictInput:false},ip:{restrictInput:false},port:{restrictInput:false},url:{restrictInput:false},email:{restrictInput:false},mobile:{restrictInput:false},idno:{restrictInput:false},zipcode:{restrictInput:false}},validateField:function(p,w){validAction=true;w.validoptions=w.validoptions||{};var b=w.element,f=$.validate.getFieldType(b),j=w.notComponent?w.component:b[f]("component"),d=w.notComponent?w.validoptions:b[f]("option"),x=null,t=w.hasTips,c=[],v=[],u=d.errorMode||w.validoptions.errorMode||$.validate.options.errorMode,m=d.errMsgPosition||w.validoptions.errMsgPosition||$.validate.options.errMsgPosition,l=d.readonly,g=d.disabled,k=d.isLabel;
if(!j.is(":visible")){t=false}t=false;if("hidden"==b.attr("type")){b.prop("isError",false);return v}if(k||g){b.prop("isError",false);return v}if(w.notComponent){x=w.value}else{if("radio"===f||"checkbox"===f){x=b.prop("checked")?b[f]("getValue"):""}else{if("datepicker"===f){x=b[f]("option","value")}else{try{x=b[f]("getValidateValue")}catch(s){$.error("cannot call methods on "+f+" , please achieve the getValue method !")}}}}for(var q=0;q<this.validTypeNames.length;q++){var n=this.validTypeNames[q],r={optionValue:d.validType,requiredMsg:d.requiredMsg,elementValue:x,field:b,errMsg:d.errMsg,validValue:d[n],validType:n};if(d[n]&&(n=="required")?true:(x!="")){var o=$.validate._validate(r);o==""||v.push(o)}}if(v.length>0){$.validate.hideErrors(j);if(!w.notComponent){if(u==0){$(j).attr("data-errors",v.toString())}else{var a=j.css("padding-right");j.append("<span class='cui-icon-notification2 coral-errorIcon' style='right:"+a+"' data-errors = '"+v.toString()+"' ></span>");j.addClass("hasErrorIcon ")}}j.addClass("coral-validate-error ");var h=v;$.validate._apply(d.onValidError,b,p,h);$(b).prop("isError",true);return v}else{$.validate._apply(d.onValidSuccess,b,p,{});j.removeClass("coral-validate-error");$.validate.hideErrors(j);$(b).prop("isError",false);$(j).removeAttr("data-errors");return v}},_apply:function(e,b,c,d){var a=$.coral.toFunction(e);if($.isFunction(a)){return a.apply(b,[c,d])}},_checkValid:function(b,f,d,e){var c="";if(!!d){c=d}var a=null;if(b){a=$.coral.toFunction(b).apply(e&&e[0],[{value:f}]);if(typeof a=="object"&&typeof a.isValid=="boolean"){if(a.isValid){return""}else{if(!!a.errMsg){return a.errMsg}return c==""?a.errMsg:c}}if(typeof a=="boolean"){if(a){return c}else{return c}}}return""},_checkRequired:function(b,d,a){var c=$.validate.options.requiredMsg;if(a){c=a}if(typeof b=="boolean"&&b&&(""==$.trim(d))){return c}else{return""}},_checkMinlength:function(b,f,e){var d="最少输入"+b+"个字符！";if(typeof e!="undefined"&&e!=null&&e!=""){d=e}if(b&&this._isPositiveInteger(b)){var a=parseInt(b),c=this._getByteLength(f);
if(c<a){return d}else{return""}}},_checkMaxlength:function(b,f,e){var d="最多输入"+b+"个字符！";if(typeof e!="undefined"&&e!=null&&e!=""){d=e}if(b&&this._isPositiveInteger(b)){var a=parseInt(b),c=this._getByteLength(f);if(c>a){return d}else{return""}}},_checkPattern:function(validValue,elementValue,errMsg){var errMsgResult="请输入匹配的字符串！";if(typeof errMsg!="undefined"&&errMsg!=null&&errMsg!=""){errMsgResult=errMsg}if(validValue){var reg=eval(validValue.replace(/\/\//g,"/"));if(!reg.test($.trim(elementValue))){return errMsgResult}else{return""}}else{return""}},_checkValidType:function(a,e,f,c){var b="";if(typeof c!="undefined"&&c!=null&&c!=""){b=c}var d=e;switch(a){case"number":if(""==b){b="请输入数字！"}return this._isNumber(d)?"":b;case"naturalnumber":if(""==b){b="请输入自然数！"}return this._isNaturalnumber(d)?"":b;case"integer":if(""==b){b="请输入整数！"}return this._isInteger(d)?"":b;case"float":if(""==b){b="请输入实数！"}return this._isFloat(d)?"":b;case"zh":if(""==b){b="请输入汉字！"}return this._isZh(d)?"":b;case"letter":if(""==b){b="请输入英文字母！"}return this._isLetter(d)?"":b;case"uppercase":if(""==b){b="请输入大写英文字母！"}return this._isUppercase(d)?"":b;case"lowercase":if(""==b){b="请输入小写英文字母！"}return this._isLowercase(d)?"":b;case"zhOrNumOrLett":if(""==b){b="请输入汉字、数字、英文字母！"}return this._isZhOrNumOrLett(d)?"":b;case"ip":if(""==b){b="请输入合法的计算机IP地址！"}return this._isIp(d)?"":b;case"port":if(""==b){b="请输入合法的计算机IP地址端口号！"}return this._isPort(d)?"":b;case"url":if(""==b){b="请输入合法的网页地址！"}return this._isUrl(d)?"":b;case"email":if(""==b){b="请输入合法的电子邮件地址！"}return this._isEmail(d)?"":b;case"mobile":if(""==b){b="请输入合法的手机号码！"}return this._isMobile(d)?"":b;case"idno":if(""==b){b="请输入合法的身份证号码！"}return this._isIDNo(d)?"":b;case"zipcode":if(""==b){b="请输入合法邮政编码！"}return this._isZipcode(d)?"":b;default:return""}},_isNumber:function(a){if(!isNaN(a)){return true}else{return false}},_isNaturalnumber:function(a){if(/^[0-9]+$/.test(a)){return true}else{return false}},_isInteger:function(a){if(/^(\+|-)?\d+$/.test(a)){return true}else{return false
}},_isFloat:function(a){if(/^(\+|-)?\d+($|\.\d+$)/.test(a)){return true}else{return false}},_isZh:function(a){if(/^[\u4e00-\u9fa5]+$/.test(a)){return true}else{return false}},_isLetter:function(a){if(/^[A-Za-z]+$/.test(a)){return true}else{return false}},_isUppercase:function(a){if(/^[A-Z]+$/.test(a)){return true}else{return false}},_isLowercase:function(a){if(/^[a-z]+$/.test(a)){return true}else{return false}},_isZhOrNumOrLett:function(a){if(/^[0-9a-zA-Z\u4e00-\u9fa5]+$/.test(a)){return true}else{return false}},_isIp:function(a){if(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/.test(a)){if(RegExp.$1<256&&RegExp.$2<256&&RegExp.$3<256&&RegExp.$4<256){return true}}else{return false}},_isPort:function(a){if(this._isNaturalnumber(a)&&a<65536){return true}else{return false}},_isUrl:function(a){if(/^http:\/\/(www\.)?.+.?$/.test(a)){return true}else{return false}},_isEmail:function(a){if(/^([-_A-Za-z0-9\.]+)@([_A-Za-z0-9]+\.)+[A-Za-z0-9]{2,3}$/.test(a)){return true}else{return false}},_isMobile:function(a){if(/^0?(13[0-9]|15[012356789]|18[0-9]|14[57])[0-9]{8}$/.test(a)){return true}else{return false}},_isIDNo:function(a){var f={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};var c=0;var b="";var k=a;var e=k.length;if(!/^\d{17}(\d|x)$/i.test(k)&&!/^\d{15}$/i.test(k)){return false}k=k.replace(/x$/i,"a");if(f[parseInt(k.substr(0,2))]==null){return false}if(e==18){var g=k.substr(6,4)+"-"+Number(k.substr(10,2))+"-"+Number(k.substr(12,2));var j=new Date(g.replace(/-/g,"/"));if(g!=(j.getFullYear()+"-"+(j.getMonth()+1)+"-"+j.getDate())){return false}for(var h=17;h>=0;h--){c+=(Math.pow(2,h)%11)*parseInt(k.charAt(17-h),11)}if(c%11!=1){return false}}else{if(e==15){g="19"+k.substr(6,2)+"-"+Number(k.substr(8,2))+"-"+Number(k.substr(10,2));var j=new Date(g.replace(/-/g,"/"));
var l=j.getFullYear().toString()+"-"+(j.getMonth()+1)+"-"+j.getDate();if(g!=l){return false}}}return true},_isZipcode:function(a){if(this._isNaturalnumber(a)&&a.length==6){return true}else{return false}},_isDate:function(b,h){var c=$.trim(b);var f,e,g,a,i;if(/^(y{4})(-|\/)(M{1,2})\2(d{1,2})$/.test(h)){a=/^(\d{4})(-|\/)(\d{1,2})\2(\d{1,2})$/}else{if(/^(y{4})(年)(M{1,2})(月)(d{1,2})(日)$/.test(h)){a=/^(\d{4})年(\d{1,2})月(\d{1,2})日$/}else{if(h=="yyyyMMdd"){a=/^(\d{4})(\d{2})(\d{2})$/}else{return false}}}i=c.match(a);if(i==null){return false}if(/^(y{4})(-|\/)(M{1,2})\2(d{1,2})$/.test(h)){f=i[1];e=i[3];g=i[4]}else{f=i[1];e=i[2];g=i[3]}if(e<1||e>12){return false}if(g<1||g>31){return false}if((e==4||e==6||e==9||e==11)&&g==31){return false}if(e==2){var d=(f%4==0&&(f%100!=0||f%400==0));if(g>29){return false}if((g==29)&&(!d)){return false}}return true},showRequiredMark:function(b){var a=b.component;a.find("span.coral-validate-required:first").remove();a.append("<span class='coral-validate-required'>*</span>")},hideRequiredMark:function(b){var a=b.component;a.find("span.coral-validate-required:first").remove()},showErrors:function(b,a,m,d){var l=b;if(b.hasClass("coral-hasLabel")||b.hasClass("coral-validate-starBefore")){if(b.find(".coral-radio-label").length){b=b.find(".coral-radio-label")}else{if(b.find(".coral-checkbox-label").length){b=b.find(".coral-checkbox-label")}else{if(b.find(".coral-label").next().length){b=b.find(".coral-label").next()}else{if(b.find(".coral-validate-required").next().length){b=b.find(".coral-validate-required").next()}}}}}var o=true,e=$(b).parents("form"),g="tooltip",q=a.join("<br />"),p,r,j=$(b);var k=j.attr("id"),p=$("."+k+validateSuffix);var n="coral-validate-errorArrow-top";if($(b).parents("form").length!=0){g=$(e).form("option","container")}switch(m){case"leftTop":n="coral-validate-errorArrow-top";break;case"leftBottom":n="coral-validate-errorArrow-bottom";break;case"rightTop":n="coral-validate-errorArrow-top";break;case"rightBottom":n="coral-validate-errorArrow-bottom";
break;case"right":n="coral-validate-errorArrow-right";break;default:break}var c='<div class="'+n+'"></div>';if(k==null){k=j.attr("id",validatePrefix+validate_uuid++).attr("id")}if($("."+k+validateSuffix).length>0){$("."+k+validateSuffix).find(".error-content").html(q)}else{p=$("<div class='"+k+validateSuffix+" coral-validate-state-error'><div class='error-content'>"+q+"</div>"+c+"</div>");var s=$(b).parents("form").attr("context");if($(s).length>0){$(s).append(p)}else{$(document.body).append(p)}r=j.position()}var h="left top",i="right-20 top-"+(p.outerHeight()+8);switch(m){case"leftTop":h="right top";i="left+"+p.outerWidth()+" top-"+(p.outerHeight()+8);break;case"leftBottom":h="right bottom";i="left+"+p.outerWidth()+" bottom+"+(p.outerHeight()+8);break;case"rightTop":h="left top";i="right-20 top-"+(p.outerHeight()+8);break;case"rightBottom":h="left bottom";i="right-20 bottom+"+(p.outerHeight()+8);break;case"right":h="left middle";i="right+15 middle";break;default:break}p.position({my:h,at:i,of:j});l.addClass("coral-validate-error");var f=this;setTimeout(function(){},2000)},clearErrors:function(e){var a=$.coral.findComponent(".ctrl-form-element",e),d=0,b=a.length;for(d;d<b;d++){var f=a[d];if(f instanceof Array){$(f[0].element)[f[0].name]("clearError")}else{f.clearError()}}},clear:function(){$(".coral-validate-state-error").remove();$(".coral-errorIcon").remove();$(".coral-validate-error").removeClass("coral-validate-error")},hideErrors:function(b){var a=$(b);var c=a.attr("id");$("."+c+validateSuffix).remove();$(".coral-errorIcon",a).remove();a.removeClass("coral-validate-error hasErrorIcon ")},hideErrorsTip:function(b){var a=$(b);var c=a.attr("id");$("."+c+validateSuffix).remove()},_showTooltip:function(e,b){var c=$(e);var d=$("<div class='coral-validate-tooltip'>"+b+"</div>");$(document.body).after(d);var a=c.position();d.position({my:"left top",at:"right+20 top+"+($(e).height()/2-d.outerHeight()/2),of:c})},_hideTooltip:function(b){var a=$(b);$(".coral-validate-tooltip").remove()
},_getSubString:function(d,e){var c=/[^\x00-\xff]/g;if(d.replace(c,"mm").length<=e){return d}var a=Math.floor(e/2);for(var b=a;b<d.length;b++){if(d.substr(0,b).replace(c,"mm").length>=e){return d.substr(0,b)}}return d},_getByteLength:function(d){var c=0;for(var a=0;a<d.length;a++){var b=d.charAt(a);if(b.match(/[^\x00-\xff]/ig)!=null){c+=2}else{c+=1}}return c},_isPositiveInteger:function(a){return parseInt(a).toString()==="NaN"?false:(parseInt(a)>0?true:false)},addField:function(a,b){var c=this;a.each(function(j,q){var o=$(q),f=o.closest(".coral-form-default"),i=f.length>0?$.extend({},$.validate.options,f.form("option")):$.extend({},$.validate.options);if(o.closest(".coral-form-default").length===0&&o.closest("form").length>0){return}var m=$.validate.getFieldType(o),p=o[m]("component"),d=o[m]("option"),l=o[m]("option","required"),e=o[m]("option","name"),h=o[m]("option","showStar"),n=o[m]("option","starBefore"),g=o[m]("option","validTypeOptions"),k=o[m]("option","triggers")||i.triggers[m]||$.validate.options.triggers[m];if(!$.data(o[0],"inited")){$.data(o[0],"inited",true)}var r=$.map(k,function(s){return m+s+".field"}).join(" ");o.off(".field").on(r,function(s,t){$.validate.validItem($(this),s,true)});o.off(".focuselement").on(m+"onkeydown.focuselement",function(w,x){var A=$.coral.keyCode,u=0;var y=f.find(".coral-button"),t;$.each(y,function(B){if(y[B].type=="submit"){t=y[B]}});var v=f.find(".tabbable"),u=0;var s=document.activeElement,z;$.each(v,function(B){z=v[B]===s;u=B;if(z){return false}});if(z){if(w.ctrlKey){switch(w.keyCode){case A.ENTER:w.preventDefault();if(u>0){v[u-1].focus()}else{if(u==0){if(t){t.focus()}else{v[v.length-1].focus()}}}break}}else{switch(w.keyCode){case A.ENTER:w.preventDefault();if(u<v.length-1){v[u+1].focus()}else{if(u==v.length-1){if(t){t.focus()}else{v[0].focus()}}}break}}}});o.off(".restrictInput").on(m+"onkeydown.restrictInput",function(s,t){return $.validate.restrictInput($(this),s)});o.off(".restrictInputup").on(m+"onkeyup.restrictInputup",function(s,t){return $.validate.restrictInput($(this),s)
});if(o[m]("option","maxlength")){$.validate.showTooltip($(this),g)}o.off(".validate").on(m+i.onStatus+".validate",function(s,t){$.validate.validItem($(this),s,t.hasTips)});o.off(".prop").on("onOptionChange.prop",function(s,t){$.validate._onFieldOptionChange($(this),s,t)});if(typeof l==="boolean"&&l){o.trigger("onOptionChange",{key:"required",value:l})}})},showTooltip:function(b,a){a=$.extend(true,{},$.validate.validTypeOptions,a);var c=a.maxlength.showTooltip;if(!c){return}$(b).attr("tooltips","tooltips");$(b).tooltip({items:"[tooltips]"}).addClass("hasTooltip");$.validate.getMaxLength(b);$(b).on({keyup:function(d){$.validate.getMaxLength(b)}})},getMaxLength:function(c){var f=0,e=$(c).val(),h=$(c).attr("component-role"),i=$(c)[h]("option","isLabel"),g=$(c)[h]("option","readonly"),d=$(c)[h]("option","readonlyInput"),b=$.validate._getByteLength(e),a=$(c)[h]("option","maxlength"),f=a-b;if(i==false&&g==false&&d==false){$(c).tooltip("option","content","还可以输入"+f+"个字符")}},restrictInput:function(c,f,e){var b=$(c).attr("component-role"),d=$(c)[b]("option"),a=null;$.each($.validate.validTypeNames,function(l,n){var k=d[n],j=$.validate.validTypeOptions[n],h=$.validate.validTypeOptions[k],m=null,g=null;if(k&&j){m=n;g=j}else{if(k&&h){m=k;g=h}}if(m&&g){if(g.restrictInput){a=$.validate.forbiddenInput(m,f,c)}}});return a},forbiddenInput:function(l,b,d){var h=$(d).attr("component-role"),a=$(d)[h]("option"),m=null;var e=d.val();switch(l){case"maxlength":if((!b.ctrlKey&&-1==$.inArray(b.keyCode,[8,46,9,37,39,35,36]))&&(""!==$.validate._checkMaxlength(a[l],e+String.fromCharCode(b.keyCode)))){var c=0,g=[];for(var f=0;f<e.length;f++){var k=e.charAt(f);if(k.match(/[^\x00-\xff]/ig)!==null){c+=2;if(c<=a[l]){g.push(k)}}else{c+=1;if(c<=a[l]){g.push(k)}}}d.val(g.join(""));m=false}break;case"number":if((!b.ctrlKey&&-1==$.inArray(b.keyCode,[8,46,9,37,39,35,36]))&&(b.keyCode<48||(b.keyCode>57&&b.keyCode<96)||b.keyCode>105)){m=false}var j=/^[0-9]+.?[0-9]*$/;if(!j.test(e)){$(d).val("")}break;default:break
}return m},_changeRequiredMark:function(d,f){var c=d.attr("component-role");var e=d.closest(".ctrl-init-form"),b;if(e.length>0){b=e.form("option")}var g=d[c]("option","showRequiredMark")||(b&&b.showRequiredMark)||$.validate.showRequiredMark;var a=d[c]("option","hideRequiredMark")||(b&&b.hideRequiredMark)||$.validate.hideRequiredMark;g=$.coral.toFunction(g);a=$.coral.toFunction(a);if(f.value===true){g&&g.apply(d[0],[{component:d[c]("component")}])}else{a&&a.apply(d[0],[{component:d[c]("component")}])}},_onFieldOptionChange:function(c,f,d){var b=c.attr("component-role"),a=d.key;switch(a){case"required":$.validate._changeRequiredMark(c,d);c[b]("clearError");case"isLabel":case"readonly":case"readonlyInput":c[b]("clearError")}},validItem:function(d,g,f){var b=this.options;var h={validoptions:b,hasTips:f,element:d};var c=$(d).attr("component-role"),e=$(d)[c]("option"),a=e.excluded;if(a){return}$.validate.validateField(g,h)},setExcluded:function(f,e){var a=$.coral.findComponent(".ctrl-form-element",$(e)),d=0,b=a.length;for(d;d<b;d++){var g=a[d];if(g instanceof Array){$(g[0].element)[g[0].name]("option","excluded",f);$(g[0].element)[g[0].name]("component").removeClass("coral-validate-error");$(g[0].element)[g[0].name]("component").removeAttr("data-errors");$(".coral-errorIcon",$(g[0].element)[g[0].name]("component")).remove();$(g[0].element).prop("isError",false)}else{g._setOption("excluded",f);g.component().removeClass("coral-validate-error");g.component().removeAttr("data-errors");$(".coral-errorIcon",g.component()).remove();g.element.prop("isError",false)}}}};$.component("coral.validate",{version:$.coral.version,options:{onStatus:"onstatus",showStar:true,errMessages:{required:"* 必输项",minLength:"{0}",maxLength:"{0}",pattern:"",validType:{number:""},valid:""},fields:{},errMsgPosition:"leftBottom",excluded:[":disabled",":hidden",":not(:visible)"]},_isExclud:function(f,c){if(!c){return false}var h=c.length;var e=f.attr("component-role"),g=f[e]("option"),b=g.excluded,a=f[e]("component");
for(var d=0;d<h;d++){if(("string"===typeof c[d]&&a.is(c[d]))||b){return true}}return false},_create:function(){var a=this;this.element.addClass("coral-validate ctrl-init ctrl-init-validate");a._initField();this.element.addClass("inited-validate")},_destroy:function(){this.element.removeClass("coral-validate ctrl-init ctrl-init-validate");this._super()},_setOption:function(a,b){if(a=="id"||a=="name"){return}this._super(a,b);return},removeField:function(){},updateField:function(){},_initField:function(){var a=$(this.element).find(".ctrl-form-element");$.validate.addField(a,this.options)},valid:function(d){if(!d){d=this.element}var f=this,b=null,g=0,c=this.options.excluded,a=null,e=true;if(c&&"string"===typeof c){c=$.map(c.split(","),function(h){return $.trim(h)})}if(d.is($("[class*='coral-validation-']"))){b=$(d)}else{b=$(d).parent().find($("[class*='coral-validation-']"))}if("form"===$(d)[0].tagName.toLowerCase()){a=$(d).form("option","errTipsType")}a="none";b.each(function(h){var j=$(this),i=$.validate.getFieldType(j);if(f._isExclud(j,c)){return}if("none"===a){e=false}j.trigger(i+f.options.onStatus+".validate",{hasTips:e});if(j.prop("isError")){if("first"===a){e=false}if(g==0){j[i]("focus")}++g}});return(g>0?false:true)}});

/*!
 * 组件库 4.0：鼠标辅助工具
 *
 * 依赖JS文件:
 *	jquery.coral.component.js
 */
(function(){var a=false;$(document).mouseup(function(){a=false});$.component("coral.mouse",{version:"4.0.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.componentName,function(c){return b._mouseDown(c)}).bind("click."+this.componentName,function(c){if(true===$.data(c.target,b.componentName+".preventClickEvent")){$.removeData(c.target,b.componentName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.componentName);if(this._mouseMoveDelegate){this.document.unbind("mousemove."+this.componentName,this._mouseMoveDelegate).unbind("mouseup."+this.componentName,this._mouseUpDelegate)}},_mouseDown:function(d){if(a){return}(this._mouseStarted&&this._mouseUp(d));this._mouseDownEvent=d;var c=this,e=(d.which===1),b=(typeof this.options.cancel==="string"&&d.target.nodeName?$(d.target).closest(this.options.cancel).length:false);if(!e||b||!this._mouseCapture(d)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)){this._mouseStarted=(this._mouseStart(d)!==false);if(!this._mouseStarted){d.preventDefault();return true}}if(true===$.data(d.target,this.componentName+".preventClickEvent")){$.removeData(d.target,this.componentName+".preventClickEvent")}this._mouseMoveDelegate=function(f){return c._mouseMove(f)};this._mouseUpDelegate=function(f){return c._mouseUp(f)};this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);d.preventDefault();a=true;return true},_mouseMove:function(b){if($.coral.ie&&(!document.documentMode||document.documentMode<9)&&!b.button){return this._mouseUp(b)}else{if(!b.which){return this._mouseUp(b)
}}if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,b)!==false);(this._mouseStarted?this._mouseDrag(b):this._mouseUp(b))}return !this._mouseStarted},_mouseUp:function(b){this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(b.target===this._mouseDownEvent.target){$.data(b.target,this.componentName+".preventClickEvent",true)}this._mouseStop(b)}a=false;return false},_mouseDistanceMet:function(b){return(Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})();

/*!
 * jQuery coral Sortable 4.0.1
 *
 * Depends:
 *	jquery.coral.core.js
 *	jquery.coral.component.js
 *	jquery.coral.mouse.js
 */
(function(){function a(d,c,e){return(d>=c)&&(d<(c+e))}function b(c){return(/left|right/).test(c.css("float"))||(/inline|table-cell/).test(c.css("display"))}$.component("coral.sortable",$.coral.mouse,{version:"4.0.1",componentEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var c=this.options;this.containerCache={};this.element.addClass("coral-sortable");this.refresh();this.floating=this.items.length?c.axis==="x"||b(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this._setHandleClassName();this.ready=true},_setOption:function(c,d){this._super(c,d);if(c==="handle"){this._setHandleClassName()}},_setHandleClassName:function(){this.element.find(".coral-sortable-handle").removeClass("coral-sortable-handle");$.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("coral-sortable-handle")})},_destroy:function(){this.element.removeClass("coral-sortable coral-sortable-disabled").find(".coral-sortable-handle").removeClass("coral-sortable-handle");this._mouseDestroy();for(var c=this.items.length-1;c>=0;c--){this.items[c].item.removeData(this.componentName+"-item")}return this},_mouseCapture:function(e,f){var c=null,g=false,d=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(e);
$(e.target).parents().each(function(){if($.data(this,d.componentName+"-item")===d){c=$(this);return false}});if($.data(e.target,d.componentName+"-item")===d){c=$(e.target)}if(!c){return false}if(this.options.handle&&!f){$(this.options.handle,c).find("*").addBack().each(function(){if(this===e.target){g=true}});if(!g){return false}}this.currentItem=c;this._removeCurrentsFromItems();return true},_mouseStart:function(f,g,d){var e,c,h=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(f);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(f);this.originalPageX=f.pageX;this.originalPageY=f.pageY;(h.cursorAt&&this._adjustOffsetFromHelper(h.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(h.containment){this._setContainment()}if(h.cursor&&h.cursor!=="auto"){c=this.document.find("body");this.storedCursor=c.css("cursor");c.css("cursor",h.cursor);this.storedStylesheet=$("<style>*{ cursor: "+h.cursor+" !important; }</style>").appendTo(c)}if(h.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",h.opacity)}if(h.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",h.zIndex)}if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",f,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()
}if(!d){for(e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("activate",f,this._uiHash(this))}}if($.coral.ddmanager){$.coral.ddmanager.current=this}if($.coral.ddmanager&&!h.dropBehaviour){$.coral.ddmanager.prepareOffsets(this,f)}this.dragging=true;this.helper.addClass("coral-sortable-helper");this._mouseDrag(f);return true},_mouseDrag:function(g){var e,f,d,j,h=this.options,c=false;this.position=this._generatePosition(g);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-g.pageY<h.scrollSensitivity){this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+h.scrollSpeed}else{if(g.pageY-this.overflowOffset.top<h.scrollSensitivity){this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-h.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-g.pageX<h.scrollSensitivity){this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+h.scrollSpeed}else{if(g.pageX-this.overflowOffset.left<h.scrollSensitivity){this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-h.scrollSpeed}}}else{if(g.pageY-$(document).scrollTop()<h.scrollSensitivity){c=$(document).scrollTop($(document).scrollTop()-h.scrollSpeed)}else{if($(window).height()-(g.pageY-$(document).scrollTop())<h.scrollSensitivity){c=$(document).scrollTop($(document).scrollTop()+h.scrollSpeed)}}if(g.pageX-$(document).scrollLeft()<h.scrollSensitivity){c=$(document).scrollLeft($(document).scrollLeft()-h.scrollSpeed)}else{if($(window).width()-(g.pageX-$(document).scrollLeft())<h.scrollSensitivity){c=$(document).scrollLeft($(document).scrollLeft()+h.scrollSpeed)}}}if(c!==false&&$.coral.ddmanager&&!h.dropBehaviour){$.coral.ddmanager.prepareOffsets(this,g)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"
}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(e=this.items.length-1;e>=0;e--){f=this.items[e];d=f.item[0];j=this._intersectsWithPointer(f);if(!j){continue}if(f.instance!==this.currentContainer){continue}if(d!==this.currentItem[0]&&this.placeholder[j===1?"next":"prev"]()[0]!==d&&!$.contains(this.placeholder[0],d)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],d):true)){this.direction=j===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(f)){this._rearrange(g,f)}else{break}this._trigger("change",g,this._uiHash());break}}this._contactContainers(g);if($.coral.ddmanager){$.coral.ddmanager.drag(this,g)}this._trigger("sort",g,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,g){if(!e){return}if($.coral.ddmanager&&!this.options.dropBehaviour){$.coral.ddmanager.drop(this,e)}if(this.options.revert){var d=this,h=this.placeholder.offset(),c=this.options.axis,f={};if(!c||c==="x"){f.left=h.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)}if(!c||c==="y"){f.top=h.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)}this.reverting=true;$(this.helper).animate(f,parseInt(this.options.revert,10)||500,function(){d._clear(e)})}else{this._clear(e,g)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("coral-sortable-helper")}else{this.currentItem.show()}for(var c=this.containers.length-1;c>=0;c--){this.containers[c]._trigger("deactivate",null,this._uiHash(this));if(this.containers[c].containerCache.over){this.containers[c]._trigger("out",null,this._uiHash(this));this.containers[c].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])
}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem)}else{$(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(e){var c=this._getItemsAsjQuery(e&&e.connected),d=[];e=e||{};$(c).each(function(){var f=($(e.item||this).attr(e.attribute||"id")||"").match(e.expression||(/(.+)[\-=_](.+)/));if(f){d.push((e.key||f[1]+"[]")+"="+(e.key&&e.expression?f[1]:f[2]))}});if(!d.length&&e.key){d.push(e.key+"=")}return d.join("&")},toArray:function(e){var c=this._getItemsAsjQuery(e&&e.connected),d=[];e=e||{};c.each(function(){d.push($(e.item||this).attr(e.attribute||"id")||"")});return d},_intersectsWith:function(o){var e=this.positionAbs.left,d=e+this.helperProportions.width,m=this.positionAbs.top,k=m+this.helperProportions.height,f=o.left,c=f+o.width,p=o.top,j=p+o.height,q=this.offset.click.top,i=this.offset.click.left,h=(this.options.axis==="x")||((m+q)>p&&(m+q)<j),n=(this.options.axis==="y")||((e+i)>f&&(e+i)<c),g=h&&n;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>o[this.floating?"width":"height"])){return g}else{return(f<e+(this.helperProportions.width/2)&&d-(this.helperProportions.width/2)<c&&p<m+(this.helperProportions.height/2)&&k-(this.helperProportions.height/2)<j)}},_intersectsWithPointer:function(e){var f=(this.options.axis==="x")||a(this.positionAbs.top+this.offset.click.top,e.top,e.height),d=(this.options.axis==="y")||a(this.positionAbs.left+this.offset.click.left,e.left,e.width),h=f&&d,c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();if(!h){return false}return this.floating?(((g&&g==="right")||c==="down")?2:1):(c&&(c==="down"?2:1))},_intersectsWithSides:function(f){var d=a(this.positionAbs.top+this.offset.click.top,f.top+(f.height/2),f.height),e=a(this.positionAbs.left+this.offset.click.left,f.left+(f.width/2),f.width),c=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();
if(this.floating&&g){return((g==="right"&&e)||(g==="left"&&!e))}else{return c&&((c==="down"&&d)||(c==="up"&&!d))}},_getDragVerticalDirection:function(){var c=this.positionAbs.top-this.lastPositionAbs.top;return c!==0&&(c>0?"down":"up")},_getDragHorizontalDirection:function(){var c=this.positionAbs.left-this.lastPositionAbs.left;return c!==0&&(c>0?"right":"left")},refresh:function(c){this._refreshItems(c);this._setHandleClassName();this.refreshPositions();return this},_connectWith:function(){var c=this.options;return c.connectWith.constructor===String?[c.connectWith]:c.connectWith},_getItemsAsjQuery:function(h){var f,e,l,k,c=[],d=[],g=this._connectWith();if(g&&h){for(f=g.length-1;f>=0;f--){l=$(g[f]);for(e=l.length-1;e>=0;e--){k=$.data(l[e],this.componentFullName);if(k&&k!==this&&!k.options.disabled){d.push([$.isFunction(k.options.items)?k.options.items.call(k.element):$(k.options.items,k.element).not(".coral-sortable-helper").not(".coral-sortable-placeholder"),k])}}}}d.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".coral-sortable-helper").not(".coral-sortable-placeholder"),this]);for(f=d.length-1;f>=0;f--){d[f][0].each(function(){c.push(this)})}return $(c)},_removeCurrentsFromItems:function(){var c=this.currentItem.find(":data("+this.componentName+"-item)");this.items=$.grep(this.items,function(e){for(var d=0;d<c.length;d++){if(c[d]===e.item[0]){return false}}return true})},_refreshItems:function(c){this.items=[];this.containers=[this];var g,e,n,h,m,d,p,o,k=this.items,f=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],c,{item:this.currentItem}):$(this.options.items,this.element),this]],l=this._connectWith();if(l&&this.ready){for(g=l.length-1;g>=0;g--){n=$(l[g]);for(e=n.length-1;e>=0;e--){h=$.data(n[e],this.componentFullName);if(h&&h!==this&&!h.options.disabled){f.push([$.isFunction(h.options.items)?h.options.items.call(h.element[0],c,{item:this.currentItem}):$(h.options.items,h.element),h]);
this.containers.push(h)}}}}for(g=f.length-1;g>=0;g--){m=f[g][1];d=f[g][0];for(e=0,o=d.length;e<o;e++){p=$(d[e]);p.data(this.componentName+"-item",m);k.push({item:p,instance:m,width:0,height:0,left:0,top:0})}}},refreshPositions:function(c){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var e,f,d,g;for(e=this.items.length-1;e>=0;e--){f=this.items[e];if(f.instance!==this.currentContainer&&this.currentContainer&&f.item[0]!==this.currentItem[0]){continue}d=this.options.toleranceElement?$(this.options.toleranceElement,f.item):f.item;if(!c){f.width=d.outerWidth();f.height=d.outerHeight()}g=d.offset();f.left=g.left;f.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(e=this.containers.length-1;e>=0;e--){g=this.containers[e].element.offset();this.containers[e].containerCache.left=g.left;this.containers[e].containerCache.top=g.top;this.containers[e].containerCache.width=this.containers[e].element.outerWidth();this.containers[e].containerCache.height=this.containers[e].element.outerHeight()}}return this},_createPlaceholder:function(d){d=d||this;var c,e=d.options;if(!e.placeholder||e.placeholder.constructor===String){c=e.placeholder;e.placeholder={element:function(){var g=d.currentItem[0].nodeName.toLowerCase(),f=$("<"+g+">",d.document[0]).addClass(c||d.currentItem[0].className+" coral-sortable-placeholder").removeClass("coral-sortable-helper");if(g==="tr"){d.currentItem.children().each(function(){$("<td>&#160;</td>",d.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(f)})}else{if(g==="img"){f.attr("src",d.currentItem.attr("src"))}}if(!c){f.css("visibility","hidden")}return f},update:function(f,g){if(c&&!e.forcePlaceholderSize){return}if(!g.height()){g.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10))}if(!g.width()){g.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10))
}}}}d.placeholder=$(e.placeholder.element.call(d.element,d.currentItem));d.currentItem.after(d.placeholder);e.placeholder.update(d,d.placeholder)},_contactContainers:function(c){var h,f,n,k,l,p,q,g,m,e,d=null,o=null;for(h=this.containers.length-1;h>=0;h--){if($.contains(this.currentItem[0],this.containers[h].element[0])){continue}if(this._intersectsWith(this.containers[h].containerCache)){if(d&&$.contains(this.containers[h].element[0],d.element[0])){continue}d=this.containers[h];o=h}else{if(this.containers[h].containerCache.over){this.containers[h]._trigger("out",c,this._uiHash(this));this.containers[h].containerCache.over=0}}}if(!d){return}if(this.containers.length===1){if(!this.containers[o].containerCache.over){this.containers[o]._trigger("over",c,this._uiHash(this));this.containers[o].containerCache.over=1}}else{n=10000;k=null;m=d.floating||b(this.currentItem);l=m?"left":"top";p=m?"width":"height";e=m?"clientX":"clientY";for(f=this.items.length-1;f>=0;f--){if(!$.contains(this.containers[o].element[0],this.items[f].item[0])){continue}if(this.items[f].item[0]===this.currentItem[0]){continue}q=this.items[f].item.offset()[l];g=false;if(c[e]-q>this.items[f][p]/2){g=true}if(Math.abs(c[e]-q)<n){n=Math.abs(c[e]-q);k=this.items[f];this.direction=g?"up":"down"}}if(!k&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[o]){return}k?this._rearrange(c,k,null,true):this._rearrange(c,null,this.containers[o].element,true);this._trigger("change",c,this._uiHash());this.containers[o]._trigger("change",c,this._uiHash(this));this.currentContainer=this.containers[o];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[o]._trigger("over",c,this._uiHash(this));this.containers[o].containerCache.over=1}},_createHelper:function(d){var e=this.options,c=$.isFunction(e.helper)?$(e.helper.apply(this.element[0],[d,this.currentItem])):(e.helper==="clone"?this.currentItem.clone():this.currentItem);if(!c.parents("body").length){$(e.appendTo!=="parent"?e.appendTo:this.currentItem[0].parentNode)[0].appendChild(c[0])
}if(c[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!c[0].style.width||e.forceHelperSize){c.width(this.currentItem.width())}if(!c[0].style.height||e.forceHelperSize){c.height(this.currentItem.height())}return c},_adjustOffsetFromHelper:function(c){if(typeof c==="string"){c=c.split(" ")}if($.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.coral.ie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var c=this.currentItem.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}
},_setContainment:function(){var d,f,c,e=this.options;if(e.containment==="parent"){e.containment=this.helper[0].parentNode}if(e.containment==="document"||e.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(e.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(e.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(e.containment)){d=$(e.containment)[0];f=$(e.containment).offset();c=($(d).css("overflow")!=="hidden");this.containment=[f.left+(parseInt($(d).css("borderLeftWidth"),10)||0)+(parseInt($(d).css("paddingLeft"),10)||0)-this.margins.left,f.top+(parseInt($(d).css("borderTopWidth"),10)||0)+(parseInt($(d).css("paddingTop"),10)||0)-this.margins.top,f.left+(c?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt($(d).css("borderLeftWidth"),10)||0)-(parseInt($(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,f.top+(c?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt($(d).css("borderTopWidth"),10)||0)-(parseInt($(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(f,h){if(!h){h=this.position}var e=f==="absolute"?1:-1,c=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=(/(html|body)/i).test(c[0].tagName);return{top:(h.top+this.offset.relative.top*e+this.offset.parent.top*e-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(g?0:c.scrollTop()))*e)),left:(h.left+this.offset.relative.left*e+this.offset.parent.left*e-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():g?0:c.scrollLeft())*e))}},_generatePosition:function(f){var h,g,i=this.options,e=f.pageX,d=f.pageY,c=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=(/(html|body)/i).test(c[0].tagName);
if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(f.pageX-this.offset.click.left<this.containment[0]){e=this.containment[0]+this.offset.click.left}if(f.pageY-this.offset.click.top<this.containment[1]){d=this.containment[1]+this.offset.click.top}if(f.pageX-this.offset.click.left>this.containment[2]){e=this.containment[2]+this.offset.click.left}if(f.pageY-this.offset.click.top>this.containment[3]){d=this.containment[3]+this.offset.click.top}}if(i.grid){h=this.originalPageY+Math.round((d-this.originalPageY)/i.grid[1])*i.grid[1];d=this.containment?((h-this.offset.click.top>=this.containment[1]&&h-this.offset.click.top<=this.containment[3])?h:((h-this.offset.click.top>=this.containment[1])?h-i.grid[1]:h+i.grid[1])):h;g=this.originalPageX+Math.round((e-this.originalPageX)/i.grid[0])*i.grid[0];e=this.containment?((g-this.offset.click.left>=this.containment[0]&&g-this.offset.click.left<=this.containment[2])?g:((g-this.offset.click.left>=this.containment[0])?g-i.grid[0]:g+i.grid[0])):g}}return{top:(d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(j?0:c.scrollTop())))),left:(e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():j?0:c.scrollLeft())))}},_rearrange:function(g,f,d,e){d?d[0].appendChild(this.placeholder[0]):f.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?f.item[0]:f.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var c=this.counter;this._delay(function(){if(c===this.counter){this.refreshPositions(!e)}})},_clear:function(d,e){this.reverting=false;var c,f=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(c in this._storedCSS){if(this._storedCSS[c]==="auto"||this._storedCSS[c]==="static"){this._storedCSS[c]=""
}}this.currentItem.css(this._storedCSS).removeClass("coral-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!e){f.push(function(g){this._trigger("receive",g,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".coral-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!e){f.push(function(g){this._trigger("update",g,this._uiHash())})}if(this!==this.currentContainer){if(!e){f.push(function(g){this._trigger("remove",g,this._uiHash())});f.push((function(g){return function(h){g._trigger("receive",h,this._uiHash(this))}}).call(this,this.currentContainer));f.push((function(g){return function(h){g._trigger("update",h,this._uiHash(this))}}).call(this,this.currentContainer))}}for(c=this.containers.length-1;c>=0;c--){if(!e){f.push((function(g){return function(h){g._trigger("deactivate",h,this._uiHash(this))}}).call(this,this.containers[c]))}if(this.containers[c].containerCache.over){f.push((function(g){return function(h){g._trigger("out",h,this._uiHash(this))}}).call(this,this.containers[c]));this.containers[c].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!e){this._trigger("beforeStop",d,this._uiHash());for(c=0;c<f.length;c++){f[c].call(this,d)}this._trigger("stop",d,this._uiHash())}this.fromOutside=false;return false}if(!e){this._trigger("beforeStop",d,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null;if(!e){for(c=0;c<f.length;c++){f[c].call(this,d)}this._trigger("stop",d,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if($.Component.prototype._trigger.apply(this,arguments)===false){this.cancel()
}},_uiHash:function(c){var d=c||this;return{helper:d.helper,placeholder:d.placeholder||$([]),position:d.position,originalPosition:d.originalPosition,offset:d.positionAbs,item:d.currentItem,sender:c?c.element:null}}})})();

/*!
 * 组件库4.0：拖动辅助工具
 *
 * 依赖JS文件:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.component.js
 */
(function(){$.component("coral.draggable",$.coral.mouse,{version:"4.0.1",componentEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}if(this.options.addClasses){this.element.addClass("coral-draggable")}if(this.options.disabled){this.element.addClass("coral-draggable-disabled")}this._setHandleClassName();this._mouseInit()},_setOption:function(a,b){this._super(a,b);if(a==="handle"){this._removeHandleClassName();this._setHandleClassName()}},_destroy:function(){if((this.helper||this.element).is(".coral-draggable-dragging")){this.destroyOnClear=true;return}this.element.removeClass("coral-draggable coral-draggable-dragging coral-draggable-disabled");this._removeHandleClassName();this._mouseDestroy()},_mouseCapture:function(c){var a=this.document[0],d=this.options;try{if(a.activeElement&&a.activeElement.nodeName.toLowerCase()!=="body"){$(a.activeElement).blur()}}catch(b){}if(this.helper||d.disabled||$(c.target).closest(".coral-resizable-handle").length>0){return false}this.handle=this._getHandle(c);if(!this.handle){return false}$(d.iframeFix===true?"iframe":d.iframeFix).each(function(){$("<div class='coral-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")});return true},_mouseStart:function(a){var b=this.options;
this.helper=this._createHelper(a);this.helper.addClass("coral-draggable-dragging");this._cacheHelperProportions();if($.coral.ddmanager){$.coral.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent(true);this.offsetParent=this.helper.offsetParent();this.offsetParentCssPosition=this.offsetParent.css("position");this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.scroll=false;$.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(a,false);this.originalPageX=a.pageX;this.originalPageY=a.pageY;(b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt));this._setContainment();if(this._trigger("start",a)===false){this._clear();return false}this._cacheHelperProportions();if($.coral.ddmanager&&!b.dropBehaviour){$.coral.ddmanager.prepareOffsets(this,a)}this._mouseDrag(a,true);if($.coral.ddmanager){$.coral.ddmanager.dragStart(this,a)}return true},_mouseDrag:function(a,c){if(this.offsetParentCssPosition==="fixed"){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(a,true);this.positionAbs=this._convertPositionTo("absolute");if(!c){var b=this._uiHash();if(this._trigger("drag",a,b)===false){this._mouseUp({});return false}this.position=b.position}this.helper[0].style.left=this.position.left+"px";this.helper[0].style.top=this.position.top+"px";if($.coral.ddmanager){$.coral.ddmanager.drag(this,a)}return false},_mouseStop:function(b){var a=this,c=false;if($.coral.ddmanager&&!this.options.dropBehaviour){c=$.coral.ddmanager.drop(this,b)}if(this.dropped){c=this.dropped;this.dropped=false}if(this.options.helper==="original"&&!$.contains(this.element[0].ownerDocument,this.element[0])){return false}if((this.options.revert==="invalid"&&!c)||(this.options.revert==="valid"&&c)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,c))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(a._trigger("stop",b)!==false){a._clear()
}})}else{if(this._trigger("stop",b)!==false){this._clear()}}return false},_mouseUp:function(a){$("div.coral-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if($.coral.ddmanager){$.coral.ddmanager.dragStop(this,a)}this.element.focus();return $.coral.mouse.prototype._mouseUp.call(this,a)},cancel:function(){if(this.helper.is(".coral-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(a){return this.options.handle?!!$(a.target).closest(this.element.find(this.options.handle)).length:true},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element;this.handleElement.addClass("coral-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("coral-draggable-handle")},_createHelper:function(b){var c=this.options,a=$.isFunction(c.helper)?$(c.helper.apply(this.element[0],[b])):(c.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!a.parents("body").length){a.appendTo((c.appendTo==="parent"?this.element[0].parentNode:c.appendTo))}if(a[0]!==this.element[0]&&!(/(fixed|absolute)/).test(a.css("position"))){a.css("position","absolute")}return a},_adjustOffsetFromHelper:function(a){if(typeof a==="string"){a=a.split(" ")}if($.isArray(a)){a={left:+a[0],top:+a[1]||0}}if("left" in a){this.offset.click.left=a.left+this.margins.left}if("right" in a){this.offset.click.left=this.helperProportions.width-a.right+this.margins.left}if("top" in a){this.offset.click.top=a.top+this.margins.top}if("bottom" in a){this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top}},_isRootNode:function(a){return(/(html|body)/i).test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var b=this.offsetParent.offset(),a=this.document[0];if(this.cssPosition==="absolute"&&this.scrollParent[0]!==a&&$.contains(this.scrollParent[0],this.offsetParent[0])){b.left+=this.scrollParent.scrollLeft();b.top+=this.scrollParent.scrollTop()
}if(this._isRootNode(this.offsetParent[0])){b={top:0,left:0}}return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative"){return{top:0,left:0}}var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(!b?this.scrollParent.scrollTop():0),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(!b?this.scrollParent.scrollLeft():0)}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,f,b,e=this.options,a=this.document[0];this.relativeContainer=null;if(!e.containment){this.containment=null;return}if(e.containment==="window"){this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(e.containment==="document"){this.containment=[0,0,$(a).width()-this.helperProportions.width-this.margins.left,($(a).height()||a.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(e.containment.constructor===Array){this.containment=e.containment;return}if(e.containment==="parent"){e.containment=this.helper[0].parentNode}f=$(e.containment);b=f[0];if(!b){return}d=f.css("overflow")!=="hidden";this.containment=[(parseInt(f.css("borderLeftWidth"),10)||0)+(parseInt(f.css("paddingLeft"),10)||0),(parseInt(f.css("borderTopWidth"),10)||0)+(parseInt(f.css("paddingTop"),10)||0),(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(f.css("borderRightWidth"),10)||0)-(parseInt(f.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(f.css("borderBottomWidth"),10)||0)-(parseInt(f.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];
this.relativeContainer=f},_convertPositionTo:function(b,e){if(!e){e=this.position}var a=b==="absolute"?1:-1,c=this._isRootNode(this.scrollParent[0]);return{top:(e.top+this.offset.relative.top*a+this.offset.parent.top*a-((this.cssPosition==="fixed"?-this.offset.scroll.top:(c?0:this.offset.scroll.top))*a)),left:(e.left+this.offset.relative.left*a+this.offset.parent.left*a-((this.cssPosition==="fixed"?-this.offset.scroll.left:(c?0:this.offset.scroll.left))*a))}},_generatePosition:function(b,h){var a,i,j,d,c=this.options,g=this._isRootNode(this.scrollParent[0]),f=b.pageX,e=b.pageY;if(!g||!this.offset.scroll){this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}}if(h){if(this.containment){if(this.relativeContainer){i=this.relativeContainer.offset();a=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else{a=this.containment}if(b.pageX-this.offset.click.left<a[0]){f=a[0]+this.offset.click.left}if(b.pageY-this.offset.click.top<a[1]){e=a[1]+this.offset.click.top}if(b.pageX-this.offset.click.left>a[2]){f=a[2]+this.offset.click.left}if(b.pageY-this.offset.click.top>a[3]){e=a[3]+this.offset.click.top}}if(c.grid){j=c.grid[1]?this.originalPageY+Math.round((e-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;e=a?((j-this.offset.click.top>=a[1]||j-this.offset.click.top>a[3])?j:((j-this.offset.click.top>=a[1])?j-c.grid[1]:j+c.grid[1])):j;d=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=a?((d-this.offset.click.left>=a[0]||d-this.offset.click.left>a[2])?d:((d-this.offset.click.left>=a[0])?d-c.grid[0]:d+c.grid[0])):d}if(c.axis==="y"){f=this.originalPageX}if(c.axis==="x"){e=this.originalPageY}}return{top:(e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:(g?0:this.offset.scroll.top))),left:(f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:(g?0:this.offset.scroll.left)))}
},_clear:function(){this.helper.removeClass("coral-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false;if(this.destroyOnClear){this.destroy()}},_trigger:function(a,b,c){c=c||this._uiHash();$.coral.plugin.call(this,a,[b,c,this],true);if(a==="drag"){this.positionAbs=this._convertPositionTo("absolute")}return $.Component.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});$.coral.plugin.add("draggable","connectToSortable",{start:function(b,d,c){var e=c.options,a=$.extend({},d,{item:c.element});c.sortables=[];$(e.connectToSortable).each(function(){var f=$.data(this,"coral-sortable");if(f&&!f.options.disabled){c.sortables.push({instance:f,shouldRevert:f.options.revert});f.refreshPositions();f._trigger("activate",b,a)}})},stop:function(b,d,c){var a=$.extend({},d,{item:c.element});$.each(c.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;c.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=this.shouldRevert}this.instance._mouseStop(b);this.instance.options.helper=this.instance.options._helper;if(c.options.helper==="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",b,a)}})},drag:function(b,d,c){var a=this;$.each(c.sortables,function(){var e=false,f=this;this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){e=true;$.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this!==f&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(f.instance.element[0],this.instance.element[0])){e=false
}return e})}if(e){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=$(a).clone().removeAttr("id").appendTo(this.instance.element).data("coral-sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return d.helper[0]};b.target=this.instance.currentItem[0];this.instance._mouseCapture(b,true);this.instance._mouseStart(b,true,true);this.instance.offset.click.top=c.offset.click.top;this.instance.offset.click.left=c.offset.click.left;this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top;c._trigger("toSortable",b);c.dropped=this.instance.element;c.currentItem=c.element;this.instance.fromOutside=c}if(this.instance.currentItem){this.instance._mouseDrag(b)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",b,this.instance._uiHash(this.instance));this.instance._mouseStop(b,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}c._trigger("fromSortable",b);c.dropped=false}}})}});$.coral.plugin.add("draggable","cursor",{start:function(c,d,a){var b=$("body"),e=a.options;if(b.css("cursor")){e._cursor=b.css("cursor")}b.css("cursor",e.cursor)},stop:function(b,c,a){var d=a.options;if(d._cursor){$("body").css("cursor",d._cursor)}}});$.coral.plugin.add("draggable","opacity",{start:function(c,d,a){var b=$(d.helper),e=a.options;if(b.css("opacity")){e._opacity=b.css("opacity")}b.css("opacity",e.opacity)},stop:function(b,c,a){var d=a.options;if(d._opacity){$(c.helper).css("opacity",d._opacity)}}});$.coral.plugin.add("draggable","scroll",{start:function(b,c,a){if(!a.scrollParentNotHidden){a.scrollParentNotHidden=a.helper.scrollParent(false)}if(a.scrollParentNotHidden[0]!==a.document[0]&&a.scrollParentNotHidden[0].tagName!=="HTML"){a.overflowOffset=a.scrollParentNotHidden.offset()
}},drag:function(d,e,c){var f=c.options,b=false,g=c.scrollParentNotHidden[0],a=c.document[0];if(g!==a&&g.tagName!=="HTML"){if(!f.axis||f.axis!=="x"){if((c.overflowOffset.top+g.offsetHeight)-d.pageY<f.scrollSensitivity){g.scrollTop=b=g.scrollTop+f.scrollSpeed}else{if(d.pageY-c.overflowOffset.top<f.scrollSensitivity){g.scrollTop=b=g.scrollTop-f.scrollSpeed}}}if(!f.axis||f.axis!=="y"){if((c.overflowOffset.left+g.offsetWidth)-d.pageX<f.scrollSensitivity){g.scrollLeft=b=g.scrollLeft+f.scrollSpeed}else{if(d.pageX-c.overflowOffset.left<f.scrollSensitivity){g.scrollLeft=b=g.scrollLeft-f.scrollSpeed}}}}else{if(!f.axis||f.axis!=="x"){if(d.pageY-$(a).scrollTop()<f.scrollSensitivity){b=$(a).scrollTop($(a).scrollTop()-f.scrollSpeed)}else{if($(window).height()-(d.pageY-$(a).scrollTop())<f.scrollSensitivity){b=$(a).scrollTop($(a).scrollTop()+f.scrollSpeed)}}}if(!f.axis||f.axis!=="y"){if(d.pageX-$(a).scrollLeft()<f.scrollSensitivity){b=$(a).scrollLeft($(a).scrollLeft()-f.scrollSpeed)}else{if($(window).width()-(d.pageX-$(a).scrollLeft())<f.scrollSensitivity){b=$(a).scrollLeft($(a).scrollLeft()+f.scrollSpeed)}}}}if(b!==false&&$.coral.ddmanager&&!f.dropBehaviour){$.coral.ddmanager.prepareOffsets(c,d)}}});$.coral.plugin.add("draggable","snap",{start:function(b,c,a){var d=a.options;a.snapElements=[];$(d.snap.constructor!==String?(d.snap.items||":data(coral-draggable)"):d.snap).each(function(){var f=$(this),e=f.offset();if(this!==a.element[0]){a.snapElements.push({item:this,width:f.outerWidth(),height:f.outerHeight(),top:e.top,left:e.left})}})},drag:function(s,n,f){var a,y,h,j,q,m,k,z,u,g,p=f.options,x=p.snapTolerance,w=n.offset.left,v=w+f.helperProportions.width,e=n.offset.top,c=e+f.helperProportions.height;for(u=f.snapElements.length-1;u>=0;u--){q=f.snapElements[u].left;m=q+f.snapElements[u].width;k=f.snapElements[u].top;z=k+f.snapElements[u].height;if(v<q-x||w>m+x||c<k-x||e>z+x||!$.contains(f.snapElements[u].item.ownerDocument,f.snapElements[u].item)){if(f.snapElements[u].snapping){(f.options.snap.release&&f.options.snap.release.call(f.element,s,$.extend(f._uiHash(),{snapItem:f.snapElements[u].item})))
}f.snapElements[u].snapping=false;continue}if(p.snapMode!=="inner"){a=Math.abs(k-c)<=x;y=Math.abs(z-e)<=x;h=Math.abs(q-v)<=x;j=Math.abs(m-w)<=x;if(a){n.position.top=f._convertPositionTo("relative",{top:k-f.helperProportions.height,left:0}).top-f.margins.top}if(y){n.position.top=f._convertPositionTo("relative",{top:z,left:0}).top-f.margins.top}if(h){n.position.left=f._convertPositionTo("relative",{top:0,left:q-f.helperProportions.width}).left-f.margins.left}if(j){n.position.left=f._convertPositionTo("relative",{top:0,left:m}).left-f.margins.left}}g=(a||y||h||j);if(p.snapMode!=="outer"){a=Math.abs(k-e)<=x;y=Math.abs(z-c)<=x;h=Math.abs(q-w)<=x;j=Math.abs(m-v)<=x;if(a){n.position.top=f._convertPositionTo("relative",{top:k,left:0}).top-f.margins.top}if(y){n.position.top=f._convertPositionTo("relative",{top:z-f.helperProportions.height,left:0}).top-f.margins.top}if(h){n.position.left=f._convertPositionTo("relative",{top:0,left:q}).left-f.margins.left}if(j){n.position.left=f._convertPositionTo("relative",{top:0,left:m-f.helperProportions.width}).left-f.margins.left}}if(!f.snapElements[u].snapping&&(a||y||h||j||g)){(f.options.snap.snap&&f.options.snap.snap.call(f.element,s,$.extend(f._uiHash(),{snapItem:f.snapElements[u].item})))}f.snapElements[u].snapping=(a||y||h||j||g)}}});$.coral.plugin.add("draggable","stack",{start:function(c,d,a){var b,f=a.options,e=$.makeArray($(f.stack)).sort(function(h,g){return(parseInt($(h).css("zIndex"),10)||0)-(parseInt($(g).css("zIndex"),10)||0)});if(!e.length){return}b=parseInt($(e[0]).css("zIndex"),10)||0;$(e).each(function(g){$(this).css("zIndex",b+g)});this.css("zIndex",(b+e.length))}});$.coral.plugin.add("draggable","zIndex",{start:function(c,d,a){var b=$(d.helper),e=a.options;if(b.css("zIndex")){e._zIndex=b.css("zIndex")}b.css("zIndex",e.zIndex)},stop:function(b,c,a){var d=a.options;if(d._zIndex){$(c.helper).css("zIndex",d._zIndex)}}})})();

/*!
 * jQuery coral Droppable 4.0.1
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.component.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */
(function(){function a(c,b,d){return(c>=b)&&(c<(b+d))}$.component("coral.droppable",{version:"4.0.1",componentEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var c,d=this.options,b=d.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(b)?b:function(e){return e.is(b)};this.proportions=function(){if(arguments.length){c=arguments[0]}else{return c?c:c={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};this._addToManager(d.scope);(d.addClasses&&this.element.addClass("coral-droppable"))},_addToManager:function(b){$.coral.ddmanager.droppables[b]=$.coral.ddmanager.droppables[b]||[];$.coral.ddmanager.droppables[b].push(this)},_splice:function(b){var c=0;for(;c<b.length;c++){if(b[c]===this){b.splice(c,1)}}},_destroy:function(){var b=$.coral.ddmanager.droppables[this.options.scope];this._splice(b);this.element.removeClass("coral-droppable coral-droppable-disabled")},_setOption:function(c,d){if(c==="accept"){this.accept=$.isFunction(d)?d:function(e){return e.is(d)}}else{if(c==="scope"){var b=$.coral.ddmanager.droppables[this.options.scope];this._splice(b);this._addToManager(d)}}this._super(c,d)},_activate:function(c){var b=$.coral.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(b){this._trigger("activate",c,this.ui(b))}},_deactivate:function(c){var b=$.coral.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(b){this._trigger("deactivate",c,this.ui(b))}},_over:function(c){var b=$.coral.ddmanager.current;if(!b||(b.currentItem||b.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(b.currentItem||b.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)
}this._trigger("over",c,this.ui(b))}},_out:function(c){var b=$.coral.ddmanager.current;if(!b||(b.currentItem||b.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(b.currentItem||b.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",c,this.ui(b))}},_drop:function(c,d){var b=d||$.coral.ddmanager.current,e=false;if(!b||(b.currentItem||b.element)[0]===this.element[0]){return false}this.element.find(":data(coral-droppable)").not(".coral-draggable-dragging").each(function(){var f=$.data(this,"coral-droppable");if(f.options.greedy&&!f.options.disabled&&f.options.scope===b.options.scope&&f.accept.call(f.element[0],(b.currentItem||b.element))&&$.coral.intersect(b,$.extend(f,{offset:f.element.offset()}),f.options.tolerance,c)){e=true;return false}});if(e){return false}if(this.accept.call(this.element[0],(b.currentItem||b.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",c,this.ui(b));return this.element}return false},ui:function(b){return{draggable:(b.currentItem||b.element),helper:b.helper,position:b.position,offset:b.positionAbs}}});$.coral.intersect=(function(){function b(d,c,e){return(d>=c)&&(d<(c+e))}return function(o,h,m,d){if(!h.offset){return false}var f=(o.positionAbs||o.position.absolute).left,k=(o.positionAbs||o.position.absolute).top,e=f+o.helperProportions.width,j=k+o.helperProportions.height,g=h.offset.left,n=h.offset.top,c=g+h.proportions().width,i=n+h.proportions().height;switch(m){case"fit":return(g<=f&&e<=c&&n<=k&&j<=i);case"intersect":return(g<f+(o.helperProportions.width/2)&&e-(o.helperProportions.width/2)<c&&n<k+(o.helperProportions.height/2)&&j-(o.helperProportions.height/2)<i);case"pointer":return b(d.pageY,n,h.proportions().height)&&b(d.pageX,g,h.proportions().width);case"touch":return((k>=n&&k<=i)||(j>=n&&j<=i)||(k<n&&j>i))&&((f>=g&&f<=c)||(e>=g&&e<=c)||(f<g&&e>c));
default:return false}}})();$.coral.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,g){var d,c,b=$.coral.ddmanager.droppables[e.options.scope]||[],f=g?g.type:null,h=(e.currentItem||e.element).find(":data(coral-droppable)").addBack();droppablesLoop:for(d=0;d<b.length;d++){if(b[d].options.disabled||(e&&!b[d].accept.call(b[d].element[0],(e.currentItem||e.element)))){continue}for(c=0;c<h.length;c++){if(h[c]===b[d].element[0]){b[d].proportions().height=0;continue droppablesLoop}}b[d].visible=b[d].element.css("display")!=="none";if(!b[d].visible){continue}if(f==="mousedown"){b[d]._activate.call(b[d],g)}b[d].offset=b[d].element.offset();b[d].proportions({width:b[d].element[0].offsetWidth,height:b[d].element[0].offsetHeight})}},drop:function(b,c){var d=false;$.each(($.coral.ddmanager.droppables[b.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&$.coral.intersect(b,this,this.options.tolerance,c)){d=this._drop.call(this,c)||d}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(b.currentItem||b.element))){this.isout=true;this.isover=false;this._deactivate.call(this,c)}});return d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){if(!b.options.refreshPositions){$.coral.ddmanager.prepareOffsets(b,c)}})},drag:function(b,c){if(b.options.refreshPositions){$.coral.ddmanager.prepareOffsets(b,c)}$.each($.coral.ddmanager.droppables[b.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var g,e,d,f=$.coral.intersect(b,this,this.options.tolerance,c),h=!f&&this.isover?"isout":(f&&!this.isover?"isover":null);if(!h){return}if(this.options.greedy){e=this.options.scope;d=this.element.parents(":data(coral-droppable)").filter(function(){return $.data(this,"coral-droppable").options.scope===e});if(d.length){g=$.data(d[0],"coral-droppable");g.greedyChild=(h==="isover")}}if(g&&h==="isover"){g.isover=false;g.isout=true;
g._out.call(g,c)}this[h]=true;this[h==="isout"?"isover":"isout"]=false;this[h==="isover"?"_over":"_out"].call(this,c);if(g&&h==="isout"){g.isout=false;g.isover=true;g._over.call(g,c)}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable");if(!b.options.refreshPositions){$.coral.ddmanager.prepareOffsets(b,c)}}}})();

/*!
 * jQuery coral Resizable 4.0.1
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.component.js
 */
(function(){function b(d){return parseInt(d,10)||0}function a(d){return !isNaN(parseInt(d,10))}function c(g,e){if($(g).css("overflow")==="hidden"){return false}var d=(e&&e==="left")?"scrollLeft":"scrollTop",f=false;if(g[d]>0){return true}g[d]=1;f=(g[d]>0);g[d]=0;return f}$.component("coral.resizable",$.coral.mouse,{version:"4.0.1",componentEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,layout:false,helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var k,e,h,f,d,g=this,j=this.options;this.element.addClass("coral-resizable");$.extend(this,{_aspectRatio:!!(j.aspectRatio),aspectRatio:j.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:j.helper||j.ghost||j.animate?j.helper||"coral-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap($("<div class='coral-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("coral-resizable",this.element.data("coral-resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));
this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=j.handles||(!$(".coral-resizable-handle",this.element).length?"e,s,se":{n:".coral-resizable-n",e:".coral-resizable-e",s:".coral-resizable-s",w:".coral-resizable-w",se:".coral-resizable-se",sw:".coral-resizable-sw",ne:".coral-resizable-ne",nw:".coral-resizable-nw"});if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw"}k=this.handles.split(",");this.handles={};for(e=0;e<k.length;e++){h=$.trim(k[e]);d="coral-resizable-"+h;f=$("<div class='coral-resizable-handle "+d+"'></div>");f.css({zIndex:j.zIndex});if("se"===h){f.addClass("coral-icon coral-icon-gripsmall-diagonal-se")}this.handles[h]=".coral-resizable-"+h;this.element.append(f)}}this._renderAxis=function(p){var m,n,l,o;p=p||this.element;for(m in this.handles){if(this.handles[m].constructor===String){this.handles[m]=this.element.children(this.handles[m]).first().show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){n=$(this.handles[m],this.element);o=/sw|ne|nw|se|n|s/.test(m)?n.outerHeight():n.outerWidth();l=["padding",/ne|nw|n/.test(m)?"Top":/se|sw|s/.test(m)?"Bottom":/^e$/.test(m)?"Right":"Left"].join("");p.css(l,o);this._proportionallyResize()}if(!$(this.handles[m]).length){continue}}};this._renderAxis(this.element);this._handles=$(".coral-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!g.resizing){if(this.className){f=this.className.match(/coral-resizable-(se|sw|ne|nw|n|e|s|w)/i)}g.axis=f&&f[1]?f[1]:"se"}});if(j.autoHide){this._handles.hide();$(this.element).addClass("coral-resizable-autohide").mouseenter(function(){if(j.disabled){return}$(this).removeClass("coral-resizable-autohide");g._handles.show()}).mouseleave(function(){if(j.disabled){return}if(!g.resizing){$(this).addClass("coral-resizable-autohide");g._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();
var e,d=function(f){$(f).removeClass("coral-resizable coral-resizable-disabled coral-resizable-resizing").removeData("resizable").removeData("coral-resizable").unbind(".resizable").find(".coral-resizable-handle").remove()};if(this.elementIsWrapper){d(this.element);e=this.element;this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e);e.remove()}this.originalElement.css("resize",this.originalResizeStyle);d(this.originalElement);return this},_mouseCapture:function(f){var e,g,d=false;for(e in this.handles){g=$(this.handles[e])[0];if(g===f.target||$.contains(g,f.target)){d=true}}return !this.options.disabled&&d},_mouseStart:function(e){var i,f,h,g=this.options,d=this.element;this.resizing=true;this._renderProxy();i=b(this.helper.css("left"));f=b(this.helper.css("top"));if(g.containment){i+=$(g.containment).scrollLeft()||0;f+=$(g.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:i,top:f};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:d.width(),height:d.height()};this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalPosition={left:i,top:f};this.sizeDiff={width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()};this.originalMousePosition={left:e.pageX,top:e.pageY};this.aspectRatio=(typeof g.aspectRatio==="number")?g.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);h=$(".coral-resizable-"+this.axis).css("cursor");$("body").css("cursor",h==="auto"?this.axis+"-resize":h);d.addClass("coral-resizable-resizing");this._propagate("start",e);return true},_mouseDrag:function(i){var j,h,k=this.originalMousePosition,e=this.axis,f=(i.pageX-k.left)||0,d=(i.pageY-k.top)||0,g=this._change[e];this._updatePrevProperties();if(!g){return false}j=g.apply(this,[i,f,d]);this._updateVirtualBoundaries(i.shiftKey);if(this._aspectRatio||i.shiftKey){j=this._updateRatio(j,i)
}j=this._respectSize(j,i);this._updateCache(j);this._propagate("resize",i);h=this._applyChanges();if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}if(!$.isEmptyObject(h)){this._updatePrevProperties();this._trigger("resize",i,this.ui());this._applyChanges()}return false},_mouseStop:function(g){this.resizing=false;var f,d,e,j,m,i,l,h=this.options,k=this;if(this._helper){f=this._proportionallyResizeElements;d=f.length&&(/textarea/i).test(f[0].nodeName);e=d&&c(f[0],"left")?0:k.sizeDiff.height;j=d?0:k.sizeDiff.width;m={width:(k.helper.width()-j),height:(k.helper.height()-e)};i=(parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left))||null;l=(parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top))||null;if(!h.animate){this.element.css($.extend(m,{top:l,left:i}))}k.helper.height(k.size.height);k.helper.width(k.size.width);if(this._helper&&!h.animate){this._proportionallyResize()}}$("body").css("cursor","auto");this.element.removeClass("coral-resizable-resizing");this._propagate("stop",g,this.ui());if(this._helper){this.helper.remove()}return false},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left};this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var d={};if(this.position.top!==this.prevPosition.top){d.top=this.position.top+"px"}if(this.position.left!==this.prevPosition.left){d.left=this.position.left+"px"}if(this.size.width!==this.prevSize.width){d.width=this.size.width+"px"}if(this.size.height!==this.prevSize.height){d.height=this.size.height+"px"}this.helper.css(d);return d},_updateVirtualBoundaries:function(f){var h,g,e,j,d,i=this.options;d={minWidth:a(i.minWidth)?i.minWidth:0,maxWidth:a(i.maxWidth)?i.maxWidth:Infinity,minHeight:a(i.minHeight)?i.minHeight:0,maxHeight:a(i.maxHeight)?i.maxHeight:Infinity};if(this._aspectRatio||f){h=d.minHeight*this.aspectRatio;e=d.minWidth/this.aspectRatio;g=d.maxHeight*this.aspectRatio;
j=d.maxWidth/this.aspectRatio;if(h>d.minWidth){d.minWidth=h}if(e>d.minHeight){d.minHeight=e}if(g<d.maxWidth){d.maxWidth=g}if(j<d.maxHeight){d.maxHeight=j}}this._vBoundaries=d},_updateCache:function(d){this.offset=this.helper.offset();if(a(d.left)){this.position.left=d.left}if(a(d.top)){this.position.top=d.top}if(a(d.height)){this.size.height=d.height}if(a(d.width)){this.size.width=d.width}},_updateRatio:function(f){var g=this.position,e=this.size,d=this.axis;if(a(f.height)){f.width=(f.height*this.aspectRatio)}else{if(a(f.width)){f.height=(f.width/this.aspectRatio)}}if(d==="sw"){f.left=g.left+(e.width-f.width);f.top=null}if(d==="nw"){f.top=g.top+(e.height-f.height);f.left=g.left+(e.width-f.width)}return f},_respectSize:function(i){var f=this._vBoundaries,l=this.axis,n=a(i.width)&&f.maxWidth&&(f.maxWidth<i.width),j=a(i.height)&&f.maxHeight&&(f.maxHeight<i.height),g=a(i.width)&&f.minWidth&&(f.minWidth>i.width),m=a(i.height)&&f.minHeight&&(f.minHeight>i.height),e=this.originalPosition.left+this.originalSize.width,k=this.position.top+this.size.height,h=/sw|nw|w/.test(l),d=/nw|ne|n/.test(l);if(g){i.width=f.minWidth}if(m){i.height=f.minHeight}if(n){i.width=f.maxWidth}if(j){i.height=f.maxHeight}if(g&&h){i.left=e-f.minWidth}if(n&&h){i.left=e-f.maxWidth}if(m&&d){i.top=k-f.minHeight}if(j&&d){i.top=k-f.maxHeight}if(!i.width&&!i.height&&!i.left&&i.top){i.top=null}else{if(!i.width&&!i.height&&!i.top&&i.left){i.left=null}}return i},_getPaddingPlusBorderDimensions:function(f){var e=0,g=[],h=[f.css("borderTopWidth"),f.css("borderRightWidth"),f.css("borderBottomWidth"),f.css("borderLeftWidth")],d=[f.css("paddingTop"),f.css("paddingRight"),f.css("paddingBottom"),f.css("paddingLeft")];for(;e<4;e++){g[e]=(parseInt(h[e],10)||0);g[e]+=(parseInt(d[e],10)||0)}return{height:g[0]+g[2],width:g[1]+g[3]}},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return}var f,e=0,d=this.helper||this.element;for(;e<this._proportionallyResizeElements.length;e++){f=this._proportionallyResizeElements[e];
if(!this.outerDimensions){this.outerDimensions=this._getPaddingPlusBorderDimensions(f)}f.css({height:(d.height()-this.outerDimensions.height)||0,width:(d.width()-this.outerDimensions.width)||0})}},_renderProxy:function(){var d=this.element,e=this.options;this.elementOffset=d.offset();if(this._helper){this.helper=this.helper||$("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(e,d){return{width:this.originalSize.width+d}},w:function(f,d){var e=this.originalSize,g=this.originalPosition;return{left:g.left+d,width:e.width-d}},n:function(g,e,d){var f=this.originalSize,h=this.originalPosition;return{top:h.top+d,height:f.height-d}},s:function(f,e,d){return{height:this.originalSize.height+d}},se:function(f,e,d){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[f,e,d]))},sw:function(f,e,d){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[f,e,d]))},ne:function(f,e,d){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[f,e,d]))},nw:function(f,e,d){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[f,e,d]))}},_propagate:function(e,d){$.coral.plugin.call(this,e,[d,this.ui()]);(e!=="resize"&&this._trigger(e,d,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});$.coral.plugin.add("resizable","animate",{stop:function(g){var l=$(this).data("coral-resizable"),i=l.options,f=l._proportionallyResizeElements,d=f.length&&(/textarea/i).test(f[0].nodeName),e=d&&c(f[0],"left")?0:l.sizeDiff.height,k=d?0:l.sizeDiff.width,h={width:(l.size.width-k),height:(l.size.height-e)},j=(parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left))||null,m=(parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top))||null;
l.element.animate($.extend(h,m&&j?{top:m,left:j}:{}),{duration:i.animateDuration,easing:i.animateEasing,step:function(){var n={width:parseInt(l.element.css("width"),10),height:parseInt(l.element.css("height"),10),top:parseInt(l.element.css("top"),10),left:parseInt(l.element.css("left"),10)};if(f&&f.length){$(f[0]).css({width:n.width,height:n.height})}l._updateCache(n);l._propagate("resize",g)}})}});$.coral.plugin.add("resizable","containment",{start:function(){var l,f,n,d,k,g,q,m=$(this).data("coral-resizable"),j=m.options,i=m.element,e=j.containment,h=(e instanceof $)?e.get(0):(/parent/.test(e))?i.parent().get(0):e;if(!h){return}m.containerElement=$(h);if(/document/.test(e)||e===document){m.containerOffset={left:0,top:0};m.containerPosition={left:0,top:0};m.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}}else{l=$(h);f=[];$(["Top","Right","Left","Bottom"]).each(function(p,o){f[p]=b(l.css("padding"+o))});m.containerOffset=l.offset();m.containerPosition=l.position();m.containerSize={height:(l.innerHeight()-f[3]),width:(l.innerWidth()-f[1])};n=m.containerOffset;d=m.containerSize.height;k=m.containerSize.width;g=(c(h,"left")?h.scrollWidth:k);q=(c(h)?h.scrollHeight:d);m.parentData={element:h,left:n.left,top:n.top,width:g,height:q}}},resize:function(e){var k,q,j,h,l=$(this).resizable("instance"),g=l.options,n=l.containerOffset,m=l.position,p=l._aspectRatio||e.shiftKey,d={top:0,left:0},f=l.containerElement,i=true;if(f[0]!==document&&(/static/).test(f.css("position"))){d=n}if(m.left<(l._helper?n.left:0)){l.size.width=l.size.width+(l._helper?(l.position.left-n.left):(l.position.left-d.left));if(p){l.size.height=l.size.width/l.aspectRatio;i=false}l.position.left=g.helper?n.left:0}if(m.top<(l._helper?n.top:0)){l.size.height=l.size.height+(l._helper?(l.position.top-n.top):l.position.top);if(p){l.size.width=l.size.height*l.aspectRatio;i=false}l.position.top=l._helper?n.top:0}j=l.containerElement.get(0)===l.element.parent().get(0);
h=/relative|absolute/.test(l.containerElement.css("position"));if(j&&h){l.offset.left=l.parentData.left+l.position.left;l.offset.top=l.parentData.top+l.position.top}else{l.offset.left=l.element.offset().left;l.offset.top=l.element.offset().top}k=Math.abs(l.sizeDiff.width+(l._helper?l.offset.left-d.left:(l.offset.left-n.left)));q=Math.abs(l.sizeDiff.height+(l._helper?l.offset.top-d.top:(l.offset.top-n.top)));if(k+l.size.width>=l.parentData.width){l.size.width=l.parentData.width-k;if(p){l.size.height=l.size.width/l.aspectRatio;i=false}}if(q+l.size.height>=l.parentData.height){l.size.height=l.parentData.height-q;if(p){l.size.width=l.size.height*l.aspectRatio;i=false}}if(!i){l.position.left=l.prevPosition.left;l.position.top=l.prevPosition.top;l.size.width=l.prevSize.width;l.size.height=l.prevSize.height}},stop:function(){var j=$(this).resizable("instance"),e=j.options,k=j.containerOffset,d=j.containerPosition,f=j.containerElement,g=$(j.helper),m=g.offset(),l=g.outerWidth()-j.sizeDiff.width,i=g.outerHeight()-j.sizeDiff.height;if(j._helper&&!e.animate&&(/relative/).test(f.css("position"))){$(this).css({left:m.left-d.left-k.left,width:l,height:i})}if(j._helper&&!e.animate&&(/static/).test(f.css("position"))){$(this).css({left:m.left-d.left-k.left,width:l,height:i})}}});$.coral.plugin.add("resizable","alsoResize",{start:function(){var d=$(this).data("coral-resizable"),f=d.options,e=function(g){$(g).each(function(){var h=$(this);h.data("coral-resizable-alsoresize",{width:parseInt(h.width(),10),height:parseInt(h.height(),10),left:parseInt(h.css("left"),10),top:parseInt(h.css("top"),10)})})};if(typeof(f.alsoResize)==="object"&&!f.alsoResize.parentNode){if(f.alsoResize.length){f.alsoResize=f.alsoResize[0];e(f.alsoResize)}else{$.each(f.alsoResize,function(g){e(g)})}}else{e(f.alsoResize)}},resize:function(f,h){var e=$(this).data("coral-resizable"),i=e.options,g=e.originalSize,k=e.originalPosition,j={height:(e.size.height-g.height)||0,width:(e.size.width-g.width)||0,top:(e.position.top-k.top)||0,left:(e.position.left-k.left)||0},d=function(l,m){$(l).each(function(){var p=$(this),s=$(this).data("coral-resizable-alsoresize"),o={},n=m&&m.length?m:p.parents(h.originalElement[0]).length?["width","height"]:["width","height","top","left"];
var q=$.coral.getStyles(p[0]);var r=jQuery.support.boxSizing&&jQuery.css(p,"boxSizing",false,q)==="border-box";$.each(n,function(t,v){var u=(s[v]||0)+(j[v]||0);if(u&&u>=0){if(r){if($.inArray(v,["width","height"])>=0){p[v](u)}else{p.css(v,u)}}else{o[v]=u||null}}});p.css(o)})};if(typeof(i.alsoResize)==="object"&&!i.alsoResize.nodeType){$.each(i.alsoResize,function(l,m){d(l,m)})}else{d(i.alsoResize)}},stop:function(){$(this).removeData("resizable-alsoresize")}});$.coral.plugin.add("resizable","ghost",{start:function(){var e=$(this).data("coral-resizable"),f=e.options,d=e.size;e.ghost=e.originalElement.clone();e.ghost.css({opacity:0.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("coral-resizable-ghost").addClass(typeof f.ghost==="string"?f.ghost:"");e.ghost.appendTo(e.helper)},resize:function(){var d=$(this).data("coral-resizable");if(d.ghost){d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})}},stop:function(){var d=$(this).data("coral-resizable");if(d.ghost&&d.helper){d.helper.get(0).removeChild(d.ghost.get(0))}}});$.coral.plugin.add("resizable","grid",{resize:function(){var g,l=$(this).resizable("instance"),q=l.options,j=l.size,k=l.originalSize,m=l.originalPosition,v=l.axis,d=typeof q.grid==="number"?[q.grid,q.grid]:q.grid,t=(d[0]||1),s=(d[1]||1),i=Math.round((j.width-k.width)/t)*t,h=Math.round((j.height-k.height)/s)*s,n=k.width+i,r=k.height+h,f=q.maxWidth&&(q.maxWidth<n),p=q.maxHeight&&(q.maxHeight<r),u=q.minWidth&&(q.minWidth>n),e=q.minHeight&&(q.minHeight>r);q.grid=d;if(u){n+=t}if(e){r+=s}if(f){n-=t}if(p){r-=s}if(/^(se|s|e)$/.test(v)){l.size.width=n;l.size.height=r}else{if(/^(ne)$/.test(v)){l.size.width=n;l.size.height=r;l.position.top=m.top-h}else{if(/^(sw)$/.test(v)){l.size.width=n;l.size.height=r;l.position.left=m.left-i}else{if(r-s<=0||n-t<=0){g=l._getPaddingPlusBorderDimensions(this)}if(r-s>0){l.size.height=r;l.position.top=m.top-h}else{r=s-g.height;l.size.height=r;l.position.top=m.top+k.height-r
}if(n-t>0){l.size.width=n;l.position.left=m.left-i}else{n=s-g.height;l.size.width=n;l.position.left=m.left+k.width-n}}}}}})})();

/*!
 * jQuery coral Selectable 4.0.1
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.component.js
 */
(function(){$.component("coral.selectable",$.coral.mouse,{version:"4.0.1",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var b,a=this;this.element.addClass("coral-selectable");this.dragged=false;this.refresh=function(){b=$(a.options.filter,a.element[0]);b.addClass("coral-selectee");b.each(function(){var c=$(this),d=c.offset();$.data(this,"selectable-item",{element:this,$element:c,left:d.left,top:d.top,right:d.left+c.outerWidth(),bottom:d.top+c.outerHeight(),startselected:false,selected:c.hasClass("coral-selected"),selecting:c.hasClass("coral-selecting"),unselecting:c.hasClass("coral-unselecting")})})};this.refresh();this.selectees=b.addClass("coral-selectee");this._mouseInit();this.helper=$("<div class='coral-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("coral-selectee").removeData("selectable-item");this.element.removeClass("coral-selectable coral-selectable-disabled");this._mouseDestroy()},_mouseStart:function(c){var b=this,a=this.options;this.opos=[c.pageX,c.pageY];if(this.options.disabled){return}this.selectees=$(a.filter,this.element[0]);this._trigger("start",c);$(a.appendTo).append(this.helper);this.helper.css({left:c.pageX,top:c.pageY,width:0,height:0});if(a.autoRefresh){this.refresh()}this.selectees.filter(".coral-selected").each(function(){var d=$.data(this,"selectable-item");d.startselected=true;if(!c.metaKey&&!c.ctrlKey){d.$element.removeClass("coral-selected");d.selected=false;d.$element.addClass("coral-unselecting");d.unselecting=true;b._trigger("unselecting",c,{unselecting:d.element})}});$(c.target).parents().addBack().each(function(){var d,e=$.data(this,"selectable-item");if(e){d=(!c.metaKey&&!c.ctrlKey)||!e.$element.hasClass("coral-selected");e.$element.removeClass(d?"coral-unselecting":"coral-selected").addClass(d?"coral-selecting":"coral-unselecting");
e.unselecting=!d;e.selecting=d;e.selected=d;if(d){b._trigger("selecting",c,{selecting:e.element})}else{b._trigger("unselecting",c,{unselecting:e.element})}return false}})},_mouseDrag:function(h){this.dragged=true;if(this.options.disabled){return}var e,g=this,c=this.options,b=this.opos[0],f=this.opos[1],a=h.pageX,d=h.pageY;if(b>a){e=a;a=b;b=e}if(f>d){e=d;d=f;f=e}this.helper.css({left:b,top:f,width:a-b,height:d-f});this.selectees.each(function(){var i=$.data(this,"selectable-item"),j=false;if(!i||i.element===g.element[0]){return}if(c.tolerance==="touch"){j=(!(i.left>a||i.right<b||i.top>d||i.bottom<f))}else{if(c.tolerance==="fit"){j=(i.left>b&&i.right<a&&i.top>f&&i.bottom<d)}}if(j){if(i.selected){i.$element.removeClass("coral-selected");i.selected=false}if(i.unselecting){i.$element.removeClass("coral-unselecting");i.unselecting=false}if(!i.selecting){i.$element.addClass("coral-selecting");i.selecting=true;g._trigger("selecting",h,{selecting:i.element})}}else{if(i.selecting){if((h.metaKey||h.ctrlKey)&&i.startselected){i.$element.removeClass("coral-selecting");i.selecting=false;i.$element.addClass("coral-selected");i.selected=true}else{i.$element.removeClass("coral-selecting");i.selecting=false;if(i.startselected){i.$element.addClass("coral-unselecting");i.unselecting=true}g._trigger("unselecting",h,{unselecting:i.element})}}if(i.selected){if(!h.metaKey&&!h.ctrlKey&&!i.startselected){i.$element.removeClass("coral-selected");i.selected=false;i.$element.addClass("coral-unselecting");i.unselecting=true;g._trigger("unselecting",h,{unselecting:i.element})}}}});return false},_mouseStop:function(b){var a=this;this.dragged=false;$(".coral-unselecting",this.element[0]).each(function(){var c=$.data(this,"selectable-item");c.$element.removeClass("coral-unselecting");c.unselecting=false;c.startselected=false;a._trigger("unselected",b,{unselected:c.element})});$(".coral-selecting",this.element[0]).each(function(){var c=$.data(this,"selectable-item");c.$element.removeClass("coral-selecting").addClass("coral-selected");
c.selecting=false;c.selected=true;c.startselected=true;a._trigger("selected",b,{selected:c.element})});this._trigger("stop",b);this.helper.remove();return false}})})();

/*!
 * 组件库4.0：元素位置辅助工具
 */
(function(){$.coral=$.coral||{};var h,k,i=Math.max,n=Math.abs,l=Math.round,c=/left|center|right/,f=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,j=/^\w+/,b=/%$/,e=$.fn.position;function m(q,p,o){return[parseFloat(q[0])*(b.test(q[0])?p/100:1),parseFloat(q[1])*(b.test(q[1])?o/100:1)]}function g(o,p){return parseInt($.css(o,p),10)||0}function d(p){var o=p[0];if(o.nodeType===9){return{width:p.width(),height:p.height(),offset:{top:0,left:0}}}if($.isWindow(o)){return{width:p.width(),height:p.height(),offset:{top:p.scrollTop(),left:p.scrollLeft()}}}if(o.preventDefault){return{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}}return{width:p.outerWidth(),height:p.outerHeight(),offset:p.offset()}}$.position={scrollbarWidth:function(){if(h!==undefined){return h}var p,o,r=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),q=r.children()[0];$("body").append(r);p=q.offsetWidth;r.css("overflow","scroll");o=q.offsetWidth;if(p===o){o=r[0].clientWidth}r.remove();return(h=p-o)},getScrollInfo:function(s){var r=s.isWindow||s.isDocument?"":s.element.css("overflow-x"),q=s.isWindow||s.isDocument?"":s.element.css("overflow-y"),p=r==="scroll"||(r==="auto"&&s.width<s.element[0].scrollWidth),o=q==="scroll"||(q==="auto"&&s.height<s.element[0].scrollHeight);return{width:o?$.position.scrollbarWidth():0,height:p?$.position.scrollbarWidth():0}},getWithinInfo:function(p){var q=$(p||window),o=$.isWindow(q[0]),r=!!q[0]&&q[0].nodeType===9;return{element:q,isWindow:o,isDocument:r,offset:q.offset()||{left:0,top:0},scrollLeft:q.scrollLeft(),scrollTop:q.scrollTop(),width:o||r?q.width():q.outerWidth(),height:o||r?q.height():q.outerHeight()}}};$.fn.position=function(y){if(!y||!y.of){return e.apply(this,arguments)}y=$.extend({},y);var z,v,t,x,s,o,u=$(y.of),r=$.position.getWithinInfo(y.within),p=$.position.getScrollInfo(r),w=(y.collision||"flip").split(" "),q={};o=d(u);if(u[0].preventDefault){y.at="left top"
}v=o.width;t=o.height;x=o.offset;s=$.extend({},x);$.each(["my","at"],function(){var C=(y[this]||"").split(" "),B,A;if(C.length===1){C=c.test(C[0])?C.concat(["center"]):f.test(C[0])?["center"].concat(C):["center","center"]}C[0]=c.test(C[0])?C[0]:"center";C[1]=f.test(C[1])?C[1]:"center";B=a.exec(C[0]);A=a.exec(C[1]);q[this]=[B?B[0]:0,A?A[0]:0];y[this]=[j.exec(C[0])[0],j.exec(C[1])[0]]});if(w.length===1){w[1]=w[0]}if(y.at[0]==="right"){s.left+=v}else{if(y.at[0]==="center"){s.left+=v/2}}if(y.at[1]==="bottom"){s.top+=t}else{if(y.at[1]==="center"){s.top+=t/2}}z=m(q.at,v,t);s.left+=z[0];s.top+=z[1];return this.each(function(){var B,K,D=$(this),F=D.outerWidth(),C=D.outerHeight(),E=g(this,"marginLeft"),A=g(this,"marginTop"),J=F+E+g(this,"marginRight")+p.width,I=C+A+g(this,"marginBottom")+p.height,G=$.extend({},s),H=m(q.my,D.outerWidth(),D.outerHeight());if(y.my[0]==="right"){G.left-=F}else{if(y.my[0]==="center"){G.left-=F/2}}if(y.my[1]==="bottom"){G.top-=C}else{if(y.my[1]==="center"){G.top-=C/2}}G.left+=H[0];G.top+=H[1];if(!k){G.left=l(G.left);G.top=l(G.top)}B={marginLeft:E,marginTop:A};$.each(["left","top"],function(M,L){if($.coral.position[w[M]]){$.coral.position[w[M]][L](G,{targetWidth:v,targetHeight:t,elemWidth:F,elemHeight:C,collisionPosition:B,collisionWidth:J,collisionHeight:I,offset:[z[0]+H[0],z[1]+H[1]],my:y.my,at:y.at,within:r,elem:D})}});if(y.using){K=function(O){var Q=x.left-G.left,N=Q+v-F,P=x.top-G.top,M=P+t-C,L={target:{element:u,left:x.left,top:x.top,width:v,height:t},element:{element:D,left:G.left,top:G.top,width:F,height:C},horizontal:N<0?"left":Q>0?"right":"center",vertical:M<0?"top":P>0?"bottom":"middle"};if(v<F&&n(Q+N)<v){L.horizontal="center"}if(t<C&&n(P+M)<t){L.vertical="middle"}if(i(n(Q),n(N))>i(n(P),n(M))){L.important="horizontal"}else{L.important="vertical"}y.using.call(this,O,L)}}D.offset($.extend(G,{using:K}))})};$.coral.position={fit:{left:function(s,r){var q=r.within,u=q.isWindow?q.scrollLeft:q.offset.left,w=q.width,t=s.left-r.collisionPosition.marginLeft,v=u-t,p=t+r.collisionWidth-w-u,o;
if(r.collisionWidth>w){if(v>0&&p<=0){o=s.left+v+r.collisionWidth-w-u;s.left+=v-o}else{if(p>0&&v<=0){s.left=u}else{if(v>p){s.left=u+w-r.collisionWidth}else{s.left=u}}}}else{if(v>0){s.left+=v}else{if(p>0){s.left-=p}else{s.left=i(s.left-t,s.left)}}}},top:function(r,q){var p=q.within,v=p.isWindow?p.scrollTop:p.offset.top,w=q.within.height,t=r.top-q.collisionPosition.marginTop,u=v-t,s=t+q.collisionHeight-w-v,o;if(q.collisionHeight>w){if(u>0&&s<=0){o=r.top+u+q.collisionHeight-w-v;r.top+=u-o}else{if(s>0&&u<=0){r.top=v}else{if(u>s){r.top=v+w-q.collisionHeight}else{r.top=v}}}}else{if(u>0){r.top+=u}else{if(s>0){r.top-=s}else{r.top=i(r.top-t,r.top)}}}}},flip:{left:function(u,t){var s=t.within,y=s.offset.left+s.scrollLeft,B=s.width,q=s.isWindow?s.scrollLeft:s.offset.left,v=u.left-t.collisionPosition.marginLeft,z=v-q,p=v+t.collisionWidth-B-q,x=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,A=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,r=-2*t.offset[0],o,w;if(z<0){o=u.left+x+A+r+t.collisionWidth-B-y;if(o<0||o<n(z)){u.left+=x+A+r}}else{if(p>0){w=u.left-t.collisionPosition.marginLeft+x+A+r-q;if(w>0||n(w)<p){u.left+=x+A+r}}}},top:function(t,s){var r=s.within,A=r.offset.top+r.scrollTop,B=r.height,o=r.isWindow?r.scrollTop:r.offset.top,v=t.top-s.collisionPosition.marginTop,x=v-o,u=v+s.collisionHeight-B-o,y=s.my[1]==="top",w=y?-s.elemHeight:s.my[1]==="bottom"?s.elemHeight:0,C=s.at[1]==="top"?s.targetHeight:s.at[1]==="bottom"?-s.targetHeight:0,q=-2*s.offset[1],z,p;if(x<0){p=t.top+w+C+q+s.collisionHeight-B-A;if((t.top+w+C+q)>x&&(p<0||p<n(x))){t.top+=w+C+q}}else{if(u>0){z=t.top-s.collisionPosition.marginTop+w+C+q-o;if((t.top+w+C+q)>u&&(z>0||n(z)<u)){t.top+=w+C+q}}}}},flipfit:{left:function(){$.coral.position.flip.left.apply(this,arguments);$.coral.position.fit.left.apply(this,arguments)},top:function(){$.coral.position.flip.top.apply(this,arguments);$.coral.position.fit.top.apply(this,arguments)}}};(function(){var s,u,p,r,q,o=document.getElementsByTagName("body")[0],t=document.createElement("div");
s=document.createElement(o?"div":"body");p={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(o){$.extend(p,{position:"absolute",left:"-1000px",top:"-1000px"})}for(q in p){s.style[q]=p[q]}s.appendChild(t);u=o||document.documentElement;u.insertBefore(s,u.firstChild);t.style.cssText="position: absolute; left: 10.7432222px;";r=$(t).offset().left;k=r>10&&r<11;s.innerHTML="";u.removeChild(s)})()}());

(function(){var a={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(c,b){a[b]=function(d){return Math.pow(d,c+2)}});$.extend(a,{Sine:function(b){return 1-Math.cos(b*Math.PI/2)},Circ:function(b){return 1-Math.sqrt(1-b*b)},Elastic:function(b){return b===0||b===1?b:-Math.pow(2,8*(b-1))*Math.sin(((b-1)*80-7.5)*Math.PI/15)},Back:function(b){return b*b*(3*b-2)},Bounce:function(d){var b,c=4;while(d<((b=Math.pow(2,--c))-1)/11){}return 1/Math.pow(4,3-c)-7.5625*Math.pow((b*3-2)/22-d,2)}});$.each(a,function(c,b){$.easing["easeIn"+c]=b;$.easing["easeOut"+c]=function(d){return 1-b(1-d)};$.easing["easeInOut"+c]=function(d){return d<0.5?b(d*2)/2:1-b(d*-2+2)/2}})})();

$.grid=$.grid||{};var grid=$.component("coral.grid",{version:"4.0.1",castProperties:["rowEditButtons","data","initData","rowList","pager","pagerTemplate","celloptions","colModel"],options:{},grid:{},diff:2,getScrollBarWidth:function(){var c=document.createElement("p");c.style.width="100%";c.style.height="200px";var d=document.createElement("div");d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.visibility="hidden";d.style.width="200px";d.style.height="150px";d.style.overflow="hidden";d.appendChild(c);document.body.appendChild(d);var b=c.offsetWidth;d.style.overflow="scroll";var a=c.offsetWidth;if(b==a){a=d.clientWidth}document.body.removeChild(d);return(b-a)+this.diff},_destroy:function(){var b="",a=$(this.element).attr("id");if(this.pagers){b=$(this.pagers).empty().addClass(a)}$(this.element).empty();this.element.removeClass("ctrl-init ctrl-init-grid");this.element.removeClass("coral-grid");this.element.removeClass(this.options.cls);this.component().replaceWith(this.element).append(b)},_create:function(){var l=this.options,g=this,h="coral-state-active",m="coral-state-focus",b=this.element.uniqueId().attr("id");l.id=b;var c={_index:{},altRows:false,altclass:" coral-priority-secondary ",ajaxGridOptions:{},asyncType:"post",autoSave:false,autoValid:true,autoWidth:true,allowSaveOnError:true,cls:"",caption:"",colModel:[],colNames:[],cellLayout:1,cellEdit:false,cellsubmit:"clientArray",clicksToEdit:2,data:[],datatype:"json",direction:"ltr",deselectAfterSort:true,emptyrecords:"无数据",ExpandColumn:null,height:150,idPrefix:"",initData:false,customPicgrid:$.noop(),gridview:false,grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"cui-icon-plus3",minusicon:"cui-icon-minus3",displayField:[],groupSummaryPos:[],formatDisplayField:[],_locgr:false},groupHeaders:[],groupHeader:false,fitStyle:"auto",forceFit:false,hoverrows:true,lastsort:0,loadonce:true,loadui:"enable",loadtext:"加载中，请耐心等候 ...",minWidth:false,multiselect:false,multiselectWidth:30,multiboxonly:false,multikey:"",clickRowToSelect:true,model:"grid",page:1,pager:"",pagerStyle:"flex",pginput:true,records:0,rninput:true,rowEditButtons:[],pgbuttons:true,picTemplate:"picTemplate",postData:{},prmNames:{page:"P_pageNumber",rows:"P_pagesize",sort:"P_orders",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},rowNum:20,rowNumMax:200,rownumbers:false,rownumWidth:35,rownumName:"",rowList:[10,20,30],savedRow:[],scrollOffset:this.getScrollBarWidth(),selarrrow:[],singleselect:false,sortorder:"asc",treeGrid:false,treeGridModel:"adjacency",treeReader:{},treeANode:-1,tree_root_level:0,onSortableColumns:false,sortableColumnsOptions:{},onSortableRows:false,beforeSortableRows:false,afterSortableRows:false,editableRows:false,containSortOrder:false,sortSeparator:" ",shrinkToFit:true,toppager:false,toolbar:[false,""],url:"",useProp:true,viewsortcols:[false,"vertical",true],viewrecords:true,minIndex:null,maxIndex:null,preIndex:null,beforePopulate:null};
l=$.extend(true,{},c,$.grid.defaults,this.options);if(l.model=="pic"){l.model="card"}this.options=l;this.options.isValid=true;l.postData=$.coral.toFunction(l.postData);l.localReader=$.extend(true,{root:"data",page:"pageNumber",total:"totalPages",records:"total",repeatitems:false,cell:"cell",id:"id",userData:"userData",subgrid:{root:"data",repeatitems:true,cell:"cell"}},l.localReader);l.jsonReader=$.extend(true,{root:"data",page:"pageNumber",total:"totalPages",records:"total",repeatitems:false,cell:"cell",id:"id",userData:"userData"},l.jsonReader);if(this.options.pivotData&&this.options.pivotData.length){this.jqPivot(this.options.pivotData,this.options.pivotOption,this.options.gridOption,this.options.ajaxOption)}if(this.options.data.length){this.normalizeData();this.refreshIndex()}this.id=b;var a={groupHeader:[],headers:[],cols:[],footers:[],dragStart:function(p,n,q){var o=this;this.resizing={idx:p,startX:n.clientX,sOL:q[0]};o.columnsView.style.cursor="col-resize";this.curGbox=$("#rs_m"+$.grid.coralID(g.options.id),"#"+$.grid.coralID(g.options.id));this.curGbox.css({display:"block",left:q[0],top:q[1],height:q[2]});g._trigger("onResizeStart",n,[{index:p}]);document.onselectstart=function(){return false}},dragMove:function(i){if(this.resizing){var q=i.clientX-this.resizing.startX,n=this.headers[this.resizing.idx],o=g.options.direction==="ltr"?n.width+q:n.width-q,r,p;$("#test").html(q);if(o>33){this.curGbox.css({left:this.resizing.sOL+q});if(g.options.forceFit===true){r=this.headers[this.resizing.idx+l.nv];p=g.options.direction==="ltr"?r.width-q:r.width+q;if(p>33){n.newWidth=o;r.newWidth=p}}else{this.newWidth=g.options.direction==="ltr"?g.options.tblwidth+q:g.options.tblwidth-q;n.newWidth=o}}}},dragEnd:function(){this.columnsView.style.cursor="default";if(this.resizing){var i=this.resizing.idx,n=this.headers[i].newWidth||this.headers[i].width;n=parseInt(n,10);this.resizing=false;$("#rs_m"+$.grid.coralID(g.options.id)).css("display","none");g.options.colModel[i].width=n;this.headers[i].width=n;
this.headers[i].el.style.width=n+"px";this.cols[i].style.width=n+"px";if($("table:first",this.rowsView).hasClass("coral-grid-btable-frozen")){$("tr.jqgfirstrow>td:eq("+i+")",$("table:first",this.rowsView))[0].style.width=n+"px"}var o=$("tr.jqg-first-row-header>th:eq("+i+")",$("table:first",this.columnsView));if(o.length>0){o[0].style.width=n+"px"}if(this.footers.length>0){this.footers[i].style.width=n+"px"}if(g.options.forceFit===true){n=this.headers[i+l.nv].newWidth||this.headers[i+l.nv].width;this.headers[i+l.nv].width=n;this.headers[i+l.nv].el.style.width=n+"px";this.cols[i+l.nv].style.width=n+"px";if(this.footers.length>0){this.footers[i+l.nv].style.width=n+"px"}g.options.colModel[i+l.nv].width=n;o=$("tr.jqg-first-row-header>th:eq("+(i+l.nv)+")",$("table:first",this.columnsView));if(o.length>0){o[0].style.width=n+"px"}}else{g.options.tblwidth=this.newWidth||g.options.tblwidth;$("table",this.rowsView).css("width",g.options.tblwidth+"px");$("table:first",this.columnsView).css("width",g.options.tblwidth+"px");this.columnsView.scrollLeft=this.rowsView.scrollLeft;if(g.options.footerrow){$("table:first",this.sDiv).css("width",c.tblwidth+"px");this.sDiv.scrollLeft=this.rowsView.scrollLeft}}g._trigger("onResizeStop",null,[{newWidth:n,index:i,headers:this.headers}])}this.curGbox=null;document.onselectstart=function(){return true}},selectionPreserver:function(p){var o=p.options,n=o.selrow,i=o.selarrrow?$.makeArray(o.selarrrow):null,r=p.grid.rowsView.scrollLeft,q=function(){var s;o.selrow=null;o.selarrrow=[];if(o.multiselect&&i&&i.length>0){for(s=0;s<i.length;s++){if(i[s]!=n){$(p.element).grid("setSelection",i[s],false,null)}}}if(n){$(p.element).grid("setSelection",n,false,null)}p.grid.rowsView.scrollLeft=r;$(p.element).unbind(".selectionPreserver",q)};$(p.element).bind("gridoncomplete.selectionPreserver",q)}};this.grid=a;var e=this.element.find(">div").filter(function(){if($(this).hasClass(g.options.id)){return false}return true}),d=$("<div class='coral-grid-rows'></div>");
if(e.length==0){this.element.prepend("<div></div>");e=this.element.find(">div").filter(function(){if($(this).hasClass(g.id)){return false}return true})}g.gridRows=d;g.gridColumns=e;g._analyzeColumns(e);e.addClass("coral-grid-columns").after(d);a.rowsView=document.createElement("div");$(a.rowsView).addClass("coral-grid-rows-view").appendTo(d);$("<span class='coral-grid-noRecordsTips' id='noRecordsTips_"+$.grid.coralID(g.options.id)+"'>"+g.options.emptyrecords+"</span>").appendTo($(a.rowsView));a.columnsView=document.createElement("div");$(a.columnsView).addClass("coral-state-default coral-grid-columns-view").appendTo(e).append("<div class='coral-grid-topRightCell'></div>");g.pic=$("<ul class='coral-pic'></ul>");e.addClass("coral-grid-columns").after(g.pic);if(g.options.grouping===true){g.options.scroll=false;g.options.rownumbers=false;g.options.treeGrid=false;g.options.gridview=true}if(this.options.treeGrid===true){try{$(g.element).grid("setTreeGrid")}catch(j){}if(g.options.datatype!="local"){g.options.localReader={id:"_id_"}}}if(this.options.subGrid){try{$(g.element).grid("setSubGrid")}catch(k){}}if(this.options.multiselect){this.options.singleselect=false}if(!this.options.keyName){this.options.keyName=false}for(var f=0;f<this.options.colModel.length;f++){this.options.colModel[f]=$.extend(true,{},this.options.cmTemplate,this.options.colModel[f].template||{},this.options.colModel[f]);if(this.options.keyName===false&&this.options.colModel[f].key===true){this.options.keyName=this.options.colModel[f].name}}if(this.options.multiselect){this.options.colNames.unshift("<input role='checkbox' id='cb_"+this.options.id+"' class='cbox' type='checkbox'/>");this.options.colModel.unshift({name:"cb",width:g.options.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}else{if(this.options.singleselect){this.options.colNames.unshift("");this.options.colModel.unshift({name:"cb",width:g.options.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})
}}if(this.options.rownumbers){this.options.colNames.unshift(g.options.rownumName);this.options.colModel.unshift({name:"rn",width:g.options.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}g._transToGrid();g._transToPicgrid();g._transPagers();g._cvH=$(a.columnsView).height();if("fill"!==l.fitStyle){}g._setGridHeight(g.options.height);if(l.model=="grid"){g.pic.hide()}else{if(l.model=="card"){g.gridRows.hide();g.gridColumns.hide()}}g.setFrozenColumns();this.component().addClass(l.componentCls);this._populate();g._setUpEvent();$(window).unload(function(){g=null});this._on(this.document,{mousedown:function(i){if(this.options.autoSave&&this._closeOnDocumentClick(i)){this.restoreAll(i)}}})},_closeOnDocumentClick:function(a){return !$(a.target).closest(".coral-grid").length},_transPagers:function(){var a=this;this.pagers=$("."+this.id);if(this.options.pager==true){this.options.pager=$("<div id='pager_0_"+this.id+"'></div>");this.options.pager.addClass("coral-grid-pager").removeClass(a.id).appendTo(this.element);a._setPager(this.options.pager[0].id,"")}else{this.pagers.each(function(b){$(this).addClass("coral-grid-pager").removeClass(a.id).attr("id","pager_"+b+++"_"+a.id)});if(this.pagers){this.pagers.each(function(b){a._setPager(a.pagers[b].id,"")})}}a.options.pager="."+a.id},toolbar:function(){return $(".pager-toolbar",this.element)},_transToPicgrid:function(){var a=this;a.pic.css({height:230,overflow:"auto"})},_transToGrid:function(){var b=this,a=this.options;if($.inArray(b.options.multikey,b._sortkeys)==-1){b.options.multikey=false}b.options.sortorder=b.options.sortorder.toLowerCase();this.element.addClass("coral-grid");this.element.addClass(b.options.cls);b._transGridView()},_transGridView:function(){var n=this,j=this.options,b=this.grid,k=j.rownumbers===true?1:0,B=j.multiselect===true?1:(j.singleselect===true?1:0),F=j.subGrid===true?1:0;var u=j.direction,v;var A="<thead><tr class='coral-grid-labels' role='rowheader'>",g,x,p,I,D,o,c,d,s,H="",a="";
if(j.shrinkToFit===true&&j.forceFit===true){for(v=j.colModel.length-1;v>=0;v--){if(!j.colModel[v].hidden){j.colModel[v].resizable=false;break}}}$.each(this.options.colModel,function(){if(typeof this.hidden==="undefined"){this.hidden=false}});s="<span class='s-ico' style='display:none'><span sort='asc' class='coral-grid-ico-sort coral-icon-asc"+H+" coral-state-disabled cui-icon-arrow-up5 coral-sort-"+u+"'></span>";s+="<span sort='desc' class='coral-grid-ico-sort coral-icon-desc"+a+" coral-state-disabled cui-icon-arrow-down5 coral-sort-"+u+"'></span></span>";for(v=0;v<j.colNames.length;v++){var l=n.options.headertitles?(' title="'+$.grid.stripHtml(n.options.colNames[v])+'"'):"";var r=j.colModel[v].columnSortable?"coral-columnSortable-disabled":"";A+="<th id='"+j.id+"_"+j.colModel[v].name+"' role='columnheader' class='coral-state-default "+r+" coral-th-column coral-th-"+u+"'"+l+">";x=j.colModel[v].index||j.colModel[v].name;if(v<k+F+B){A+="<div id='jqgh_"+j.id+"_"+j.colModel[v].name+"' "+g+">"+j.colNames[v]}else{A+="<div id='jqgh_"+j.id+"_"+j.colModel[v].name+"'  title='"+j.colNames[v]+"'"+g+">"+j.colNames[v]}if(!j.colModel[v].width){j.colModel[v].width=150}else{j.colModel[v].width=parseInt(j.colModel[v].width,10)}if(typeof(j.colModel[v].title)!=="boolean"){j.colModel[v].title=true}if(x==j.sortname){j.lastsort=v}A+=s+"</div></th>"}A+="</tr></thead>";s=null;var z=$("<table class='coral-grid-htable' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(A);n.gridColumns.find(".coral-grid-columns-view").append(z);$("thead tr:first th",b.columnsView).hover(function(){$(this).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover")});n._setMultiselect();var G;if(typeof(j.width)!=="undefined"){if(typeof(j.width)=="string"&&j.width=="auto"){var t=$(n.element).innerWidth();n.options.width=t>0?t:"nw";G=t}else{G=j.width}}n._trigger("beforePopulate",null,[]);this._setColWidth();$(n.element).append("<div class='coral-grid-resize-mark' id='rs_m"+n.options.id+"'>&#160;</div>");
A=$("thead:first",n.element).get(0);var q="";if(n.options.footerrow){q+="<table role='grid' style='width:"+n.options.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow'>"}var h=$("tr:first",A),E="<tr class='jqgfirstrow' role='row' style='height:auto'>";$("th",h).each(function(i){p=j.colModel[i].width;if(typeof j.colModel[i].resizable==="undefined"){j.colModel[i].resizable=true}if(j.colModel[i].resizable){I=document.createElement("span");$(I).html("&#160;").addClass("coral-grid-resize coral-grid-resize-"+u);$(I).css("cursor","col-resize");$(this).addClass(j.resizeclass)}else{I=""}$(this).css("width",p+"px").prepend(I);var w="";if(j.colModel[i].hidden){$(this).css("display","none");w="display:none;"}E+="<td role='gridcell' style='height:0px;width:"+p+"px;"+w+"'></td>";b.headers[i]={width:p,el:this};D=j.colModel[i].sortable;if(typeof D!=="boolean"){j.colModel[i].sortable=true;D=true}var e=j.colModel[i].name;if(!(e=="cb"||e=="subgrid"||e=="rn")){if(j.viewsortcols[2]){$(">div",this).addClass("coral-grid-sortable")}}if(D){if(j.viewsortcols[0]){$("div span.s-ico",this).show();if(i==j.lastsort){$("div span.coral-icon-"+j.sortorder,this).removeClass("coral-state-disabled")}}else{if(i==j.lastsort){$("div span.s-ico",this).show();$("div span.coral-icon-"+j.sortorder,this).removeClass("coral-state-disabled")}}}if(j.footerrow){q+="<td role='gridcell' "+n._formatCol(i,0,"",null,"",false)+">&#160;</td>"}}).mousedown(function(w){if($(w.target).closest("th>span.coral-grid-resize").length!=1){return}var i=n._getColumnHeaderIndex(this);if(j.forceFit===true){j.nv=n._nextVisible(i)}b.dragStart(i,w,n._getOffset(i));return false}).click(function(L){if(j.disableClick){j.disableClick=false;return false}var J="th>div.coral-grid-sortable",K,M;if(!j.viewsortcols[2]){J="th>div>span>span.coral-grid-ico-sort"}var w=$(L.target).closest(J);if(w.length!=1){return}var i=n._getColumnHeaderIndex(this);if(!j.viewsortcols[2]){K=true;
M=w.attr("sort")}n._sortData($("div",this)[0].id,i,K,M,this);return false});if(n.options.onSortableColumns&&$.fn.sortable){try{$(n.element).grid("sortableColumns",h)}catch(C){}}if(n.options.footerrow){q+="</tr></tbody></table>"}E+="</tr>";var f=$("<table id='"+n.options.id+"_table' class='coral-grid-btable' role='grid' cellspacing='0' cellpadding='0' border='0'></table>").append(E);n.gridRows.find(".coral-grid-rows-view").append(f);this.rows=n.gridRows.find(".coral-grid-btable")[0].rows;this.element.prepend("<div class='coral-grid-view'></div>");var m;if(n.options.footerrow){b.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];m=$("<div class='ui-jqgrid-hbox'></div>");$(b.sDiv).append(m).width(b.width).insertAfter(n.gridColumns);$(m).append(q);b.footers=$(".ui-jqgrid-ftable",b.sDiv)[0].rows[0].cells;if(n.options.rownumbers){b.footers[0].className="ui-state-default jqgrid-rownum"}}m=null;if(n.options.caption.length>0){b.caption=document.createElement("div");b.caption.className="coral-grid-caption";$(b.caption).html(n.options.caption);this.element.prepend(b.caption)}$(b.columnsView).add(b.rowsView).parent().appendTo(this.element.find(".coral-grid-view"));if(j.shrinkToFit===true&&j.forceFit===true){$("table:first",b.rowsView).css("width",n.grid.width+"px");$("table:first",b.columnsView).css("width",n.grid.width+"px")}else{if(j.shrinkToFit===false){$("table:first",b.rowsView).css("width",n.options.tblwidth+"px");$("table:first",b.columnsView).css("width",n.options.tblwidth+"px")}}n._setOption("width",G);this.grid.cols=this.rows[0].cells;if(j.groupHeader){this.setGroupHeaders({useColSpanStyle:true,groupHeaders:j.groupHeaders});var y=$("tr.jqg-third-row-header",A);if(n.options.sortable&&$.fn.sortable){try{$(n.element).grid("sortableColumns",y)}catch(C){}}}A=null;z=null;f=null},_sortkeys:["shiftKey","altKey","ctrlKey"],_getColumnHeaderIndex:function(d){var c=this;var b,e=c.grid.headers,a=$.grid.getCellIndex(d);if(this.grid.rightfhDiv){a=e.length-a-1}for(b=0;b<e.length;b++){if(d===e[b].el){a=b;
break}}return a},_analyzeColumns:function(d){var e=this,c=0,b=this.options;if(this.options.colModel.length<=0){d.children().each(function(g){var h=$.parser.parseOptions(this,null,["data"]);if(typeof(h.name)!="undefined"){b.colModel.push(h);b.colNames.push(h.label||$(this).html())}else{if(typeof(h.header)!="undefined"){var f=0;var j;$(this).children().each(function(k){var l=$.parser.parseOptions(this,null,["data"]);b.colModel.push(l);b.colNames.push(l.label||$(this).html());f++;k==0&&(j=l)});b.groupHeaders.push({startColumnName:j.name,numberOfColumns:f,titleText:h.header})}}})}for(c=0;c<this.options.colModel.length;c++){var a=this.options.colModel[c];if(a.formatter=="combobox"||a.formatter=="combotree"||a.formatter=="combogrid"){if(a.revertCode!=false){a.revertCode=true}}a.postMode=a.postMode||"value";if(a.edittype=="combobox"||a.edittype=="combotree"||a.edittype=="autocomplete"||a.edittype=="combogrid"){(a.edittype=="combotree")&&(a.dataStructure="tree");a.formatter=a.formatter||"convertCode"}}if(this.options.colNames.length===0){for(c=0;c<this.options.colModel.length;c++){this.options.colNames[c]=this.options.colModel[c].label||this.options.colModel[c].name}}if(this.options.colNames.length!==this.options.colModel.length){alert("errors! colNames not equals to colModel!");return}d.children().not(".coral-grid-columns-view").remove()},_updateMultiSelectIndexsOption:function(b){var d=b.minIndex,c=b.maxIndex,e=b.preIndex,a=b.curIndex;if(null==d){d=c=e=(null==e?a:e)}if(a<=d){d=a;c=e}else{if(a>d&&a<c){d=Math.min(a,e);c=Math.max(a,e)}else{if(a>c){c=a;d=e}}}return{minIndex:d,maxIndex:c,preIndex:e}},_addShiftKeySelect:function(h,k){var g=this,a=g.options;if(!k.rowId){return}var j=$(g.element),c=false,m=j.find(".coral-grid-btable")[0].rows,b=m.namedItem(k.rowId).rowIndex;if(h.shiftKey){var f=g._updateMultiSelectIndexsOption({maxIndex:a.maxIndex,minIndex:a.minIndex,preIndex:a.preIndex,curIndex:b});a.minIndex=f.minIndex;a.maxIndex=f.maxIndex;a.preIndex=f.preIndex;j.grid("resetSelection");
for(var d=a.minIndex;d<=a.maxIndex;d++){var l=false;if(d==a.maxIndex){l=true}j.grid("setSelection",m[d].id,l)}if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){window.getSelection().removeAllRanges()}}c=true}else{a.minIndex=a.maxIndex=null;a.preIndex=b}return c},_setUpEvent:function(){var f=this,e=this.grid,c=this.options;var a,d,b,h,g;if(f.options.cellEdit===false&&f.options.hoverrows===true){$(f.element).bind("mouseover",function(j){var i=!!(f.options.model=="card");if(i){g=$(j.target,f.pic).closest("li.gridPanel").find(".rowgrid");if($(g).attr("class")!=="coral-subgrid"){$(g).addClass("coral-state-hover")}}else{g=$(j.target,f.rows).closest("tr.jqgrow");if($(g).attr("class")!=="coral-subgrid"){$(g).addClass("coral-state-hover")}}}).bind("mouseout",function(j){var i=!!(f.options.model=="card");if(i){g=$(j.target,f.pic).closest("li.gridPanel ").find(".rowgrid")}else{g=$(j.target,f.rows).closest("tr.jqgrow")}$(g).removeClass("coral-state-hover")})}$(e.rowsView).scroll(function(m){if(c.scroll){var l=$(e.rowsView)[0].scrollTop;if(e.scrollTop===undefined){e.scrollTop=0}if(l!=e.scrollTop){e.scrollTop=l;if(e.timer){clearTimeout(e.timer)}e.timer=setTimeout(e.populateVisible,c.scrollTimeout)}}$(e.columnsView)[0].scrollLeft=$(e.rowsView)[0].scrollLeft;var k=$(e.rowsView)[0].scrollTop;$(".coral-grid-btable-frozen").css("left",-$(e.rowsView)[0].scrollLeft+"px");var i=$(".row-editable",f.element),j=$(f.element).grid("getInd",f.editRowIndex,true);if(i.length>0){f.editButtonsPos(f.editRowIndex,i)}if(c.footerrow){e.sDiv.scrollLeft=$(e.rowsView)[0].scrollLeft}});$(".coral-grid-btable",f.element).add(f.pic).click(function(p){var i=!!(f.options.model=="card");var o;h=p.target;if(i){g=$(h,f.pic).closest("li.gridPanel")}else{g=$(h,f.rows).closest("tr.jqgrow")}if($(g).length===0||g[0].className.indexOf("coral-state-disabled")>-1||$(h,f.element).closest("table.coral-grid-btable").length<0){return this}var j=$(h).hasClass("cbox"),l=f._trigger("beforeSelectRow",p,[{rowId:g[0].id}]);
l=(l===false||l==="stop")?false:true;if(h.tagName=="A"||((h.tagName=="INPUT"||h.tagName=="TEXTAREA"||h.tagName=="OPTION"||h.tagName=="SELECT")&&!j)){return}if(l===true){o=g[0].id;b=$(h).closest("td,th").html();if(!i){d=$.grid.getCellIndex(h);if(f._addShiftKeySelect(p,{rowId:g[0].id})){return}f._trigger("onSelectCell",p,[{rowId:o,rowIndex:g[0].rowIndex,cellIndex:d,cellHtml:b}])}if(f.options.editableRows&&f.options.clicksToEdit==1&&c.editrow!=o){f.restoreRow(c.editrow);if(f.rowEditButtons){f.rowEditButtons.remove()}}if(f.options.editableRows&&f.options.clicksToEdit==1&&!j){c.editrow=g[0].id;f.editRow(g[0].id,true)}if(f.options.cellEdit===true&&f.options.clicksToEdit==1){var m=f.options.colModel[d].editable;var n=f.options.multiselect||f.options.singleselect;if((n&&j&&f.options.clickRowToSelect)||(n&&!m&&!f.options.multikey)){$(f.element).grid("setSelection",o,true,p)}else{if(!i){try{$(f.element).grid("editCell",g[0].rowIndex,d,true)}catch(k){}}}}else{if(!f.options.multikey){f.selectMultikey(f,p,o)}else{if(p[f.options.multikey]){$(f.element).grid("setSelection",o,true,p)}else{if((f.options.multiselect||f.options.singleselect)&&j){$(f.element).grid("setSelection",o,true,p);if(!j){f._cancelCheckAll()}}else{f.options.multiboxonly=true;f.selectMultikey(f,p,o)}}}}}});$(f.element).dblclick(function(l){h=l.target;g=$(h,f.rows).closest("tr.jqgrow");if($(g).length===0){return}if(f.options.editableRows&&c.editrow!=g[0].id){f.restoreRow(c.editrow);if(f.rowEditButtons){f.rowEditButtons.remove()}}var i=g[0].rowIndex;var k=$.grid.getCellIndex(h);if(f.options.editableRows&&f.options.clicksToEdit==2){c.editrow=g[0].id;f.editRow(g[0].id,true)}if(f.options.cellEdit===true&&f.options.clicksToEdit==2){i=g[0].rowIndex;try{$(f.element).grid("editCell",i,k,true)}catch(j){}}f._trigger("onDblClickRow",null,[{rowId:g[0].id,rowIndex:i,cellIndex:k}])}).bind("contextmenu",function(i){h=i.target;g=$(h,f.rows).closest("tr.jqgrow");if($(g).length===0){return}if(!f.options.multiselect){$(f.element).grid("setSelection",g[0].id,true,i)
}a=g[0].rowIndex;d=$.grid.getCellIndex(h);f._trigger("onRightClickRow",null,[{rowId:g[0].id,rowIndex:a,cellIndex:d}])});$(e.columnsView).mousemove(function(i){if(e.resizing){e.dragMove(i);return false}});$(".coral-grid-labels",e.columnsView).bind("selectstart",function(){return false});$(document).mouseup(function(){if(e.resizing){e.dragEnd();return false}return true});this._off($(".coral-paginator-page"));this._on({"click.coral-paginator-page":function(j){var i=f._intNum($(j.target).html(),1);f.options.page=i;if(!f._clearVals(this.id)){return false}f._populate();return false}})},selectMultikey:function(c,f,d){var g=f.target;var a=$(g).hasClass("cbox");if(c.options.multiselect&&c.options.multiboxonly){if(a){$(c.element).grid("setSelection",d,true,f)}else{var b=c.options.frozenColumns?c.options.id+"_frozen":"";if(c.options.clickRowToSelect){$(c.options.selarrrow).each(function(e,j){var h=c.rows.namedItem(j);$(h).removeClass("coral-state-highlight");$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(j))[c.options.useProp?"prop":"attr"]("checked",false);if(b){$("#"+$.grid.coralID(j),"#"+$.grid.coralID(b)).removeClass("coral-state-highlight");$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(j),"#"+$.grid.coralID(b))[c.options.useProp?"prop":"attr"]("checked",false)}});c.options.selarrrow=[];$(c.element).grid("setSelection",d,true,f)}}}else{if(a||c.options.clickRowToSelect){$(c.element).grid("setSelection",d,true,f)}}},restoreAll:function(){if(this.options.editableRows){this.restoreRow(this.options.editrow);if(this.rowEditButtons){this.rowEditButtons.remove()}}if(this.options.savedRow.length>0){if(!$(this.element).grid("saveCell",this.options.savedRow[0].id,this.options.savedRow[0].ic)){return}}},setSelectAll:function(d){var c=this,f,h,b=(this.options.model==="card");if(b){f=c.element.find(".coral-pic>li")}else{f=c.rows}if(this.options.multiselect){var g=[],a;var e=c.options.frozenColumns===true?c.options.id+"_frozen":"";if(d){$(f).each(function(k){h=b?k>=0:k>0;
if(h>0){if(!$(this).hasClass("coral-subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass("coral-state-disabled")){var j=$.inArray(this.id,c.options.selarrrow);if(j===-1){if(b){$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",true);$(f).find(".rowgrid").addClass("coral-state-highlight").attr("aria-selected","true")}else{$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",true);c._setHeadCheckBox(true);$(this).addClass("coral-state-highlight").attr("aria-selected","true");if(e){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv)[c.options.useProp?"prop":"attr"]("checked",true);$("#"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv).addClass("coral-state-highlight");if(c.grid.fhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv)[c.options.useProp?"prop":"attr"]("checked",true);$("#"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv).addClass("coral-state-highlight")}else{if(c.grid.rightfhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[k].id),c.grid.rightfbDiv)[c.options.useProp?"prop":"attr"]("checked",true);$("#"+$.grid.coralID(c.rows[k].id),c.grid.rightfbDiv).addClass("coral-state-highlight")}}}}c.options.selarrrow.push(this.id);c.options.selrow=this.id}}}});a=true;g=[]}else{c.options.selarrrow=[];$(f).each(function(j){h=b?j>=0:j>0;if(h){if(!$(this).hasClass("coral-subgrid")&&!$(this).hasClass("coral-state-disabled")){if(b){$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",false);$(f).find(".rowgrid").removeClass("coral-state-highlight").attr("aria-selected","false")}else{$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",false);c._setHeadCheckBox(false);$(this).removeClass("coral-state-highlight").attr("aria-selected","false");
if(e){if(c.grid.fhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[j].id),c.grid.fbDiv)[c.options.useProp?"prop":"attr"]("checked",false);$("#"+$.grid.coralID(c.rows[j].id),c.grid.fbDiv).removeClass("coral-state-highlight")}else{if(c.grid.rightfhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[j].id),c.grid.rightfbDiv)[c.options.useProp?"prop":"attr"]("checked",false);$("#"+$.grid.coralID(c.rows[j].id),c.grid.rightfbDiv).removeClass("coral-state-highlight")}}}}g.push(this.id)}}});c.options.selrow=null;a=false}c._trigger("onSelectAll",null,[{aRowIds:a?c.options.selarrrow:g,status:a}])}},_setMultiselect:function(){var b=this;if(this.options.multiselect){var c=[],a;$("#cb_"+$.grid.coralID(b.options.id),this.grid.columnsView).bind("click",function(d){b.setSelectAll(this.checked)})}},_refresh:function(a,b){},reload:function(a){var d=this,b=this.grid,c={},g=false,f=[];if(typeof(a)==="undefined"){a=this.options.orgdatatype==="json"?this.options.url:this.options.data}if(!a&&!this.options.url){a=[]}else{if(!a&&this.options.url){a=this.options.url}}if(typeof(a)!=="string"){c=a;if(c.data){f=c.data}else{if(c.url){a=c.url;g=true}else{if(a instanceof Array){f=a}else{if(!c.url&&!c.data&&!this.options.url){f=this.options.data}else{if(!c.url&&!c.data&&this.options.url){a=this.options.url;g=true}}}}}}else{g=true}if(d.options.treeGrid===true){d.options.datatype=d.options.treedatatype}if(c&&c.current){d.grid.selectionPreserver(d)}if(d.options.datatype=="local"){$(d.element).grid("resetSelection");if(d.options.data.length){d.normalizeData();d.refreshIndex()}}else{if(!d.options.treeGrid){d.options.selrow=null;if(d.options.multiselect){d.options.selarrrow=[];d._setHeadCheckBox(false)}d.options.savedRow=[]}}if(d.options.scroll){emptyRows(d.grid.rowsView,true,false)}if(c&&c.page){var e=c.page;if(e>d.options.lastpage){e=d.options.lastpage}if(e<1){e=1}d.options.page=e;if(d.grid.prevRowHeight){d.grid.rowsView.scrollTop=(e-1)*d.grid.prevRowHeight*d.options.rowNum
}else{d.grid.rowsView.scrollTop=0}}if(d.grid.prevRowHeight&&d.options.scroll){delete d.options.lastpage;d._populateVisible()}else{if(d.options.localonce==true){d.options.search=true}else{d.options.search=false;if(!g){d.options.datatype="local";delete d.options.orgdatatype;d.options.data=f}else{d.options.datatype="json";delete d.options.orgdatatype;d.options.url=a}}d._populate();d.options.localonce=false}return false},resetFrozen:function(){if(!this._hasHorizontalScrollBar()){$(this.grid.rightfbDiv).hide();$(this.grid.rightfhDiv).hide()}else{$(this.grid.rightfbDiv).show();$(this.grid.rightfhDiv).show()}},refresh:function(f){var e,d=this,b=this.options,a=b.fitStyle,c=this.element.parent();e=c.height();d.resetFrozen();this.element.siblings(":visible").each(function(){var h=$(this),g=h.css("position");if(g==="absolute"||g==="fixed"){return}e-=h.outerHeight(true)});if(!$("#"+d.element[0].id).length){return}if(a==="fill"){$.coral.fitParent(this.component(),true);$(d.element).grid("option","height",e);$(d.element).grid("option","width",d.element.innerWidth()>0?d.element.innerWidth():0)}else{if(a==="width"){$(d.element).grid("option","width",d.element.innerWidth()>0?d.element.innerWidth():0);$(d.element).grid("option","height",d.options.height)}else{if(a==="height"){$.coral.fitParent(this.component(),true);$(d.element).grid("option","height",e)}else{if(a==="auto"){$(d.element).grid("option","height",d.options.height)}}}}d.refreshPager();d._noRecordsTipsPositon();if(d.options.frozenColumns===true){d.resizeFrozen()}if(this.element.find(".loading-overlay").length){switch(this.options.loadui){case"disable":break;case"enable":case"block":$(this.element).loading("refresh");break}}$.coral.refreshAllComponent(this.element)},refreshPager:function(){var a=this;if(this.pagers){this.pagers.each(function(d){var c=$(".paginator-left",a.element).outerWidth()+5;var b=$("#"+a.pagers[d].id).width();$(".toolbarpanel",a.element).css({left:c+"px",position:"absolute",top:0,width:(b-c)+"px"})});a.options.pager="."+a.id;
if($(".ctrl-init-toolbar",a.element).length){$(".ctrl-init-toolbar",a.element).toolbar("refresh")}}},setSelectionAll:function(){if(!$("#cb_"+this.options.id).prop("checked")){$("#cb_"+this.options.id).trigger("click")}},setSelection:function(j,m,h){var g=this,f,k=(this.options.model==="card"),l,i,c,b,d;if(j===undefined){return}m=m===false?false:true;if(k){l=this.element.find(".coral-pic #"+j)[0]}else{l=this.rows.namedItem(j+"")}if(!l||!l.className||l.className.indexOf("coral-state-disabled")>-1){return}function a(p){var o=$(g.grid.rowsView)[0].clientHeight,n=$(g.grid.rowsView)[0].scrollTop,q=g.rows[p].offsetTop,e=g.rows[p].clientHeight;if(q+e>=o+n){$(g.grid.rowsView)[0].scrollTop=q-(o+n)+e+n}else{if(q<o+n){if(q<n){$(g.grid.rowsView)[0].scrollTop=q}}}}if(this.options.scrollrows===true){i=this.rows.namedItem(j).rowIndex;if(i>=0){a(i)}}if(this.options.frozenColumns===true){d=this.options.id+"_frozen"}if(!this.options.multiselect){if(l.className!=="coral-subgrid"){if(this.options.selrow!=l.id){if(k){this.element.find("#"+this.options.selrow+">ul").removeClass("coral-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(l).find(".rowgrid").addClass("coral-state-highlight").attr({"aria-selected":"true",tabindex:"0"});if(d){$("#"+$.grid.coralID(this.options.selrow),"#"+$.grid.coralID(d)).find(".rowgrid").removeClass("coral-state-highlight");$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).find(".rowgrid").addClass("coral-state-highlight")}}else{$(this.rows.namedItem(this.options.selrow)).removeClass("coral-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(l).addClass("coral-state-highlight").attr({"aria-selected":"true",tabindex:"0"});if(d){$("#"+$.grid.coralID(this.options.selrow),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight");$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).addClass("coral-state-highlight")}}f=true;$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(l.id),$(l))[this.options.useProp?"prop":"attr"]("checked",f);
if(d){$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(j),"#"+$.grid.coralID(d))[this.options.useProp?"prop":"attr"]("checked",f)}}else{f=false}this.options.selrow=l.id;if(m){this._trigger("onSelectRow",h,[{rowId:l.id,status:f}])}}}else{this._setHeadCheckBox(false);this.options.selrow=l.id;c=$.inArray(this.options.selrow,this.options.selarrrow);if(c===-1){if(k){if(l.className!=="coral-subgrid"){$(l).find(".rowgrid").addClass("coral-state-highlight").attr("aria-selected","true")}}else{if(l.className!=="coral-subgrid"){$(l).addClass("coral-state-highlight").attr("aria-selected","true")}}f=true;this.options.selarrrow.push(this.options.selrow)}else{if(k){if(l.className!=="coral-subgrid"){$(l).find(".rowgrid").removeClass("coral-state-highlight").attr("aria-selected","false")}}else{if(l.className!=="coral-subgrid"){$(l).removeClass("coral-state-highlight").attr("aria-selected","false")}}f=false;this.options.selarrrow.splice(c,1);b=this.options.selarrrow[0];this.options.selrow=(b===undefined)?null:b}if(this.rows.length-1===this.options.selarrrow.length){this._setHeadCheckBox(true)}$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(l.id),$(l))[this.options.useProp?"prop":"attr"]("checked",f);if(d){if(k){if(c===-1){$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).find(".rowgrid").addClass("coral-state-highlight")}else{$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).find(".rowgrid").removeClass("coral-state-highlight")}}else{if(c===-1){$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).addClass("coral-state-highlight")}else{$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight")}}$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(j),"#"+$.grid.coralID(d))[this.options.useProp?"prop":"attr"]("checked",f)}if(m){this._trigger("onSelectRow",h,[{rowId:l.id,status:f}])}}},_setHeadCheckBox:function(b){var a=this;$("#cb_"+$.grid.coralID(a.options.id),a.grid.columnsView)[a.options.useProp?"prop":"attr"]("checked",b);var c=a.options.frozenColumns?a.options.id+"_frozen":"";
if(c){$("#cb_"+$.grid.coralID(a.options.id),a.grid.fhDiv)[a.options.useProp?"prop":"attr"]("checked",b)}},setFrozenRows:function(f){var e=this,d=e.grid;e.destroyFrozenRows();e.rowsView2=$(d.rowsView);if(!e.rowsView2.children("table.coral-grid-btable-frozen").length){$(e.rowsView2).prepend('<table class="coral-grid-btable-frozen" cellspacing="0" cellpadding="0"></table>');e.rowsView2.children("table.coral-grid-btable-frozen").css({position:"absolute",left:0,top:$(d.columnsView).height()+"px"})}var g=e.element.find(".coral-grid-rows-view").height();b(false);c(false);var a=e.rowsView2.find("table.coral-grid-btable-frozen").outerHeight();e.rowsView2.css({"margin-top":a+"px",height:(g-a)+"px"});e.rowsView2.find(".coral-grid-btable-frozen").css({left:-$(d.rowsView)[0].scrollLeft+"px",width:e.rowsView2.find(".coral-grid-btable").width()+"px","table-layout":"fixed"});function b(h){var i=e.rowsView2.find(".coral-grid-btable")[0].rows[0];(h?e.rowsView1:e.rowsView2).children("table.coral-grid-btable-frozen").append($(i).clone())}function c(i){var h=e.rowsView2.find(".coral-grid-btable tr").filter(function(k){if(k==0){return false}if(k<=f){return true}});var j=e.rowsView2.find(".coral-grid-btable")[0].rows[1];(i?e.rowsView1:e.rowsView2).children("table.coral-grid-btable-frozen").append(h)}},destroyFrozenRows:function(){var d=this,b=d.grid;d.rowsView2=$(b.rowsView);if(!d.rowsView2.children("table.coral-grid-btable-frozen").length){$(d.rowsView2).prepend('<table class="coral-grid-btable-frozen" cellspacing="0" cellpadding="0"></table>');d.rowsView2.children("table.coral-grid-btable-frozen").css({position:"absolute",left:0,top:0})}var f=d.element.find(".coral-grid-rows-view").height();var a=d.rowsView2.find("table.coral-grid-btable-frozen").outerHeight();e(false);c(false);d.rowsView2.css({"margin-top":0,height:(f+a)+"px"});function e(g){var i=d.rowsView2.find("table.coral-grid-btable-frozen tr").filter(function(j){if(j==0){return false}return true});var h=(g?d.rowsView1:d.rowsView2).children("table.coral-grid-btable-frozen")[0].rows[1];
$(d.rowsView2.find(".coral-grid-btable tbody:first tr:first")[0]).after(i)}function c(g){(g?d.rowsView1:d.rowsView2).children("table.coral-grid-btable-frozen").remove()}},showHideCol:function(f,c){var e=this,g=false,h=$.support.boxSizing?0:this._intNum(this.options.cellLayout,0),b;if(!e.grid){return}if(typeof f==="string"){f=[f]}c=c!="none"?"":"none";var a=c===""?true:false,d=e.options.groupHeader&&(typeof e.options.groupHeader==="object"||$.isFunction(e.options.groupHeader));if(d){$(e.element).grid("destroyGroupHeader",false)}$(this.options.colModel).each(function(j){if($.inArray(this.name,f)!==-1&&this.hidden===a){if(e.options.frozenColumns===true&&this.frozen===true){}$("tr",e.grid.columnsView).each(function(){$(this.cells[j]).css("display",c)});$(e.rows).each(function(){if(!$(this).hasClass("jqgroup")){$(this.cells[j]).css("display",c)}});if(e.options.footerrow){$("tr.footrow td:eq("+j+")",e.grid.sDiv).css("display",c)}b=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(c==="none"){e.options.tblwidth-=b+h}else{e.options.tblwidth+=b+h}this.hidden=!a;g=true;e._trigger("onShowHideCol",null,[{show:a,name:this.name,index:j}])}});if(g===true){if(e.options.shrinkToFit===true&&!isNaN(e.options.height)){e.options.tblwidth+=parseInt(e.options.scrollOffset,10)}e._setGridWidth(e.options.shrinkToFit===true?e.options.tblwidth:e.options.width)}if(d){$(e.element).grid("setGroupHeaders",e.options.groupHeader)}},hideCol:function(a){return $(this.element).grid("showHideCol",a,"none")},showCol:function(a){return $(this.element).grid("showHideCol",a,"")},remapColumns:function(c,f,e){function b(g){var h;if(g.length){h=$.makeArray(g)}else{h=$.extend({},g)}$.each(c,function(j){g[j]=h[this]})}var d=this;function a(h,g){$(">tr"+(g||""),h).each(function(){var j=this;var i=$.makeArray(j.cells);$.each(c,function(){var k=i[this];if(k){j.appendChild(k)}})})}b(d.options.colModel);b(d.options.colNames);b(d.grid.headers);a($("thead:first",d.grid.columnsView),e&&":not(.coral-grid-labels)");if(f){a($("#"+$.grid.coralID(d.options.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")
}if(d.options.footerrow){a($("tbody:first",d.grid.sDiv))}if(d.options.remapColumns){if(!d.options.remapColumns.length){d.options.remapColumns=$.makeArray(c)}else{b(d.options.remapColumns)}}d.options.lastsort=$.inArray(d.options.lastsort,c);if(d.options.treeGrid){d.options.expColInd=$.inArray(d.options.expColInd,c)}$(d).triggerHandler("gridRemapColumns",[c,f,e])},sortableColumns:function(b){var c=this,e=$.grid.coralID(c.options.id);function f(){c.options.disableClick=true}var d={tolerance:"pointer",axis:"x",cancel:".coral-columnSortable-disabled",scrollSensitivity:"1",helper:function(h,g){return g.clone()},items:">th:not(:has(#jqgh_"+e+"_cb,#jqgh_"+e+"_rn,#jqgh_"+e+"_subgrid),:hidden, .coral-columnSortable-disabled)",placeholder:{element:function(h){var i=typeof(h.attr("rowspan"))=="undefined"?"1":"2",j=typeof(h.attr("colspan"))=="undefined"?"1":"2";var g=$(document.createElement(h[0].nodeName)).addClass(h[0].className+" coral-sortable-placeholder coral-state-highlight").removeClass("coral-sortable-helper").attr("rowspan",i).attr("colspan",j)[0];return g},update:function(g,h){h.height(g.currentItem.innerHeight()-parseInt(g.currentItem.css("paddingTop")||0,10)-parseInt(g.currentItem.css("paddingBottom")||0,10));h.width(g.currentItem.innerWidth()-parseInt(g.currentItem.css("paddingLeft")||0,10)-parseInt(g.currentItem.css("paddingRight")||0,10))}},update:function(h,l){var i=$(l.item).parent(),j=$(">th",i),n=c.options.colModel,g={},k=c.options.id+"_";l.itemId=[];$.each(n,function(p){g[this.name]=p});var m=[];var o=[];j.each(function(){var p=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(k,"");if(p in g){m.push(g[p]);o.push(p)}});$.each(l.item,function(p){l.itemId.push(l.item[p].id.replace(/^jqgh_/,"").replace(k,""))});l.prevItemId=$(l.item[0]).prev("th").attr("id").replace(/^jqgh_/,"").replace(k,"");l.nextItemId=$(l.item[0]).next("th").attr("id").replace(/^jqgh_/,"").replace(k,"");l.targetId=l.position.left>l.originalPosition.left?l.prevItemId:l.nextItemId;$(c.element).grid("remapColumns",m,true,true);
l.permutation=m;l.permutationOfId=o;c._trigger("onSortableColumns",h,[l]);setTimeout(function(){c.options.disableClick=false},50)}};$.extend(d,c.options.sortableColumnsOptions);if(d.beforesortablecolumns){var a=d.beforesortablecolumns;d.start=function(h,g){f();a.call(this,h,g)}}else{d.start=f}if(c.options.sortableColumnsOptions.exclude){d.items+=":not("+c.options.sortableColumnsOptions.exclude+")"}b.sortable(d).data("sortable").floating=true},setCaption:function(a){this.options.caption=a;$("span.coral-grid-title, span.coral-grid-title-rtl",this.grid.caption).html(a);$(this.grid.cDiv).show()},setLabel:function(f,b,h,d){var c=this,g=-1;if(!c.grid){return}if(typeof(f)!="undefined"){$(c.options.colModel).each(function(j){if(this.name==f){g=j;return false}})}else{return}if(g>=0){var a=$("tr.coral-grid-labels th:eq("+g+")",c.grid.columnsViews);if(b){var e=$(".s-ico",a);$("[id^=jqgh_]",a).empty().html(b).append(e);c.options.colNames[g]=b}if(h){if(typeof h==="string"){$(a).addClass(h)}else{$(a).css(h)}}if(typeof d==="object"){$(a).attr(d)}}},setCell:function(b,h,e,f,p,c){var j=this,k=-1,o,m;if(!j.grid){return}if(isNaN(h)){$(j.options.colModel).each(function(q){if(this.name==h){k=q;return false}})}else{k=parseInt(h,10)}if(k>=0){var d=j.rows.namedItem(b);var a=$(j.element).grid("getRowData",b);if(d){var l=$("td:eq("+k+")",d);if(e!==""||c===true){o=j._formatter(b,e,k,a,"edit");m=j.options.colModel[k].title?{title:$.grid.stripHtml(o)}:{};if(j.options.treeGrid&&$(".tree-wrap",$(l)).length>0){$("span",$(l)).html(o).attr(m)}else{$(l).html(o).attr(m)}$.fn.afterFmatter.call(j);if(j.options.datatype=="local"){var n=j.options.colModel[k],i;var g=$.coral.toFunction(n.formatter);if($.isFunction(g)){e=g.apply(this.element[0])}else{e=n.formatter&&typeof(n.formatter)==="string"&&n.formatter=="date"?$.unformat.date.call(j,e,n):e}i=j.options._index[b];if(typeof i!="undefined"){j.options.data[i][n.name]=e}}}if(typeof f==="string"){$(l).addClass(f)}else{if(f){$(l).css(f)}}if(typeof p==="object"){$(l).attr(p)
}}}},getCell:function(c,b){var a=false;var h=this,g=-1;if(!h.grid){return}if(isNaN(b)){$(h.options.colModel).each(function(e){if(this.name===b){g=e;return false}})}else{g=parseInt(b,10)}if(g>=0){var d=h.rows.namedItem(c);if(d){try{a=$.unformat.call(h,$("td:eq("+g+")",d),{rowId:d.id,colModel:h.options.colModel[g]},g)}catch(f){a=$.grid.htmlDecode($("td:eq("+g+")",d).html())}}}return a},getCol:function(b,g,p){var k=[],a,h=0,c,n,o;g=typeof(g)!="boolean"?false:g;if(typeof p=="undefined"){p=false}var f=this,m=-1;if(!f.grid){return}if(isNaN(b)){$(f.options.colModel).each(function(e){if(f.options.colModel[e].name===b){m=e;return false}})}else{m=parseInt(b,10)}if(m>=0){var l=f.rows.length,d=0;if(l&&l>0){while(d<l){if($(f.rows[d]).hasClass("jqgrow")){try{a=$.unformat.call(f,$(f.rows[d].cells[m]),{rowId:f.rows[d].id,colModel:f.options.colModel[m]},m)}catch(j){a=$.grid.htmlDecode(f.rows[d].cells[m].innerHTML)}if(p){o=parseFloat(a);h+=o;if(d===0){c=o;n=o}else{c=Math.min(c,o);n=Math.max(n,o)}}else{if(g){k.push({id:f.rows[d].id,value:a})}else{k.push(a)}}}d++}if(p){switch(p.toLowerCase()){case"sum":k=h;break;case"avg":k=h/l;break;case"count":k=l;break;case"min":k=c;break;case"max":k=n;break}}}}return k},getCellComponent:function(a,e,c,d,j,b){var f=this,g=-1,i,h;if(!f.grid){return}return $("#"+a).find("[aria-describedby$="+e+"]").find(".ctrl-init")},_formatter:function(b,d,c,i,f){var g=this.options.colModel[c],h;if(typeof g.formatter!=="undefined"){var a={rowId:b,colModel:g,gid:this.options.id,pos:c,model:this.options.model};var e=$.coral.toFunction(g.formatter);if($.isFunction(e)){h=e.apply(this.element[0],[d,a,i,f])}else{if($.fmatter){h=$.fn.fmatter.call(this,g.formatter,d,a,i,f)}else{h=this._cellVal(d)}}}else{h=this._cellVal(d)}return h},_getOffset:function(b){var e=this;var c,a={},d=$.support.boxSizing?0:e.options.cellLayout;a[0]=a[1]=a[2]=0;for(c=0;c<=b;c++){if(e.options.colModel[c].hidden===false||typeof(e.options.colModel[c].hidden)=="undefined"){a[0]+=e.options.colModel[c].width+d
}}a[0]=a[0]-e.grid.rowsView.scrollLeft;a[2]+=$(e.grid.rowsView).height()+$(e.grid.columnsView).height();return a},_sortData:function(j,g,b,f,h){var i=this;if(!this.options.colModel[g].sortable){return}i.options.b_sortdata=true;var d;if(this.options.savedRow.length>0){return}if(!b){if(this.options.lastsort==g){if(this.options.sortorder=="asc"){this.options.sortorder="desc"}else{if(this.options.sortorder=="desc"){this.options.sortorder="asc"}}}else{this.options.sortorder=this.options.colModel[g].firstsortorder||"asc"}this.options.page=1}if(f){if(this.options.lastsort==g&&this.options.sortorder==f&&!b){return}else{i.options.sortorder=f}}var c=this.grid.headers[this.options.lastsort].el,a=this.options.frozenColumns?h:this.grid.headers[g].el;$("span.coral-grid-ico-sort",c).addClass("coral-state-disabled");$(c).attr("aria-selected","false");if(this.options.frozenColumns){if(this.grid.fhDiv){this.grid.fhDiv.find("span.coral-grid-ico-sort").addClass("coral-state-disabled");this.grid.fhDiv.find("th").attr("aria-selected","false")}else{if(this.grid.rightfhDiv){this.grid.rightfhDiv.find("span.coral-grid-ico-sort").addClass("coral-state-disabled");this.grid.rightfhDiv.find("th").attr("aria-selected","false")}}}$("span.coral-icon-"+this.options.sortorder,a).removeClass("coral-state-disabled");$(a).attr("aria-selected","true");if(!this.options.viewsortcols[0]){if(this.options.lastsort!=g){if(this.options.frozenColumns){if(this.grid.fhDiv){this.grid.fhDiv.find("span.s-ico").hide()}else{if(this.grid.rightfhDiv){this.grid.rightfhDiv.find("span.s-ico").hide()}}}$("span.s-ico",c).hide();$("span.s-ico",a).show()}else{if(this.options.sortname===""){$("span.s-ico",a).show()}}}j=j.substring(5+this.options.id.length+1);this.options.sortname=this.options.colModel[g].index||j;d=this.options.sortorder;if(i._trigger("onSortCol",null,[{id:j,colIndex:g,sortorder:d}])==="stop"){this.options.lastsort=g;return}if(this.options.datatype=="local"){if(this.options.deselectAfterSort){$(this.element).grid("resetSelection")
}}else{this.options.selrow=null;if(this.options.multiselect){i._setHeadCheckBox(false)}this.options.selarrrow=[];this.options.savedRow=[]}if(this.options.scroll){var e=this.grid.rowsView.scrollLeft;emptyRows(this.grid.rowsView,true,false);this.grid.columnsView.scrollLeft=e}if(this.options.subGrid&&this.options.datatype=="local"){$("td.sgexpanded","#"+$.grid.coralID(this.options.id)).each(function(){$(this).trigger("click")})}this._populate();this.options.lastsort=g;if(this.options.sortname!=j&&g){this.options.lastsort=g}i.options.b_sortdata=false},_intNum:function(b,a){b=parseInt(b,10);if(isNaN(b)){return a?a:0}else{return b}},_beginReq:function(){var a=$("#noRecordsTips_"+$.grid.coralID(this.options.id));if(a.is(":visible")){a.hide()}this.refresh();this.grid.columnsView.loading=true;if(this.options.hiddengrid){return}switch(this.options.loadui){case"disable":break;case"enable":$(this.element).loading({position:"overlay",text:this.options.loadtext});break;case"block":$("#lui_"+$.grid.coralID(this.options.id)).show();$(this.element).loading({position:"overlay",text:this.options.loadtext});break}},_endReq:function(){var a=this;this._delay(function(){a.refreshPager()},300);this.grid.columnsView.loading=false;switch(this.options.loadui){case"disable":break;case"enable":$(this.element).loading("hide");break;case"block":$("#lui_"+$.grid.coralID(this.options.id)).hide();$(this.element).loading("hide");break}this.element.find(".coral-grid-htable,.coral-grid-btable").css({"table-layout":"fixed"});if($(a.grid.rowsView).find(".jqgrow").length==0){a._noRecordsTipsPositon();$("#noRecordsTips_"+$.grid.coralID(a.options.id)).css("display","inline-block");$(a.grid.fhDiv).css("display","none");$(a.grid.fhDiv).css("display","none")}else{$("#noRecordsTips_"+$.grid.coralID(a.options.id)).css("display","none");$(a.grid.fhDiv).css("display","block");$(a.grid.fhDiv).css("display","block")}},_noRecordsTipsPositon:function(){var b=this;var e=this.element.width(),a=this.gridRows.height(),d=$("#noRecordsTips_"+$.grid.coralID(b.options.id)).width(),c=$("#noRecordsTips_"+$.grid.coralID(b.options.id)).height();
$("#noRecordsTips_"+$.grid.coralID(b.options.id)).css({"margin-top":(a-c)/2+"px","margin-left":e/2+"px"})},_setColWidth:function(){var h=this;var a=this.grid;var d=0,e=$.support.boxSizing?0:this._intNum(this.options.cellLayout,0),j=0,c,f=this._intNum(this.options.scrollOffset,0),g,k=false,b,m=0,l=0,i;$.each(this.options.colModel,function(){if(h.options.grouping&&h.options.autowidth){var n=$.inArray(this.name,h.options.groupingView.groupField);if(n>=0&&h.options.groupingView.groupColumnShow.length>n){this.hidden=!h.options.groupingView.groupColumnShow[n]}}this.widthOrg=g=h._intNum(this.width,0);if((this.hidden===false||typeof(this.hidden)=="undefined")){d+=g+e;if(this.fixed){m+=g+e}else{j++}l++}});if(isNaN(h.options.width)){h.options.width=a.width=d}else{a.width=h.options.width}h.options.tblwidth=d;if(h.options.shrinkToFit===false&&h.options.forceFit===true){h.options.forceFit=false}if(h.options.shrinkToFit===true&&j>0){b=a.width-e*j-m;if(!isNaN(this.options.height)){b-=f;k=true}d=0;$.each(h.options.colModel,function(n){if((this.hidden===false||typeof(this.hidden)=="undefined")&&!this.fixed){g=Math.round(b*this.width/(h.options.tblwidth-e*j-m));this.width=g;d+=g;c=n}});i=0;if(k){if(a.width-m-(d+e*j)!==f){i=a.width-m-(d+e*j)-f}}else{if(!k&&Math.abs(a.width-m-(d+e*j))!==1){i=a.width-m-(d+e*j)-1}}h.options.colModel[c].width+=i;h.options.tblwidth=d+i+e*j+m;if(h.options.tblwidth>h.options.width){h.options.colModel[c].width-=(h.options.tblwidth-parseInt(h.options.width,10));h.options.tblwidth=h.options.width}h.options.tblwidth}},_nextVisible:function(c){var b=c,a=c,d;for(d=c+1;d<this.options.colModel.length;d++){if(this.options.colModel[d].hidden!==true){a=d;break}}return a-b},_formatCol:function(e,l,p,q,i,f){var g=this;if(g.options.model=="card"){return""}var a=g.grid;var h=g.options.colModel[e],k=h.align,j='style="',b=h.cls,c=h.name,r,o=[],d="";if(k){j+="text-align:"+k+";"}if(h.hidden===true){j+="display:none;"}var m=$.coral.toFunction(h.cellattr);if(l===0){j+="width: "+a.headers[e].width+"px;"
}else{if($.isFunction(m)){r=m.apply(g.element[0],[{rowId:i,value:p,rawObject:q,colModel:h,rowData:f}]);if(r&&typeof(r)==="string"){r=r.replace(/style/i,"style").replace(/title/i,"title");if(r.indexOf("title")>-1){h.title=false}if(r.indexOf("class")>-1){b=undefined}o=r.split("style");if(o.length===2){o[1]=$.trim(o[1].replace("=",""));if(o[1].indexOf("'")===0||o[1].indexOf('"')===0){o[1]=o[1].substring(1)}j+=o[1].replace(/'/gi,'"')}else{j+='"'}}}}if(q){var n=q[c]||"";n=$.grid.htmlEncode(n);d+="data-org='"+n+"'"}if(!o.length){o[0]="";j+='"'}j+=(b!==undefined?(' class="'+b+'"'):"")+((h.title&&p)?(' title="'+$.grid.stripHtml(p)+'"'):"");j+=' aria-describedby="'+g.options.id+"_"+c+'"';return j+o[0]+d},findTextByValue:function(d,c){var b=c.colModel.editoptions.data;if(!b){return d}for(var a=0;a<b.length;a++){if(b[a].text==d){return b[a].value}else{}}return d},_cellVal:function(a){return a===undefined||a===null||a===""?"&#160;":(this.options.autoencode?$.grid.htmlEncode(a):a+"")},_addCell:function(f,a,h,d,c,g){if(this.options.model=="card"){var b,e;b=this._formatter(f,a,h,c,"add");e=this._formatCol(h,d,b,c,f,g);return'<div role="gridcell" '+e+">"+b+"</div>"}var b,e;b=this._formatter(f,a,h,c,"add");e=this._formatCol(h,d,b,c,f,g);return'<td role="gridcell" '+e+">"+b+"</td>"},_orderedCols:function(c){var b=this;var a=b.options.remapColumns;if(!a||!a.length){a=$.map(b.options.colModel,function(d,e){return e})}if(c){a=$.map(a,function(d){return d<c?null:d-c})}return a},emptyRows:function(d,a,f){var e=this,b=!!(e.options.model=="card");if(b){$("#"+$.grid.coralID(e.options.id)+" .coral-pic").children().remove()}else{if(e.options.deepempty){$("#"+$.grid.coralID(e.options.id)+" tbody:first tr:gt(0)").remove()}else{var c=$("#"+$.grid.coralID(e.options.id)+" tbody:first tr:first")[0];$("#"+$.grid.coralID(e.options.id)+" tbody:first").empty().append(c)}if(a&&e.options.scroll){$(">div:first",d).css({height:"auto"}).children("div:first").css({height:0,display:"none"});d.scrollTop=0}if(f===true){if(e.options.treeGrid===true){e.options.data=[];
e.options._index={}}}}},normalizeData:function(){var k=this.options,w=k.data,d=w.length,q,o,a,r,m,s,f,l,n=k.localReader,e=k.colModel,g=n.cell,u=(k.multiselect===true?1:0)+(k.subGrid===true?1:0)+(k.rownumbers===true?1:0),t=k.scroll?$.jgrid.randId():1,b,c,h;if(k.datatype!=="local"||n.repeatitems!==true){return}b=this._orderedCols(u);c=this._reader("local");r=k.keyName===false?($.isFunction(n.id)?n.id.call(ts,w):n.id):k.keyName;for(q=0;q<d;q++){a=w[q];m=$.grid.getAccessor(a,r);if(m===undefined){if(typeof r==="number"&&e[r+u]!=null){m=$.grid.getAccessor(a,e[r+u].name)}if(m===undefined){m=t+q;if(g){s=$.grid.getAccessor(a,g)||a;m=s!=null&&s[r]!==undefined?s[r]:m;s=null}}}l={};l[n.id]=m;if(g){a=$.grid.getAccessor(a,g)||a}h=$.isArray(a)?b:c;for(o=0;o<h.length;o++){f=$.grid.getAccessor(a,h[o]);l[e[o+u].name]=f}$.extend(true,w[q],l)}},refreshIndex:function(){var c=this;var e=c.options.data.length,b,a,d;if(c.options.keyName===false||c.options.loadonce===true){b=c.options.localReader.id}else{b=c.options.keyName}for(a=0;a<e;a++){d=$.grid.getAccessor(c.options.data[a],b);c.options._index[d]=a}},constructPanel:function(b,f,h,j,i){var e="-1",d="",g,a=f?"display:none;":"",c="gridPanel coral-row-"+this.options.direction+h;return'<li role="row" id="'+b+'" tabindex="'+e+'" class="'+c+'"'+(a===""?"":' style="'+a+'"')+d+">"},constructTr:function(d,i,m,o,n,g){var h="-1",f="",l,b=i?"display:none;":"",a,e="coral-component-content jqgrow coral-row-"+this.options.direction+m+(g?" coral-state-highlight":"");if(this.options.treeGrid){var k=this.options.treeReader.parent_id_field;if(n[k]!==null&&String(n[k]).toLowerCase()!="null"){e+=" treeGridRow "}}var j=$.coral.toFunction(this.options.rowattr);a=$.isFunction(j)?j.apply(this.element[0],[{rowId:d,rowData:o,currentObj:n}]):{};if(!$.isEmptyObject(a)){if(a.hasOwnProperty("id")){d=a.id;delete a.id}if(a.hasOwnProperty("tabindex")){h=a.tabindex;delete a.tabindex}if(a.hasOwnProperty("style")){b+=a.style;delete a.style}if(a.hasOwnProperty("class")){e+=" "+a["class"];
delete a["class"]}try{delete a.role}catch(c){}for(l in a){if(a.hasOwnProperty(l)){f+=" "+l+"="+a[l]}}}return'<tr role="row" id="'+d+'" tabindex="'+h+'" class="'+e+'"'+(b===""?"":' style="'+b+'"')+f+">"},_clearVals:function(b){var c=this,a;a=c._trigger("onPaging",null,[{pgButton:b}]);if(!a){return false}c.options.selrow=null;c.options.editrow=null;if(c.options.multiselect){c.options.selarrrow=[];c._setHeadCheckBox(false)}c.options.savedRow=[];return true},_getPagination:function(){},_setPager:function(z,J){var y=this,b="<span class='paginator-left'>{viewrecords}</span><span class='paginator-center'>{prev}{links}{next}{pginput}{navbar}{description}</span><span class='paginator-right'><em>每页</em>{rninput}<em>条</em></span>",a="<div class='paginator-left'>{viewrecords}{rowlist}{first}{prev}{pginput}{next}{last}{navbar}{description}</div><div class='toolbarpanel'>{toolbar}</div>";J+="_"+z;var F=false;if($.isFunction(y.options.pagerTemplate)){F=y.options.pagerTemplate.call(y)}var G=this.options.direction;var g=["first"+J,"prev"+J,"next"+J,"last"+J];if(G=="rtl"){g.reverse()}var l="",u="",d="",n="",q="",B="",m="",e="",x="<span class='coral-paginator-pages'></span>",p="<em>第</em><input type='text' class='coral-pg-input'/><em>页</em>",H="<button class='reload-button' id='_reloadGrid' type='button' data-options='customData:{gridId:\""+y.options.id+'"},label:"刷新",text: false,icons: "cui-icon-loop3",onClick: function( e, ui ){$( "#'+y.options.id+'" ).grid( "reload" );}\'>reload</button>',f="<span id='"+g[0]+"' class='coral-paginator-first coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-first2' title='第一页'></span></span>",k="<span id='"+g[3]+"' class='coral-paginator-last coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-last2' title='最后一页'></span></span>",c="<span id='"+g[2]+"' class='coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3' title='下一页'></span></span>",s="<span id='"+g[1]+"' class='coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3' title='前一页'></span></span>",r="<span>|</span>",o="<span class='pager-navbar'></span>",j="<span class='pager-toolbar'></span>",h="<span class='pager-description'></span>",t,K,A,I,w,v,C;
t="pg_"+z;K=z+"_left";A=z+"_center";I=z+"_right";d+="<input type='text' class='coral-rn-input' val=''/>";if(!y.options.rninput){}else{if(y.options.rowList.length>0){}}n+="<span class='coral-paginator-combobox'><select class='coral-pg-selbox' role='listbox'>";for(C=0;C<y.options.rowList.length;C++){n+='<option role="option" value="'+y.options.rowList[C]+'"'+((y.options.rowNum==y.options.rowList[C])?' selected="selected"':"")+">"+y.options.rowList[C]+"</option>"}n+="</select></span>";if(y.options.viewrecords){q+="<span class='coral-paging-info'></span>";B+="<span class='coral-paging-totalpage'></span>"}if(y.options.pginput===true){l="<td dir='"+G+"'>"+$.grid.format(y.options.pgtext||"","<input class='coral-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.grid.coralID(z)+"'></span>")+"</td>"}if(y.options.pagerStyle=="flex"){if(F){b=F}e="<span id='"+g[1]+"' class='coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3'>p</span></span><span class='coral-paginator-pages'></span><span id='"+g[2]+"' class='coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3'>p</span></span><em>第</em><input type='text' class='coral-pg-input'/><em>页</em>";m=b.replace(/\{viewrecords\}/g,q).replace(/\{navbar\}/g,o).replace(/\{reload\}/g,H).replace(/\{-\}/g,r).replace(/\{first\}/g,f).replace(/\{last\}/g,k).replace(/\{next\}/g,c).replace(/\{totalPage\}/g,B).replace(/\{prev\}/g,s).replace(/\{links\}/g,x).replace(/\{pginput\}/g,p).replace(/\{toolbar\}/g,j).replace(/\{description\}/g,h).replace(/\{rowlist\}/g,n).replace(/\{rninput\}/g,d);$("#"+$.grid.coralID(z)).addClass("coral-pager-flex");$("#"+$.grid.coralID(z)).append("<div id='"+t+"' class='coral-paginator' role='group'>"+m+"</div>");y._bindpager(z,J)}else{if(y.options.pagerStyle=="tradition"){if(F){a=F}e="<span id='"+g[0]+"' class='coral-paginator-first coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-first2'></span></span><span id='"+g[1]+"' class='coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3'></span></span><em>第</em><input type='text' class='coral-pg-input'/><em>页</em><span id='"+g[2]+"' class='coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3'></span></span><span id='"+g[3]+"' class='coral-paginator-last coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-last2'></span></span>";
m=a.replace(/\{viewrecords\}/g,q).replace(/\{navbar\}/g,o).replace(/\{reload\}/g,H).replace(/\{-\}/g,r).replace(/\{first\}/g,f).replace(/\{last\}/g,k).replace(/\{next\}/g,c).replace(/\{prev\}/g,s).replace(/\{links\}/g,x).replace(/\{totalPage\}/g,B).replace(/\{pginput\}/g,p).replace(/\{toolbar\}/g,j).replace(/\{description\}/g,h).replace(/\{rowlist\}/g,n).replace(/\{rninput\}/g,d);$("#"+$.grid.coralID(z)).addClass("coral-pager-tradition");$("#"+$.grid.coralID(z)).append("<div id='"+t+"' class='coral-paginator' role='group'>"+m+"</div>");y._bindpagerTradition(z,J)}else{}}var D=$.parser.parseOptions($("#"+$.grid.coralID(z))[0],null);y.options.toolbarOptions=D.toolbarOptions;y.options.description=D.description;var E=y.options.navbarOptions||{};D.toolbarOptions=D.toolbarOptions||{};$(".reload-button",y.element).button();if($(".pager-toolbar",y.element).length){$(".pager-toolbar",y.element).toolbar(D.toolbarOptions)}if(y.options.description){$(".pager-description",y.element).html(y.options.description)}},_bindpagerTradition:function(c,b){var a=this;$("input.coral-pg-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"pg",onKeyPress:function(i,g){var d=i.charCode?i.charCode:i.keyCode?i.keyCode:0;if(d==13){var f=a._intNum(a.options.lastpage,1);var h=a._intNum(g.text,1);if(h>f){a.options.page=f;$(this).textbox("setValue",a.options.page)}else{a.options.page=(g.text>0)?g.text:a.options.page}if(!a._clearVals("user")){return false}a._populate();return false}return this},onBlur:function(){var d=a._intNum(a.options.lastpage,1);var e=$(this).textbox("getValue");if(e!==a.options.page){$(this).textbox("setValue",a.options.page)}}});$("input.coral-rn-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"rn",onKeyPress:function(g,f){var d=g.charCode?g.charCode:g.keyCode?g.keyCode:0;if(d==13){a.options.rowNum=(f.text>0)?(f.text<a.options.rowNumMax?f.text:a.options.rowNumMax):a.options.rowNum;if(!a._clearVals("records")){return false}a._populate();return false}return this}});$(".coral-pg-selbox",$("#"+$.grid.coralID(c))).combobox({componentCls:"rn",panelHeight:"auto",onChange:function(d,e){a.options.page=Math.round(a.options.rowNum*(a.options.page-1)/e.value-0.5)+1;
a.options.rowNum=e.value;if(!a._clearVals("records")){return false}a._populate();return false}});$("#first"+$.grid.coralID(b)+", #prev"+$.grid.coralID(b)+", #next"+$.grid.coralID(b)+", #last"+$.grid.coralID(b)).click(function(){var i=a._intNum(a.options.page,1),g=a._intNum(a.options.lastpage,1),j=false,e=true,d=true,h=true,f=true;if(g===0||g===1){e=false;d=false;h=false;f=false}else{if(g>1&&i>=1){if(i===1){e=false;d=false}else{if(i===g){h=false;f=false}}}else{if(g>1&&i===0){h=false;f=false;i=g-1}}}if(this.id==="first"+b&&e){a.options.page=1;j=true}if(this.id==="prev"+b&&d){a.options.page=(i-1);j=true}if(this.id==="next"+b&&h){a.options.page=(i+1);j=true}if(this.id==="last"+b&&f){a.options.page=g;j=true}if(j){if(!a._clearVals(this.id)){return false}a._populate()}return false})},_bindpager:function(c,b){var a=this;$("input.coral-pg-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"pg",onKeyPress:function(i,g){var d=i.charCode?i.charCode:i.keyCode?i.keyCode:0;if(d==13){var f=a._intNum(a.options.lastpage,1);var h=a._intNum(g.text,1);if(h>f){a.options.page=f;$(this).textbox("setValue",a.options.page)}else{a.options.page=(g.text>0)?g.text:a.options.page}if(!a._clearVals("user")){return false}a._populate();return false}return this},onBlur:function(){var d=a._intNum(a.options.lastpage,1);var e=$(this).textbox("getValue");if(e!==a.options.page){$(this).textbox("setValue",a.options.page)}}});$("input.coral-rn-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"rn",onKeyPress:function(g,f){var d=g.charCode?g.charCode:g.keyCode?g.keyCode:0;if(d==13){a.options.rowNum=(f.text>0)?(f.text<a.options.rowNumMax?f.text:a.options.rowNumMax):a.options.rowNum;if(!a._clearVals("records")){return false}a._populate();return false}return this}});$(".coral-pg-selbox",$("#"+$.grid.coralID(c))).combobox({componentCls:"rn",panelHeight:"auto",onChange:function(d,e){a.options.page=Math.round(a.options.rowNum*(a.options.page-1)/e.newValue-0.5)+1;a.options.rowNum=e.newValue;if(!a._clearVals("records")){return false
}a._populate();return false}});$(".coral-textbox-btn-ico-search",$("#"+$.grid.coralID(c))).click(function(d){a.options.page=($(this).prev().val()>0)?$(this).prev().val():a.options.page;if(!a._clearVals("user")){return false}a._populate();return false});this._off($(".coral-paginator-page"));this._on({"click.coral-paginator-page":function(d){var f=d.target;if($(f).hasClass("coral-state-disabled")){f.style.cursor="default"}else{$(f).addClass("coral-state-hover");f.style.cursor="pointer"}}});this._on({"mouseenter.coral-paginator-page":function(d){var f=d.target;if($(f).hasClass("coral-state-disabled")){f.style.cursor="default"}else{$(f).addClass("coral-state-hover");f.style.cursor="pointer"}},"mouseleave.coral-paginator-page":function(d){var f=d.target;if(!$(f).hasClass("coral-state-disabled")){$(f).removeClass("coral-state-hover");f.style.cursor="default"}}});$("#first"+$.grid.coralID(b)+", #prev"+$.grid.coralID(b)+", #next"+$.grid.coralID(b)+", #last"+$.grid.coralID(b)).click(function(){var i=a._intNum(a.options.page,1),g=a._intNum(a.options.lastpage,1),j=false,e=true,d=true,h=true,f=true;if(g===0||g===1){e=false;d=false;h=false;f=false}else{if(g>1&&i>=1){if(i===1){e=false;d=false}else{if(i===g){h=false;f=false}}}else{if(g>1&&i===0){h=false;f=false;i=g-1}}}if(this.id==="first"+b&&e){a.options.page=1;j=true}if(this.id==="prev"+b&&d){a.options.page=(i-1);j=true}if(this.id==="next"+b&&h){a.options.page=(i+1);j=true}if(this.id==="last"+b&&f){a.options.page=g;j=true}if(j){if(!a._clearVals(this.id)){return false}a._populate()}return false})},_updatepager:function(j,q){var g=this;var f,h,e,s,d,k,c,r="",a,t,b,v=g.options.pager?"_"+$.grid.coralID(g.options.pager.substr(1)):"",u=g.options.toppager?"_"+g.options.toppager.substr(1):"";e=parseInt(g.options.page,10)-1;if(e<0){e=0}e=e*parseInt(g.options.rowNum,10);d=e+g.options.reccount;if(g.options.scroll){var i=$("tbody:first > tr:gt(0)",g.grid.rowsView);e=d-i.length;g.options.reccount=i.length;var n=i.outerHeight()||g.grid.prevRowHeight;
if(n){var l=e*n;var m=parseInt(g.options.records,10)*n;$(">div:first",g.grid.rowsView).css({height:m}).children("div:first").css({height:l,display:l?"":"none"})}g.grid.rowsView.scrollLeft=g.grid.columnsView.scrollLeft}if(g.options.treeGrid){var i=$("tbody:first > tr:not(.treeGridRow,.jqgfirstrow)",g.grid.rowsView);g.options.reccount=i.length;d=e+g.options.reccount}r=$(g.element).find(".coral-grid-pager");if(r.length>0){c=$.grid.formatter.integer||{};f=g._intNum(g.options.page);h=g._intNum(g.options.lastpage);$(".selbox",r)[this.options.useProp?"prop":"attr"]("disabled",false);if($(".coral-pg-input",r).length>0){$(".coral-pg-input",r).val(g.options.page);a=g.options.toppager?"#sp_1"+v+",#sp_1"+u:"#sp_1"+v;$(a).html($.fmatter?$.fmatter.util.NumberFormat(g.options.lastpage,c):g.options.lastpage)}if(g.options.rninput===true){$(".coral-rn-input",r).val(g.options.rowNum)}if(g.options.viewrecords){if(g.options.reccount===0){$(".coral-paging-info",r).html("");$(".coral-paging-totalpage",r).html("")}else{s=e+1;k=g.options.records;t=g.options.reccount;if(k%t==0){b=parseInt(k/t)}else{b=parseInt(k/t)+1}if($.fmatter){s=$.fmatter.util.NumberFormat(s,c);d=$.fmatter.util.NumberFormat(d,c);k=$.fmatter.util.NumberFormat(k,c);t=$.fmatter.util.NumberFormat(t,c);b=$.fmatter.util.NumberFormat(b,c)}$(".coral-paging-info",r).html($.grid.format(g.options.recordtext,s,d,k));$(".coral-paging-totalpage",r).html($.grid.format(g.options.pagetext,b))}}if(g.options.pgbuttons===true){var o=[],p=[];g.pagers.each(function(){o.push("#first_"+this.id);o.push("#prev_"+this.id);p.push("#next_"+this.id);p.push("#last_"+this.id)});if(f<=0){f=h=0}if(f==1||f===0){$(o.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover");if(g.options.toppager){$("#first_t"+u+", #prev_t"+u).addClass("coral-state-disabled").removeClass("coral-state-hover")}}else{$(o.join(",")).removeClass("coral-state-disabled");if(g.options.toppager){$("#first_t"+u+", #prev_t"+u).removeClass("coral-state-disabled")}}if(f==h||f===0){$(p.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover");
if(g.options.toppager){$("#next_t"+u+", #last_t"+u).addClass("coral-state-disabled").removeClass("coral-state-hover")}}else{$(p.join(",")).removeClass("coral-state-disabled");if(g.options.toppager){$("#next_t"+u+", #last_t"+u).removeClass("coral-state-disabled")}}if(0==h){$(p.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover")}}g._paginators()}if(j===true&&g.options.rownumbers===true){$("td.grid-rownum",g.rows).each(function(w){$(this).html(e+1+w)})}if(q&&g.options.jqgdnd){$(g.element).grid("gridDnD","updateDnD")}g._trigger("onComplete",null,[]);g._trigger("afterComplete",null,[])},_paginators:function(){var g=this;var h=g._intNum(g.options.page,1),j=g._intNum(g.options.lastpage,1),b=false;var a=3,c=h>2?h+2-a:1,e,d="";e=a+c>j?j+1:a+c;if(c>3&&e<=j+2){c=e-a}if(h>2&&j>a){if(c>=2){d+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>1</span>"}if(c>=3){d+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>2</span>"}if(c!=3&&c!=1&&c!=2){d+="<span class='coral-page-pointer'>...</span>"}}for(var f=c;f<e;f++){if(h==f){d+="<span class='coral-paginator-page coral-state-default coral-state-active coral-corner-all'  tabindex='0'>"+f+"</span>"}else{d+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>"+f+"</span>"}}if(e==j){d+="<span class='coral-paginator-page coral-state-default coral-corner-all'>"+j+"</span>"}else{if(e<=j){d+="<span class='coral-page-pointer'>...</span><span class='coral-paginator-page coral-state-default coral-corner-all'>"+j+"</span>"}}$(".coral-paginator-pages",g.element).html(d)},_populate:function(c){var g=this,p=!!(g.options.model=="card");var a=g.grid;if(true){var d=g.options.scroll&&c===false,i={},m,l,j=g.options.prmNames;if(g.options.page<=0){g.options.page=1}if(j.search!==null){i[j.search]=g.options.search}if(j.nd!==null){i[j.nd]=new Date().getTime()}if(j.rows!==null){i[j.rows]=g.options.rowNum}if(j.page!==null){i[j.page]=g.options.page
}if(j.sort!==null){i[j.sort]=g.options.sortname}if(j.order!==null){i[j.order]=g.options.sortorder}if(g.options.rowTotal!==null&&j.totalrows!==null){i[j.totalrows]=g.options.rowTotal}var o=function(t){g._trigger("onLoad",null,[t]);if(g.options.afterSortableRows&&$.fn.sortable){try{$(g.element).grid("sortableRows")}catch(u){}}};var q=0;c=c||1;if(c>1){if(j.npage!==null){i[j.npage]=c;q=c-1;c=1}else{o=function(t){g.options.page++;a.columnsView.loading=false;g._trigger("onLoad",null,[t]);g._populate(c-1)}}}else{if(j.npage!==null){delete g.options.postData[j.npage]}}if(g.options.grouping){this.groupingSetup();var h=g.options.groupingView,s,n="";for(s=0;s<h.groupField.length;s++){var e=h.groupField[s];$.each(g.options.colModel,function(t,u){if(u.name===e&&u.index){e=u.index}});n+=e+" "+h.groupOrder[s]+", "}i[j.sort]=n+i[j.sort]}if(g.options.containSortOrder&&i[j.sort]&&i[j.order]){i[j.sort]=i[j.sort]+g.options.sortSeparator+i[j.order]}$.extend(g.options.postData,i);var r=!g.options.scroll?1:g.rows.length-1;var k=g._trigger("beforeRequest",null,[]);if(k===false||k==="stop"){return}if($.isFunction(g.options.datatype)){g.options.datatype.call(g,g.options.postData,"load_"+g.options.id);return}m=g.options.datatype.toLowerCase();if(!(g.options.b_sortdata&&g.options.b_sortdata===true)&&g.options.orgdatatype){m=g.options.orgdatatype;g.options.datatype=m}if(g.options.localonce){m="local"}if(g.options.initData){m="initinlocal"}var f=function(w,u,x){if(g.options.loadonce){g.options.orgdatatype=m}if(!g._trigger("beforeProcessing",null,[{content:w,state:u,xhr:x}])){g._endReq();return}else{g._addJSONData(w,a.rowsView,r,c>1,q)}if(!p){g._hasScrollOffset()}if(o){o.call(g,w)}g._trigger("afterLoad",null,[{content:w}]);if(d){a.populateVisible()}if(g.options.loadonce||g.options.treeGrid){g.options.datatype="local";g.options.orgpage=g.options.page}if(c===1){g._endReq()}var v,t;if(g.options.orgdatatype=="local"){v=g.options.localReader}else{v=g.options.jsonReader}t=$.grid.getAccessor(w,v.root);if(t.length==0&&parseInt(g.options.page)!=1&&parseInt(g.options.lastpage)<parseInt(g.options.page)){$(g.element).grid("reload",{page:g.options.lastpage})
}w=null;g.refresh()};switch(m){case"initinlocal":m="json";f(g.options.initData,null,null);this.options.initData=false;break;case"json":case"jsonp":if(this.xhr){this.xhr.abort()}this.xhr=$.ajax(this._ajaxSettings());this.xhr.success(function(u,t,v){f(u,t,v)}).error(function(v,t,u){g._trigger("onLoadError",null,[{xhr:v,st:t,err:u}]);if(c===1){g._endReq()}v=null;g.refresh()}).complete(function(u,t){if(u===g.xhr){g.xhr=null}});break;case"local":case"clientside":g._beginReq();g.options.datatype="local";var b=g._addLocalData();this._addJSONData(b,a.rowsView,r,c>1,q);if(!g.options.b_sortdata){g.refresh();if(o){o.call(g,b)}g._trigger("AfterLoad",null,[b]);if(d){a.populateVisible()}}g._endReq();if(g.options.frozenColumns){g._setFrozenHeight()}break}}},_setFrozenHeight:function(){var b=this,e="",d=0,a=0,c=0;if(this.grid.fhDiv){d=this.grid.fhDiv.height();this.grid.fbDiv.css("top",d);$("tr",b.grid.fbDiv).slice(1).each(function(){e=$(this).attr("id");a=parseFloat($("td:first",this).height());c=parseFloat($("#"+e,b.gridRows).find("td:first").height());if(a<c){$("td",this).each(function(){$(this).height(c)})}else{if(a>c){$("td",$("#"+e,b.gridRows)).each(function(){$(this).height(a)})}}})}if(this.grid.rightfhDiv){d=this.grid.rightfhDiv.height();this.grid.rightfbDiv.css("top",d);$("tr",b.grid.rightfbDiv).slice(1).each(function(){e=$(this).attr("id");a=parseFloat($("td:first",this).height());c=parseFloat($("#"+e,b.gridRows).find("td:first").height());if(a<c){$("td",this).each(function(){$(this).height(c)})}else{if(a>c){$("td",$("#"+e,b.gridRows)).each(function(){$(this).height(a)})}}})}},_ajaxSettings:function(){var b=this,a=this.options;return $.extend({url:a.url,type:a.asyncType,beforeSend:function(e,d){var c=true;c=b._trigger("beforeSend",null,{xhr:e,settings:d});if(c===undefined){c=true}if(c===false){return false}else{b._beginReq()}},data:$.isFunction(a.serializeGridData)?a.serializeGridData.call(this,a.postData):a.postData,dataType:"json"},$.grid.ajaxOptions,a.ajaxGridOptions)},_reader:function(c){var d=this;
var g,e=[],a=0,b;for(b=0;b<this.options.colModel.length;b++){g=this.options.colModel[b];if(g.name!=="cb"&&g.name!=="subgrid"&&g.name!=="rn"){e[a]=c=="local"?g.name:((c=="xml"||c==="xmlstring")?g.xmlmap||g.name:g.jsonmap||g.name);if(d.options.keyName!==false&&g.key===true){d.options.keyName=e[a]}a++}}return e},_addMulti:function(f,h,c,e){var d=this,a=!!(d.options.model=="card"),b='<input role="checkbox" type="checkbox" id="jqg_'+d.options.id+"_"+f+'" class="cbox" name="jqg_'+d.options.id+"_"+f+'"'+(e?'checked="checked"':"")+"/>",g=d._formatCol(h,c,"",null,f,true);if(a){return b}return'<td role="gridcell" '+g+">"+b+"</td>"},_addSingle:function(e,g,c){var d=this,a=!!(d.options.model=="card"),b='<input role="radio" type="radio" id="jqg_'+d.options.id+"_"+e+'" class="cbox" name="jqg_'+d.options.id+'"/>',f=d._formatCol(g,c,"",null,e,true);if(a){return b}return'<td role="gridcell" '+f+">"+b+"</td>"},_addRowNum:function(f,b,e,c){var a=(parseInt(e,10)-1)*parseInt(c,10)+1+b,d=this._formatCol(f,b,a,null,b,true);return'<td role="gridcell" class="coral-state-default grid-rownum" '+d+">"+a+"</td>"},_customPanel:function(l,c,b){var f=this,k={},d="",e="",j="",g="";var h=$.coral.toFunction(f.options.picTemplate);if($.isFunction(h)){k=h.apply(f.element[0],[{rowData:l,ni:c,muti:b,getData:true}])}if(typeof(k)=="undefined"){return""}var a=k.src;if(!a){a="src"}d=k.coreData||(l.src?"<img src='"+l.src+"'/>":"");e=k.itemData||"";j=k.toolbarsData||"";g=k.buttonsData||"";var i=[];i.push("<ul class='rowgrid coral-component-content coral-corner-all'>");if(d.length>0){i.push("<li class='gridModel1 gridModel'>");i.push(d);i.push("<div class='valigh-fix'></div>");if(j.length>0){i.push("<div class='gridtoolbars'><div class='bgopacity'>&#160;</div>"+j+"</div>")}i.push("</li>")}if(e.length>0){i.push("<li class='gridModel2 gridModel'>");i.push("<div class='griditem'>"+e+"</div>");i.push("</li>")}if(k.muti&&b.length>0||g.length>0){i.push("<li class='gridModel3 gridModel'>");if(e.length>0||g.length>0){i.push("<ul class='griditem'>");
if(b.length>0&&k.muti){i.push("<li class='gridCheckbox'>"+b+"</li>")}if(g.length>0){i.push("<li class='gridbuttons'>"+g+"</li>")}i.push("</ul>")}i.push("</li>")}i.push("</ul>");return i.join("")},_addJSONData:function(ab,O,n,J,W){var L=this,Q=!!(L.options.model=="card");var g=new Date();if(ab){if(L.options.treeANode===-1&&!L.options.scroll){L.emptyRows(O,false,true);n=1}else{n=n>1?n:1}}else{return}var b,o="_id_",Z,z=(L.options.datatype!="local"&&L.options.loadonce)||L.options.datatype=="jsonstring";if(z){L.options.data=[];L.options._index={};L.options.localReader.id=o}L.options.reccount=0;if(L.options.datatype=="local"){b=L.options.localReader;Z="local"}else{b=L.options.jsonReader;Z="json"}var m=this,D=0,N,V,U,X=[],q,k,s=L.options.multiselect?1:0,u=L.options.subGrid?1:0,ae=L.options.rownumbers===true?1:0,w,E,c,M={},A,a,R=[],y=[],ac=[],C=(L.options.altRows===true)?" "+L.options.altclass:"",h,H;if(s==0){s=L.options.singleselect?1:0}L.options.page=$.grid.getAccessor(ab,b.page)||0;H=$.grid.getAccessor(ab,b.total);L.options.lastpage=H===undefined?1:H;L.options.records=$.grid.getAccessor(ab,b.records)||0;L.options.total=$.grid.getAccessor(ab,b.total)||0;L.options.userData=$.grid.getAccessor(ab,b.userData)||{};if(!b.repeatitems){q=X=L._reader(Z)}if(L.options.keyName===false){c=$.isFunction(b.id)?b.id.call(L,ab):b.id}else{c=L.options.keyName}if(X.length>0&&!isNaN(c)){if(L.options.remapColumns&&L.options.remapColumns.length){c=$.inArray(c,L.options.remapColumns)}c=X[c]}E=$.grid.getAccessor(ab,b.root);if(!E){E=[]}w=E.length;V=0;if(w>0&&L.options.page<=0){L.options.page=1}var K=parseInt(L.options.rowNum,10),S=L.options.scroll?$.grid.randId():1,p,G=false,d;if(W){K*=W+1}if(L.options.datatype==="local"&&!L.options.deselectAfterSort){G=true}var aa=$.isFunction(L.options.afterInsertRow),x=[],T=false,B;if(L.options.grouping){T=L.options.groupingView.groupCollapse===true;B=this.groupingPrepare}while(V<w){k=E[V];a=$.grid.getAccessor(k,c);if(a===undefined){a=S+V;if(X.length===0){if(b.cell){var P=$.grid.getAccessor(k,b.cell);
a=P!==undefined?P[c]||a:a;P=null}}}a=L.options.idPrefix+a;p=n===1?0:n;h=(p+V)%2==1?C:"";if(G){if(L.options.multiselect){d=($.inArray(a,L.options.selarrrow)!==-1)}else{d=(a===L.options.selrow)}}var I=R.length;var l=y.length;R.push("");if(ae){R.push(L._addRowNum(0,V,L.options.page,L.options.rowNum))}if(s){if(L.options.singleselect){R.push(L._addSingle(a,ae,V,d));ac.push(L._addSingle(a,ae,V,d))}else{R.push(L._addMulti(a,ae,V,d));ac.push(L._addMulti(a,ae,V,d))}}if(u){R.push($(L.element).grid("addSubGridCell",s+ae,V+n))}if(b.repeatitems){if(b.cell){k=$.grid.getAccessor(k,b.cell)}if(!q){q=this._orderedCols(s+u+ae)}}for(U=0;U<q.length;U++){N=$.grid.getAccessor(k,q[U]);M[L.options.colModel[U+s+u+ae].name]=N;R.push(this._addCell(a,N,U+s+u+ae,V+n,k,M))}if(L.options.model=="card"){y[I]=L.constructPanel(a,T,h,M,k);y.push(L._customPanel(M,ae,ac));y.push("</li>")}else{R[I]=L.constructTr(a,T,h,M,k,d);R.push("</tr>")}if(L.options.grouping){x.push(R);if(!L.options.groupingView._locgr){B.call(m,M,V)}R=[]}if(z||L.options.treeGrid===true){M[o]=a;L.options.data.push(M);L.options._index[a]=L.options.data.length-1}if(L.options.gridview===false){if(Q){$("#"+$.grid.coralID(L.options.id)+" .coral-pic").append(y.join(""))}else{$("#"+$.grid.coralID(L.options.id)+" .coral-grid-btable tbody:first").append(R.join(""))}$(L).triggerHandler("gridAfterInsertRow",[a,M,k]);if(aa){L.options.afterInsertRow.call(L,a,M,k)}R=[];y=[];ac=[]}$.fn.afterFmatter.call(L);M={};D++;V++;if(D==K){break}}if(L.options.gridview===true){A=L.options.treeANode>-1?L.options.treeANode:0;if(L.options.grouping){if(!z){this.groupingRender(x,L.options.colModel.length,L.options.page,K);x=null}}else{if(L.options.treeGrid===true&&A>0){$(L.rows[A]).after(R.join(""))}else{$("#"+$.grid.coralID(L.options.id)+" tbody:first").append(R.join(""))}}}if(L.options.subGrid===true){try{$(L.element).grid("addSubGrid",s+ae)}catch(ad){}}L.options.totaltime=new Date()-g;if(D>0){if(L.options.records===0){L.options.records=w}}R=null;if(L.options.treeGrid===true){try{$(L.element).grid("setTreeNode",A+1,D+A+1)
}catch(Y){}}if(!L.options.treeGrid&&!L.options.scroll&&!Q){L.grid.rowsView.scrollTop=0}L.options.reccount=D;L.options.treeANode=-1;if(L.options.userDataOnFooter){$(L.element).grid("footerData",L.options.userData,true)}if(z&&!L.options.orgdatatype){L.options.records=w;L.options.lastpage=Math.ceil(w/K)}if(!J){L._updatepager(false,true)}if(z){while(D<w&&E[D]){k=E[D];a=$.grid.getAccessor(k,c);if(a===undefined){a=S+D;if(X.length===0){if(b.cell){var r=$.grid.getAccessor(k,b.cell);a=r[c]||a;r=null}}}if(k){a=L.options.idPrefix+a;if(b.repeatitems){if(b.cell){k=$.grid.getAccessor(k,b.cell)}if(!q){q=L._orderedCols(s+u+ae)}}for(U=0;U<q.length;U++){N=$.grid.getAccessor(k,q[U]);M[L.options.colModel[U+s+u+ae].name]=N}M[o]=a;if(L.options.grouping){B.call(m,M,D)}L.options.data.push(M);L.options._index[a]=L.options.data.length-1;M={}}D++}if(L.options.grouping){L.options.groupingView._locgr=true;this.groupingRender(x,L.options.colModel.length,L.options.page,K);x=null}}},_addLocalData:function(){var i=this;var r,m=false,v={},f=[],e=[],p,b,x;if(!$.isArray(i.options.data)){return}var l=i.options.grouping?i.options.groupingView:false,g,k;$.each(i.options.colModel,function(){b=this.sorttype||"text";if(b=="date"||b=="datetime"){if(this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"){if(this.formatoptions&&this.formatoptions.srcformat){p=this.formatoptions.srcformat}else{p=$.grid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){x=this.formatoptions.newformat}else{x=$.grid.formatter.date.newformat}}else{p=x=this.datefmt||"Y-m-d"}v[this.name]={stype:b,srcfmt:p,newfmt:x}}else{v[this.name]={stype:b,srcfmt:"",newfmt:""}}if(i.options.grouping){for(k=0,g=l.groupField.length;k<g;k++){if(this.name===l.groupField[k]){var j=this.name;if(this.index){j=this.index}f[k]=v[j];e[k]=j}}}if(!m&&(this.index==i.options.sortname||this.name==i.options.sortname)){r=this.name;m=true}});if(i.options.treeGrid){$(i.element).grid("sortTree",r,i.options.sortorder,v[r].stype,v[r].srcfmt);
return}var B={eq:function(j){return j.equals},ne:function(j){return j.notEquals},lt:function(j){return j.less},le:function(j){return j.lessOrEquals},gt:function(j){return j.greater},ge:function(j){return j.greaterOrEquals},cn:function(j){return j.contains},nc:function(j,D){return D==="OR"?j.orNot().contains:j.andNot().contains},bw:function(j){return j.startsWith},bn:function(j,D){return D==="OR"?j.orNot().startsWith:j.andNot().startsWith},en:function(j,D){return D==="OR"?j.orNot().endsWith:j.andNot().endsWith},ew:function(j){return j.endsWith},ni:function(j,D){return D==="OR"?j.orNot().equals:j.andNot().equals},"in":function(j){return j.equals},nu:function(j){return j.isNull},nn:function(j,D){return D==="OR"?j.orNot().isNull:j.andNot().isNull}},d=$.grid.from(i.options.data);if(i.options.ignoreCase){d=d.ignoreCase()}function y(J){var L=0,F,I,D,j,H;if(J.groups!==undefined){I=J.groups.length&&J.groupOp.toString().toUpperCase()==="OR";if(I){d.orBegin()}for(F=0;F<J.groups.length;F++){if(L>0&&I){d.or()}try{y(J.groups[F])}catch(G){alert(G)}L++}if(I){d.orEnd()}}if(J.rules!==undefined){if(L>0){var K=d.select();d=$.grid.from(K);if(i.options.ignoreCase){d=d.ignoreCase()}}try{D=J.rules.length&&J.groupOp.toString().toUpperCase()==="OR";if(D){d.orBegin()}for(F=0;F<J.rules.length;F++){H=J.rules[F];j=J.groupOp.toString().toUpperCase();if(B[H.op]&&H.field){if(L>0&&j&&j==="OR"){d=d.or()}d=B[H.op](d,j)(H.field,H.data,v[H.field])}L++}if(D){d.orEnd()}}catch(E){alert(E)}}}if(i.options.search===true){var n=i.options.postData.filters;if(n){if(typeof n=="string"){n=$.grid.parse(n)}y(n)}else{try{d=B[i.options.postData.searchOper](d)(i.options.postData.searchField,i.options.postData.searchString,v[i.options.postData.searchField])}catch(C){}}}if(i.options.grouping){for(k=0;k<g;k++){d.orderBy(e[k],l.groupOrder[k],f[k].stype,f[k].srcfmt)}}if(r&&i.options.sortorder&&m&&i.options.sortname){if(i.options.sortorder.toUpperCase()=="DESC"){d.orderBy(i.options.sortname,"d",v[r].stype,v[r].srcfmt)}else{d.orderBy(i.options.sortname,"a",v[r].stype,v[r].srcfmt)
}}var a=d.select(),w=i._trigger("afterFilter",null,[{queryResults:d.select(),getData:true}])["result"];if(w){a=w}var h=parseInt(i.options.rowNum,10),A=a.length,c=parseInt(i.options.page,10),s=Math.ceil(A/h),u={};if((i.options.search||i.options.resetsearch)&&i.options.grouping&&i.options.groupingView._locgr){i.options.groupingView.groups=[];var t,o=i.groupingPrepare,z,q;if(i.options.footerrow&&i.options.userDataOnFooter){for(z in i.options.userData){if(i.options.userData.hasOwnProperty(z)){i.options.userData[z]=0}}q=true}for(t=0;t<A;t++){if(q){for(z in i.options.userData){i.options.userData[z]+=parseFloat(a[t][z]||0)}}o.call($(this),a[t],t,h)}}a=a.slice((c-1)*h,c*h);d=null;v=null;if(i.options.orgdatatype){u[i.options.localReader.total]=i.options.lastpage;u[i.options.localReader.page]=i.options.orgpage;u[i.options.localReader.records]=i.options.records}else{u[i.options.localReader.total]=s;u[i.options.localReader.page]=c;u[i.options.localReader.records]=A}u[i.options.localReader.root]=a;u[i.options.localReader.userData]=i.options.userData;a=null;return u},getColProp:function(d){var a={},c=this;if(!c.grid){return false}var e=c.options.colModel;for(var b=0;b<e.length;b++){if(e[b].name==d){a=e[b];break}}return a},setColProp:function(c,b){if(this.grid){if(b){var d=this.options.colModel;for(var a=0;a<d.length;a++){if(d[a].name==c){$.extend(this.options.colModel[a],b);break}}}}},destroyGroupHeader:function(j){if(typeof(j)=="undefined"){j=true}var k=this,h,f,d,b,o,c,a=k.grid,m=$("table.coral-grid-htable thead",a.columnsView),n=k.options.colModel,g;if(!a){return}$(this.element).unbind(".setGroupHeaders");h=$("<tr>",{role:"rowheader"}).addClass("coral-grid-labels");b=a.headers;for(f=0,d=b.length;f<d;f++){g=n[f].hidden?"none":"";o=$(b[f].el).width(b[f].width).css("display",g);try{o.removeAttr("rowSpan")}catch(e){o.attr("rowSpan",1)}h.append(o);c=o.children("span.coral-grid-resize");if(c.length>0){c[0].style.height=""}o.children("div")[0].style.top=""}$(m).children("tr.coral-grid-labels").remove();
$(m).prepend(h);if(j===true){$(k.element).grid("option",{groupHeader:null})}},setGroupHeaders:function(t){t=$.extend({useColSpanStyle:false,groupHeaders:[]},t||{});this.options.groupHeader=t;var h=this,y,u,v=0,A,m,f,c,e,d,z,p,n,s,l=h.options.colModel,q=l.length,a=h.grid.headers,x=$("table.coral-grid-htable",h.grid.columnsView),b=x.children("thead").children("tr.coral-grid-labels:last").addClass("jqg-second-row-header"),k=x.children("thead"),r,j=x.find(".jqg-first-row-header");if(j[0]===undefined){j=$("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto")}else{j.empty()}var g,w=function(D,B){var o=0,C=B.length;for(;o<C;o++){if(B[o].startColumnName===D){return o}}return -1};h.element.find(".coral-grid-columns-view>table").prepend(k);A=$("<tr>",{role:"rowheader"}).addClass("coral-gird-labels jqg-third-row-header");for(y=0;y<q;y++){f=a[y].el;c=$(f);u=l[y];e={height:"0px",width:a[y].width+"px",display:(u.hidden?"none":"")};$("<th>",{role:"gridcell"}).css(e).addClass("coral-first-th-"+h.options.direction).appendTo(j);f.style.width="";d=w(u.name,t.groupHeaders);if(d>=0){z=t.groupHeaders[d];p=z.numberOfColumns;n=z.titleText;for(s=0,d=0;d<p&&(y+d<q);d++){if(!l[y+d].hidden){s++}}m=$("<th>").attr({role:"columnheader"}).addClass("coral-state-default coral-th-column-header coral-th-"+h.options.direction).css({"border-top":"0px none"}).html(n);if(s>0){m.attr("colspan",String(s))}if(h.options.headertitles){m.attr("title",m.text())}if(s===0){m.hide()}c.before(m);A.append(f);v=p-1}else{if(v===0){if(t.useColSpanStyle){c.attr("rowspan","2")}else{$("<th>",{role:"columnheader"}).addClass("coral-state-default coral-th-column-header coral-th-"+h.options.direction).css({display:u.hidden?"none":"","border-top":"0px none"}).insertBefore(c);A.append(f)}}else{A.append(f);v--}}}r=$(h.element).find(".coral-grid-htable").children("thead");r.prepend(j);A.insertAfter(b);x.append(r);if(t.useColSpanStyle){x.find("span.coral-gird-resize").each(function(){var i=$(this).parent();
if(i.is(":visible")){this.style.cssText="height: "+i.height()+"px !important; cursor: col-resize;"}});x.find("div.coral-gird-sortable").each(function(){var i=$(this),o=i.parent();if(o.is(":visible")&&o.is(":has(span.coral-gird-resize)")){i.css("top",(o.height()-i.outerHeight())/2+"px")}})}g=r.find("tr.jqg-first-row-header");$(h.element).bind("gridonresizestop.setGroupHeaders",function(B,o,i){g.find("th").eq(i).width(o)})},getGridParam:function(a){var b=this;if(!b||!b.grid){return}if(!a){return b.p}else{return typeof(b.options[a])!="undefined"?b.options[a]:null}},setGridParam:function(a){if(this.grid&&typeof(a)==="object"){$.extend(true,this.options,a)}},_setOption:function(b,d){var c=this,a=this.options;if(this.grid){$.extend(true,a[b],d)}if(b=="height"){c._setGridHeight(d);c._hasScrollOffset()}if(b=="width"){c._setGridWidth(d);c._hasScrollOffset()}if(b=="model"){if(d=="grid"){c.pic.hide();c.gridRows.show();c.gridColumns.show()}else{if(d=="card"){c.gridRows.hide();c.gridColumns.hide();c.pic.show()}}}if(b=="datatype"){this.options.orgdatatype=d}this._super(b,d)},_hasScrollOffset:function(){var b=this,a=this.grid;if(a.rowsView.style.overflow!="hidden"&&a.rowsView.scroll!="no"&&a.rowsView.scrollHeight>a.rowsView.offsetHeight){$(a.columnsView).css("padding-right",b.options.scrollOffset+"px");return true}else{$(a.columnsView).css("padding-right","");$(a.rowsView).css("padding-right","");return false}},_hasHorizontalScrollBar:function(){var b=this,a=this.grid;var c=b.rightFrozenWidth;if(a.rowsView.style.overflow!="hidden"&&a.rowsView.scroll!="no"&&(a.rowsView.scrollWidth-a.rowsView.clientWidth)>0){return true}else{return false}},_setGridWidth:function(d,l){if(!this.grid||d==0||!this.rows){return}var g=this,a=this.grid,e,c=0,p=$.support.boxSizing?0:g.options.cellLayout,o,b=0,r=false,n=g.options.scrollOffset,j,k=0,i=0,f;if(typeof l!="boolean"){l=g.options.shrinkToFit}if(isNaN(d)){return}else{d=parseInt(d,10);g.grid.width=g.options.width=d}if(g.options.footerrow){$(g.grid.sDiv).css("width",d+"px")
}if(l===false&&g.options.forceFit===true){g.options.forceFit=false}$.each(g.options.colModel,function(){if((this.hidden===false||typeof(this.hidden)=="undefined")){e=this.widthOrg?this.widthOrg:parseInt(this.width,10);c+=e+p;if(this.fixed){k+=e+p}else{b++}i++}});var m=false;if(g.options.minWidth&&c>$(g.element).width()){m=true}if(l===true||m){if(b===0){return}g.options.tblwidth=c;j=d-p*b-k;if(!isNaN(g.options.height)){if($(g.grid.rowsView)[0].clientHeight<$(g.grid.rowsView)[0].scrollHeight||g.rows.length===1){r=true;j-=n}}c=0;var h=g.grid.cols.length>0;$.each(g.options.colModel,function(t){if((this.hidden===false||typeof(this.hidden)=="undefined")&&!this.fixed){e=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(!m){e=Math.round(j*e/(g.options.tblwidth-p*b-k))}if(e<0){return}this.width=e;c+=e;g.grid.headers[t].width=e;g.grid.headers[t].el.style.width=e+"px";var s=$("tr.jqg-first-row-header>th:eq("+t+")",$("table:first",g.grid.columnsView));if(s.length>0){s[0].style.width=e+"px"}if(g.options.footerrow){g.grid.footers[t].style.width=e+"px"}if(h){g.grid.cols[t].style.width=(e)+"px"}o=t}});if(!o){return}f=0;if(!m){if(r){if(d-k-(c+p*b)!==n){f=d-k-(c+p*b)-n}}else{if(Math.abs(d-k-(c+p*b))!==1){f=d-k-(c+p*b)}}g.options.colModel[o].width+=(f-1)}else{f=g.options.colModel[o].width}g.options.tblwidth=c+f+p*b+k;if(g.options.tblwidth>d){var q=g.options.tblwidth-parseInt(d,10);g.options.tblwidth=d;e=g.options.colModel[o].width=g.options.colModel[o].width-q}else{e=g.options.colModel[o].width}g.grid.headers[o].width=e;g.grid.headers[o].el.style.width=e+"px";if(h){g.grid.cols[o].style.width=e+"px"}if(g.options.footerrow){g.grid.footers[o].style.width=e+"px"}}$(a.rowsView).width(d);$(a.columnsView).width(d);if(g.options.tblwidth){$("table:first",a.rowsView).css("width",g.options.tblwidth+"px");$("table:first",a.columnsView).css("width",g.options.tblwidth+"px");g.grid.columnsView.scrollLeft=g.grid.rowsView.scrollLeft;if(g.options.footerrow){$("table:first",g.grid.sDiv).css("width",g.options.tblwidth+"px")
}}},_setGridHeight:function(d){var e=this,c=e.grid,b=!!(e.options.model=="card");if(!e.grid){return}var f=$(e.grid.rowsView);if(e.options.frozenColumns===true){$("#"+$.grid.coralID(e.options.id)+"_frozen").parent().height(f.height()-16)}var a="auto";if(String(d).toLowerCase()==="auto"){d="auto";a="auto";e.pic.css({height:"auto"});f.css({height:"auto"})}else{a=d-e.element.find(".coral-grid-pager").height()-$(c.caption).height();e.pic.css({height:a+(isNaN(a)?"":"px")});a=d-$(c.columnsView).outerHeight(true)-e.element.find(".coral-grid-pager").outerHeight(true)-$(c.caption).height();f.css({height:a+(isNaN(a)?"":"px")})}e.options.height=d;if(e.options.scroll){e.grid.populateVisible()}},getDataIDs:function(){var d=[],c=0,a,b=0;a=this.rows.length;if(a&&a>0){while(c<a){if($(this.rows[c]).hasClass("jqgrow")){d[b]=this.rows[c].id;b++}c++}}return d},setRowData:function(b,g,f){var h=this,q,n=true,l;if(!this.grid){return false}var p=this,d,c,j=typeof f,o={};c=p.rows.namedItem(b);if(!c){return false}if(g){try{$(this.options.colModel).each(function(e){q=this.name;if(g[q]!==undefined){o[q]=this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"?$.unformat.date.call(p,g[q],this):g[q];d=p._formatter(b,g[q],e,g,"edit");l=this.title?{title:$.grid.stripHtml(d)}:{};if(p.options.treeGrid===true&&q==p.options.ExpandColumn){$("td:eq("+e+") > span:first",c).html(d).attr(l)}else{$("td:eq("+e+")",c).html(d).attr(l)}$.fn.afterFmatter.call(h)}});if(p.options.datatype=="local"){var a=$.grid.stripPref(p.options.idPrefix,b),k=p.options._index[a];if(p.options.treeGrid){for(var m in p.options.treeReader){if(o.hasOwnProperty(p.options.treeReader[m])){delete o[p.options.treeReader[m]]}}}if(typeof(k)!="undefined"){p.options.data[k]=$.extend(true,p.options.data[k],o)}o=null}}catch(i){n=false}}if(n){if(j==="string"){$(c).addClass(f)}else{if(j==="object"){$(c).css(f)}}p._trigger("aftercomplete")}return n},delRowData:function(b){var k=false,e,c,i;var f=this;var j=!!(f.options.model=="card");
if(j){e=f.pic.children("#"+b)[0];if(!e){return false}else{$(e).remove();f.options.records--;f.options.reccount--;f._updatepager(true,false);k=true;if(f.options.multiselect){c=$.inArray(b,f.options.selarrrow);if(c!=-1){f.options.selarrrow.splice(c,1)}}if(b==f.options.selrow){f.options.selrow=null}}if(f.options.datatype=="local"){var a=$.grid.stripPref(f.options.idPrefix,b),g=f.options._index[a];if(typeof(g)!="undefined"){f.options.data.splice(g,1);f.refreshIndex()}}}else{e=f.rows.namedItem(b);if(!e){return false}else{i=e.rowIndex;$(e).remove();f.options.records--;f.options.reccount--;f._updatepager(true,false);k=true;if(f.options.multiselect){c=$.inArray(b,f.options.selarrrow);if(c!=-1){f.options.selarrrow.splice(c,1)}}if(b==f.options.selrow){f.options.selrow=null}if(b==f.options.editrow){f.options.editrow=null;f.rowEditButtons.remove()}var d=$.each(f.options.savedRow,function(m,l){if(l.id==b){c=m;return true}});if(d.length){if(c!=-1){f.options.savedRow.splice(c,1)}}}if(f.options.datatype=="local"){var a=$.grid.stripPref(f.options.idPrefix,b),g=f.options._index[a];if(typeof(g)!="undefined"){f.options.data.splice(g,1);f.refreshIndex()}}if(f.options.altRows===true&&k){var h=f.options.altclass;$(f.rows).each(function(l){if(l%2==1){$(this).addClass(h)}else{$(this).removeClass(h)}})}if(!f.getDataIDs().length){f._cancelCheckAll()}if(this.options.frozenColumns){this._setFrozenHeight()}return k}},_cancelCheckAll:function(){var a=this;if(a.options.multiselect){$("#cb_"+$.grid.coralID(a.options.id),a.grid.columnsView)[a.options.useProp?"prop":"attr"]("checked",false)}},resetSelection:function(c){var a=this,d,b,e;if(a.options.frozenColumns===true){e=a.options.id+"_frozen"}if(typeof(c)!=="undefined"){b=c===a.options.selrow?a.options.selrow:c;$("#"+$.grid.coralID(a.options.id)+" tbody:first tr#"+$.grid.coralID(b)).removeClass("coral-state-highlight").attr("aria-selected","false");if(e){$("#"+$.grid.coralID(b),"#"+$.grid.coralID(e)).removeClass("coral-state-highlight")}if(a.options.multiselect){$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(b),"#"+$.grid.coralID(a.options.id))[a.options.useProp?"prop":"attr"]("checked",false);
if(e){$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(b),"#"+$.grid.coralID(e))[a.options.useProp?"prop":"attr"]("checked",false)}a._setHeadCheckBox(false)}b=null}else{if(!a.options.multiselect){if(a.options.selrow){$("#"+$.grid.coralID(a.options.id)+" tbody:first tr#"+$.grid.coralID(a.options.selrow)).removeClass("coral-state-highlight").attr("aria-selected","false");if(e){$("#"+$.grid.coralID(a.options.selrow),"#"+$.grid.coralID(e)).removeClass("coral-state-highlight")}a.options.selrow=null}}else{$(a.options.selarrrow).each(function(f,g){d=a.rows.namedItem(g);$(d).removeClass("coral-state-highlight").attr("aria-selected","false");$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(g))[a.options.useProp?"prop":"attr"]("checked",false);if(e){$("#"+$.grid.coralID(g),"#"+$.grid.coralID(e)).removeClass("coral-state-highlight");$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(g),"#"+$.grid.coralID(e))[a.options.useProp?"prop":"attr"]("checked",false)}});a._setHeadCheckBox(false);a.options.selarrrow=[]}}if(a.options.cellEdit===true){if(parseInt(a.options.iCol,10)>=0&&parseInt(a.options.iRow,10)>=0){$("td:eq("+a.options.iCol+")",a.rows[a.options.iRow]).removeClass("edit-cell coral-state-highlight");$(a.rows[a.options.iRow]).removeClass("selected-row coral-state-hover")}}a.options.savedRow=[]},getRowData:function(a){var i={},m,e=false,h,f=0;var g=this,n,b;var l=!!(g.options.model=="card");if(l){if(typeof(a)=="undefined"){e=true;m=[];h=g.pic.children("li").length}else{b=g.pic.children("#"+a)[0];if(!b){return i}h=2}var d="_id_";while(f<h){if(e){b=g.pic.children("li")[f]}if($(b).hasClass("gridPanel")){for(var c=0;c<g.options.data.length;c++){if(g.options.data[c][d]==b.id){i=g.options.data[c]}}if(e){m.push(i);i={}}}f++}}else{if(typeof(a)=="undefined"){e=true;m=[];h=g.rows.length}else{b=g.rows.namedItem(a);if(!b){return i}h=2}while(f<h){if(e){b=g.rows[f]}if($(b).hasClass("jqgrow")){$('td[role="gridcell"]',b).each(function(j){n=g.options.colModel[j].name;
if(n!=="cb"&&n!=="subgrid"&&n!=="rn"){if(g.options.treeGrid===true&&n==g.options.ExpandColumn){i[n]=$.grid.htmlDecode($("span:first",this).html())}else{try{i[n]=$.unformat.call(g,this,{rowId:b.id,colModel:g.options.colModel[j]},j,"get")}catch(k){i[n]=$.grid.htmlDecode($(this).html())}}}});if(e){m.push(i);i={}}}f++}}return m?m:i},addRowData:function(j,h,f,l){if(!f){f="last"}var m=false,a,g,E,I,B,F,c,u,A,r,p="",q,D,n,H,o,w;if(h){if($.isArray(h)){q=true;D=j}else{h=[h];q=false}var s=this,x=h.length;var z=!!(s.options.model=="card");c=s.options.rownumbers===true?1:0;B=s.options.multiselect===true?1:(s.options.singleselect===true?1:0);F=s.options.subGrid===true?1:0;if(!q){if(typeof(j)!="undefined"){j=j+""}else{j=$.grid.randId();if(s.options.keyName!==false){D=s.options.keyName;if(typeof h[0][D]!="undefined"){j=h[0][D]}}}}n=s.options.altclass;var y=0,b="",d={},G=$.isFunction(s.options.afterInsertRow)?true:false;while(y<x){H=h[y];g=[];I=[];E=[];if(q){try{j=H[D]}catch(C){j=$.grid.randId()}b=s.options.altRows===true?(s.rows.length-1)%2===0?n:"":""}b+=" new-row ";w=j;j=s.options.idPrefix+j;if(c){p=s._formatCol(0,1,"",null,j,true);g[g.length]='<td role="gridcell" aria-describedby="'+s.options.id+'_rn" class="coral-state-default grid-rownum" '+p+">0</td>"}if(B){if(this.options.singleselect){r='<input role="radio" type="radio" id="jqg_'+s.options.id+"_"+j+'" name="jqg_'+s.options.id+'" class="cbox"/>'}else{r='<input role="checkbox" type="checkbox" id="jqg_'+s.options.id+"_"+j+'" name="jqg_'+s.options.id+"_"+j+'" class="cbox"/>'}p=s._formatCol(c,1,"",null,j,true);g[g.length]='<td role="gridcell" aria-describedby="'+s.options.id+'_cb" '+p+">"+r+"</td>";I.push(r)}if(F){g[g.length]=$(s).grid("addSubGridCell",B+c,1)}for(A=B+F+c;A<s.options.colModel.length;A++){o=s.options.colModel[A];a=o.name;d[a]=o.formatter&&typeof(o.formatter)==="string"&&o.formatter=="date"?$.unformat.date.call(s,H[a],o):H[a];r=s._formatter(j,$.grid.getAccessor(H,a),A,H);p=s._formatCol(A,1,r,H,j,true);g[g.length]='<td role="gridcell" aria-describedby="'+s.options.id+"_"+a+'" '+p+">"+r+"</td>"
}if(z){E.unshift(s.constructPanel(j,false,b,d,d));E.push(s._customPanel(d,c,I));E.push("</li>")}else{g.unshift(s.constructTr(j,false,b,d,d,false));g[g.length]="</tr>"}if(z){$("#"+$.grid.coralID(s.options.id)+" .coral-pic").append(E.join(""))}else{if(s.rows.length===0){$("table:first",s.grid.rowsView).append(g.join(""))}else{switch(f){case"last":$(s.rows[s.rows.length-1]).after(g.join(""));u=s.rows.length-1;break;case"first":$(s.rows[0]).after(g.join(""));u=1;break;case"after":u=s.rows.namedItem(l);if(u){if($(s.rows[u.rowIndex+1]).hasClass("coral-subgrid")){$(s.rows[u.rowIndex+1]).after(g)}else{$(u).after(g.join(""))}}u++;break;case"before":u=s.rows.namedItem(l);if(u){$(u).before(g.join(""));u=u.rowIndex}u--;break}}}if(s.options.subGrid===true){$(s).grid("addSubGrid",B+c,u)}s.options.records++;s.options.reccount++;$(s).triggerHandler("gridAfterInsertRow",[j,H,H]);if(G){s.options.afterInsertRow.call(s,j,H,H)}y++;if(s.options.datatype=="local"){d[s.options.localReader.id]=w;s.options._index[w]=s.options.data.length;s.options.data.push(d);d={}}}if(s.options.altRows===true&&!q){if(f=="last"){if((s.rows.length-1)%2==1){$(s.rows[s.rows.length-1]).addClass(n)}}else{$(s.rows).each(function(e){if(e%2==1){$(this).addClass(n)}else{$(this).removeClass(n)}})}}s._updatepager(true,true);m=true;$("#noRecordsTips_"+$.grid.coralID(s.options.id)).hide();$.fn.afterFmatter.call(s)}if(this.options.frozenColumns){this._setFrozenHeight()}return m},footerData:function(d,g){var j,b="set",h=false,e={},f;function c(l){var k;for(k in l){if(l.hasOwnProperty(k)){return false}}return true}if(d==undefined){b="get"}if(typeof g!=="boolean"){g=true}b=b.toLowerCase();var i=this,a;if(!i.grid||!i.options.footerrow){return false}if(b==="set"){if(c(d)){return false}}h=true;$(this.options.colModel).each(function(k){j=this.name;if(b==="set"){if(d[j]!==undefined){a=g?i._formatter("",d[j],k,d,"edit"):d[j];f=this.title?{title:$.grid.stripHtml(a)}:{};$("tr.footrow td:eq("+k+")",i.grid.sDiv).html(a).attr(f);h=true}}else{if(b==="get"){e[j]=$("tr.footrow td:eq("+k+")",i.grid.sDiv).html()
}}});$.fn.afterFmatter.call(i);return b==="get"?e:h},clearGridData:function(d){var c=this;var a=!!(c.options.model=="card");if(!c.grid){return}if(typeof d!="boolean"){d=false}if(a){$("#"+$.grid.coralID(c.options.id)+" .coral-pic").empty()}else{if(c.options.deepempty){$("#"+$.grid.coralID(c.options.id)+" tbody:first tr:gt(0)").remove()}else{var b=$(" tbody:first tr:first",c.element)[0];$(" tbody:first",c.element).empty().append(b)}}if(c.options.footerrow&&d){$(".coral-grid-ftable td",c.grid.sDiv).html("&#160;")}c.options.selrow=null;c.options.selarrrow=[];c.options.savedRow=[];c.options.records=0;c.options.page=1;c.options.lastpage=0;c.options.reccount=0;c.options.data=[];c.options._index={};c._updatepager(true,false);c._cancelCheckAll()},sortableRows:function(){var c={},a=0;if(c.sortableRowsOptions){$.extend(c,c.sortableRowsOptions)}var b=this;if(!b.grid){return}if(b.options.treeGrid){return}if($.fn.sortable){c=$.extend({cursor:"move",axis:"y",items:".jqgrow"},c||{});c.change=function(f,d){d.prevItemId=$(d.placeholder[0]).prev("tr").attr("id");d.nextItemId=$(d.placeholder[0]).next("tr").attr("id");d.targetId=d.position.top>d.originalPosition.top?d.prevItemId:d.nextItemId;$("#"+b.id+" #"+d.targetId).siblings().removeClass("coral-state-target");$("#"+b.id+" #"+d.targetId).addClass("coral-state-target");b._trigger("onSortableRows",f,[d])};c.start=function(g,f){$(f.item).css("border-width","0px");f.originalPermutation=[];if(f.item.is("tr")){$("td",f.item).each(function(e){this.style.width=b.grid.cols[e].style.width})}else{$("td",f.item.find("tr:first")).each(function(e){this.style.width=b.grid.cols[e].style.width})}if(b.options.subGrid){var d=$(f.item).attr("id");try{$(b).grid("collapseSubGridRow",d)}catch(g){}}$("tr.jqgrow",b.element.find(".coral-grid-btable")).each(function(){this.id!==""&&f.originalPermutation.push(this.id)});b.sortableRowOriginalPermutation=f.originalPermutation;b._trigger("beforeSortableRows",g,[f])};c.update=function(j,g){$(g.item).css("border-width","");
g.itemId=[];g.permutation=[];g.originalPermutation=b.sortableRowOriginalPermutation||[];if(b.options.rownumbers===true){$("td.grid-rownum",b.rows).each(function(e){$(this).html(e+1+(parseInt(b.options.page,10)-1)*parseInt(b.options.rowNum,10));g.permutation.push(b.rows[e+1].id)})}else{$("tr.jqgrow",b.grid.rowsView).each(function(e){g.permutation.push(this.id)})}$.each(g.item,function(e){g.itemId.push(g.item[e].id)});g.prevItemId=$(g.item[0]).prev("tr").attr("id");g.nextItemId=$(g.item[0]).next("tr").attr("id");g.targetId=g.position.top>g.originalPosition.top?g.prevItemId:g.nextItemId;var h=$.data(b.element[0],"dns-ref");if(h){var f=$.data(h,"dns");if(f.dragToSort){g.item.remove();f.dragToSort=false;var d=0;if(g.targetId){for(;d<f.dataItems.length;d++){$(h).grid("delRowData",f.dataItems[d].id)}b.element.grid("addRowData",f.rowid,f.dataItems,"after",g.targetId)}}}$("#"+b.id+" #"+g.targetId).removeClass("coral-state-target");b._trigger("afterSortableRows",j,[g])};$("tbody:first",b.grid.rowsView).sortable(c)}},destroySortableRows:function(b){var a=this;if(!a.grid){return}if($.fn.sortable){$("tbody:first",a.grid.rowsView).sortable("destroy")}},gridDnS:function(b){var e=this,j=0,f=[];if(!e.grid){return}if(e.options.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}var h="<table id='grid_dns' class='coral-grid-dns'></table>";if($("#grid_dns")[0]===undefined){$("body").append(h)}if(!b.connectWith){return}b.connectWith=b.connectWith.split(",");b.connectWith=$.map(b.connectWith,function(i){return $.trim(i)});var d=b.connectWith.join(" .coral-grid-btable>tbody, ")+" .coral-grid-btable>tbody";b=$.extend({onstart:null,onstop:null,beforedrop:null,ondrop:null,dragcopy:false,dropbyname:false,droppos:"first",autoid:true,rowid:"id",dataItems:[],autoidprefix:"dns_"},b||{});$.data(e.element[0],"dns",b);if(e.options.reccount!="0"&&!e.options.jqgdns){var a=$.data(e.element,"dns");$("tr.jqgrow:not(.coral-draggable)",e.element).draggable({revert:"invalid",helper:function(o,n){var p=$(o.target).parent("tr")[0].id,l=0,k=$("<div></div>"),m=e.element.grid("option","selarrrow").concat();
$.data(e.element[0],"dns").dataItems=[];if($.inArray(p,m)>-1){for(l;l<m.length;l++){$.data(e.element[0],"dns").dataItems.push($(e.element).grid("getRowData",m[l]));k.append($(".coral-grid-btable>tbody #"+m[l],e.element).clone())}return k}else{$.data(e.element[0],"dns").dataItems.push(e.element.grid("getRowData",p));k.append($(o.target).parent("tr").clone());return k}},connectToSortable:d,cursor:"move",appendTo:"#grid_dns",zIndex:5000,start:function(m,n){if(e.options.subGrid){var k=$(n.helper).attr("id");try{$(e.element).grid("collapseSubGridRow",k)}catch(o){}}$.data(e.element[0],"dns").dragToSort=true;for(var l=0;l<$.data(e.element[0],"dns").connectWith.length;l++){if($($.data(e.element[0],"dns").connectWith[l]).grid("option","reccount")=="0"){$($.data(e.element[0],"dns").connectWith[l]).grid("addRowData","jqg_empty_row",{})}}n.helper.addClass("coral-state-highlight");$("td",n.helper.find("tr:first")).each(function(p){this.style.width=e.grid.headers[p].width+"px"});if(b.onstart&&$.isFunction(b.onstart)){b.onstart.call($($t),m,n)}},stop:function(m,n){if(n.helper.dropped&&!b.dragcopy){var l=$(n.helper).attr("id");if(l===undefined){l=$(this).attr("id")}$(e.element).grid("delRowData",l)}for(var k=0;k<$.data(e.element[0],"dns").connectWith.length;k++){$($.data(e.element[0],"dns").connectWith[k]).grid("delRowData","jqg_empty_row")}if(b.onstop&&$.isFunction(b.onstop)){b.onstop.call($($t),m,n)}}})}e.options.jqgdns=true;for(var c=0;c<b.connectWith.length;c++){var g=b.connectWith[c];$.data($(g)[0],"dns-ref",e.element[0])}},gridDnD:function(e){var d=this;if(!d.grid){return}if(d.options.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}function f(){var h=$.data(d.element,"dnd");$("tr.jqgrow:not(.coral-draggable)",d.element).draggable($.isFunction(h.drag)?h.drag.call($(d.element),h):h.drag)}var b="<table id='jqgrid_dnd' class='coral-grid-dnd'></table>";if($("#jqgrid_dnd")[0]===undefined){$("body").append(b)}if(typeof e=="string"&&e=="updateDnD"&&d.options.jqgdnd===true){f();
return}if(!e.connectWith){return}e.connectWith=e.connectWith.split(",");e.connectWith=$.map(e.connectWith,function(h){return $.trim(h)});var a=e.connectWith.join(" .coral-grid-btable>tbody, ")+" .coral-grid-btable>tbody";e=$.extend({drag:function(h){return $.extend({start:function(l,m){if(d.options.subGrid){var j=$(m.helper).attr("id");try{$(d.element).grid("collapseSubGridRow",j)}catch(n){}}for(var k=0;k<$.data(d.element,"dnd").connectWith.length;k++){if($($.data(d.element,"dnd").connectWith[k]).grid("option","reccount")=="0"){$($.data(d.element,"dnd").connectWith[k]).grid("addRowData","jqg_empty_row",{})}}m.helper.addClass("coral-state-highlight");$("td",m.helper).each(function(o){this.style.width=d.grid.headers[o].width+"px"});if(h.onstart&&$.isFunction(h.onstart)){h.onstart.call($($t),l,m)}},stop:function(l,m){if(m.helper.dropped&&!h.dragcopy){var k=$(m.helper).attr("id");if(k===undefined){k=$(this).attr("id")}$(d.element).grid("delRowData",k)}for(var j=0;j<$.data(d.element,"dnd").connectWith.length;j++){$($.data(d.element,"dnd").connectWith[j]).grid("delRowData","jqg_empty_row")}if(h.onstop&&$.isFunction(h.onstop)){h.onstop.call($($t),l,m)}}},h.drag_opts||{})},drop:function(h){return $.extend({accept:function(j){if(!$(j).hasClass("jqgrow")){return j}var i=$(j).closest("table.coral-grid-btable");if(i.length>0&&$.data(d.element,"dnd")!==undefined){var k=$.data(d.element,"dnd").connectWith;return $.inArray("#"+$.grid.coralID(this.id),k)!=-1?true:false}return false},drop:function(r,q){if(!$(q.draggable).hasClass("jqgrow")){return}var n=$(q.draggable).attr("id");var l=q.draggable.parents(".coral-grid").grid("getRowData",n);if(!h.dropbyname){var o=0,k={},u;var s=$("#"+$.grid.coralID(this.id)).grid("option","colModel");try{for(var t in l){if(l.hasOwnProperty(t)){u=s[o].name;if(!(u=="cb"||u=="rn"||u=="subgrid")){if(l.hasOwnProperty(t)&&s[o]){k[u]=l[t]}}else{o++}o++}}l=k}catch(p){}}q.helper.dropped=true;if(h.beforedrop&&$.isFunction(h.beforedrop)){var m=h.beforedrop.call(this,r,q,l,$("#"+$.grid.coralID(d.options.id)),$(this));
if(typeof m!="undefined"&&m!==null&&typeof m=="object"){l=m}}if(q.helper.dropped){var i;if(h.autoid){if($.isFunction(h.autoid)){i=h.autoid.call(this,l)}else{i=Math.ceil(Math.random()*1000);i=h.autoidprefix+i}}$("#"+$.grid.coralID(this.id)).grid("addRowData",i,l,h.droppos)}if(h.ondrop&&$.isFunction(h.ondrop)){h.ondrop.call(this,r,q,l)}}},h.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"coral-state-active",hoverClass:"coral-state-hover"},drag_opts:{revert:"invalid",helper:"clone",connectToSortable:a,cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5000},dragcopy:false,dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},e||{});$.data(d.element,"dnd",e);if(d.options.reccount!="0"&&!d.options.jqgdnd){f()}d.options.jqgdnd=true;for(var c=0;c<e.connectWith.length;c++){var g=e.connectWith[c];$(g).droppable($.isFunction(e.drop)?e.drop.call($(d),e):e.drop)}},getInd:function(b,c){var a=false,d;d=this.rows.namedItem(b);if(d){a=c===true?d:d.rowIndex}return a}});$.extend($.grid,{htmlDecode:function(a){if(a&&(a=="&nbsp;"||a=="&#160;"||(a.length===1&&a.charCodeAt(0)===160))){return""}return !a?a:String(a).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/\'/g,"&acute;")},htmlEncode:function(a){return !a?a:String(a).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&acute;")},format:function(b){var a=$.makeArray(arguments).slice(1);if(b===undefined){b=""}return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})},getCellIndex:function(a){var b=$(a);if(b.is("tr")){return -1}b=(!b.is("td")&&!b.is("th")?b.closest("td,th"):b)[0];return b.cellIndex},stripHtml:function(a){a=a+"";var b=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(a){a=a.replace(b,"");return(a&&a!=="&nbsp;"&&a!=="&#160;")?a.replace(/\"/g,"'"):""}else{return a}},stripPref:function(a,c){var b=$.type(a);if(b=="string"||b=="number"){a=String(a);c=a!==""?String(c).replace(String(a),""):c}return c
},stringToDoc:function(c){var a;if(typeof c!=="string"){return c}try{var d=new DOMParser();a=d.parseFromString(c,"text/xml")}catch(b){a=new ActiveXObject("Microsoft.XMLDOM");a.async=false;a.loadXML(c)}return(a&&a.documentElement&&a.documentElement.tagName!="parsererror")?a:null},parse:function(jsonString){var js=jsonString;if(js.substr(0,9)=="while(1);"){js=js.substr(9)}if(js.substr(0,2)=="/*"){js=js.substr(2,js.length-4)}if(!js){js="{}"}return($.grid.useJSON===true&&typeof(JSON)==="object"&&typeof(JSON.parse)==="function")?JSON.parse(js):eval("("+js+")")},parseDate:function(i,e){var f={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},g,c,j,b=/[\\\/:_;.,\t\T\s-]/;if(e&&e!==null&&e!==undefined){e=$.trim(e);e=e.split(b);if($.grid.formatter.date.masks[i]!==undefined){i=$.grid.formatter.date.masks[i]}i=i.split(b);var a=$.grid.formatter.date.monthNames;var l=$.grid.formatter.date.AmPm;var d=function(k,m){if(k===0){if(m===12){m=0}}else{if(m!==12){m+=12}}return m};for(g=0,c=i.length;g<c;g++){if(i[g]=="M"){j=$.inArray(e[g],a);if(j!==-1&&j<12){e[g]=j+1;f.m=e[g]}}if(i[g]=="F"){j=$.inArray(e[g],a);if(j!==-1&&j>11){e[g]=j+1-12;f.m=e[g]}}if(i[g]=="a"){j=$.inArray(e[g],l);if(j!==-1&&j<2&&e[g]==l[j]){e[g]=j;f.h=d(e[g],f.h)}}if(i[g]=="A"){j=$.inArray(e[g],l);if(j!==-1&&j>1&&e[g]==l[j]){e[g]=j-2;f.h=d(e[g],f.h)}}if(e[g]!==undefined){f[i[g].toLowerCase()]=parseInt(e[g],10)}}f.m=parseInt(f.m,10)-1;var h=f.y;if(h>=70&&h<=99){f.y=1900+f.y}else{if(h>=0&&h<=69){f.y=2000+f.y}}if(f.j!==undefined){f.d=f.j}if(f.n!==undefined){f.m=parseInt(f.n,10)-1}}return new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u)},coralID:function(a){return String(a).replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"coralg",randId:function(a){return(a?a:$.grid.uidPref)+($.grid.guid++)},getAccessor:function(h,g){var b,f,a=[],c;if(typeof g==="function"){return g(h)}b=h[g];if(b===undefined){try{if(typeof g==="string"){a=g.split(".")}c=a.length;if(c){b=h;while(b&&c--){f=a.shift();b=b[f]}}}catch(d){}}return b},ajaxOptions:{},from:function(source){var QueryObject=function(d,q){if(typeof(d)=="string"){d=$.data(d)
}var self=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_orDepth=0,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true,_usePinyin=true;if(typeof(d)=="object"&&d.push){if(d.length>0){if(typeof(d[0])!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array"}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(s){var phrase=[];if(_trim){phrase.push("jQuery.trim(")}phrase.push("String("+s+")");if(_trim){phrase.push(")")}if(!_usecase){phrase.push(".toLowerCase()")}return phrase.join("")};this._strComp=function(val){if(typeof(val)=="string"){return".toString()"}else{return""}};this._group=function(f,u){return({field:f.toString(),unique:u,items:[]})};this._toStr=function(phrase){if(_trim){phrase=$.trim(phrase)}phrase=phrase.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return _usecase?phrase:phrase.toLowerCase()};this._funcLoop=function(func){var results=[];$.each(_data,function(i,v){results.push(func(v))});return results};this._append=function(s){var i;if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}for(i=0;i<_orDepth;i++){_query+="("}if(_negate){_query+="!"}_query+="("+s+")";_negate=false;_queuedOperator="";_orDepth=0};this._setCommand=function(f,c){_lastCommand=f;_lastField=c};this._resetNegate=function(){_negate=false};this._repeatCommand=function(f,v){if(_lastCommand===null){return self}if(f!==null&&v!==null){return _lastCommand(f,v)}if(_lastField===null){return _lastCommand(f)}if(!_useProperties){return _lastCommand(f)}return _lastCommand(_lastField,f)};this._equals=function(a,b){return(self._compare(a,b,1)===0)};this._compare=function(a,b,d){var toString=Object.prototype.toString;if(d===undefined){d=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return -1}if(toString.call(a)==="[object Date]"&&toString.call(b)==="[object Date]"){if(a<b){return -d
}if(a>b){return d}return 0}if(!_usecase&&typeof(a)!=="number"&&typeof(b)!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return -d}if(a>b){return d}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=self._doSort(_data,0)};this._doSort=function(d,q){var by=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt;if(q==_sorting.length-1){return self._getOrder(d,by,dir,type,dfmt)}q++;var values=self._getGroup(d,by,dir,type,dfmt);var results=[];for(var i=0;i<values.length;i++){var sorted=self._doSort(values[i].items,q);for(var j=0;j<sorted.length;j++){results.push(sorted[j])}}return results};this._getOrder=function(data,by,dir,type,dfmt){var sortData=[],_sortData=[],newDir=dir=="a"?1:-1,i,ab,j,findSortKey;if(type===undefined){type="text"}if(type=="float"||type=="number"||type=="currency"||type=="numeric"){findSortKey=function($cell){var key=parseFloat(String($cell).replace(_stripNum,""));return isNaN(key)?0:key}}else{if(type=="int"||type=="integer"){findSortKey=function($cell){return $cell?parseFloat(String($cell).replace(_stripNum,"")):0}}else{if(type=="date"||type=="datetime"){findSortKey=function($cell){return $.grid.parseDate(dfmt,$cell).getTime()}}else{if($.isFunction(type)){findSortKey=type}else{findSortKey=function($cell){if(!$cell){$cell=""}return $.trim(String($cell).toUpperCase())}}}}}$.each(data,function(i,v){ab=by!==""?$.grid.getAccessor(v,by):v;if(ab===undefined){ab=""}ab=findSortKey(ab,v);_sortData.push({vSort:ab,index:i})});_sortData.sort(function(a,b){a=a.vSort;b=b.vSort;return self._compare(a,b,newDir)});j=0;var nrec=data.length;while(j<nrec){i=_sortData[j].index;sortData.push(data[i]);j++}return sortData};this._getGroup=function(data,by,dir,type,dfmt){var results=[],group=null,last=null,val;$.each(self._getOrder(data,by,dir,type,dfmt),function(i,v){val=$.grid.getAccessor(v,by);if(val===undefined){val=""}if(!self._equals(last,val)){last=val;if(group!==null){results.push(group)}group=self._group(by,val)
}group.items.push(v)});if(group!==null){results.push(group)}return results};this.ignoreCase=function(){_usecase=false;return self};this.useCase=function(){_usecase=true;return self};this.trim=function(){_trim=true;return self};this.noTrim=function(){_trim=false;return self};this.execute=function(){var match=_query,results=[];if(match===null){return self}$.each(_data,function(){if(eval(match)){results.push(this)}});_data=results;return self};this.data=function(){return _data};this.select=function(f){self._performSort();if(!self._hasData()){return[]}self.execute();if($.isFunction(f)){var results=[];$.each(_data,function(i,v){results.push(f(v))});return results}return _data};this.hasMatch=function(){if(!self._hasData()){return false}self.execute();return _data.length>0};this.andNot=function(f,v,x){_negate=!_negate;return self.and(f,v,x)};this.orNot=function(f,v,x){_negate=!_negate;return self.or(f,v,x)};this.not=function(f,v,x){return self.andNot(f,v,x)};this.and=function(f,v,x){_queuedOperator=" && ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.or=function(f,v,x){_queuedOperator=" || ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.orBegin=function(){_orDepth++;return self};this.orEnd=function(){if(_query!==null){_query+=")"}return self};this.isNot=function(f){_negate=!_negate;return self.is(f)};this.is=function(f){self._append("this."+f);self._resetNegate();return self};this._compareValues=function(func,f,v,how,t){var fld;if(_useProperties){fld="jQuery.grid.getAccessor(this,'"+f+"')"}else{fld="this"}if(v===undefined){v=null}var val=v,swst=t.stype===undefined?"text":t.stype;if(v!==null){switch(swst){case"int":case"integer":val=(isNaN(Number(val))||val==="")?"0":val;fld="parseInt("+fld+",10)";val="parseInt("+val+",10)";break;case"float":case"number":case"numeric":val=String(val).replace(_stripNum,"");val=(isNaN(Number(val))||val==="")?"0":val;fld="parseFloat("+fld+")";val="parseFloat("+val+")";break;case"date":case"datetime":val=String($.grid.parseDate(t.newfmt||"Y-m-d",val).getTime());
fld='jQuery.grid.parseDate("'+t.srcfmt+'",'+fld+").getTime()";break;default:fld=self._getStr(fld);val=self._getStr('"'+self._toStr(val)+'"')}}self._append(fld+" "+how+" "+val+" || pinyinEngine.toPinyin("+fld+', false, "") '+how+" "+val);self._setCommand(func,f);self._resetNegate();return self};this.equals=function(f,v,t){return self._compareValues(self.equals,f,v,"==",t)};this.notEquals=function(f,v,t){return self._compareValues(self.equals,f,v,"!==",t)};this.isNull=function(f,v,t){return self._compareValues(self.equals,f,null,"===",t)};this.greater=function(f,v,t){return self._compareValues(self.greater,f,v,">",t)};this.less=function(f,v,t){return self._compareValues(self.less,f,v,"<",t)};this.greaterOrEquals=function(f,v,t){return self._compareValues(self.greaterOrEquals,f,v,">=",t)};this.lessOrEquals=function(f,v,t){return self._compareValues(self.lessOrEquals,f,v,"<=",t)};this.startsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(v)+'"'))}else{length=_trim?$.trim(v.toString()).length:v.toString().length;self._append(self._getStr("this")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(f)+'"'))}self._setCommand(self.startsWith,f);self._resetNegate();return self};this.endsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+".substr("+self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+".length-"+length+","+length+') == "'+self._toStr(v)+'"')}else{self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"')}self._setCommand(self.endsWith,f);self._resetNegate();return self};this.contains=function(f,v){if(_useProperties){if(_usePinyin){self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1 || '+self._getStr("pinyinEngine.toPinyin(jQuery.grid.getAccessor(this,'"+f+'\'), false, "")')+'.indexOf("'+self._toStr(v)+'",0) > -1')
}else{self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1')}}else{if(_usePinyin){self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1 || '+pinyinEngine.toPinyin(self._getStr("this"),false,"")+'.indexOf("'+self._toStr(v)+'",0) > -1')}else{self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1')}}self._setCommand(self.contains,f);self._resetNegate();return self};this.groupBy=function(by,dir,type,datefmt){if(!self._hasData()){return null}return self._getGroup(_data,by,dir,type,datefmt)};this.orderBy=function(by,dir,stype,dfmt){dir=dir===undefined||dir===null?"a":$.trim(dir.toString().toLowerCase());if(stype===null||stype===undefined){stype="text"}if(dfmt===null||dfmt===undefined){dfmt="Y-m-d"}if(dir=="desc"||dir=="descending"){dir="d"}if(dir=="asc"||dir=="ascending"){dir="a"}_sorting.push({by:by,dir:dir,type:stype,datefmt:dfmt});return self};return self};return new QueryObject(source,null)},getMethod:function(a){return this.getAccessor($.fn.grid,a)},extend:function(a){$.extend($.fn.grid,a);if(!this.no_legacy_api){$.fn.extend(a)}}});grid=$.component("coral.grid",$.coral.grid,{setTreeNode:function(n,p){var d=this;if(!d.grid||!d.options.treeGrid){return}var h=d.options.expColInd,k=d.options.treeReader.expanded_field,s=d.options.treeReader.leaf_field,a=d.options.treeReader.level_field,r=d.options.treeReader.icon_field,m=d.options.treeReader.loaded,u,j,b,f,l,v,t,g;while(n<p){var e=d.rows[n].id,c=d.options._index[e],q;t=d.options.data[c];if(d.options.treeGridModel=="nested"){if(!t[s]){u=parseInt(t[d.options.treeReader.left_field],10);j=parseInt(t[d.options.treeReader.right_field],10);t[s]=(j===u+1)?"true":"false";d.rows[n].cells[d.options._treeleafpos].innerHTML=t[s]}}b=parseInt(t[a],10);if(d.options.tree_root_level===0){f=b+1;l=b}else{f=b;l=b-1}v="<div class='tree-wrap tree-wrap-"+d.options.direction+"' style='width:"+(f*18)+"px;'>";v+="<div style='"+(d.options.direction=="rtl"?"right:":"left:")+(l*18)+"px;' class=' ";
if(t[m]!==undefined){if(t[m]=="true"||t[m]===true){t[m]=true}else{t[m]=false}}if(t[s]=="true"||t[s]===true){v+=((t[r]!==undefined&&t[r]!=="")?t[r]:d.options.treeIcons.leaf)+" tree-leaf treeclick";t[s]=true;g="leaf"}else{t[s]=false;g=""}t[k]=((t[k]=="true"||t[k]===true)?true:false)&&t[m];if(t[k]===false){v+=((t[s]===true)?"'":d.options.treeIcons.plus+" tree-plus treeclick'")}else{v+=((t[s]===true)?"'":d.options.treeIcons.minus+" tree-minus treeclick'")}v+="></div></div>";$(d.rows[n].cells[h]).wrapInner("<span class='cell-wrapper"+g+"'></span>").prepend(v);if(b!==parseInt(d.options.tree_root_level,10)){var o=$(d.element).grid("getNodeParent",t);q=o&&o.hasOwnProperty(k)?o[k]:true;if(!q){$(d.rows[n]).css("display","none")}}$(d.rows[n].cells[h]).find("div.treeclick").bind("click",function(w){var i=w.target||w.srcElement,y=$(i,d.rows).closest("tr.jqgrow")[0].id,x=d.options._index[y];if(!d.options.data[x][s]){if(d.options.data[x][k]){$(d.element).grid("collapseRow",d.options.data[x]);$(d.element).grid("collapseNode",d.options.data[x])}else{$(d.element).grid("expandRow",d.options.data[x]);$(d.element).grid("expandNode",d.options.data[x])}}return false});if(d.options.ExpandColClick===true){$(d.rows[n].cells[h]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(w){var i=w.target||w.srcElement,y=$(i,d.rows).closest("tr.jqgrow")[0].id,x=d.options._index[y];if(!d.options.data[x][s]){if(d.options.data[x][k]){$(d.element).grid("collapseRow",d.options.data[x]);$(d.element).grid("collapseNode",d.options.data[x])}else{$(d.element).grid("expandRow",d.options.data[x]);$(d.element).grid("expandNode",d.options.data[x])}}$(d.element).grid("setSelection",y);return false})}n++}},setTreeGrid:function(){var f=this,e=0,c,h=false,b,d,a=[];if(!f.options.treeGrid){return}if(!f.options.treedatatype){$.extend(f.options,{treedatatype:f.options.datatype})}f.options.subGrid=false;f.options.altRows=false;f.options.gridview=true;if(f.options.rowTotal===null){f.options.rowNum=10000}f.options.multiselect=false;
f.options.rowList=[];f.options.expColInd=0;c="coral-icon-triangle-1-"+(f.options.direction=="rtl"?"w":"e");f.options.treeIcons=$.extend({plus:"cui-icon-arrow-right3",minus:"cui-icon-arrow-down3",leaf:"cui-icon-file-empty2"},f.options.treeIcons||{});if(f.options.treeGridModel=="nested"){f.options.treeReader=$.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},f.options.treeReader)}else{if(f.options.treeGridModel=="adjacency"){f.options.treeReader=$.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},f.options.treeReader)}}for(d in f.options.colModel){if(f.options.colModel.hasOwnProperty(d)){b=f.options.colModel[d].name;if(b==f.options.ExpandColumn&&!h){h=true;f.options.expColInd=e}e++;for(var g in f.options.treeReader){if(f.options.treeReader[g]==b){a.push(b)}}}}$.each(f.options.treeReader,function(i,k){if(k&&$.inArray(k,a)===-1){if(i==="leaf_field"){f.options._treeleafpos=e}e++;f.options.colNames.push(k);f.options.colModel.push({name:k,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})},expandRow:function(a){var d=this;if(!d.grid||!d.options.treeGrid){return}var c=$(d.element).grid("getNodeChildren",a),b=d.options.treeReader.expanded_field,e=d.rows;$(c).each(function(){var f=$.grid.getAccessor(this,d.options.localReader.id);$(e.namedItem(f)).css("display","");if(this[b]){$(d.element).grid("expandRow",this)}})},collapseRow:function(a){var d=this;if(!d.grid||!d.options.treeGrid){return}var c=$(d.element).grid("getNodeChildren",a),b=d.options.treeReader.expanded_field,e=d.rows;$(c).each(function(){var f=$.grid.getAccessor(this,d.options.localReader.id);$(e.namedItem(f)).css("display","none");if(this[b]){$(d.element).grid("collapseRow",this)}})},getRootNodes:function(){var a=[];var b=this;if(!b.grid||!b.options.treeGrid){return}switch(b.options.treeGridModel){case"nested":var d=b.options.treeReader.level_field;
$(b.options.data).each(function(){if(parseInt(this[d],10)===parseInt(b.options.tree_root_level,10)){a.push(this)}});break;case"adjacency":var c=b.options.treeReader.parent_id_field;$(b.options.data).each(function(){if(this[c]===null||String(this[c]).toLowerCase()=="null"){a.push(this)}});break}return a},getNodeDepth:function(b){var a=null;this.each(function(){if(!this.grid||!this.options.treeGrid){return}var d=this;switch(that.options.treeGridModel){case"nested":var c=that.options.treeReader.level_field;a=parseInt(b[c],10)-parseInt(that.options.tree_root_level,10);break;case"adjacency":a=$(d).grid("getNodeAncestors",b).length;break}});return a},getNodeParent:function(a){var k=null;var e=this;if(!e.grid||!e.options.treeGrid){return}switch(e.options.treeGridModel){case"nested":var d=e.options.treeReader.left_field,j=e.options.treeReader.right_field,f=e.options.treeReader.level_field,i=parseInt(a[d],10),h=parseInt(a[j],10),b=parseInt(a[f],10);$(e.options.data).each(function(){if(parseInt(this[f],10)===b-1&&parseInt(this[d],10)<i&&parseInt(this[j],10)>h){k=this;return false}});break;case"adjacency":var g=e.options.treeReader.parent_id_field,c=e.options.localReader.id;$(e.options.data).each(function(){if(this[c]==a[g]){k=this;return false}});break}return k},getNodeChildren:function(a){var k=[];var e=this;if(!e.grid||!e.options.treeGrid){return}switch(e.options.treeGridModel){case"nested":var d=e.options.treeReader.left_field,j=e.options.treeReader.right_field,f=e.options.treeReader.level_field,i=parseInt(a[d],10),h=parseInt(a[j],10),b=parseInt(a[f],10);$(this.options.data).each(function(){if(parseInt(this[f],10)===b+1&&parseInt(this[d],10)>i&&parseInt(this[j],10)<h){k.push(this)}});break;case"adjacency":var g=e.options.treeReader.parent_id_field,c=e.options.localReader.id;$(this.options.data).each(function(){if(this[g]==a[c]){k.push(this)}});break}return k},getFullTreeNode:function(b){var a=[];this.each(function(){var f=this,g;if(!f.grid||!that.options.treeGrid){return}switch(that.options.treeGridModel){case"nested":var e=that.options.treeReader.left_field,l=that.options.treeReader.right_field,h=that.options.treeReader.level_field,k=parseInt(b[e],10),j=parseInt(b[l],10),c=parseInt(b[h],10);
$(this.options.data).each(function(){if(parseInt(this[h],10)>=c&&parseInt(this[e],10)>=k&&parseInt(this[e],10)<=j){a.push(this)}});break;case"adjacency":if(b){a.push(b);var i=that.options.treeReader.parent_id_field,d=that.options.localReader.id;$(this.options.data).each(function(m){g=a.length;for(m=0;m<g;m++){if(a[m][d]==this[i]){a.push(this);break}}})}break}});return a},getNodeAncestors:function(b){var a=[];this.each(function(){if(!this.grid||!this.options.treeGrid){return}var c=$(this).grid("getNodeParent",b);while(c){a.push(c);c=$(this).grid("getNodeParent",c)}});return a},isVisibleNode:function(b){var a=true;this.each(function(){var e=this;if(!e.grid||!that.options.treeGrid){return}var d=$(e).grid("getNodeAncestors",b),c=that.options.treeReader.expanded_field;$(d).each(function(){a=a&&this[c];if(!a){return false}})});return a},isNodeLoaded:function(d){var a;var c=this;if(!c.grid||!c.options.treeGrid){return}var b=c.options.treeReader.leaf_field;if(d!==undefined){if(d.loaded!==undefined){a=d.loaded}else{if(d[b]||$(c.element).grid("getNodeChildren",d).length>0){a=true}else{a=false}}}else{a=false}return a},expandNode:function(a){if(!this.grid||!this.options.treeGrid){return}var g=this.options.treeReader.expanded_field,h=this.options.treeReader.parent_id_field,e=this.options.treeReader.loaded,b=this.options.treeReader.level_field,j=this.options.treeReader.left_field,i=this.options.treeReader.right_field;if(!a[g]){var c=$.grid.getAccessor(a,this.options.localReader.id);var d=$("#"+$.grid.coralID(c),this.grid.rowsView)[0];var f=this.options._index[c];if($(this.element).grid("isNodeLoaded",this.options.data[f])){a[g]=true;$("div.treeclick",d).removeClass(this.options.treeIcons.plus+" tree-plus").addClass(this.options.treeIcons.minus+" tree-minus")}else{if(!this.grid.columnsView.loading){a[g]=true;$("div.treeclick",d).removeClass(this.options.treeIcons.plus+" tree-plus").addClass(this.options.treeIcons.minus+" tree-minus");this.options.treeANode=d.rowIndex;this.options.datatype=this.options.treedatatype;
if(this.options.treeGridModel=="nested"){$(this.element).grid("option",{postData:{nodeid:c,n_left:a[j],n_right:a[i],n_level:a[b]}})}else{$(this.element).grid("option",{postData:{nodeid:c,parentid:a[h],n_level:a[b]}})}$(this.element).grid("reload");a[e]=true;if(this.options.treeGridModel=="nested"){$(this.element).grid("option",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}})}else{$(this.element).grid("option",{postData:{nodeid:"",parentid:"",n_level:""}})}}}}},collapseNode:function(c){if(!this.grid||!this.options.treeGrid){return}var b=this.options.treeReader.expanded_field;if(c[b]){c[b]=false;var d=$.grid.getAccessor(c,this.options.localReader.id);var a=$("#"+$.grid.coralID(d),this.grid.rowsView)[0];$("div.treeclick",a).removeClass(this.options.treeIcons.minus+" tree-minus").addClass(this.options.treeIcons.plus+" tree-plus")}},sortTree:function(f,a,m,k){if(!this.grid||!this.options.treeGrid){return}var e,h,d,b=[],g=this,j,l,c=$(g.element).grid("getRootNodes");j=$.grid.from(c);j.orderBy(f,a,m,k);l=j.select();for(e=0,h=l.length;e<h;e++){d=l[e];b.push(d);$(g.element).grid("collectChildrenSortTree",b,d,f,a,m,k)}$.each(b,function(i){var n=$.grid.getAccessor(this,g.options.localReader.id);$("#"+$.grid.coralID(g.options.id)+" tbody tr:eq("+i+")").after($("tr#"+$.grid.coralID(n),g.grid.rowsView))});j=null;l=null;b=null},collectChildrenSortTree:function(e,f,h,d,m,l){if(!this.grid||!this.options.treeGrid){return}var g,j,c,a,k,b;a=$(this.element).grid("getNodeChildren",f);k=$.grid.from(a);k.orderBy(h,d,m,l);b=k.select();for(g=0,j=b.length;g<j;g++){c=b[g];e.push(c);$(this.element).grid("collectChildrenSortTree",e,c,h,d,m,l)}},setTreeRow:function(a,b){var c=false;this.each(function(){var d=this;if(!d.grid||!d.options.treeGrid){return}c=$(d).grid("setRowData",a,b)});return c},delTreeNode:function(a){return this.each(function(){var h=this,m=that.options.localReader.id,f=that.options.treeReader.left_field,k=that.options.treeReader.right_field,c,d,j,l;if(!h.grid||!that.options.treeGrid){return
}var b=that.options._index[a];if(b!==undefined){c=parseInt(that.options.data[b][k],10);d=c-parseInt(that.options.data[b][f],10)+1;var e=$(h).grid("getFullTreeNode",that.options.data[b]);if(e.length>0){for(var g=0;g<e.length;g++){$(h).grid("delRowData",e[g][m])}}if(that.options.treeGridModel==="nested"){j=$.grid.from(that.options.data).greater(f,c,{stype:"integer"}).select();if(j.length){for(l in j){if(j.hasOwnProperty(l)){j[l][f]=parseInt(j[l][f],10)-d}}}j=$.grid.from(that.options.data).greater(k,c,{stype:"integer"}).select();if(j.length){for(l in j){if(j.hasOwnProperty(l)){j[l][k]=parseInt(j[l][k],10)-d}}}}}})},addChildNode:function(f,l,x){var r=this[0];if(x){var m=that.options.treeReader.expanded_field,u=that.options.treeReader.leaf_field,a=that.options.treeReader.level_field,g=that.options.treeReader.parent_id_field,c=that.options.treeReader.left_field,v=that.options.treeReader.right_field,n=that.options.treeReader.loaded,b,w,h,k,p,q,o=0,j=l,t,s;if(typeof f==="undefined"||f===null){p=that.options.data.length-1;if(p>=0){while(p>=0){o=Math.max(o,parseInt(that.options.data[p][that.options.localReader.id],10));p--}}f=o+1}var A=$(r).grid("getInd",l);t=false;if(l===undefined||l===null||l===""){l=null;j=null;b="last";k=that.options.tree_root_level;p=that.options.data.length+1}else{b="after";w=that.options._index[l];h=that.options.data[w];l=h[that.options.localReader.id];k=parseInt(h[a],10)+1;var d=$(r).grid("getFullTreeNode",h);if(d.length){p=d[d.length-1][that.options.localReader.id];j=p;p=$(r).grid("getInd",j)+1}else{p=$(r).grid("getInd",l)+1}if(h[u]){t=true;h[m]=true;$(r.rows[A]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(that.options.treeIcons.leaf+" tree-leaf").addClass(that.options.treeIcons.minus+" tree-minus");that.options.data[w][u]=false;h[n]=true}}q=p+1;x[m]=false;x[n]=true;x[a]=k;x[u]=true;if(that.options.treeGridModel==="adjacency"){x[g]=l}if(that.options.treeGridModel==="nested"){var e,z,y;
if(l!==null){s=parseInt(h[v],10);e=$.grid.from(that.options.data);e=e.greaterOrEquals(v,s,{stype:"integer"});z=e.select();if(z.length){for(y in z){if(z.hasOwnProperty(y)){z[y][c]=z[y][c]>s?parseInt(z[y][c],10)+2:z[y][c];z[y][v]=z[y][v]>=s?parseInt(z[y][v],10)+2:z[y][v]}}}x[c]=s;x[v]=s+1}else{s=parseInt($(r).grid("getCol",v,false,"max"),10);z=$.grid.from(that.options.data).greater(c,s,{stype:"integer"}).select();if(z.length){for(y in z){if(z.hasOwnProperty(y)){z[y][c]=parseInt(z[y][c],10)+2}}}z=$.grid.from(that.options.data).greater(v,s,{stype:"integer"}).select();if(z.length){for(y in z){if(z.hasOwnProperty(y)){z[y][v]=parseInt(z[y][v],10)+2}}}x[c]=s+1;x[v]=s+2}}if(l===null||$(r).grid("isNodeLoaded",h)||t){$(r).grid("addRowData",f,x,b,j);$(r).grid("setTreeNode",p,q)}if(h&&!h[m]){$(r.rows[A]).find("div.treeclick").click()}}},refreshDescription:function(a){if(this.options.toolbarOptions){if(this.options.description){$(".pager-description",this.element).html(a)}}},hideGridHeader:function(){this.element.find(".coral-grid-columns").hide()},showGridHeader:function(){this.element.find(".coral-grid-columns").show()},valid:function(b,g){var k={},m,e=false,i,f=0;var h=this,l,d,c;h.errorResults=[];var a;if(typeof(b)=="undefined"||!b){e=true;m=[];i=h.rows.length}else{c=h.rows.namedItem(b);if(!c){return k}i=2}while(f<i){if(e){c=h.rows[f]}if($(c).hasClass("jqgrow")){$('td[role="gridcell"]',c).each(function(n){l=h.options.colModel[n].name;d=h.options.colModel[n].editable;if(!g||(g&&l==g)){if(l!=="cb"&&l!=="subgrid"&&l!=="rn"){if(h.options.treeGrid===true&&l==h.options.ExpandColumn){k[l]=$.grid.htmlDecode($("span:first",this).html())}else{try{var s=$.grep(h.options.savedRow,function(t){return t.id==c.id||h.rows[t.id].id==c.id});if(h.options.savedRow.length&&s.length&&d){a="edittype"}else{a=null}k[l]=$.unformat.call(h,this,{rowId:c.id,colModel:h.options.colModel[n]},n,"get",a)}catch(r){k[l]=$.grid.htmlDecode($(this).html())}}var q=$.extend(h.options.colModel[n].formatoptions||{},h.options.colModel[n].editoptions||{});
var o=$.Event();o.target=this;var p={validoptions:q,notComponent:!(a=="edittype"),showRequiredMark:$.noop,hasTips:false,component:(a=="edittype")?h.getCellComponent(c.id,l):$(this),element:$(this).find(".ctrl-init").length>0?$(this).find(".ctrl-init"):$(this),value:k[l]};var j=$.validate.validateField(o,p);if(j.length){if(h.options.allowSaveOnError){$(this).addClass("coral-gridcell-error").attr("data-errors",j)}else{$(this).addClass("coral-gridcell-error")}h.errorResults.push({rowId:c.id,rowIndex:f,cellIndex:n,errors:j})}else{$(this).removeClass("coral-gridcell-error").removeAttr("data-errors")}}}});if(e){m.push(k);k={}}}f++}this.options.isValid=!(this.errorResults.length>0);return this.options.isValid},clearErrors:function(a,g){var l={},n,e=false,i,f=0;var h=this,m,c,b;this.errorResults=this.errorResults||[];if(typeof(a)=="undefined"||!a){e=true;n=[];i=h.rows.length;h.errorResults=[]}else{b=h.rows.namedItem(a);if(!b){return l}i=2;var d=h.errorResults.length;for(d;d>0;d--){if(h.errorResults[d-1].rowId==b.id){h.errorResults.splice(d-1,1)}}}while(f<i){if(e){b=h.rows[f]}if($(b).hasClass("jqgrow")){$('td[role="gridcell"]',b).each(function(j){$(this).removeClass("coral-gridcell-error coral-validate-error").removeAttr("data-errors")})}f++}this.options.isValid=!(this.errorResults.length>0)},getCellErrors:function(){return that.errorResults},resizeFrozen:function(){var c=this.options.caption?$(this.grid.cDiv).outerHeight():0,b=$(".coral-grid-htable","#"+$.grid.coralID(this.options.id)).outerHeight();if(this.options.toppager){c=c+$($t.grid.topDiv).outerHeight()}if(this.options.toolbar[0]===true){if(this.options.toolbar[1]!="bottom"){c=c+$(this.grid.uDiv).outerHeight()}}if(this.grid.fhDiv){var a=$("th",this.grid.columnsView).height();$(this.grid.fhDiv).css({top:c});$("th",this.grid.fhDiv).each(function(){$(this).height(a)});$(this.grid.fbDiv).css({top:(parseInt(c,10)+parseInt(b,10))});$(this.grid.fbDiv).height($(this.grid.rowsView).height()-this.getScrollBarWidth()+2)}if(this.grid.rightfhDiv){var a=$("th",this.grid.columnsView).height();
$("th",this.grid.rightfhDiv).each(function(){$(this).height(a)});$(this.grid.rightfhDiv).css({top:c});$(this.grid.rightfbDiv).css({top:(parseInt(c,10)+parseInt(b,10))});$(this.grid.rightfbDiv).height($(this.grid.rowsView).height()-this.getScrollBarWidth()+2)}},setFrozenColumns:function(){if(!this.grid){return}var k=this,r=k.options.colModel,l=0,n=r.length,h=n-1,d=-1,q=-1,a=false;if(k.options.subGrid===true||k.options.treeGrid===true||k.options.cellEdit===true||k.options.sortable||k.options.scroll||k.options.grouping){return}if(k.options.rownumbers){l++}if(k.options.multiselect||k.options.singleselect){l++}while(l<n){if(r[l].frozen===true){a=true;q=l}else{break}l++}while(h>0){if(r[h].frozen===true){a=true;d=h}else{break}h--}if(d>0){q=-1}if(a){var p=k.options.caption?$(k.grid.cDiv).outerHeight():0,o=$(".coral-grid-htable","#"+$.grid.coralID(k.options.id)).outerHeight();if(k.options.toppager){p=p+$(k.grid.topDiv).outerHeight()}if(k.options.toolbar[0]===true){if(k.options.toolbar[1]!="bottom"){p=p+$(k.grid.uDiv).outerHeight()}}if(q>=0){k.grid.fhDiv=$('<div style="position:absolute;left:0px;top:'+p+'px;" class="frozen-div-left coral-state-default coral-grid-columns coral-grid-columns-view"></div>');k.grid.fbDiv=$('<div style="position:absolute;left:0px;top:'+(parseInt(p,10)+parseInt(o,10))+'px;overflow-y:hidden" class="frozen-bdiv coral-grid-rows coral-grid-rows-view"></div>');$("#"+$.grid.coralID(k.options.id)).append(k.grid.fhDiv)}if(d>=0){k.grid.rightfhDiv=$('<div style="position:absolute;right:0;top:'+p+'px;" class="frozen-div-right coral-state-default coral-grid-columns coral-grid-columns-view"></div>');k.grid.rightfbDiv=$('<div style="position:absolute;right:0;top:'+(parseInt(p,10)+parseInt(o,10))+'px;overflow-y:hidden" class="frozen-bdiv coral-grid-rows coral-grid-rows-view"></div>');$("#"+$.grid.coralID(k.options.id)).append(k.grid.rightfhDiv)}var f=$(".coral-grid-htable","#"+$.grid.coralID(k.options.id)).clone(true);var m=$(".coral-grid-htable","#"+$.grid.coralID(k.options.id)).clone(true);
k.rightFrozenWidth=0;if(k.options.groupHeader){if(q>=0){$("tr.jqg-first-row-header, tr.jqg-third-row-header",f).each(function(){$("th:gt("+q+")",this).remove()})}if(d>=0){$("tr.jqg-first-row-header, tr.jqg-third-row-header",m).each(function(){$("th:lt("+d+")",this).remove()})}var b=-1,e=-1;$("tr.jqg-second-row-header th",f).each(function(){var i=parseInt($(this).attr("colspan"),10);if(i){b=b+i;e++}if(b===q){return false}});if(b!==q){e=q}$("tr.jqg-second-row-header",f).each(function(){$("th:gt("+e+")",this).remove()})}else{if(q>=0){$("tr",f).each(function(){$("th:gt("+q+")",this).remove()})}if(d>=0){$("tr",m).each(function(){$("th:lt("+d+")",this).remove();var i=k.getScrollBarWidth()-2;$(this).append("<th style='width:"+i+"px;' class='coral-state-default'>&nbsp;</th>")})}}$(f).width(1);$(m).width(1);if(q>=0){$(k.grid.fhDiv).append(f).mousemove(function(i){if(k.grid.resizing){k.grid.dragMove(i);return false}})}if(d>=0){$(k.grid.rightfhDiv).append(m).mousemove(function(i){if(k.grid.resizing){k.grid.dragMove(i);return false}})}$(k.element).bind("gridonresizestop.setFrozenColumns",function(x,v){var t=v.index,i=v.newWidth;if(q>=0){var u=$(".coral-grid-htable",k.grid.fhDiv);$("th:eq("+t+")",u).width(i);var j=$(".coral-grid-btable",k.grid.fbDiv);$("tr:first td:eq("+t+")",j).width(i)}if(d>=0){var u=$(".coral-grid-htable",k.grid.rightfhDiv);$("th:eq("+(n-t-1)+")",u).width(i);var j=$(".coral-grid-btable",k.grid.rightfbDiv);$("tr:first td:eq("+(n-t-1)+")",j).width(i);k.resetFrozen()}});$(k.element).bind("gridonsortcol.setFrozenColumns",function(u,v){var j=v.id,w=v.colIndex;if(q>=0){var i=$("tr.coral-grid-labels:last th:eq("+k.options.lastsort+")",k.grid.fhDiv),t=$("tr.coral-grid-labels:last th:eq("+w+")",k.grid.fhDiv);$("span.coral-grid-ico-sort",i).addClass("coral-state-disabled");$(i).attr("aria-selected","false");$("span.coral-icon-"+k.options.sortorder,t).removeClass("coral-state-disabled");$(t).attr("aria-selected","true");if(!k.options.viewsortcols[0]){if(k.options.lastsort!=w){$("span.s-ico",i).hide();
$("span.s-ico",t).show()}}}if(d>=0){w=k.grid.headers.length-w-1;var i=$("tr.coral-grid-labels:last th:eq("+k.options.lastsort+")",k.grid.rightfhDiv),t=$("tr.coral-grid-labels:last th:eq("+w+")",k.grid.rightfhDiv);$("span.coral-grid-ico-sort",i).addClass("coral-state-disabled");$(i).attr("aria-selected","false");$("span.coral-icon-"+k.options.sortorder,t).removeClass("coral-state-disabled");$(t).attr("aria-selected","true");if(!k.options.viewsortcols[0]){if(k.options.lastsort!=w){$("span.s-ico",i).hide();$("span.s-ico",t).show()}}}});if(q>=0){$("#"+$.grid.coralID(k.options.id)).append(k.grid.fbDiv)}if(d>=0){$("#"+$.grid.coralID(k.options.id)).append(k.grid.rightfbDiv)}jQuery(k.grid.rowsView).scroll(function(){if(q>=0){jQuery(k.grid.fbDiv).scrollTop(jQuery(this).scrollTop())}if(d>=0){jQuery(k.grid.rightfbDiv).scrollTop(jQuery(this).scrollTop())}});var c=0,g=0,s=0;if(q>=0){$(k.grid.fbDiv).mousewheel(function(j,t){var i=-(j.deltaY*j.deltaFactor);g=$(k.grid.rowsView).scrollTop();c=g;c=c+i;$(k.grid.rowsView).scrollTop(c);s=$(k.grid.rowsView).scrollTop();if(s==g){c=c-i}else{j.preventDefault()}})}if(d>=0){$(k.grid.rightfbDiv).mousewheel(function(j,t){var i=-(j.deltaY*j.deltaFactor);g=$(k.grid.rowsView).scrollTop();c=g;c=c+i;$(k.grid.rowsView).scrollTop(c);s=$(k.grid.rowsView).scrollTop();if(s==g){c=c-i}else{j.preventDefault()}})}if(k.options.hoverrows===true){$("#"+$.grid.coralID(k.options.id)).unbind("mouseover").unbind("mouseout")}$(k.element).bind("gridaftercomplete.setFrozenColumns",function(){$("#"+$.grid.coralID(k.options.id)+"_frozen").remove();var i,j;if(q>=0){i=$("#"+$.grid.coralID(k.options.id)+"_table").clone(true);jQuery(k.grid.fbDiv).height(jQuery(k.grid.rowsView).height()-k.getScrollBarWidth()+2);$("tr",i).each(function(){$("td:gt("+q+")",this).remove();!k.options.singleselect||$("td:eq(0)>input",this).attr("name",$("td:eq(0)>input",this).attr("name")+"_forzen")});$(i).width(1).attr("id",k.options.id+"_frozen");$(k.grid.fbDiv).append(i);if(k.options.hoverrows===true){$("tr.jqgrow",i).hover(function(){$(this).addClass("coral-state-hover");
$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).removeClass("coral-state-hover")});$("tr.jqgrow","#"+$.grid.coralID(k.options.id)).hover(function(){$(this).addClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").removeClass("coral-state-hover")})}i=null}if(d>=0){if(($(k.grid.rowsView)[0].scrollHeight-$(k.grid.rowsView)[0].clientHeight)>0){k.grid.rightfbDiv.css({right:(k.getScrollBarWidth()-2)+"px"})}j=$("#"+$.grid.coralID(k.options.id)+"_table").clone(true);jQuery(k.grid.rightfbDiv).height(jQuery(k.grid.rowsView).height()-k.getScrollBarWidth()+2);$("tr",j).each(function(){$("td:lt("+d+")",this).remove();!k.options.singleselect||$("td:eq(0)>input",this).attr("name",$("td:eq(0)>input",this).attr("name")+"_forzen")});$(j).width(1).attr("id",k.options.id+"_frozen");$(k.grid.rightfbDiv).append(j);if(k.options.hoverrows===true){$("tr.jqgrow",j).hover(function(){$(this).addClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).removeClass("coral-state-hover")});$("tr.jqgrow","#"+$.grid.coralID(k.options.id)).hover(function(){$(this).addClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").removeClass("coral-state-hover")})}j=null}});k.options.frozenColumns=true}},destroyFrozenColumns:function(){if(!this.grid){return}if(this.options.frozenColumns===true){var b=this;
$(b.grid.fhDiv).remove();$(b.grid.fbDiv).remove();$(b.grid.rightfhDiv).remove();$(b.grid.rightfbDiv).remove();b.grid.fhDiv=null;b.grid.fbDiv=null;b.grid.rightfhDiv=null;b.grid.rightfbDiv=null;$(this.element).unbind(".setFrozenColumns");if(b.options.hoverrows===true){var a;$("#"+$.grid.coralID(b.options.id)).bind("mouseover",function(c){a=$(c.target).closest("tr.jqgrow");if($(a).attr("class")!=="coral-subgrid"){$(a).addClass("coral-state-hover")}}).bind("mouseout",function(c){a=$(c.target).closest("tr.jqgrow");$(a).removeClass("coral-state-hover")})}this.options.frozenColumns=false}}});$.extend($.grid,{template:function(d){var b=$.makeArray(arguments).slice(1),a,c=b.length;if(d==null){d=""}return d.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(e,h){if(!isNaN(parseInt(h,10))){return b[parseInt(h,10)]}for(a=0;a<c;a++){if($.isArray(b[a])){var g=b[a],f=g.length;while(f--){if(h===g[f].nm){return g[f].v}}}}})}});grid=$.component("coral.grid",$.coral.grid,{groupingSetup:function(){var e=this,d,c,f,b=e.options.colModel,a=e.options.groupingView;if(a!==null&&((typeof a==="object")||$.isFunction(a))){if(!a.groupField.length){e.options.grouping=false}else{if(a.visibiltyOnNextGrouping===undefined){a.visibiltyOnNextGrouping=[]}a.lastvalues=[];if(!a._locgr){a.groups=[]}a.counters=[];for(d=0;d<a.groupField.length;d++){if(!a.groupOrder[d]){a.groupOrder[d]="asc"}if(!a.groupText[d]){a.groupText[d]="{0}"}if(typeof a.groupColumnShow[d]!=="boolean"){a.groupColumnShow[d]=true}if(typeof a.groupSummary[d]!=="boolean"){a.groupSummary[d]=false}if(!a.groupSummaryPos[d]){a.groupSummaryPos[d]="footer"}if(a.groupColumnShow[d]===true){a.visibiltyOnNextGrouping[d]=true;$(this.element).grid("showCol",a.groupField[d])}else{a.visibiltyOnNextGrouping[d]=$("#"+$.grid.coralID(e.options.id+"_"+a.groupField[d])).is(":visible");$(this.element).grid("hideCol",a.groupField[d])}}a.summary=[];if(a.hideFirstGroupCol){a.formatDisplayField[0]=function(g){return g}}for(c=0,f=b.length;c<f;c++){if(a.hideFirstGroupCol){if(!b[c].hidden&&a.groupField[0]===b[c].name){b[c].formatter=function(){return""
}}}if(b[c].summaryType){if(b[c].summaryDivider){a.summary.push({nm:b[c].name,st:b[c].summaryType,v:"",sd:b[c].summaryDivider,vd:"",sr:b[c].summaryRound,srt:b[c].summaryRoundType||"round"})}else{a.summary.push({nm:b[c].name,st:b[c].summaryType,v:"",sr:b[c].summaryRound,srt:b[c].summaryRoundType||"round"})}}}}}else{this.options.grouping=false}},groupingPrepare:function(c,e){var d=this,k=this.options.groupingView,b,j=k.groupField.length,l,h,g,f,a=0;for(b=0;b<j;b++){l=k.groupField[b];g=k.displayField[b];h=c[l];f=g==null?null:c[g];if(f==null){f=h}if(h!==undefined){if(e===0){k.groups.push({idx:b,dataIndex:l,value:h,displayValue:f,startRow:e,cnt:1,summary:[]});k.lastvalues[b]=h;k.counters[b]={cnt:1,pos:k.groups.length-1,summary:$.extend(true,[],k.summary)};$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}else{if(typeof h!=="object"&&($.isArray(k.isInTheSameGroup)&&$.isFunction(k.isInTheSameGroup[b])?!k.isInTheSameGroup[b].call(this,k.lastvalues[b],h,b,k):k.lastvalues[b]!==h)){k.groups.push({idx:b,dataIndex:l,value:h,displayValue:f,startRow:e,cnt:1,summary:[]});k.lastvalues[b]=h;a=1;k.counters[b]={cnt:1,pos:k.groups.length-1,summary:$.extend(true,[],k.summary)};$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}else{if(a===1){k.groups.push({idx:b,dataIndex:l,value:h,displayValue:f,startRow:e,cnt:1,summary:[]});k.lastvalues[b]=h;
k.counters[b]={cnt:1,pos:k.groups.length-1,summary:$.extend(true,[],k.summary)};$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}else{k.counters[b].cnt+=1;k.groups[k.counters[b].pos].cnt=k.counters[b].cnt;$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}}}}}return this},groupingToggle:function(b){var e=this,g=e.options.groupingView,s=b.split("_"),f=parseInt(s[s.length-2],10);s.splice(s.length-2,2);var d=s.join("_"),a=g.minusicon,q=g.plusicon,p=$("#"+$.grid.coralID(b)),j=p.length?p[0].nextSibling:null,h=$("#"+$.grid.coralID(b)+" span.tree-wrap-"+e.options.direction),o=function(r){var t=$.map(r.split(" "),function(u){if(u.substring(0,d.length+1)===d+"_"){return parseInt(u.substring(d.length+1),10)}});return t.length>0?t[0]:undefined},n,i,c=false,k=e.options.frozenColumns?e.options.id+"_frozen":false,l=k?$("#"+$.grid.coralID(b),"#"+$.grid.coralID(k)):false,m=(l&&l.length)?l[0].nextSibling:null;if(h.hasClass(a)){if(g.showSummaryOnHide){if(j){while(j){n=o(j.className);if(n!==undefined&&n<=f){break}$(j).hide();j=j.nextSibling;if(k){$(m).hide();m=m.nextSibling}}}}else{if(j){while(j){n=o(j.className);if(n!==undefined&&n<=f){break}$(j).hide();j=j.nextSibling;if(k){$(m).hide();m=m.nextSibling}}}}h.removeClass(a).addClass(q);c=true}else{if(j){i=undefined;while(j){n=o(j.className);if(i===undefined){i=n===undefined}if(n!==undefined){if(n<=f){break
}if(n===f+1){$(j).show().find(">td>span.tree-wrap-"+e.options.direction).removeClass(a).addClass(q);if(k){$(m).show().find(">td>span.tree-wrap-"+e.options.direction).removeClass(a).addClass(q)}}}else{if(i){$(j).show();if(k){$(m).show()}}}j=j.nextSibling;if(k){m=m.nextSibling}}}h.removeClass(q).addClass(a)}this._trigger("onClickGroup",null,[{headId:b,collapsed:c}]);return false},groupingRender:function(s,g,d,j){var h=this,i=h.options.groupingView,o="",r="",c,b,l=i.groupCollapse?i.plusicon:i.minusicon,k,f=[],p=i.groupField.length;l+=" tree-wrap-"+h.options.direction;$.each(h.options.colModel,function(t,v){var u;for(u=0;u<p;u++){if(i.groupField[u]===v.name){f[u]=t;break}}});var m=0;function e(w,x,t){var u=false,v;if(x===0){u=t[w]}else{var y=t[w].idx;if(y===0){u=t[w]}else{for(v=w;v>=0;v--){if(t[v].idx===y-x){u=t[v];break}}}}return u}function a(v,A,D,y){var w=e(v,A,D),B=h.options.colModel,z,C=w.cnt,x="",u;for(u=y;u<g;u++){var t="<td "+h._formatCol(u,1,"")+">&#160;</td>",E="{0}";$.each(w.summary,function(){if(this.nm===B[u].name){if(B[u].summaryTpl){E=B[u].summaryTpl}if(typeof this.st==="string"&&this.st.toLowerCase()==="avg"){if(this.sd&&this.vd){this.v=(this.v/this.vd)}else{if(this.v&&C>0){this.v=(this.v/C)}}}try{this.groupCount=w.cnt;this.groupIndex=w.dataIndex;this.groupValue=w.value;z=this.formatter("",this.v,u,this)}catch(F){z=this.v}t="<td "+h._formatCol(u,1,"")+">"+$.grid.format(E,z)+"</td>";return false}});x+=t}return x}var n=$.makeArray(i.groupSummary),q;n.reverse();q=h.options.multiselect?' colspan="2"':"";$.each(i.groups,function(y,v){if(i._locgr){if(!(v.startRow+v.cnt>(d-1)*j&&v.startRow<d*j)){return true}}m++;b=h.options.id+"ghead_"+v.idx;c=b+"_"+y;r="<span style='cursor:pointer;' class='icon "+l+"' onclick=\"jQuery('#"+$.grid.coralID(h.options.id)+"').grid('groupingToggle','"+c+"');return false;\"></span>";try{if($.isArray(i.formatDisplayField)&&$.isFunction(i.formatDisplayField[v.idx])){v.displayValue=i.formatDisplayField[v.idx].call(this,v.displayValue,v.value,h.options.colModel[f[v.idx]],v.idx,i);
k=v.displayValue}else{k=this.formatter(c,v.displayValue,f[v.idx],v.value)}}catch(E){k=v.displayValue}if(i.groupSummaryPos[v.idx]==="header"){o+='<tr id="'+c+'"'+(i.groupCollapse&&v.idx>0?' style="display:none;" ':" ")+'role="row" class= "coral-component-content jqgroup coral-row-'+h.options.direction+" "+b+'"><td style="padding-left:'+(v.idx*12)+'px;"'+q+">"+r+$.grid.template(i.groupText[v.idx],k,v.cnt,v.summary)+"</td>";o+=a(y,0,i.groups,i.groupColumnShow[v.idx]===false?(q===""?2:3):((q==="")?1:2));o+="</tr>"}else{o+='<tr id="'+c+'"'+(i.groupCollapse&&v.idx>0?' style="display:none;" ':" ")+'role="row" class= "coral-component-content jqgroup coral-row-'+h.options.direction+" "+b+'"><td style="padding-left:'+(v.idx*12)+'px;" colspan="'+(i.groupColumnShow[v.idx]===false?g-1:g)+'">'+r+$.grid.template(i.groupText[v.idx],k,v.cnt,v.summary)+"</td></tr>"}var A=p-1===v.idx;if(A){var B=i.groups[y+1],t,D,x=0,u=v.startRow,w=B!==undefined?B.startRow:i.groups[y].startRow+i.groups[y].cnt;if(i._locgr){x=(d-1)*j;if(x>v.startRow){u=x}}for(t=u;t<w;t++){if(!s[t-x]){break}o+=s[t-x].join("")}if(i.groupSummaryPos[v.idx]!=="header"){var z;if(B!==undefined){for(z=0;z<i.groupField.length;z++){if(B.dataIndex===i.groupField[z]){break}}m=i.groupField.length-z}for(D=0;D<m;D++){if(!n[D]){continue}var C="";if(i.groupCollapse&&!i.showSummaryOnHide){C=' style="display:none;"'}o+="<tr"+C+' jqfootlevel="'+(v.idx-D)+'" role="row" class="coral-component-content jqfoot coral-row-'+h.options.direction+'">';o+=a(y,D,i.groups,0);o+="</tr>"}m=z}}});$("#"+$.grid.coralID(h.options.id)+" tbody:first").append(o);o=null},groupingGroupBy:function(c,b){var e=this;if(typeof c==="string"){c=[c]}var a=e.options.groupingView;e.options.grouping=true;if(a.visibiltyOnNextGrouping===undefined){a.visibiltyOnNextGrouping=[]}var d;for(d=0;d<a.groupField.length;d++){if(!a.groupColumnShow[d]&&a.visibiltyOnNextGrouping[d]){$(this).grid("showCol",a.groupField[d])}}for(d=0;d<c.length;d++){a.visibiltyOnNextGrouping[d]=$("#"+$.grid.coralID(e.options.id)+"_"+$.grid.coralID(c[d])).is(":visible")
}e.options.groupingView=$.extend(e.options.groupingView,b||{});a.groupField=c;$(this).trigger("reloadGrid")},groupingRemove:function(d){var c=this;if(d===undefined){d=true}c.options.grouping=false;if(d===true){var a=c.options.groupingView,b;for(b=0;b<a.groupField.length;b++){if(!a.groupColumnShow[b]&&a.visibiltyOnNextGrouping[b]){$(this).grid("showCol",a.groupField)}}$("tr.jqgroup, tr.jqfoot","#"+$.grid.coralID(c.options.id)+" tbody:first").remove();$("tr.jqgrow:hidden","#"+$.grid.coralID(c.options.id)+" tbody:first").show()}else{$(this).trigger("reloadGrid")}},groupingCalculations:{handler:function(e,h,f,i,g,a){var b={sum:function(){return parseFloat(h||0)+parseFloat((a[f]||0))},min:function(){if(h===""){return parseFloat(a[f]||0)}return Math.min(parseFloat(h),parseFloat(a[f]||0))},max:function(){if(h===""){return parseFloat(a[f]||0)}return Math.max(parseFloat(h),parseFloat(a[f]||0))},count:function(){if(h===""){h=0}if(a.hasOwnProperty(f)){return h+1}return 0},avg:function(){return b.sum()}};if(!b[e]){throw ("grid Grouping No such method: "+e)}var d=b[e]();if(i!=null){if(g==="fixed"){d=d.toFixed(i)}else{var c=Math.pow(10,i);d=Math.round(d*c)/c}}return d}}});

function _pivotfilter(d,c){var b,f,a=[],e;if(!this||typeof d!=="function"||(d instanceof RegExp)){throw new TypeError()}e=this.length;for(b=0;b<e;b++){if(this.hasOwnProperty(b)){f=this[b];if(d.call(c,f,b,this)){a.push(f);break}}}return a}$.assocArraySize=function(c){var b=0,a;for(a in c){if(c.hasOwnProperty(a)){b++}}return b};$.component("coral.grid",$.coral.grid,{pivotSetup:function(f,k){var d=[],h=this,i=[],j=[],e=[],g=[],a={grouping:true,groupingView:{groupField:[],groupSummary:[],groupSummaryPos:[]}},c=[],b=$.extend({rowTotals:false,rowTotalsText:"Total",colTotals:false,groupSummary:true,groupSummaryPos:"header",frozenStaticCols:false},k||{});this.element.each(function(){var t,q,J,Q=f.length,D,K,E,O,u,z=0;function B(S,R,r){var T;T=_pivotfilter.call(S,R,r);return T.length>0?T[0]:null}function s(U,S){var R=0,r=true,T;for(T in U){if(U[T]!=h[R]){r=false;break}R++;if(R>=h.length){break}}if(r){q=S}return r}function x(U,r,T,S){var R;switch(U){case"sum":R=parseFloat(r||0)+parseFloat((S[T]||0));break;case"count":if(r===""||r==null){r=0}if(S.hasOwnProperty(T)){R=r+1}else{R=0}break;case"min":if(r===""||r==null){R=parseFloat(S[T]||0)}else{R=Math.min(parseFloat(r),parseFloat(S[T]||0))}break;case"max":if(r===""||r==null){R=parseFloat(S[T]||0)}else{R=Math.max(parseFloat(r),parseFloat(S[T]||0))}break}return R}function P(ac,T,aa,ad){var R=T.length,V,Z,U,ab,S="",W=[];if($.isArray(aa)){ab=aa.length;W=aa}else{ab=1;W[0]=aa}e=[];g=[];e.root=0;for(U=0;U<ab;U++){var Y=[],r;for(V=0;V<R;V++){if(aa==null){Z=$.trim(T[V].member)+"_"+T[V].aggregator;r=Z;W[0]=r}else{r=aa[U].replace(/\s+/g,"");try{Z=(R===1?S+r:S+r+"_"+T[V].aggregator+"_"+String(V))}catch(X){}}Z=!isNaN(parseInt(Z,10))?Z+" ":Z;ad[Z]=Y[Z]=x(T[V].aggregator,ad[Z],T[V].member,ac);if(U<=1&&r!=="_r_Totals"&&S===""){S=r}}e[Z]=Y;g[Z]=W[U]}return ad}if(b.rowTotals&&b.yDimension.length>0){var G=b.yDimension[0].dataName;b.yDimension.splice(0,0,{dataName:G});b.yDimension[0].converter=function(){return"_r_Totals"}}D=$.isArray(b.xDimension)?b.xDimension.length:0;
K=b.yDimension.length;E=$.isArray(b.aggregates)?b.aggregates.length:0;if(D===0||E===0){throw ("xDimension or aggregates optiona are not set!")}var L;for(J=0;J<D;J++){L={name:b.xDimension[J].dataName,frozen:b.frozenStaticCols};if(b.xDimension[J].isGroupField==null){b.xDimension[J].isGroupField=true}L=$.extend(true,L,b.xDimension[J]);d.push(L)}var H=D-1,y={};while(z<Q){t=f[z];var F=[];var M=[];O={};J=0;do{F[J]=$.trim(t[b.xDimension[J].dataName]);O[b.xDimension[J].dataName]=F[J];J++}while(J<D);var I=0;q=-1;u=B(i,s,F);if(!u){I=0;if(K>=1){for(I=0;I<K;I++){M[I]=$.trim(t[b.yDimension[I].dataName]);if(b.yDimension[I].converter&&$.isFunction(b.yDimension[I].converter)){M[I]=b.yDimension[I].converter.call(this,M[I],F,M)}}O=P(t,b.aggregates,M,O)}else{if(K===0){O=P(t,b.aggregates,null,O)}}i.push(O)}else{if(q>=0){I=0;if(K>=1){for(I=0;I<K;I++){M[I]=$.trim(t[b.yDimension[I].dataName]);if(b.yDimension[I].converter&&$.isFunction(b.yDimension[I].converter)){M[I]=b.yDimension[I].converter.call(this,M[I],F,M)}}u=P(t,b.aggregates,M,u)}else{if(K===0){u=P(t,b.aggregates,null,u)}}i[q]=u}}var p=0,C=null,A=null,o;for(o in e){if(e.hasOwnProperty(o)){if(p===0){if(!y.children||y.children===undefined){y={text:o,level:0,children:[],label:o}}C=y.children}else{A=null;for(J=0;J<C.length;J++){if(C[J].text===o){A=C[J];break}}if(A){C=A.children}else{C.push({children:[],text:o,level:p,fields:e[o],label:g[o]});C=C[C.length-1].children}}p++}}z++}var n=[],l=d.length,w=l;if(K>0){c[K-1]={useColSpanStyle:false,groupHeaders:[]}}function N(X){var U,W,Z,V,R;for(Z in X){if(X.hasOwnProperty(Z)){if(typeof X[Z]!=="object"){if(Z==="level"){if(n[X.level]===undefined){n[X.level]="";if(X.level>0&&X.text!=="_r_Totals"){c[X.level-1]={useColSpanStyle:false,groupHeaders:[]}}}if(n[X.level]!==X.text&&X.children.length&&X.text!=="_r_Totals"){if(X.level>0){c[X.level-1].groupHeaders.push({titleText:X.label,numberOfColumns:0});var r=c[X.level-1].groupHeaders.length-1,T=r===0?w:l+E;if(X.level-1===(b.rowTotals?1:0)){if(r>0){var S=c[X.level-1].groupHeaders[r-1].numberOfColumns;
if(S){T=S+1+b.aggregates.length}}}c[X.level-1].groupHeaders[r].startColumnName=d[T].name;c[X.level-1].groupHeaders[r].numberOfColumns=d.length-T;l=d.length}}n[X.level]=X.text}if(X.level===K&&Z==="level"&&K>0){if(E>1){var Y=1;for(U in X.fields){if(Y===1){c[K-1].groupHeaders.push({startColumnName:U,numberOfColumns:1,titleText:X.text})}Y++}c[K-1].groupHeaders[c[K-1].groupHeaders.length-1].numberOfColumns=Y-1}else{c.splice(K-1,1)}}}if(X[Z]!=null&&typeof X[Z]==="object"){N(X[Z])}if(Z==="level"){if(X.level>0){W=0;for(U in X.fields){if(X.fields.hasOwnProperty(U)){R={};for(V in b.aggregates[W]){if(b.aggregates[W].hasOwnProperty(V)){switch(V){case"member":case"label":case"aggregator":break;default:R[V]=b.aggregates[W][V]}}}if(E>1){R.name=U;R.label=b.aggregates[W].label||X.label}else{R.name=X.text;R.label=X.text==="_r_Totals"?b.rowTotalsText:X.label}d.push(R);W++}}}}}}}N(y);var m;if(b.colTotals){var v=i.length;while(v--){for(J=D;J<d.length;J++){m=d[J].name;if(!j[m]){j[m]=parseFloat(i[v][m]||0)}else{j[m]+=parseFloat(i[v][m]||0)}}}}if(H>0){for(J=0;J<H;J++){if(d[J].isGroupField){a.groupingView.groupField.push(d[J].name);a.groupingView.groupSummary.push(b.groupSummary);a.groupingView.groupSummaryPos.push(b.groupSummaryPos)}}}else{a.grouping=false}a.sortname=d[H].name;a.groupingView.hideFirstGroupCol=true});return{colModel:d,rows:i,groupOptions:a,groupHeaders:c,summary:j}},jqPivot:function(e,f,a,c){var d=this;function b(l){var h=d.pivotSetup(l,f),m=$.assocArraySize(h.summary)>0?true:false,k=$.grid.from(h.rows),j;for(j=0;j<h.groupOptions.groupingView.groupField.length;j++){k.orderBy(h.groupOptions.groupingView.groupField[j],"a","text","")}$.extend(true,d.options,{data:k.select(),userData:m?h.summary:{},datatype:"local",footerrow:m,userDataOnFooter:m,colModel:h.colModel,viewrecords:true,groupHeader:true,groupHeaders:f.rowTotals?h.groupHeaders[1]&&h.groupHeaders[1].groupHeaders:h.groupHeaders[0]&&h.groupHeaders[0].groupHeaders,sortname:f.xDimension[0].dataName},h.groupOptions,a||{});var g=h.groupHeaders;
if(f.frozenStaticCols){$(this.element).grid("setFrozenColumns")}}if(typeof e==="string"){$.ajax($.extend({url:data,dataType:"json",success:function(g){b($.grid.getAccessor(g,c&&c.reader?c.reader:"rows"))}},ajaxOpt||{}))}else{b(e)}}});

$.extend($.grid,{showModal:function(a){a.w.show()},closeModal:function(a){a.w.hide().attr("aria-hidden","true");if(a.o){a.o.remove()}},hideModal:function(a,d){d=$.extend({jqm:true,gb:""},d||{});if(d.onClose){var b=d.onClose(a);if(typeof b=="boolean"&&!b){return}}if($.fn.jqm&&d.jqm===true){$(a).attr("aria-hidden","true").jqmHide()}else{if(d.gb!==""){try{$(".jqgrid-overlay:first",d.gb).hide()}catch(c){}}$(a).hide().attr("aria-hidden","true")}},findPos:function(b){var c=0,a=0;if(b.offsetParent){do{c+=b.offsetLeft;a+=b.offsetTop}while(b=b.offsetParent)}return[c,a]},createModal:function(h,o,l,a,u,b,g){var j=document.createElement("div"),q,k=this;g=$.extend({},g||{});q=$(l.gbox).attr("dir")=="rtl"?true:false;j.className="coral-component coral-component-content coral-corner-all coral-jqdialog";j.id=h.themodal;var t=document.createElement("div");t.className="coral-jqdialog-titlebar coral-component-header coral-corner-all coral-helper-clearfix";t.id=h.modalhead;$(t).append("<span class='coral-jqdialog-title'>"+l.caption+"</span>");var m=$("<a href='javascript:void(0)' class='coral-jqdialog-titlebar-close coral-corner-all'></a>").hover(function(){m.addClass("coral-state-hover")},function(){m.removeClass("coral-state-hover")}).append("<span class='coral-icon coral-icon-closethick'></span>");$(t).append(m);if(q){j.dir="rtl";$(".coral-jqdialog-title",t).css("float","right");$(".coral-jqdialog-titlebar-close",t).css("left",0.3+"em")}else{j.dir="ltr";$(".coral-jqdialog-title",t).css("float","left");$(".coral-jqdialog-titlebar-close",t).css("right",0.3+"em")}var v=document.createElement("div");$(v).addClass("coral-jqdialog-content coral-component-content").attr("id",h.modalcontent);$(v).append(o);j.appendChild(v);$(j).prepend(t);if(b===true){$("body").append(j)}else{if(typeof b=="string"){$(b).append(j)}else{$(j).insertBefore(a)}}$(j).css(g);if(typeof l.jqModal==="undefined"){l.jqModal=true}var n={};if($.fn.jqm&&l.jqModal===true){if(l.left===0&&l.top===0&&l.overlay){var c=[];c=this.findPos(u);
l.left=c[0]+4;l.top=c[1]+4}n.top=l.top+"px";n.left=l.left}else{if(l.left!==0||l.top!==0){n.left=l.left;n.top=l.top+"px"}}$("a.coral-jqdialog-titlebar-close",t).click(function(){var e=$("#"+$.grid.jqID(h.themodal)).data("onClose")||l.onClose;var p=$("#"+$.grid.jqID(h.themodal)).data("gbox")||l.gbox;k.hideModal("#"+$.grid.jqID(h.themodal),{gb:p,jqm:l.jqModal,onClose:e});return false});if(l.width===0||!l.width){l.width=300}if(l.height===0||!l.height){l.height=200}if(!l.zIndex){var d=$(a).parents("*[role=dialog]").filter(":first").css("z-index");if(d){l.zIndex=parseInt(d,10)+2}else{l.zIndex=950}}var f=0;if(q&&n.left&&!b){f=$(l.gbox).width()-(!isNaN(l.width)?parseInt(l.width,10):0)-8;n.left=parseInt(n.left,10)+parseInt(f,10)}if(n.left){n.left+="px"}$(j).css($.extend({width:isNaN(l.width)?"auto":l.width+"px",height:isNaN(l.height)?"auto":l.height+"px",zIndex:l.zIndex,overflow:"hidden"},n)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":h.modalhead,"aria-hidden":"true"});if(typeof l.drag=="undefined"){l.drag=true}if(typeof l.resize=="undefined"){l.resize=true}if(l.drag){$(t).css("cursor","move");if($.fn.jqDrag){$(j).jqDrag(t)}else{try{$(j).draggable({handle:$("#"+$.grid.jqID(t.id))})}catch(s){}}}if(l.resize){if($.fn.jqResize){$(j).append("<div class='jqResize coral-resizable-handle coral-resizable-se coral-icon coral-icon-gripsmall-diagonal-se coral-icon-grip-diagonal-se'></div>");$("#"+$.grid.jqID(h.themodal)).jqResize(".jqResize",h.scrollelm?"#"+$.grid.jqID(h.scrollelm):false)}else{try{$(j).resizable({handles:"se, sw",alsoResize:h.scrollelm?"#"+$.grid.jqID(h.scrollelm):false})}catch(i){}}}if(l.closeOnEscape===true){$(j).keydown(function(r){if(r.which==27){var p=$("#"+$.grid.jqID(h.themodal)).data("onClose")||l.onClose;k.hideModal(this,{gb:l.gbox,jqm:l.jqModal,onClose:p})}})}},viewModal:function(a,c){c=$.extend({toTop:true,overlay:10,modal:false,overlayClass:"coral-component-overlay",onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:true,jqM:true},c||{});if($.fn.jqm&&c.jqm===true){if(c.jqM){$(a).attr("aria-hidden","false").jqm(c).jqmShow()
}else{$(a).attr("aria-hidden","false").jqmShow()}}else{if(c.gbox!==""){$(".jqgrid-overlay:first",c.gbox).show();$(a).data("gbox",c.gbox)}$(a).show().attr("aria-hidden","false");try{$(":input:visible",a)[0].focus()}catch(b){}}},info_dialog:function(p,j,b,o){var l={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+p+"</b>",left:250,top:170,zIndex:1000,jqModal:true,modal:false,closeOnEscape:true,align:"center",buttonalign:"center",buttons:[]};$.extend(l,o||{});var d=l.jqModal,q=this;if($.fn.jqm&&!d){d=false}var g="";if(l.buttons.length>0){for(var f=0;f<l.buttons.length;f++){if(typeof l.buttons[f].id=="undefined"){l.buttons[f].id="info_button_"+f}g+="<a href='javascript:void(0)' id='"+l.buttons[f].id+"' class='fm-button coral-state-default coral-corner-all'>"+l.buttons[f].text+"</a>"}}var k=isNaN(l.dataheight)?l.dataheight:l.dataheight+"px",n="text-align:"+l.align+";";var a="<div id='info_id'>";a+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+k+";"+n+"'>"+j+"</div>";a+=b?"<div class='coral-component-content coral-helper-clearfix' style='text-align:"+l.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button coral-state-default coral-corner-all'>"+b+"</a>"+g+"</div>":g!==""?"<div class='coral-component-content coral-helper-clearfix' style='text-align:"+l.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+g+"</div>":"";a+="</div>";try{if($("#info_dialog").attr("aria-hidden")=="false"){this.hideModal("#info_dialog",{jqm:d})}$("#info_dialog").remove()}catch(h){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},a,l,"","",true);if(g){$.each(l.buttons,function(e){$("#"+$.grid.jqID(this.id),"#info_id").bind("click",function(){l.buttons[e].onClick.call($("#info_dialog"));
return false})})}$("#closedialog","#info_id").click(function(){q.hideModal("#info_dialog",{jqm:d});return false});$(".fm-button","#info_dialog").hover(function(){$(this).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover")});if($.isFunction(l.beforeOpen)){l.beforeOpen()}this.viewModal("#info_dialog",{onHide:function(e){e.w.hide().remove();if(e.o){e.o.remove()}},modal:l.modal,jqm:d});if($.isFunction(l.afterOpen)){l.afterOpen()}try{$("#info_dialog").focus()}catch(c){}},createEl:function(d,f,u,j,s){var t="",o=this;function k(i,e){if($.isFunction(e.dataInit)){e.dataInit.call(o,i)}if(e.dataEvents){$.each(e.dataEvents,function(){if(this.data!==undefined){$(i).bind(this.type,this.data,this.fn)}else{$(i).bind(this.type,this.fn)}})}return e}function q(y,i,e){if(!i.hasOwnProperty("id")){$(y).attr("id",$.grid.randId())}}switch(d){case"textarea":t=document.createElement("textarea");if(j){if(!f.cols){$(t).css({width:"98%"})}}else{if(!f.cols){f.cols=20}}if(!f.rows){f.rows=2}if(u=="&nbsp;"||u=="&#160;"||(u.length==1&&u.charCodeAt(0)==160)){u=""}t.value=u;q(t,f);$(t).attr({role:"textbox",multiline:"true"});break;case"select":t=document.createElement("select");t.setAttribute("role","select");var c,g=[];if(f.multiple===true){c=true;t.multiple="multiple";$(t).attr("aria-multiselectable","true")}else{c=false}if(typeof(f.dataUrl)!="undefined"){$.ajax($.extend({url:f.dataUrl,type:"GET",dataType:"html",context:{elem:t,options:f,vl:u},success:function(D){var y,i=[],C=this.elem,B=this.vl,z=$.extend({},this.options),A=z.multiple===true;if($.isFunction(z.buildSelect)){var e=z.buildSelect.call(o,D);y=$(e).html()}else{y=$(D).html()}if(y){$(C).append(y);q(C,z);if(typeof z.size==="undefined"){z.size=A?3:1}if(A){i=B.split(",");i=$.map(i,function(E){return $.trim(E)})}else{i[0]=$.trim(B)}setTimeout(function(){$("option",C).each(function(E){if(E===0&&C.multiple){this.selected=false}$(this).attr("role","option");if($.inArray($.trim($(this).text()),i)>-1||$.inArray($.trim($(this).val()),i)>-1){this.selected="selected"
}})},0)}}},s||{}))}else{if(f.value){var n;if(typeof f.size==="undefined"){f.size=c?3:1}if(c){g=u.split(",");g=$.map(g,function(e){return $.trim(e)})}if(typeof f.value==="function"){f.value=f.value()}var p,m,h,l=f.separator===undefined?":":f.separator,v=f.delimiter===undefined?";":f.delimiter;if(typeof f.value==="string"){p=f.value.split(v);for(n=0;n<p.length;n++){m=p[n].split(l);if(m.length>2){m[1]=$.map(m,function(i,e){if(e>0){return i}}).join(l)}h=document.createElement("option");h.setAttribute("role","option");h.value=m[0];h.innerHTML=m[1];t.appendChild(h);if(!c&&($.trim(m[0])==$.trim(u)||$.trim(m[1])==$.trim(u))){h.selected="selected"}if(c&&($.inArray($.trim(m[1]),g)>-1||$.inArray($.trim(m[0]),g)>-1)){h.selected="selected"}}}else{if(typeof f.value==="object"){var b=f.value;for(var x in b){if(b.hasOwnProperty(x)){h=document.createElement("option");h.setAttribute("role","option");h.value=x;h.innerHTML=b[x];t.appendChild(h);if(!c&&($.trim(x)==$.trim(u)||$.trim(b[x])==$.trim(u))){h.selected="selected"}if(c&&($.inArray($.trim(b[x]),g)>-1||$.inArray($.trim(x),g)>-1)){h.selected="selected"}}}}}q(t,f,["value"])}}break;case"datepicker":case"autocomplete":case"autocompletetree":case"text":case"password":case"button":var w;if(d=="button"){w="button"}else{w="textbox"}t=document.createElement("input");if(d=="datepicker"){t.type="text"}else{if(d=="autocomplete"){t.type="text"}else{t.type=d}}t.value=u;q(t,f);if(d!="button"){if(j){if(!f.size){$(t).css({width:"98%"})}}else{if(!f.size){f.size=20}}}$(t).attr("role",w);break;case"image":case"file":t=document.createElement("input");t.type=d;q(t,f);break;case"custom":t=document.createElement("span");try{if($.isFunction(f.custom_element)){var a=f.custom_element.call(o,u,f);if(a){a=$(a).addClass("customelement").attr({id:f.id,name:f.name});$(t).empty().append(a)}else{throw"e2"}}else{throw"e1"}}catch(r){if(r=="e1"){this.info_dialog($.grid.errors.errcap,"function 'custom_element' "+$.grid.edit.msg.nodefined,$.grid.edit.bClose)}if(r=="e2"){this.info_dialog($.grid.errors.errcap,"function 'custom_element' "+$.grid.edit.msg.novalue,$.grid.edit.bClose)
}else{this.info_dialog($.grid.errors.errcap,typeof(r)==="string"?r:r.message,$.grid.edit.bClose)}}break;case"checkbox":t=document.createElement("input");t.type=d;t.value=u;q(t,f);break;case"combobox":case"combotree":case"combogrid":t=document.createElement("input");t.type="text";t.value=u;q(t,f);break;default:break}return t},checkDate:function(n,c){var l=function(i){return(((i%4===0)&&(i%100!==0||(i%400===0)))?29:28)},k=function(q){for(var j=1;j<=q;j++){this[j]=31;if(j==4||j==6||j==9||j==11){this[j]=30}if(j==2){this[j]=29}}return this};var e={},p;n=n.toLowerCase();if(n.indexOf("/")!=-1){p="/"}else{if(n.indexOf("-")!=-1){p="-"}else{if(n.indexOf(".")!=-1){p="."}else{p="/"}}}n=n.split(p);c=c.split(p);if(c.length!=3){return false}var g=-1,o,f=-1,d=-1;for(var h=0;h<n.length;h++){var b=isNaN(c[h])?0:parseInt(c[h],10);e[n[h]]=b;o=n[h];if(o.indexOf("y")!=-1){g=h}if(o.indexOf("m")!=-1){d=h}if(o.indexOf("d")!=-1){f=h}}if(n[g]=="y"||n[g]=="yyyy"){o=4}else{if(n[g]=="yy"){o=2}else{o=-1}}var a=k(12),m;if(g===-1){return false}else{m=e[n[g]].toString();if(o==2&&m.length==1){o=1}if(m.length!=o||(e[n[g]]===0&&c[g]!="00")){return false}}if(d===-1){return false}else{m=e[n[d]].toString();if(m.length<1||e[n[d]]<1||e[n[d]]>12){return false}}if(f===-1){return false}else{m=e[n[f]].toString();if(m.length<1||e[n[f]]<1||e[n[f]]>31||(e[n[d]]==2&&e[n[f]]>l(e[n[g]]))||e[n[f]]>a[e[n[d]]]){return false}}return true},isEmpty:function(a){if(a.match(/^\s+$/)||a===""){return true}else{return false}},checkTime:function(c){var b=/^(\d{1,2}):(\d{2})([ap]m)?$/,a;if(!this.isEmpty(c)){a=c.match(b);if(a){if(a[3]){if(a[1]<1||a[1]>12){return false}}else{if(a[1]>23){return false}}if(a[2]>59){return false}}else{return false}}return true},checkValues:function(c,o,k,p,h){var f,j,q,b,l;if(typeof(p)==="undefined"){if(typeof(o)=="string"){for(j=0,l=k.options.colModel.length;j<l;j++){if(k.options.colModel[j].name==o){f=k.options.colModel[j].editrules;o=j;try{q=k.options.colModel[j].formoptions.label}catch(n){}break}}}else{if(o>=0){f=k.options.colModel[o].editrules
}}}else{f=p;q=h===undefined?"_":h}if(f){if(!q){q=k.options.colNames[o]}if(f.required===true){if(this.isEmpty(c)){return[false,q+": "+$.grid.edit.msg.required,""]}}var d=f.required===false?false:true;if(f.number===true){if(!(d===false&&this.isEmpty(c))){if(isNaN(c)){return[false,q+": "+$.grid.edit.msg.number,""]}}}if(typeof f.minValue!="undefined"&&!isNaN(f.minValue)){if(parseFloat(c)<parseFloat(f.minValue)){return[false,q+": "+$.grid.edit.msg.minValue+" "+f.minValue,""]}}if(typeof f.maxValue!="undefined"&&!isNaN(f.maxValue)){if(parseFloat(c)>parseFloat(f.maxValue)){return[false,q+": "+$.grid.edit.msg.maxValue+" "+f.maxValue,""]}}var a;if(f.email===true){if(!(d===false&&this.isEmpty(c))){a=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!a.test(c)){return[false,q+": "+$.grid.edit.msg.email,""]}}}if(f.integer===true){if(!(d===false&&this.isEmpty(c))){if(isNaN(c)){return[false,q+": "+$.grid.edit.msg.integer,""]}if((c%1!==0)||(c.indexOf(".")!=-1)){return[false,q+": "+$.grid.edit.msg.integer,""]}}}if(f.date===true){if(!(d===false&&this.isEmpty(c))){if(k.options.colModel[o].formatoptions&&k.options.colModel[o].formatoptions.newformat){b=k.options.colModel[o].formatoptions.newformat
}else{b=k.options.colModel[o].datefmt||"Y-m-d"}if(!this.checkDate(b,c)){return[false,q+": "+$.grid.edit.msg.date+" - "+b,""]}}}if(f.time===true){if(!(d===false&&this.isEmpty(c))){if(!this.checkTime(c)){return[false,q+": "+$.grid.edit.msg.date+" - hh:mm (am/pm)",""]}}}if(f.url===true){if(!(d===false&&this.isEmpty(c))){a=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!a.test(c)){return[false,q+": "+$.grid.edit.msg.url,""]}}}if(f.custom===true){if(!(d===false&&this.isEmpty(c))){if($.isFunction(f.custom_func)){var m=f.custom_func.call(k,c,q);if($.isArray(m)){return m}else{return[false,$.grid.edit.msg.customarray,""]}}else{return[false,$.grid.edit.msg.customfcheck,""]}}}}return[true,"",""]}});

$.component("coral.grid",$.coral.grid,{editCell:function(e,c,f){var h=this,b,s,n,i;if(!h.grid||h.options.cellEdit!==true){return}c=parseInt(c,10);if(!h.options.knv){$(h.element).grid("GridNav")}if(h.options.savedRow.length>0){if(f===true){if(e==h.options.iRow&&c==h.options.iCol){return}}if(h.rows[h.options.savedRow[0].id]){if(!$(h.element).grid("saveCell",h.options.savedRow[0].id,h.options.savedRow[0].ic)){return}}}else{window.setTimeout(function(){$("#"+$.grid.coralID(h.options.knv)).attr("tabindex","-1").focus()},0)}i=h.options.colModel[c];b=i.name;if(b=="subgrid"||b=="cb"||b=="rn"){return}n=$("td:eq("+c+")",h.rows[e]);if(i.editable===true&&f===true&&!n.hasClass("not-editable-cell")){if(parseInt(h.options.iCol,10)>=0&&parseInt(h.options.iRow,10)>=0){$("td:eq("+h.options.iCol+")",h.rows[h.options.iRow]).removeClass("edit-cell coral-state-highlight");$(h.rows[h.options.iRow]).removeClass("selected-row coral-state-hover")}$(n).addClass("edit-cell coral-state-highlight");$(h.rows[e]).addClass("selected-row coral-state-hover");try{s=$.unformat.call(h,n,{rowId:h.rows[e].id,colModel:i},c)}catch(t){s=(i.edittype&&i.edittype=="textarea")?$(n).text():$(n).html()}if(h.options.autoencode){s=$.grid.htmlDecode(s)}if(!h._trigger("beforeEditCell",null,[{rowId:h.rows[e].id,name:b,cellValue:s,rowIndex:e,cellIndex:c}])){return}h.options.savedRow.push({id:e,ic:c,name:b,value:s});if(s==="&nbsp;"||s==="&#160;"||(s.length===1&&s.charCodeAt(0)===160)){s=""}if($.isFunction(h.options.formatCell)){var o=h.options.formatCell.call(h,h.rows[e].id,b,s,e,c);if(o!==undefined){s=o}}var u=i.editoptions,q={id:e+"_"+b,name:b};u=$.extend({},u||{},q);var m=$.grid.createEl.call(h,i.edittype,u,s,true,$.extend({},$.grid.ajaxOptions,h.options.ajaxSelectOptions||{}));$(n).html("").append(m).attr("tabindex","0");var a=function(v){if(v.keyCode===27){if($("input.hasDatepicker",n).length>0){if($(".coral-datepicker").is(":hidden")){$(h.element).grid("restoreCell",e,c)}else{$("input.hasDatepicker",n).datepicker("hide")
}}else{$(h.element).grid("restoreCell",e,c)}}if(v.keyCode===13){$(h.element).grid("saveCell",e,c);return false}if(v.keyCode===9){if(!h.grid.columnsView.loading){if(v.shiftKey){$(h.element).grid("prevCell",e,c)}else{$(h.element).grid("nextCell",e,c)}}else{return false}}v.stopPropagation()};var g={onKeyDown:a,value:$(m).val()},d=i.edittype,k=$(h.element).grid("getRowData",h.rows[e].id);switch(i.edittype){case"text":case"textarea":u=$.extend({},u,g);$(m).textbox(u);break;case"datepicker":u=$.extend({},u,g);$(m).datepicker(u);break;case"radio":u=$.extend({},u,g);$(m).radio(u);if($(m).val()=="Yes"){$(m).radio("check")}else{$(m).radio("uncheck")}break;case"checkbox":u=$.extend({},u,g);$(m).checkbox(u);if($(m).val()=="Yes"){$(m).checkbox("check")}else{$(m).checkbox("uncheck")}break;case"autocomplete":var p=$(m).val();var j=typeof(u.source)=="string";u=$.extend({},u,g);var r=u.postMode||"value";u.postMode=r;u=$.extend({},u,{onKeyDown:a});$(m).autocomplete(u);if(j){u.postMode="text";$(m).autocomplete(u);$(m).autocomplete("setValue",p)}else{if(r=="value"){$(m).autocomplete("setValue",p)}else{$(m).autocomplete("setValue",p);$(m).autocomplete("setText",p)}}break;case"combobox":case"combotree":case"combogrid":u=$.extend({},u,g);if(i.cellEditoptions){var l=h.getCellEditOptions(i,$(m).val(),u,k,q,g)}d=l&&l.type?l.type:i.edittype;u=l&&l.cOpts?l.cOpts:u;d=d=="text"?"textbox":d;$(m)[d](u);break}window.setTimeout(function(){$(m).focus()},0);h._trigger("afterEditCell",null,[{rowId:h.rows[e].id,name:b,cellValue:s,rowIndex:e,celIndex:c}])}else{if(parseInt(h.options.iCol,10)>=0&&parseInt(h.options.iRow,10)>=0){$("td:eq("+h.options.iCol+")",h.rows[h.options.iRow]).removeClass("edit-cell coral-state-highlight");$(h.rows[h.options.iRow]).removeClass("selected-row coral-state-hover")}n.addClass("edit-cell coral-state-highlight");$(h.rows[e]).addClass("selected-row coral-state-hover");s=n.html().replace(/\&#160\;/ig,"");$(h.element).triggerHandler("jqGridSelectCell",[h.rows[e].id,b,s,e,c]);if($.isFunction(h.options.onSelectCell)){h.options.onSelectCell.call(h,h.rows[e].id,b,s,e,c)
}}h.options.iCol=c;h.options.iRow=e},getCellEditOptions:function(c,f,g,b,a,h){var d=$.coral.toFunction(c.cellEditoptions).call(this,f,g,b);var e=d&&d.type?d.type:c.edittype;d=d&&d.cellEditoptions?$.extend({},d.cellEditoptions,a,h):g;g=d||g;return{cOpts:d,type:e}},GridNav:function(){var f=this;if(!f.grid||f.options.cellEdit!==true){return}f.options.knv=f.options.id+"_kn";var e=$("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+f.options.knv+"'></span></span>"),c,b;function d(o,m,n){if(n.substr(0,1)=="v"){var g=$(f.grid.rowsView)[0].clientHeight,p=$(f.grid.rowsView)[0].scrollTop,q=f.rows[o].offsetTop+f.rows[o].clientHeight,k=f.rows[o].offsetTop;if(n=="vd"){if(q>=g){$(f.grid.rowsView)[0].scrollTop=$(f.grid.rowsView)[0].scrollTop+f.rows[o].clientHeight}}if(n=="vu"){if(k<p){$(f.grid.rowsView)[0].scrollTop=$(f.grid.rowsView)[0].scrollTop-f.rows[o].clientHeight}}}if(n=="h"){var j=$(f.grid.rowsView)[0].clientWidth,i=$(f.grid.rowsView)[0].scrollLeft,h=f.rows[o].cells[m].offsetLeft+f.rows[o].cells[m].clientWidth,l=f.rows[o].cells[m].offsetLeft;if(h>=j+parseInt(i,10)){$(f.grid.rowsView)[0].scrollLeft=$(f.grid.rowsView)[0].scrollLeft+f.rows[o].cells[m].clientWidth}else{if(l<i){$(f.grid.rowsView)[0].scrollLeft=$(f.grid.rowsView)[0].scrollLeft-f.rows[o].cells[m].clientWidth}}}}function a(k,g){var j,h;if(g=="lft"){j=k+1;for(h=k;h>=0;h--){if(f.options.colModel[h].hidden!==true){j=h;break}}}if(g=="rgt"){j=k-1;for(h=k;h<f.options.colModel.length;h++){if(f.options.colModel[h].hidden!==true){j=h;break}}}return j}$(e).insertBefore(f.grid.columnsView);$("#"+f.options.knv).focus().keydown(function(g){b=g.keyCode;if(f.options.direction=="rtl"){if(b===37){b=39}else{if(b===39){b=37}}}switch(b){case 38:if(f.options.iRow-1>0){d(f.options.iRow-1,f.options.iCol,"vu");$(f.element).grid("editCell",f.options.iRow-1,f.options.iCol,false)}break;case 40:if(f.options.iRow+1<=f.rows.length-1){d(f.options.iRow+1,f.options.iCol,"vd");
$(f.element).grid("editCell",f.options.iRow+1,f.options.iCol,false)}break;case 37:if(f.options.iCol-1>=0){c=a(f.options.iCol-1,"lft");d(f.options.iRow,c,"h");$(f.element).grid("editCell",f.options.iRow,c,false)}break;case 39:if(f.options.iCol+1<=f.options.colModel.length-1){c=a(f.options.iCol+1,"rgt");d(f.options.iRow,c,"h");$(f.element).grid("editCell",f.options.iRow,c,false)}break;case 13:if(parseInt(f.options.iCol,10)>=0&&parseInt(f.options.iRow,10)>=0){$(f.element).grid("editCell",f.options.iRow,f.options.iCol,true)}break;default:return true}return false})},saveCell:function(f,d){var h=this,g;if(!h.grid||h.options.cellEdit!==true){return}if(h.options.savedRow.length>=1){g=0}else{g=null}if(g!==null){var q=$("td:eq("+d+")",h.rows[f]),o,a,j=h.options.colModel[d],b=j.name,i=$.grid.coralID(b);if(this.options.autoValid){var x=this.valid(h.rows[f].id,j.name);if(!this.options.allowSaveOnError&&!x){$.message("请确认是否输入正确！");return x}}var r=j.edittype;if(j.cellEditoptions){var n=$(h.element).grid("getRowData",h.rows[f].id),w=$("#"+f+"_"+i,h.rows[f]),z=$.coral.toFunction(j.cellEditoptions).call(this,$(w).val(),j.editoptions,n);r=z&&z.type?z.type:r}switch(r){case"select":if(!j.editoptions.multiple){o=$("#"+f+"_"+i+" option:selected",h.rows[f]).val();a=$("#"+f+"_"+i+" option:selected",h.rows[f]).text()}else{var w=$("#"+f+"_"+i,h.rows[f]),u=[];o=$(w).val();if(o){o.join(",")}else{o=""}$("option:selected",w).each(function(e,v){u[e]=$(v).text()});a=u.join(",")}if(j.formatter){a=o}break;case"checkbox":var s=["Yes","No"];if(j.editoptions){s=j.editoptions.value.split(":")}o=$("#"+f+"_"+i,h.rows[f]).is(":checked")?s[0]:s[1];a=o;break;case"password":case"text":case"textarea":o=$("#"+f+"_"+i,h.rows[f]).val();a=o;break;case"button":o=$("#"+f+"_"+i,h.rows[f]).val();a=o;break;case"custom":try{if(j.editoptions&&$.isFunction(j.editoptions.custom_value)){o=j.editoptions.custom_value.call(h,$(".customelement",q),"get");if(o===undefined){throw"e2"}else{a=o}}else{throw"e1"}}catch(y){if(y=="e1"){$.grid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)
}if(y=="e2"){$.grid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{$.grid.info_dialog(jQuery.jgrid.errors.errcap,y.message,jQuery.jgrid.edit.bClose)}}break;case"datepicker":o=$("#"+f+"_"+i,h.rows[f]).val();a=o;var C=$("#"+f+"_"+i,h.rows[f]);break;case"combobox":case"combogrid":case"combotree":o=$("#"+f+"_"+i,h.rows[f])[r]("getValues").toString();a=$("#"+f+"_"+i,h.rows[f])[r]("getText");if(j.formatter){a=o}break;case"autocomplete":a=$("#"+f+"_"+i,h.rows[f])[r]("getText");if(typeof(j.editoptions.source)=="string"){o=a}else{o=$("#"+f+"_"+i,h.rows[f])[r]("getValue")}if(j.formatter&&j.postMode=="value"){a=o}break}if(a!==h.options.savedRow[g].value){var B=$(h).triggerHandler("jqGridBeforeSaveCell",[h.rows[f].id,b,o,f,d]);if(B){o=B;a=B}if($.isFunction(h.options.beforeSaveCell)){var t=h.options.beforeSaveCell.call(h,h.rows[f].id,b,o,f,d);if(t){o=t;a=t}}var c=$.grid.checkValues(o,d,h);if(c[0]===true){var l=$(h).triggerHandler("jqGridBeforeSubmitCell",[h.rows[f].id,b,o,f,d])||{};if($.isFunction(h.options.beforeSubmitCell)){l=h.options.beforeSubmitCell.call(h,h.rows[f].id,b,o,f,d);if(!l){l={}}}if($("input.hasDatepicker",q).length>0){$("input.hasDatepicker",q).datepicker("hide")}if(h.options.cellsubmit=="remote"){if(h.options.cellurl){var A={};if(h.options.autoencode){o=$.grid.htmlEncode(o)}A[b]=o;var p,m,k;k=h.options.prmNames;p=k.id;m=k.oper;A[p]=$.grid.stripPref(h.options.idPrefix,h.rows[f].id);A[m]=k.editoper;A=$.extend(l,A);$("#lui_"+$.grid.coralID(h.options.id)).show();h.grid.columnsView.loading=true;$.ajax($.extend({url:h.options.cellurl,data:$.isFunction(h.options.serializeCellData)?h.options.serializeCellData.call(h,A):A,type:"POST",complete:function(e,D){$("#lui_"+h.options.id).hide();h.grid.columnsView.loading=false;if(D=="success"){var v=$(h).triggerHandler("jqGridAfterSubmitCell",[h,e,A.id,b,o,f,d])||[true,""];if(v[0]===true&&$.isFunction(h.options.afterSubmitCell)){v=h.options.afterSubmitCell.call(h,e,A.id,b,o,f,d)
}if(v[0]===true){$(q).empty();$(h.element).grid("setCell",h.rows[f].id,d,a,false,false,true);$(q).addClass("dirty-cell");$(h.rows[f]).addClass("edited");$(h).triggerHandler("jqGridAfterSaveCell",[h.rows[f].id,b,o,f,d]);if($.isFunction(h.options.afterSaveCell)){h.options.afterSaveCell.call(h,h.rows[f].id,b,o,f,d)}h.options.savedRow.splice(0,1)}else{$.grid.info_dialog($.grid.errors.errcap,v[1],$.grid.edit.bClose);$(h.element).grid("restoreCell",f,d)}}},error:function(e,v,D){$("#lui_"+$.grid.coralID(h.options.id)).hide();h.grid.columnsView.loading=false;$(h).triggerHandler("jqGridErrorCell",[e,v,D]);if($.isFunction(h.options.errorCell)){h.options.errorCell.call(h,e,v,D);$(h.element).grid("restoreCell",f,d)}else{$.grid.info_dialog($.grid.errors.errcap,e.status+" : "+e.statusText+"<br/>"+v,$.grid.edit.bClose);$(h.element).grid("restoreCell",f,d)}}},$.grid.ajaxOptions,h.options.ajaxCellOptions||{}))}else{try{$.grid.info_dialog($.grid.errors.errcap,$.grid.errors.nourl,$.grid.edit.bClose);$(h.element).grid("restoreCell",f,d)}catch(y){}}}if(h.options.cellsubmit=="clientArray"){$(q).empty();$(h.element).grid("setCell",h.rows[f].id,d,a,false,false,true);$(q).addClass("dirty-cell");$(h.rows[f]).addClass("edited");h._trigger("afterSaveCell",null,[{rowId:h.rows[f].id,name:b,cellValue:o,rowIndex:f,celIndex:d}]);h.options.savedRow.splice(0,1)}}else{try{window.setTimeout(function(){$.grid.info_dialog($.grid.errors.errcap,o+" "+c[1],$.grid.edit.bClose)},100);$(h.element).grid("restoreCell",f,d)}catch(y){}}}else{$(h.element).grid("restoreCell",f,d)}}if(false){$("#"+$.grid.coralID(h.options.knv)).attr("tabindex","-1").focus()}else{window.setTimeout(function(){$("#"+$.grid.coralID(h.options.knv)).attr("tabindex","-1").focus()},0)}},restoreCell:function(d,b){var c=this,a;if(!c.grid||c.options.cellEdit!==true){return}if(c.options.savedRow.length>=1){a=0}else{a=null}if(a!==null){var e=$("td:eq("+b+")",c.rows[d]);$(e).empty().attr("tabindex","-1");$(c.element).grid("setCell",c.rows[d].id,b,c.options.savedRow[a].value,false,false,true);
$(c).triggerHandler("jqGridAfterRestoreCell",[c.rows[d].id,c.options.savedRow[a].value,d,b]);if($.isFunction(c.options.afterRestoreCell)){c.options.afterRestoreCell.call(c,c.rows[d].id,c.options.savedRow[a].value,d,b)}c.options.savedRow.splice(0,1)}window.setTimeout(function(){$("#"+c.options.knv).attr("tabindex","-1").focus()},0)},nextCell:function(d,a){var c=this,e=false;if(!c.grid||c.options.cellEdit!==true){return}for(var b=a+1;b<c.options.colModel.length;b++){if(c.options.colModel[b].editable===true){e=b;break}}if(e!==false){$(c.element).grid("editCell",d,e,true)}else{if(c.options.savedRow.length>0){$(c.element).grid("saveCell",d,a)}}},prevCell:function(d,a){var c=this,e=false;if(!c.grid||c.options.cellEdit!==true){return}for(var b=a-1;b>=0;b--){if(c.options.colModel[b].editable===true){e=b;break}}if(e!==false){$(c.element).grid("editCell",d,e,true)}else{if(c.options.savedRow.length>0){$(c.element).grid("saveCell",d,a)}}},getChangedCells:function(e){var b=[];if(!e){e="all"}var c=this,a,d=true;if(!c.grid||c.options.cellEdit!==true){return}$(c.rows).each(function(f){var g={};if($(this).hasClass("edited")){$("td",this).each(function(h){a=c.options.colModel[h].name;if(a!=="cb"&&a!=="subgrid"){if($(this).hasClass("coral-gridcell-error")){d=false;return false}if(e=="dirty"){if($(this).hasClass("dirty-cell")){try{g[a]=$.unformat.call(c,this,{rowId:c.rows[f].id,colModel:c.options.colModel[h]},h)}catch(j){g[a]=$.jgrid.htmlDecode($(this).html())}}}else{try{g[a]=$.unformat.call(c,this,{rowId:c.rows[f].id,colModel:c.options.colModel[h]},h)}catch(j){g[a]=$.jgrid.htmlDecode($(this).html())}}}});if(!d){return false}g.id=this.id;b.push(g)}});if(!d){b=[]}return b}});

"use strict";$.coral.grid.inlineEdit=$.coral.grid.inlineEdit||{};$.component("coral.grid",$.coral.grid,{editButtonsPos:function(d,c){var g=this,b,f,a,e;b=$(g.element).grid("getDataIDs");f=$(g.element).grid("getInd",d,true);e=g.element.find(".coral-grid-rows-view").outerHeight();a=g.element.find(".coral-grid-btable").outerHeight();if((a+$(f).outerHeight()>e)&&d==b[b.length-1]){c.position({my:"left-"+(c.outerWidth()/2)+" top-2",at:"right-"+($(f).outerWidth()/2)+" top-"+($(c).outerHeight()),collision:"fit",of:$(f)})}else{c.position({my:"left-"+(c.outerWidth()/2)+" top-2",at:"right-"+($(f).outerWidth()/2)+" top+"+($(f).outerHeight()),collision:"fit",of:$(f)})}},editRow:function(g,q,A,f,d,e,l,j,a){var t={},c=$.makeArray(arguments).slice(1);if($.type(c[0])==="object"){t=c[0]}else{if(typeof q!=="undefined"){t.keys=q}if($.isFunction(A)){t.oneditfunc=A}if($.isFunction(f)){t.successfunc=f}if(typeof d!=="undefined"){t.url=d}if(typeof e!=="undefined"){t.extraparam=e}if($.isFunction(l)){t.aftersavefunc=l}if($.isFunction(j)){t.errorfunc=j}if($.isFunction(a)){t.afterrestorefunc=a}}t=$.extend(true,{keys:true,oneditfunc:null,successfunc:null,url:"clientArray",extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:true,mtype:"POST"},$.coral.grid.inlineEdit,t);var x=this,b,y,u,v=0,s=null,k={},n,m;if(!x.grid){return}n=$(x.element).grid("getInd",g,true);x.options.editrow=g;x.editRowIndex=g;if(n===false){return}u=$(n).attr("editable")||"0";if(x._trigger("beforeInlineEditRow",null,[{rowId:g,options:t}])==false){return}if(u=="0"&&!$(n).hasClass("not-editable-row")){if(this.options.rowEditButtons){var z=$("<div class='row-editable coral-grid-rows'><div class='row-editable-btns coral-state-highlight'><div class='grid_edit_toolbar'></div></div></div>");var p=[];var h={type:"button",id:"update",label:$.grid.edit.bUpdate,name:"update",onClick:function(){var i=x.saveRow(n.id,null,"clientArray")}};var r={type:"button",id:"cancel",label:$.grid.edit.bCancel,name:"cancel",onClick:function(){x.restoreRow(n.id);
z.remove();x._trigger("afterInlineCancelRow",null,[{rowId:n.id,options:t,isUpdated:!$(n.id).hasClass("new-row")}])}};if(this.options.rowEditButtons.length===0){this.options.rowEditButtons=["update","cancel"]}for(var w=0;w<this.options.rowEditButtons.length;w++){if(this.options.rowEditButtons[w]=="update"){p.push(h)}else{if(this.options.rowEditButtons[w]=="cancel"){p.push(r)}else{p.push(this.options.rowEditButtons[w])}}}this.rowEditButtons=z;x.element.find(".row-editable").remove();x.element.find(".coral-grid-view").prepend(z[0]);$(".grid_edit_toolbar",x.element).toolbar({data:p});this._delay(function(){this.editButtonsPos(g,z)})}m=x.options.colModel;$('td[role="gridcell"]',n).each(function(F){b=m[F].name;var G=x.options.treeGrid===true&&b==x.options.ExpandColumn;if(G){y=$("span:first",this).html()}else{try{y=$.unformat.call(x,this,{rowId:g,colModel:m[F]},F)}catch(K){y=(m[F].edittype&&m[F].edittype=="textarea")?$(this).text():$(this).html()}}if(b!="cb"&&b!="subgrid"&&b!="rn"){if(x.options.autoencode){y=$.grid.htmlDecode(y)}k[b]=y;if(m[F].editable===true){if(s===null){s=F}if(G){$("span:first",this).html("")}else{$(this).html("")}var B=$.extend({},m[F].editoptions||{},{id:g+"_"+b,name:b});if(!m[F].edittype){m[F].edittype="text"}if(y=="&nbsp;"||y=="&#160;"||(y.length==1&&y.charCodeAt(0)==160)){y=""}var o=$.grid.createEl.call(x,m[F].edittype,B,y,false,$.extend({},$.grid.ajaxOptions,x.options.ajaxSelectOptions||{}));$(o).addClass("editable");if(G){$("span:first",this).append(o)}else{$(this).append(o)}var C=m[F].editoptions||{};var D=C.postMode||"value";$.extend(C,{onValidError:function(M,i){$(o).parents("td").addClass("coral-gridcell-error");M.stopPropagation()},onValidSuccess:function(M,i){$(o).parents("td").removeClass("coral-gridcell-error");M.stopPropagation()},onKeyDown:function(M,i){},onClick:function(M,i){M.stopPropagation()},dataCustom:{rowId:g,gridId:x.options.id}});var J=m[F].edittype;switch(J){case"autocomplete":var I=$(o).val();var L=typeof(C.source)=="string";
var H=C.onSelect;C=$.extend({},C,{onSelect:function(M,i){$(o).closest("td").attr("data-org",L?i.value:i.text);H&&H.apply(o,[M,i])}});if(L){C.postMode="text";$(o).autocomplete(C);$(o).autocomplete("setValue",I)}else{$(o).autocomplete(C);if(D=="value"){$(o).autocomplete("setValue",I)}else{$(o).autocomplete("setValue",I);$(o).autocomplete("setText",I)}}break;case"checkbox":$(o).checkbox(C);var E=["Yes","No"];if(C&&C.value){E=C.value.split(":")}if($(o).val()==E[0]){$(o).checkbox("check")}else{$(o).checkbox("uncheck")}break;case"combogrid":case"combobox":case"combotree":$(o)[J](C);$(o)[J]("setValues",$(o).val().split(","));break;case"text":case"textarea":$(o)["textbox"](C);break;default:$(o)[J](C);break}v++}}});if(v>0){k.id=g;x.options.savedRow.push(k);$(n).attr("editable","1");$("td:eq("+s+") input",n).focus();if(t.keys===true){$(n).bind("keydown",function(o){if(o.keyCode===27){$(x.element).grid("restoreRow",g,t.afterrestorefunc);if(x.options._inlinenav){try{$(x.element).grid("showAddEditButtons")}catch(C){}}return false}if(o.keyCode===13){var i=o.target;if(i.tagName=="TEXTAREA"){return true}if($(x.element).grid("saveRow",g,t)){if(x.options._inlinenav){try{$(x.element).grid("showAddEditButtons")}catch(B){}}}return false}})}x._trigger("onInlineEditRow",null,[{rowId:g,options:t}])}}},saveRow:function(j,h,f,g,p,m,a){var c=$.makeArray(arguments).slice(1),y={};if($.type(c[0])==="object"){y=c[0]}else{if($.isFunction(h)){y.successfunc=h}if(typeof f!=="undefined"){y.url=f}if(typeof g!=="undefined"){y.extraparam=g}if($.isFunction(p)){y.aftersavefunc=p}if($.isFunction(m)){y.errorfunc=m}if($.isFunction(a)){y.afterrestorefunc=a}}y=$.extend(true,{successfunc:null,url:null,extraparam:{},aftersavefunc:null,errorfunc:null,afterrestorefunc:null,restoreAfterError:true,mtype:"POST"},$.grid.inlineEdit,y);var l=false;var C=this,b,E={},x={},w={},z,i,d,s;if(!C.grid){return l}s=$(C.element).grid("getInd",j,true);if(s===false){return l}if(this.options.autoValid){var B=this.valid(s.id);if(!this.options.allowSaveOnError&&!B){$.message("请确认是否输入正确！");
return B}}z=$(s).attr("editable");y.url=y.url?y.url:C.options.editurl;y.url=y.url?y.url:"clientArray";if(z==="1"){var q;$('td[role="gridcell"]',s).each(function(o){q=C.options.colModel[o];b=q.name;if(b!="cb"&&b!="subgrid"&&q.editable===true&&b!="rn"&&!$(this).hasClass("not-editable-cell")){var F=q.edittype;switch(F){case"checkbox":var k=["Yes","No"];if(q.editoptions){k=q.editoptions.value.split(":")}E[b]=$("input",this).is(":checked")?k[0]:k[1];break;case"datepicker":E[b]=$("input[type='hidden']",this).val();break;case"autocomplete":if(typeof(q.editoptions.source)=="string"){E[b]=$(".ctrl-init-"+F,this)[F]("getText")}else{E[b]=$(".ctrl-init-"+F,this)[F]("getValue")}break;case"text":case"password":case"textarea":case"button":E[b]=$("input, textarea",this).val();break;case"combogrid":case"combobox":case"combotree":E[b]=$(".ctrl-init-"+F,this)[F]("getValues").toString();x[b]=$(".ctrl-init-"+F,this)[F]("getText");if(q.formatter&&q.formatter==F){x={}}break;case"custom":try{if(q.editoptions&&$.isFunction(q.editoptions.custom_value)){E[b]=q.editoptions.custom_value.call(C,$(".customelement",this),"get");if(E[b]===undefined){throw"e2"}}else{throw"e1"}}catch(G){if(G=="e1"){$.grid.info_dialog($.grid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.nodefined,$.grid.edit.bClose)}if(G=="e2"){$.grid.info_dialog($.grid.errors.errcap,"function 'custom_value' "+$.grid.edit.msg.novalue,$.grid.edit.bClose)}else{$.grid.info_dialog($.grid.errors.errcap,G.message,$.grid.edit.bClose)}}break}d=$.grid.checkValues(E[b],o,C);if(d[0]===false){d[1]=E[b]+" "+d[1];return false}if(C.options.autoencode){E[b]=$.grid.htmlEncode(E[b])}if(y.url!=="clientArray"&&q.editoptions){if(E[b]===""){w[b]="null"}}}});if(d[0]===false){try{var n=$.grid.findPos($("#"+$.grid.coralID(j),C.grid.bDiv)[0]);$.grid.info_dialog($.grid.errors.errcap,d[1],$.grid.edit.bClose,{left:n[0],top:n[1]})}catch(D){alert(d[1])}return l}var u,r,t;r=C.options.prmNames;t=r.oper;if(C.options.keyName===false){u=r.id}else{u=C.options.keyName
}if(E){E[t]=r.editoper;E[u]=j;if(typeof(C.options.inlineData)=="undefined"){C.options.inlineData={}}E=$.extend({},E,C.options.inlineData,y.extraparam)}if(y.url=="clientArray"){if(C.options.autoencode){$.each(E,function(k,e){E[k]=$.grid.htmlDecode(e)})}var v=$(C.element).grid("setRowData",j,E);$(s).attr("editable","0");for(var A=0;A<C.options.savedRow.length;A++){if(C.options.savedRow[A].id==j){i=A;break}}if(i>=0){C.options.savedRow.splice(i,1)}l=v;if(l){C.options.editrow=null}if(C.options.rowEditButtons){C.rowEditButtons.hide()}C._trigger("afterInlineSaveRow",null,[{rowId:j,options:y,status:v}]);if($.isFunction(y.aftersavefunc)){y.aftersavefunc.call(C,j,v)}$(s).unbind("keydown")}else{$("#lui_"+$.grid.coralID(C.options.id)).show();w=$.extend({},E,w);w[u]=$.grid.stripPref(C.options.idPrefix,w[u]);$.ajax($.extend({url:y.url,data:$.isFunction(C.options.serializeRowData)?C.options.serializeRowData.call(C,w):w,type:y.mtype,async:false,complete:function(F,G){$("#lui_"+$.grid.coralID(C.options.id)).hide();if(G==="success"){var o=true,H;H=C._trigger("inlineSuccessSaveRow",null,[{res:F,rowId:j,options:y}]);if(!$.isArray(H)){H=[true,E]}if(H[0]&&$.isFunction(y.successfunc)){H=y.successfunc.call(C,F)}if($.isArray(H)){o=H[0];E=H[1]?H[1]:E}else{o=H}if(o===true){if(C.options.autoencode){$.each(E,function(I,k){E[I]=$.grid.htmlDecode(k)})}E=$.extend({},E,x);$(C.element).grid("setRowData",j,E);$(s).attr("editable","0");for(var e=0;e<C.options.savedRow.length;e++){if(C.options.savedRow[e].id==j){i=e;break}}if(i>=0){C.options.savedRow.splice(i,1)}$(C).triggerHandler("gridInlineAfterSaveRow",[j,F,E,y]);if($.isFunction(y.aftersavefunc)){y.aftersavefunc.call(C,j,F)}l=true;C.options.editrow=null;if(C.rowEditButtons){C.rowEditButtons.hide()}C._trigger("afterInlineSaveRow",null,[{rowId:j,options:y,status:v}]);$(s).unbind("keydown")}else{$(C).triggerHandler("gridInlineErrorSaveRow",[j,F,G,null,y]);if($.isFunction(y.errorfunc)){y.errorfunc.call(C,j,F,G,null)}if(y.restoreAfterError===true){$(C.element).grid("restoreRow",j,y.afterrestorefunc)
}}}},error:function(k,o,F){$("#lui_"+$.grid.coralID(C.options.id)).hide();$(C).triggerHandler("gridInlineErrorSaveRow",[j,k,o,F,y]);if($.isFunction(y.errorfunc)){y.errorfunc.call(C,j,k,o,F)}else{try{$.grid.info_dialog($.grid.errors.errcap,'<div class="coral-state-error">'+k.responseText+"</div>",$.grid.edit.bClose,{buttonalign:"right"})}catch(G){alert(k.responseText)}}if(y.restoreAfterError===true){$(C.element).grid("restoreRow",j,y.afterrestorefunc)}}},$.grid.ajaxOptions,C.options.ajaxRowOptions||{}))}}if(l){$(s).removeClass("new-row")}return l},restoreRow:function(a,j){var l=$.makeArray(arguments).slice(1),b={};if($.type(l[0])==="object"){b=l[0]}else{if($.isFunction(j)){b.afterrestorefunc=j}}b=$.extend(true,$.grid.inlineEdit,b);var g=this,h,c,f={};if(!g.grid){return}c=$(g.element).grid("getInd",a,true);if(g.options.editrow&&a==g.options.editrow){g.options.editrow=null;g.clearErrors(a)}if(c===false){return}for(var d=0;d<g.options.savedRow.length;d++){if(g.options.savedRow[d].id==a){h=d;break}}if(h>=0){if($.isFunction($.fn.datepicker)){try{$("input.hasDatepicker","#"+$.grid.coralID(c.id)).datepicker("hide")}catch(i){}}$.each(g.options.colModel,function(){if(this.editable===true&&this.name in g.options.savedRow[h]){f[this.name]=g.options.savedRow[h][this.name]}});$(g.element).grid("setRowData",a,f);$(c).attr("editable","0").unbind("keydown");g.options.savedRow.splice(h,1);if($("#"+$.grid.coralID(a),"#"+$.grid.coralID(g.options.id)).hasClass("grid-new-row")){setTimeout(function(){$(g.element).grid("delRowData",a)},0)}}$(g).triggerHandler("gridInlineAfterRestoreRow",[a]);if($.isFunction(b.afterrestorefunc)){b.afterrestorefunc.call(g,a)}if(g.options.rowEditButtons){g.rowEditButtons.hide()}},addRow:function(b){b=$.extend(true,{rowID:"new_row",initdata:{},position:"first",useDefValues:true,useFormatter:false,addRowParams:{extraparam:{}}},b||{});if(!this.grid){return}var d=this;if(b.useDefValues===true){$(d.options.colModel).each(function(){if(this.editoptions&&this.editoptions.defaultValue){var f=this.editoptions.defaultValue,e=$.isFunction(f)?f.call(d):f;
b.initdata[this.name]=e}})}$(d.element).grid("addRowData",b.rowID,b.initdata,b.position);$("#"+$.grid.coralID(b.rowID),"#"+$.grid.coralID(d.options.id)).addClass("grid-new-row");if(b.useFormatter){$("#"+$.grid.coralID(b.rowID)+" .coral-inline-edit","#"+$.grid.coralID(d.options.id)).click()}else{var a=d.options.prmNames,c=a.oper;b.addRowParams.extraparam[c]=a.addoper;$(d.element).grid("editRow",b.rowID,b.addRowParams);$(d.element).grid("setSelection",b.rowID)}},clearEdited:function(b){var a=$(this.getInd(b,true));a.removeClass("edited");a.children("td").removeClass("dirty-cell")},inlineNav:function(a,b){b=$.extend({edit:true,editicon:"coral-icon-pencil",add:true,addicon:"coral-icon-plus",save:true,saveicon:"coral-icon-disk",cancel:true,cancelicon:"coral-icon-cancel",addParams:{useFormatter:false,rowID:"new_row"},editParams:{},restoreAfterSelect:true},$.grid.nav,b||{});return this.each(function(){if(!this.grid){return}var j=this,d,g=$.grid.coralID(j.options.id);j.options._inlinenav=true;if(b.addParams.useFormatter===true){var c=j.options.colModel,f;for(f=0;f<c.length;f++){if(c[f].formatter&&c[f].formatter==="actions"){if(c[f].formatoptions){var h={keys:false,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null},e=$.extend(h,c[f].formatoptions);b.addParams.addRowParams={keys:e.keys,oneditfunc:e.onEdit,successfunc:e.onSuccess,url:e.url,extraparam:e.extraparam,aftersavefunc:e.afterSavef,errorfunc:e.onError,afterrestorefunc:e.afterRestore}}break}}}if(b.add){$(j.element).grid("navButtonAdd",a,{caption:b.addtext,title:b.addtitle,buttonicon:b.addicon,id:j.options.id+"_iladd",onClickButton:function(){$(j.element).grid("addRow",b.addParams);if(!b.addParams.useFormatter){$("#"+g+"_ilsave").removeClass("coral-state-disabled");$("#"+g+"_ilcancel").removeClass("coral-state-disabled");$("#"+g+"_iladd").addClass("coral-state-disabled");$("#"+g+"_iledit").addClass("coral-state-disabled")}}})}if(b.edit){$(j.element).grid("navButtonAdd",a,{caption:b.edittext,title:b.edittitle,buttonicon:b.editicon,id:j.options.id+"_iledit",onClickButton:function(){var i=$(j.element).grid("getGridParam","selrow");
if(i){$(j.element).grid("editRow",i,b.editParams);$("#"+g+"_ilsave").removeClass("coral-state-disabled");$("#"+g+"_ilcancel").removeClass("coral-state-disabled");$("#"+g+"_iladd").addClass("coral-state-disabled");$("#"+g+"_iledit").addClass("coral-state-disabled")}else{$.grid.viewModal("#alertmod",{gbox:"#gbox_"+g,jqm:true});$("#jqg_alrt").focus()}}})}if(b.save){$(j.element).grid("navButtonAdd",a,{caption:b.savetext||"",title:b.savetitle||"Save row",buttonicon:b.saveicon,id:j.options.id+"_ilsave",onClickButton:function(){var k=j.options.savedRow[0].id;if(k){var i=j.options.prmNames,l=i.oper;if(!b.editParams.extraparam){b.editParams.extraparam={}}if($("#"+$.grid.coralID(k),"#"+g).hasClass("grid-new-row")){b.editParams.extraparam[l]=i.addoper}else{b.editParams.extraparam[l]=i.editoper}if($(j.element).grid("saveRow",k,b.editParams)){$(j.element).grid("showAddEditButtons")}}else{$.grid.viewModal("#alertmod",{gbox:"#gbox_"+g,jqm:true});$("#jqg_alrt").focus()}}});$("#"+g+"_ilsave").addClass("coral-state-disabled")}if(b.cancel){$(j.element).grid("navButtonAdd",a,{caption:b.canceltext||"",title:b.canceltitle||"Cancel row editing",buttonicon:b.cancelicon,id:j.options.id+"_ilcancel",onClickButton:function(){var i=j.options.savedRow[0].id;if(i){$(j.element).grid("restoreRow",i,b.editParams);$(j.element).grid("showAddEditButtons")}else{$.grid.viewModal("#alertmod",{gbox:"#gbox_"+g,jqm:true});$("#jqg_alrt").focus()}}});$("#"+g+"_ilcancel").addClass("coral-state-disabled")}if(b.restoreAfterSelect===true){if($.isFunction(j.options.beforeSelectRow)){d=j.options.beforeSelectRow}else{d=false}j.options.beforeSelectRow=function(l,k){var i=true;if(j.options.savedRow.length>0&&j.options._inlinenav===true&&(l!==j.options.selrow&&j.options.selrow!==null)){if(j.options.selrow==b.addParams.rowID){$(j.element).grid("delRowData",j.options.selrow)}else{$(j.element).grid("restoreRow",j.options.selrow,b.editParams)}$(j.element).grid("showAddEditButtons")}if(d){i=d.call(j,l,k)}return i}}})},showAddEditButtons:function(){return this.each(function(){if(!this.grid){return
}var a=$.grid.coralID(this.options.id);$("#"+a+"_ilsave").addClass("coral-state-disabled");$("#"+a+"_ilcancel").addClass("coral-state-disabled");$("#"+a+"_iladd").removeClass("coral-state-disabled");$("#"+a+"_iledit").removeClass("coral-state-disabled")})}});

(function(){$.fmatter={};$.extend($.fmatter,{isBoolean:function(b){return typeof b==="boolean"},isObject:function(b){return(b&&(typeof b==="object"||$.isFunction(b)))||false},isString:function(b){return typeof b==="string"},isNumber:function(b){return typeof b==="number"&&isFinite(b)},isNull:function(b){return b===null},isUndefined:function(b){return typeof b==="undefined"},isValue:function(b){return(this.isObject(b)||this.isString(b)||this.isNumber(b)||this.isBoolean(b))},isEmpty:function(b){if(!this.isString(b)&&this.isValue(b)){return false}else{if(!this.isValue(b)){return true}}b=$.trim(b).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return b===""}});$.fn.fmatter=function(h,i,g,b,c){var d=i;g=$.extend({},$.grid.formatter,g);if(c==="edit"&&h!=="convertCode"&&g.rowId){$("#"+g.rowId,this.element).children("td[aria-describedby$='"+g.colModel.name+"']").attr("data-org",d)}if(c==="edit"&&g.colModel.cellEditoptions){var f=$.coral.toFunction(g.colModel.cellEditoptions).call(this,d,g,b);h=f&&f.type?f.type:h;if(h==="combobox"||h==="combogrid"||h==="combotree"||h==="convertCode"){return $.fn.fmatter.convertCode.call(this,i,g,b,c)}else{return d}}try{d=$.fn.fmatter[h].call(this,i,g,b,c)}catch(e){}return d};$.fmatter.util={NumberFormat:function(d,b){if(!$.fmatter.isNumber(d)){d*=1}if($.fmatter.isNumber(d)){var f=(d<0);var l=d+"";var h=(b.decimalSeparator)?b.decimalSeparator:".";var j;if($.fmatter.isNumber(b.decimalPlaces)){var k=b.decimalPlaces;var e=Math.pow(10,k);l=Math.round(d*e)/e+"";j=l.lastIndexOf(".");if(k>0){if(j<0){l+=h;j=l.length-1}else{if(h!=="."){l=l.replace(".",h)}}while((l.length-1-j)<k){l+="0"}}}if(b.thousandsSeparator){var n=b.thousandsSeparator;j=l.lastIndexOf(h);j=(j>-1)?j:l.length;var m=l.substring(j);var c=-1;for(var g=j;g>0;g--){c++;if((c%3===0)&&(g!==j)&&(!f||(g>1))){m=n+m}m=l.charAt(g-1)+m}l=m}l=(b.prefix)?b.prefix+l:l;l=(b.suffix)?l+b.suffix:l;return l}else{return d}},DateFormat:function(J,M,P,y){var m=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,D=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,L=/[^-+\dA-Z]/g,p=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),f=((typeof M==="string")?M.match(p):null),K=function(j,i){j=String(j);
i=parseInt(i,10)||2;while(j.length<i){j="0"+j}return j},b={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},e=0,r,F,d,E=["i18n"];E.i18n={dayNames:y.dayNames,monthNames:y.monthNames};if(J in y.masks){J=y.masks[J]}if(!isNaN(M-0)&&String(J).toLowerCase()=="u"){e=new Date(parseFloat(M)*1000)}else{if(M.constructor===Date){e=M}else{if(f!==null){e=new Date(parseInt(f[1],10));if(f[3]){var g=Number(f[5])*60+Number(f[6]);g*=((f[4]=="-")?1:-1);g-=e.getTimezoneOffset();e.setTime(Number(Number(e)+(g*60*1000)))}}else{M=String(M).split(/[\\\/:_;.,\t\T\s-]/);J=J.split(/[\\\/:_;.,\t\T\s-]/);for(F=0,d=J.length;F<d;F++){if(J[F]=="M"){r=$.inArray(M[F],E.i18n.monthNames);if(r!==-1&&r<12){M[F]=r+1}}if(J[F]=="F"){r=$.inArray(M[F],E.i18n.monthNames);if(r!==-1&&r>11){M[F]=r+1-12}}if(M[F]){b[J[F].toLowerCase()]=parseInt(M[F],10)}}if(b.f){b.m=b.f}if(b.m===0&&b.y===0&&b.d===0){return"&#160;"}b.m=parseInt(b.m,10)-1;var O=b.y;if(O>=70&&O<=99){b.y=1900+b.y}else{if(O>=0&&O<=69){b.y=2000+b.y}}e=new Date(b.y,b.m,b.d,b.h,b.i,b.s,b.u)}}}if(P in y.masks){P=y.masks[P]}else{if(!P){P="Y-m-d"}}var v=e.getHours(),I=e.getMinutes(),H=e.getDate(),C=e.getMonth()+1,B=e.getTimezoneOffset(),A=e.getSeconds(),x=e.getMilliseconds(),t=e.getDay(),c=e.getFullYear(),l=(t+6)%7+1,q=(new Date(c,C-1,H)-new Date(c,0,1))/86400000,h={d:K(H),D:E.i18n.dayNames[t],j:H,l:E.i18n.dayNames[t+7],N:l,S:y.S(H),w:t,z:q,W:l<5?Math.floor((q+l-1)/7)+1:Math.floor((q+l-1)/7)||((new Date(c-1,0,1).getDay()+6)%7<4?53:52),F:E.i18n.monthNames[C-1+12],m:K(C),M:E.i18n.monthNames[C-1],n:C,t:"?",L:"?",o:"?",Y:c,y:String(c).substring(2),a:v<12?y.AmPm[0]:y.AmPm[1],A:v<12?y.AmPm[2]:y.AmPm[3],B:"?",g:v%12||12,G:v,h:K(v%12||12),H:K(v),i:K(I),s:K(A),u:x,e:"?",I:"?",O:(B>0?"-":"+")+K(Math.floor(Math.abs(B)/60)*100+Math.abs(B)%60,4),P:"?",T:(String(e).match(D)||[""]).pop().replace(L,""),Z:"?",c:"?",r:"?",U:Math.floor(e/1000)};return P.replace(m,function(i){return i in h?h[i]:i.substring(1)})}};$.fn.fmatter.defaultFormat=function(e,d,b,c){return($.fmatter.isValue(e)&&e!=="")?e:d.defaultValue?d.defaultValue:"&#160;"
};$.fn.fmatter.email=function(e,d,b,c){if(!$.fmatter.isEmpty(e)){return'<a href="mailto:'+e+'">'+e+"</a>"}else{return $.fn.fmatter.defaultFormat(e,d)}};$.fn.fmatter.combobox=function(f,d,b,c){var g=$.extend({},d.combobox),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<input class="parseformatter" data-formatter="combobox" data-pos="'+d.pos+'" type="text" value="'+f+'" '+e+"/>"};$.fn.fmatter.combotree=function(f,d,b,c){var g=$.extend({},d.combotree),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<input class="parseformatter" data-formatter="combotree" data-pos="'+d.pos+'" type="text" value="'+f+'" '+e+"/>"};$.fn.fmatter.combogrid=function(f,d,b,c){var g=$.extend({},d.combogrid),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<input class="parseformatter" data-formatter="combogrid" data-pos="'+d.pos+'" type="text" value="'+f+'" '+e+"/>"};$.fn.fmatter.autocomplete=function(f,d,b,c){var g=$.extend({},d.autocomplete),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<input class="parseformatter" data-formatter="autocomplete" data-pos="'+d.pos+'" type="text" value="'+f+'" '+e+"/>"};$.fn.fmatter.toolbar=function(f,d,b,c){var g=$.extend({},d.toolbar),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'
}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<div class="parseformatter" data-formatter="toolbar" data-pos="'+d.pos+'" '+e+"/>"};$.fn.fmatter.text=function(f,d,b,c){var g=$.extend({},d.textbox),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<input class="parseformatter" data-formatter="textbox" data-pos="'+d.pos+'" type="text" value="'+f+'" '+e+"/>"};$.fn.fmatter.datepicker=function(f,d,b,c){var g=$.extend({},d.datepicker),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<input class="parseformatter" data-formatter="datepicker" data-pos="'+d.pos+'" type="text" value="'+f+'" '+e+"/>"};$.fn.fmatter.textarea=function(f,d,b,c){var g=$.extend({},d.textbox),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<textarea class="parseformatter" data-formatter="textbox" data-pos="'+d.pos+'" '+e+"/>"+f+"</textarea>"};$.fn.fmatter.progressbar=function(f,d,b,c){var g=$.extend({},d.progressbar),e;if(!$.fmatter.isUndefined(d.colModel.formatoptions)){g=$.extend({},g,d.colModel.formatoptions)}if(g.disabled===true){e='disabled="disabled"'}else{e=""}if($.fmatter.isEmpty(f)||$.fmatter.isUndefined(f)){f=""}f=f+"";return'<div class="parseformatter" data-formatter="progressbar" data-pos="'+d.pos+'" '+e+"/>"};$.fn.fmatter.convertCode=function(p,l,k,t){var f=l.colModel.formatoptions||l.colModel.editoptions||{},n=f.postMode||"value";var g="convertCode";if(l.colModel.cellEditoptions){var s=$.coral.toFunction(l.colModel.cellEditoptions).call(this,p,f,k);
f=s&&s.cellEditoptions?s.cellEditoptions:f;g=s&&s.type?s.type:"convertCode"}$("#"+l.rowId,this.element).children("td[aria-describedby$='"+l.colModel.name+"']").attr("data-org",p);if(g!=="convertCode"&&g!=="combobox"&&g!=="combogrid"){return p}var c=f.data,u=f.dataStructure||"list",b=f.valueField||"value",m=f.textField||"text",h=f.separator||",";if(typeof(p)==="undefined"||p===null){return""}if(n!="value"){return p}if(l.colModel.edittype=="combobox"&&f.code){c=f.code}if(l.colModel.edittype=="combotree"&&f.code){c=f.code}if(l.colModel.edittype=="combogrid"&&f.code){c=f.code}if(l.colModel.edittype=="combotree"){u="tree"}if(l.colModel.edittype=="autocomplete"&&typeof(f.code)=="string"){c=f.code}if(l.colModel.edittype=="autocomplete"&&f.source){c=f.source}var r=[],e=false,d=p.toString().split(h);if(u=="tree"){for(var q=0;q<d.length;q++){a(c,d[q],r)}}else{for(var q=0;q<d.length;q++){for(var o=0;o<c.length;o++){if(c[o][b]==d[q]){r.push(c[o][m]);e=true}}if(!e&&!f.forceSelection){r.push(d[q])}e=false}}return r.join(h)};function a(e,b,d){for(var c=0;c<e.length;c++){if(e[c].id==b){d.push(e[c].name)}else{if(e[c].children){a(e[c].children,b,d)}}}}$.fn.fmatter.checkbox=function(e,c){var f=$.extend({},c.checkbox),d;var b=["Yes","No"];if(!$.fmatter.isUndefined(c.colModel.formatoptions)){f=$.extend({},f,c.colModel.formatoptions);if(c.colModel.formatoptions&&c.colModel.formatoptions.value){b=c.colModel.formatoptions.value.split(":")}}if(f.disabled===true){d='disabled="disabled"'}else{d=""}if($.fmatter.isEmpty(e)||$.fmatter.isUndefined(e)){e=""}e=e+"";return'<input class="parseformatter" data-formatter="checkbox" value=\''+e+"' data-pos=\""+c.pos+'" type="checkbox" '+d+"/>"};$.fn.afterFmatter=function(b){var c=this;$(".parseformatter",c.element).each(function(){$(this).removeClass("parseformatter");var h=$(this).attr("data-pos"),e=$(this).attr("data-formatter"),f=$.trim($(this).val())===""?"":$(this).val(),g=$.extend({},c.options.colModel[h].formatoptions,{dataCustom:{rowId:$(this).closest("tr")[0].id,gridId:c.options.id}});
switch(e){case"combobox":case"combotree":case"combogrid":case"textbox":g.value=f;break;case"toolbar":case"progressbar":break;case"checkbox":var d=["Yes","No"];if(e&&c.options.colModel[h].formatoptions.value){d=c.options.colModel[h].formatoptions.value.split(":")}if($(this).val()==d[0]){g.checked=true}else{g.checked=false}break}$(this)[e](g)})};$.fn.fmatter.link=function(d,b){var e={target:b.target};var c="";if(!$.fmatter.isUndefined(b.colModel.formatoptions)){e=$.extend({},e,b.colModel.formatoptions)}if(e.target){c="target="+e.target}if(!$.fmatter.isEmpty(d)){return"<a "+c+' href="'+d+'">'+d+"</a>"}else{return $.fn.fmatter.defaultFormat(d,b)}};$.fn.fmatter.showlink=function(d,b){var f={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName},c="",e;if(!$.fmatter.isUndefined(b.colModel.formatoptions)){f=$.extend({},f,b.colModel.formatoptions)}if(f.target){c="target="+f.target}e=f.baseLinkUrl+f.showAction+"?"+f.idName+"="+b.rowId+f.addParam;if($.fmatter.isString(d)||$.fmatter.isNumber(d)){return"<a "+c+' href="'+e+'">'+d+"</a>"}else{return $.fn.fmatter.defaultFormat(d,b)}};$.fn.fmatter.integer=function(c,b){var d=$.extend({},b.integer);if(!$.fmatter.isUndefined(b.colModel.formatoptions)){d=$.extend({},d,b.colModel.formatoptions)}if($.fmatter.isEmpty(c)){return d.defaultValue}return $.fmatter.util.NumberFormat(c,d)};$.fn.fmatter.number=function(c,b){var d=$.extend({},b.number);if(!$.fmatter.isUndefined(b.colModel.formatoptions)){d=$.extend({},d,b.colModel.formatoptions)}if($.fmatter.isEmpty(c)){return d.defaultValue}return $.fmatter.util.NumberFormat(c,d)};$.fn.fmatter.currency=function(c,b){var d=$.extend({},b.currency);if(!$.fmatter.isUndefined(b.colModel.formatoptions)){d=$.extend({},d,b.colModel.formatoptions)}if($.fmatter.isEmpty(c)){return d.defaultValue}return $.fmatter.util.NumberFormat(c,d)};$.fn.fmatter.date=function(g,f,b,c){var h=$.extend({},f.date);if(!$.fmatter.isUndefined(f.colModel.formatoptions)){h=$.extend({},h,f.colModel.formatoptions)
}var e=h.srcDateFormat||h.dateFormat;var d=$.datepicker.parseDate(e,g||"");return $.datepicker.formatDate(h.dateFormat,d)||""};$.fn.fmatter.select=function(g,b){g=g+"";var e=false,k=[],o,d;if(!$.fmatter.isUndefined(b.colModel.formatoptions)){e=b.colModel.formatoptions.value;o=b.colModel.formatoptions.separator===undefined?":":b.colModel.formatoptions.separator;d=b.colModel.formatoptions.delimiter===undefined?";":b.colModel.formatoptions.delimiter}else{if(!$.fmatter.isUndefined(b.colModel.editoptions)){e=b.colModel.editoptions.value;o=b.colModel.editoptions.separator===undefined?":":b.colModel.editoptions.separator;d=b.colModel.editoptions.delimiter===undefined?";":b.colModel.editoptions.delimiter}}if(e){var n=b.colModel.editoptions.multiple===true?true:false,m=[],l;if(n){m=g.split(",");m=$.map(m,function(i){return $.trim(i)})}if($.fmatter.isString(e)){var c=e.split(d),f=0;for(var h=0;h<c.length;h++){l=c[h].split(o);if(l.length>2){l[1]=$.map(l,function(p,j){if(j>0){return p}}).join(o)}if(n){if($.inArray(l[0],m)>-1){k[f]=l[1];f++}}else{if($.trim(l[0])==$.trim(g)){k[0]=l[1];break}}}}else{if($.fmatter.isObject(e)){if(n){k=$.map(m,function(i){return e[i]})}else{k[0]=e[g]||""}}}}g=k.join(", ");return g===""?$.fn.fmatter.defaultFormat(g,b):g};$.fn.fmatter.rowactions=function(l,g,h,j){var f={keys:false,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{},url:null,delOptions:{},editOptions:{}};l=$.grid.coralID(l);g=$.grid.coralID(g);var k=$("#"+g)[0].options.colModel[j];if(!$.fmatter.isUndefined(k.formatoptions)){f=$.extend(f,k.formatoptions)}if(!$.fmatter.isUndefined($("#"+g)[0].options.editOptions)){f.editOptions=$("#"+g)[0].options.editOptions}if(!$.fmatter.isUndefined($("#"+g)[0].options.delOptions)){f.delOptions=$("#"+g)[0].options.delOptions}var d=$("#"+g)[0];var e=function(n,m){if($.isFunction(f.afterSave)){f.afterSave.call(d,n,m)}$("tr#"+l+" div.coral-inline-edit, tr#"+l+" div.coral-inline-del","#"+g+".coral-grid-btable:first").show();
$("tr#"+l+" div.coral-inline-save, tr#"+l+" div.coral-inline-cancel","#"+g+".coral-grid-btable:first").hide()},i=function(m){if($.isFunction(f.afterRestore)){f.afterRestore.call(d,m)}$("tr#"+l+" div.coral-inline-edit, tr#"+l+" div.coral-inline-del","#"+g+".coral-grid-btable:first").show();$("tr#"+l+" div.coral-inline-save, tr#"+l+" div.coral-inline-cancel","#"+g+".coral-grid-btable:first").hide()};if($("#"+l,"#"+g).hasClass("grid-new-row")){var c=d.options.prmNames,b=c.oper;f.extraparam[b]=c.addoper}switch(h){case"edit":$("#"+g).grid("editRow",l,f.keys,f.onEdit,f.onSuccess,f.url,f.extraparam,e,f.onError,i);$("tr#"+l+" div.coral-inline-edit, tr#"+l+" div.coral-inline-del","#"+g+".coral-grid-btable:first").hide();$("tr#"+l+" div.coral-inline-save, tr#"+l+" div.coral-inline-cancel","#"+g+".coral-grid-btable:first").show();$(d).triggerHandler("jqGridAfterGridComplete");break;case"save":if($("#"+g).grid("saveRow",l,f.onSuccess,f.url,f.extraparam,e,f.onError,i)){$("tr#"+l+" div.coral-inline-edit, tr#"+l+" div.coral-inline-del","#"+g+".coral-grid-btable:first").show();$("tr#"+l+" div.coral-inline-save, tr#"+l+" div.coral-inline-cancel","#"+g+".coral-grid-btable:first").hide();$(d).triggerHandler("jqGridAfterGridComplete")}break;case"cancel":$("#"+g).grid("restoreRow",l,i);$("tr#"+l+" div.coral-inline-edit, tr#"+l+" div.coral-inline-del","#"+g+".coral-grid-btable:first").show();$("tr#"+l+" div.coral-inline-save, tr#"+l+" div.coral-inline-cancel","#"+g+".coral-grid-btable:first").hide();$(d).triggerHandler("jqGridAfterGridComplete");break;case"del":$("#"+g).grid("delGridRow",l,f.delOptions);break;case"formedit":$("#"+g).grid("setSelection",l);$("#"+g).grid("editGridRow",l,f.editOptions);break}};$.fn.fmatter.actions=function(e,c){var g={keys:false,editbutton:true,delbutton:true,editformbutton:false};if(!$.fmatter.isUndefined(c.colModel.formatoptions)){g=$.extend(g,c.colModel.formatoptions)}var b=c.rowId,f="",d;if(typeof(b)=="undefined"||$.fmatter.isEmpty(b)){return""}if(g.editformbutton){d="onclick=jQuery.fn.fmatter.rowactions('"+b+"','"+c.gid+"','formedit',"+c.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ";
f=f+"<div title='"+$.grid.nav.edittitle+"' style='float:left;cursor:pointer;' class='coral-pg-div coral-inline-edit' "+d+"><span class='coral-icon coral-icon-pencil'></span></div>"}else{if(g.editbutton){d="onclick=jQuery.fn.fmatter.rowactions('"+b+"','"+c.gid+"','edit',"+c.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover') ";f=f+"<div title='"+$.grid.nav.edittitle+"' style='float:left;cursor:pointer;' class='coral-pg-div coral-inline-edit' "+d+"><span class='coral-icon coral-icon-pencil'></span></div>"}}if(g.delbutton){d="onclick=jQuery.fn.fmatter.rowactions('"+b+"','"+c.gid+"','del',"+c.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ";f=f+"<div title='"+$.grid.nav.deltitle+"' style='float:left;margin-left:5px;' class='coral-pg-div coral-inline-del' "+d+"><span class='coral-icon coral-icon-trash'></span></div>"}d="onclick=jQuery.fn.fmatter.rowactions('"+b+"','"+c.gid+"','save',"+c.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ";f=f+"<div title='"+$.grid.edit.bSubmit+"' style='float:left;display:none' class='coral-pg-div coral-inline-save' "+d+"><span class='coral-icon coral-icon-disk'></span></div>";d="onclick=jQuery.fn.fmatter.rowactions('"+b+"','"+c.gid+"','cancel',"+c.pos+"); onmouseover=jQuery(this).addClass('coral-state-hover'); onmouseout=jQuery(this).removeClass('coral-state-hover'); ";f=f+"<div title='"+$.grid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='coral-pg-div coral-inline-cancel' "+d+"><span class='coral-icon coral-icon-cancel'></span></div>";return"<div style='margin-left:8px;'>"+f+"</div>"};$.unformat=function(f,o,k,d,c){var i,c=c||"formatter",g=o.colModel[c],e,h=o.colModel.formatoptions||{},n,m=/([\.\*\_\'\(\)\{\}\+\?\\])/g,j=o.colModel.unformat||($.fn.fmatter[g]&&$.fn.fmatter[g].unformat);j=$.coral.toFunction(j);
if(o.colModel.edittype=="combobox"&&o.colModel.revertCode||o.colModel.edittype=="combotree"&&o.colModel.revertCode||o.colModel.edittype=="combogrid"&&o.colModel.revertCode||o.colModel.edittype=="datepicker"&&o.colModel.revertCode||o.colModel.edittype=="autocomplete"&&o.colModel.revertCode||o.colModel.revertCode){if(g=="autocomplete"||g=="datepicker"||g=="combobox"||g=="combotree"||g=="combogrid"){}else{g="convertCode"}}if(typeof j!=="undefined"&&$.isFunction(j)){i=j.call(this,$(f).text(),o,f)}else{if(!$.fmatter.isUndefined(g)&&$.fmatter.isString(g)){var b=$.grid.formatter||{},l;switch(g){case"integer":h=$.extend({},b.integer,h);n=h.thousandsSeparator.replace(m,"\\$1");l=new RegExp(n,"g");i=$(f).text().replace(l,"");break;case"number":h=$.extend({},b.number,h);n=h.thousandsSeparator.replace(m,"\\$1");l=new RegExp(n,"g");i=$(f).text().replace(l,"").replace(h.decimalSeparator,".");break;case"currency":h=$.extend({},b.currency,h);n=h.thousandsSeparator.replace(m,"\\$1");l=new RegExp(n,"g");i=$(f).text();if(h.prefix&&h.prefix.length){i=i.substr(h.prefix.length)}if(h.suffix&&h.suffix.length){i=i.substr(0,i.length-h.suffix.length)}i=i.replace(l,"").replace(h.decimalSeparator,".");break;case"checkbox":i=$.unformat.checkbox(f,o,k,d);break;case"select":i=$.unformat.select(f,o,k,d);break;case"date":i=$.unformat.date(f,o,k,d);break;case"combobox":case"combogrid":case"combotree":i=$.unformat[g](f,o,k,d);break;case"datepicker":i=$.unformat.datepicker(f,o,k,d);break;case"autocomplete":i=$.unformat.autocomplete(f,o,k,d);break;case"text":case"textarea":i=$.unformat.textbox(f,o,k,d);break;case"convertCode":if(d=="get"){if(o.colModel.revertCode==true){i=$.unformat.convertCode(f,o,k,d)}else{i=$(f).text()}}else{if(o.colModel.postMode=="value"){i=$.unformat.convertCode(f,o,k,d)}else{i=$(f).text()}}break;case"actions":return"";default:i=$(f).text()}}}return i!==undefined?i:d===true?$(f).text():$.grid.htmlDecode($(f).html())};$.unformat.autocomplete=function(d,i,g,c){var f=[];var h=$(d).text();
if(c===true){return h}var e=$.extend({},!$.fmatter.isUndefined(i.colModel.formatoptions)?i.colModel.formatoptions:i.colModel.editoptions),j=e.separator===undefined?":":e.separator,b=e.delimiter===undefined?";":e.delimiter;if(i.colModel.revertCode){return $(d).find(".ctrl-init").autocomplete("getValue").toString()}else{return $(d).find(".ctrl-init").autocomplete("getText")}};$.unformat.combobox=function(d,i,g,c){var f=[];var h=$(d).text();if(c===true){return h}var e=$.extend({},!$.fmatter.isUndefined(i.colModel.formatoptions)?i.colModel.formatoptions:i.colModel.editoptions),j=e.separator===undefined?":":e.separator,b=e.delimiter===undefined?";":e.delimiter;if(i.colModel.revertCode){return $(d).find(".ctrl-init").combobox("getValue")}else{return $(d).find(".ctrl-init").combobox("getText")}};$.unformat.combotree=function(d,i,g,c){var f=[];var h=$(d).text();if(c===true){return h}var e=$.extend({},!$.fmatter.isUndefined(i.colModel.formatoptions)?i.colModel.formatoptions:i.colModel.editoptions),j=e.separator===undefined?":":e.separator,b=e.delimiter===undefined?";":e.delimiter;if(i.colModel.revertCode){return $(d).find(".ctrl-init").combotree("getValue").toString()}else{return $(d).find(".ctrl-init").combotree("getText")}};$.unformat.combogrid=function(d,i,g,c){var f=[];var h=$(d).text();if(c===true){return h}var e=$.extend({},!$.fmatter.isUndefined(i.colModel.formatoptions)?i.colModel.formatoptions:i.colModel.editoptions),j=e.separator===undefined?":":e.separator,b=e.delimiter===undefined?";":e.delimiter;if(i.colModel.revertCode){return $(d).find(".ctrl-init").combogrid("getValue")}else{return $(d).find(".ctrl-init").combogrid("getText")}};$.unformat.textbox=function(d,i,g,c){var f=[];var h=$(d).text();if(c===true){return h}var e=$.extend({},!$.fmatter.isUndefined(i.colModel.formatoptions)?i.colModel.formatoptions:i.colModel.editoptions),j=e.separator===undefined?":":e.separator,b=e.delimiter===undefined?";":e.delimiter;return $(d).find(".ctrl-init").textbox("getValue")};
$.unformat.datepicker=function(d,i,g,c){var f=[];var h=$(d).text();if(c===true){return h}var e=$.extend({},!$.fmatter.isUndefined(i.colModel.formatoptions)?i.colModel.formatoptions:i.colModel.editoptions),j=e.separator===undefined?":":e.separator,b=e.delimiter===undefined?";":e.delimiter;return $(d).find(".ctrl-init").datepicker("getValue")};$.unformat.convertCode=function(d,b,e,c){return $(d).attr("data-org")};$.unformat.select=function(g,r,m,d){var l=[];var p=$(g).text();if(d===true){return p}var k=$.extend({},!$.fmatter.isUndefined(r.colModel.formatoptions)?r.colModel.formatoptions:r.colModel.editoptions),s=k.separator===undefined?":":k.separator,c=k.delimiter===undefined?";":k.delimiter;if(k.value){var e=k.value,q=k.multiple===true?true:false,o=[],n;if(q){o=p.split(",");o=$.map(o,function(i){return $.trim(i)})}if($.fmatter.isString(e)){var b=e.split(c),f=0;for(var h=0;h<b.length;h++){n=b[h].split(s);if(n.length>2){n[1]=$.map(n,function(t,j){if(j>0){return t}}).join(s)}if(q){if($.inArray(n[1],o)>-1){l[f]=n[0];f++}}else{if($.trim(n[1])==$.trim(p)){l[0]=n[0];break}}}}else{if($.fmatter.isObject(e)||$.isArray(e)){if(!q){o[0]=p}l=$.map(o,function(j){var i;$.each(e,function(t,u){if(u==j){i=t;return false}});if(typeof(i)!="undefined"){return i}})}}return l.join(", ")}else{return p||""}};$.unformat.date=function(c,b){if(b.revertCode){return $(c).attr("data-org")}else{return $(c).text()}};$.unformat.checkbox=function(d,c){var e=$.extend({},!$.fmatter.isUndefined(c.colModel.formatoptions)?c.colModel.formatoptions:c.colModel.editoptions);var b=(e.value)?e.value.split(":"):["Yes","No"];return $("input",d).is(":checked")?b[0]:b[1]}})();

$.component("coral.textbox",$.coral.inputbase,{version:$.coral.version,castProperties:["dataCustom","title","buttons","buttonOptions","triggers"],options:{swfPath:$.coral.contextPath+"/jquery-cui/resource/swfupload.swf",hasTips:false,showStar:true,showClose:false,dataCustom:null,value:"",readonly:false,readonlyInput:false,disabled:false,required:false,isLabel:false,title:null,buttons:[],useHiddenInput:true,errMsg:null,errMsgPosition:"leftBottom",placeholder:"",type:"text",labelField:null,starBefore:false,valueChangedOnKeyUp:false,onClick:null,onChange:null,onBlur:null,onFocus:null,onKeyDown:null,onKeyUp:null,onKeyPress:null,onEnter:null,onMouseEnter:null,onMouseLeave:null,onCreate:null,onValidSuccess:null,onValidError:null,onValidWarn:null,onUploadSuccess:null,buttonOptions:null,triggers:null,excluded:false},button:function(){if(null!==this.options.buttonOptions){return this.$button}},component:function(){return this.uiTextbox},focus:function(){if(this.options.disabled||this.options.isLabel||this.options.readonly||this.options.readonlyInput){return false}if("hidden"==this.element.attr("type")){return}var a=this;this.element.focus();return true},_create:function(){var a=this;if(a.options.hasTips){a.options.title=true}if("hidden"!==this.element.attr("type")&&"file"!==this.element.attr("type")&&"password"!==this.element.attr("type")&&"text"!==this.element.attr("type")&&"INPUT"==this.element[0].tagName.toUpperCase()){this.element.attr("type","text")}this.element.addClass("ctrl-form-element");if(this.options.dataCustom){this.element.attr("data-custom",this.options.dataCustom)}this._initElement();this.setValue(this.element.val(),false);this.originalValue=this.getValue();this._bindEvents();if(null!==this.options.buttonOptions){this._outerButtons()}a._trigger("onCreate",null,[])},_getButtonEl:function(){return $("<button type='button'></button>").addClass("coral-textbox-button")},reset:function(){this.setValue(this.originalValue)},_initSimple:function(){var a=this,b=a.element.uniqueId().attr("id")
},_initUpload:function(){var a=this,b=a.element.uniqueId().attr("id");a.select=[];$(this.element).wrap('<span class="coral-file-default"></span>').before("<span class='coral-file'>请选择...</span>").before("<div id='"+b+"_upload'></div>").before("<div id='"+b+"_queue'></div>").hide();a.uploader=$("#"+b+"_upload");a.uploader.uploadify({swf:this.options.swfPath,uploader:a.options.uploadUrl,queueID:b+"_queue",height:"28",width:"800",buttonText:"浏览",onDialogOpen:function(){a.select=[]},onDialogClose:function(){},onSelect:function(c){a.select.push(c.name);a.uiTextbox.find(".coral-file").html(a.select.join(","));a.uiTextbox.find("object").attr("title",a.select.join(","))},onCancel:function(c){},onQueueComplete:function(c){setTimeout(function(){$("#"+b+"_queue").dialog("close");a.select=[]},3500)},onUploadSuccess:function(d,e,c){a._trigger("onUploadSuccess",null,[{file:d,data:e,response:c}])},auto:false});$("#"+b+"_queue").dialog({autoOpen:false,modal:false,resizable:false,onOpen:function(){a.uploader.uploadify("upload","*")}})},upload:function(a){var b=this;var c=b.element[0].id;if(this.select.length===0){return}$("#"+c+"_queue").dialog("open")},cancel:function(a){this.uploader.uploadify("cancel")},clear:function(a){this.select=[];this.uiTextbox.find(".coral-file").html("请选择...");this.uiTextbox.find("object").attr("title","请选择...");this.uploader.uploadify("cancel")},_getIcon:function(e){var a=[];if(typeof e==="undefined"||e==null||e==""){return[]}if(typeof e=="object"){for(var d in e){var f={};f[e[d].icon]=e[d].click;a.push(f)}}else{var c=$.trim(e).split(",");for(var d in c){var b=c[d].split(" ");var f={};f[b[0]]=b[1];a.push(f)}}return a},_triggerClick:function(a,c,d){var b=this;var e=$.coral.toFunction(a);c=$.Event(c);return e.apply(b.element[0],[c].concat(d))},_updateLabel:function(a){this.uiLabel.html(a)},_initElement:function(){var f=this,b=null,c=f.options;this.uiTextbox=$('<span class="coral-textbox"><span class="coral-textbox-border coral-corner-all"></span></span>').insertAfter(f.element);
f.elementBorder=f.uiTextbox.find(".coral-textbox-border");f.element.appendTo(f.elementBorder);f.element.addClass("coral-textbox-default coral-validation-textbox tabbable");if(this.options.buttons.length>0){this._createButtonPanel()}if(c.labelField){this.uiLabel=$('<label class="coral-label">'+c.labelField+"</label>");this.elementBorder.before(this.uiLabel);this.uiTextbox.addClass("coral-hasLabel")}if(this.options.useHiddenInput){this.valuebox=$("<input type='hidden' class='coral-value-textbox'>").appendTo(this.uiTextbox)}else{this.valuebox=this.element}if("hidden"==this.element.attr("type")){f.uiTextbox.hide()}if("TEXTAREA"==this.element[0].tagName){f.component().addClass("coral-textbox-textarea")}if("file"==f.element.attr("type")){if("uploadify"==f.options.formatter){f._initUpload()}if("simple"==f.options.formatter||typeof f.options.formatter=="undefined"){f._initSimple()}}var a=[],e=null;if((a=f._getIcon(f.options.icons)).length!=0){e=true}else{if((a=f._getIcon(f.options.texticons)).length!=0){e=false}}if(e!=null){this.uiDialogButtonPanel=$('<span class="coral-textbox-btn-icons coral-corner-right"></span>');f.elementBorder.append(this.uiDialogButtonPanel);for(var d in a){$.each(a[d],function(g,i){var h=$('<span class="coral-textbox-btn-ico icon"></span>');if(e){h.addClass(g)}else{h.addClass("coral-textbox-btn-textico").html(g)}h.bind("click"+f.eventNamespace,function(j){if(f.options.disabled){return}f._triggerClick(i,j,[{value:f.element.val()}])});f.uiDialogButtonPanel.append(h)})}this.rightPos=this.uiDialogButtonPanel.outerWidth()}if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name")}else{if(this.options.name){this.element.attr("name",this.options.name)}}if("TEXTAREA"===this.element[0].tagName){if($.trim(this.element.text())!==""){this.options.value=this.element.text()}else{if(this.options.value){this.element.text(this.options.value)
}}}else{if($.trim(this.element.val())!==""){this.options.value=this.element.val()}else{if(this.options.value){this.element.val(this.options.value)}}}if(c.width!==""&&c.width!==undefined){this.uiTextbox.css("width",c.width)}if(c.height!==""&&c.height!==undefined){this._setOption("height",c.height)}if(c.readonlyInput){this._setReadonlyInput()}if(c.readonly){this._setReadonly()}if(typeof c.isLabel=="boolean"&&c.isLabel){this._setReadonly();this.options.readonly=true;this.component().addClass("coral-isLabel");return}if(typeof c.disabled==="boolean"&&c.disabled){this._setOption("disabled",c.disabled)}if(this.options.showClose){this.uiClose=$("<span class='coral-textbox-close cui-icon-cross2'></span>");this.elementBorder.append(this.uiClose);this.uiClose.css("right",this.rightPos?this.rightPos:0)}this.element.attr("placeholder",c.placeholder);if(c.placeholder&&""===this.element.val()){this._showPlaceholder()}this._updateTitle();this._refresh()},_setReadonlyInput:function(){if(typeof this.element.attr("readonly")!="undefined"){this.options.readonlyInput=this.element.prop("readonly")}else{if(this.options.readonlyInput){this.element.prop("readonly",this.options.readonlyInput)}}if(this.element.prop("readonly")){this.component().addClass("coral-readonlyInput")}},_setReadonly:function(){this.options.readonlyInput=true;this._setReadonlyInput();this.component().removeClass("coral-readonlyInput").addClass("coral-readonly")},_updateTitle:function(){var b=this,a=this.options;if(a.title==true){b.element.attr("title",b.element.val())}else{if(a.title==false){b.element.attr("title","")}else{b.element.attr("title",a.title)}}},_showPlaceholder:function(){if($.support.placeholder){return}var b=this,a=$("<span class='coral-textbox-placeholder-label'>"+b.options.placeholder+"</span>");$(b.element).after(a)},_hidePlaceholder:function(){if($.support.placeholder){return}var a=this;a.uiTextbox.find(".coral-textbox-placeholder-label").remove()},_bindEvents:function(){var c=this,b=this.options;var a;
this._on({"mouseenter.coral-textbox-border":function(d){if(typeof b.isLabel=="boolean"&&b.isLabel){return}if(typeof b.readonly=="boolean"&&b.readonly){return}c.component().addClass("coral-textbox-hover");this._trigger("onMouseEnter",d,[])},"mouseleave.coral-textbox-border":function(d){if(typeof b.isLabel=="boolean"&&b.isLabel){return}if(typeof b.readonly=="boolean"&&b.readonly){return}c.component().removeClass("coral-textbox-hover");this._trigger("onMouseLeave",d,[])},click:function(d){c._hidePlaceholder();this._trigger("onClick",d,[])},"click.coral-textbox-placeholder-label":function(d){c._hidePlaceholder();c.element.focus()},dblclick:function(d){this._trigger("onDblClick",d,[])},blur:function(d){this.component().removeClass("coral-state-focus");if(""===this.element.val()){this._showPlaceholder()}if(a){a=false;return}this.setValue(this.element.val(),true);this._trigger("onBlur",d,[])},focusin:function(d){if(b.isLabel||b.readonly||b.readonlyInput){this._trigger("onFocus",d,[{value:this.valuebox.val(),text:this.element.val()}]);return}this.component().addClass("coral-state-focus");this._trigger("onFocus",d,[{value:this.valuebox.val(),text:this.element.val()}])},keydown:function(d){if(b.isLabel||b.readonly||b.readonlyInput){return}this._trigger("onKeyDown",d,[{value:this.valuebox.val(),text:this.element.val(),id:this.options.id}]);if(d.keyCode==13){this.setValue(this.element.val(),true);this._trigger("onEnter",d,[{value:this.valuebox.val(),text:this.element.val()}])}this._hidePlaceholder()},keypress:function(d){if(b.isLabel||b.readonly||b.readonlyInput){return}this._trigger("onKeyPress",d,[{value:this.valuebox.val(),text:this.element.val()}])},keyup:function(d){if(b.isLabel||b.readonly||b.readonlyInput){return}if(this.options.valueChangedOnKeyUp){this.setValue(this.element.val(),true,false)}this._trigger("onKeyUp",d,[{value:this.valuebox.val(),text:this.element.val(),id:this.options.id}])},"click.coral-textbox-close":function(d){d.preventDefault();this.setValue("",true);
if(this.options.placeholder){this._showPlaceholder()}this._trigger("onCloseClick",event,[])},"mousedown.coral-textbox-close":function(d){d.stopPropagation();a=true}})},_refresh:function(){var b=this,a=this.options},_setOption:function(d,f){var e=this;if(d==="id"||d==="name"||d==="type"){return}if(d==="height"){if(f){this.component().outerHeight(f);this.uiTextbox.find(".coral-textbox-btn-textico").css({"line-height":(f-6)+"px",height:f+"px"})}}if(d==="width"){if(f){this.component().outerWidth(f)}}this._super(d,f);if(d==="placeholder"){this.element.attr("placeholder",this.options.placeholder);if(this.getValue()===""){this._showPlaceholder()}}if(d=="texticons"){var b=e._getIcon(e.options.texticons);var a=$('<span class="coral-textbox-btn-icons coral-corner-right"></span>');e.elementBorder.find(".coral-textbox-btn-icons").replaceWith(a);for(var c in b){$.each(b[c],function(g,i){var h=$('<span class="coral-textbox-btn-ico icon"></span>').addClass("coral-textbox-btn-textico").html(g);h.bind("click"+e.eventNamespace,function(j){if(e.options.disabled){return}e._triggerClick(i,j,[{value:e.element.val()}])});a.append(h)})}}if(d==="value"){e._updateTitle();e.setValue(f,false)}if(d==="isLabel"){if(typeof f=="boolean"&&f){this._setReadonly();this.component().removeClass("coral-readonly").addClass("coral-isLabel")}else{if(typeof f=="boolean"&&!f){this.element.prop("readonly",false);this.options.readonly=false;this.options.isLabel=false;this.options.readonlyInput=false;this.component().removeClass("coral-isLabel coral-readonly")}}}if(d==="readonly"){if(typeof f=="boolean"&&f){this._setReadonly();this.component().removeClass("coral-isLabel").addClass("coral-readonly")}else{if(typeof f=="boolean"&&!f){this.element.prop("readonly",false);this.options.readonly=false;this.options.readonlyInput=false;this.element.prop("readonly",false);this.component().removeClass("coral-isLabel coral-readonly")}}}if(d==="readonlyInput"){if(typeof f=="boolean"&&f){this._setReadonlyInput();this.component().removeClass("coral-isLabel").addClass("coral-readonlyInput")
}else{if(typeof f=="boolean"&&!f){this.element.prop("readonly",false);this.options.readonlyInput=false;this.component().removeClass("coral-isLabel coral-readonlyInput")}}}if(d==="disabled"){if(f){this.element.prop("disabled",true)}else{this.element.prop("disabled",false)}}if(d==="labelField"){e._updateLabel(f)}if(d==="title"){e._updateTitle()}if(d==="hasTips"){e._updateTitle()}},_destroy:function(){this.uiTextbox.replaceWith(this.element);this.element.val("");this.element.removeAttr("value");this.element.removeClass("coral-textbox-default").removeClass("coral-validation-textbox").removeClass("coral-textbox-hover").removeClass("coral-textbox-textarea").removeClass("coral-textbox-input").removeAttr("placeholder").removeAttr("title").removeAttr("readonly").removeAttr("disabled")},disable:function(){this._setOption("disabled",true)},enable:function(){this._setOption("disabled",false)},getHtml:function(){return this.element.text()},setHtml:function(){this.element.text(value);this._updateTitle()},getValue:function(){return this.valuebox.val()},getValidateValue:function(){return this.getText()},getText:function(){if(this.component().hasClass("coral-state-focus")){if(this.element.is("textarea")){return this.element.text()}else{return this.element.val()}}else{return this.valuebox.val()}},setValue:function(e,b,d){e=e===null||typeof(e)==="undefined"?"":e;var f=e,c;d=d!==false?true:false;var a=$.coral.toFunction(this.options.formatterText);if($.isFunction(a)){f=a.apply(this.options.element,[{value:e}])}if(d){this.setText(f)}this.valuebox.val(e);this.options.value=e;if(b&&this.previous!=e){this._trigger("onChange",null,[{value:e,text:f}])}this.previous=e;if(e!==""){this._hidePlaceholder()}},setText:function(a){if(this.element.is("textarea")){this.element.val(a);this.element.text(a)}else{this.element.val(a)}this._updateTitle()},formValue:function(){var b={},a=this.element.attr("name");if(!a){return null}b[a]=this.getValue();return b}});

$.component("coral.toolbar",{version:"4.0.2",castProperties:["data","dataCustom","dropdownOptions"],options:{clickToDisplay:1,id:null,name:null,dataCustom:{},responsive:true,disabled:false,cls:null,url:null,title:false,method:"get",data:null,width:"auto",height:null,isOverflow:true,dropdownOptions:{button:{text:false,label:"更多"},panelPosition:{my:"right top",at:"right bottom"},atGroup:0},align:0,autoDisplay:false,margin:5,onCreate:null,onClick:null,onLoad:null},_jion:function(c,b){var a=[];$.each(c,function(e,f){a.push($(f))});$.each(b,function(e,f){a.push($(f))});return a},_hideMenus:function(){$(".coral-tieredmenu").hide()},_create:function(){var a=this;this.groupLength=1;this._initElements();this._bindEvents()},_bindEvents:function(){var a=this;this._on(this.document,{mousedown:function(b){if(a.options.clickToDisplay==1&&a.options.autoDisplay){a.uiBox.toggleClass("coral-toolbar-click-active",false)}}})},_initElements:function(){var b=this,a=this.options;this.uiBox=$('<div class="coral-toolbar"></div>');this.uiBorder=$('<div class="coral-toolbar-border"></div>');this.uiBox.append(this.uiBorder);this.uiBox.insertAfter(this.element);this.element.appendTo(this.uiBorder);if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name")}else{if(this.options.name){this.element.attr("name",this.options.name)}}this.uiAfter=$("<button type='button' data-frozen='true' class='coral-toolbar-after-element ctrl-toolbar-element'></button>").menubutton({label:this.options.dropdownOptions.button.label,text:this.options.dropdownOptions.button.text,renderType:"button",icons:"cui-icon-arrow-down3 right",data:[],position:this.options.dropdownOptions.panelPosition});this.uiAfter.menubutton("component").addClass("coral-toolbar-item coral-toolbar-after");this.uiAfter.menubutton("hide");this._loadData();if(this.options.clickToDisplay==0){this.uiBox.addClass("coral-toolbar-click-active")
}},_loadData:function(){var b=this,a=this.options;if(a.url){$.ajax({type:a.method,url:a.url,data:{},dataType:"json",success:function(c){b._initData(c)},error:function(){$.alert("Json Format Error!")}})}else{if(a.data){this._initData(a.data)}}},_initData:function(b){var a=this;if(typeof b==="object"){this._addItems(null,b);this._trigger("onLoad",null,{});this.isLoaded=true;this._setFrozenElements();this._position()}if(this.options.disabled){this._setDisabled(this.options.disabled)}},_addItems:function(e,b,j){if(typeof b!=="object"){return}var d=this,g=[],f=b.length;for(var c=0;c<f;c++){var a=b[c];if(a==""||!$.isEmptyObject(a)){g.push(d._createItem(a))}}this._appendItems(e,g,j);this._initItems(g);if(!this.element.find(".coral-toolbar-after-element").length){var k=this._getGroupNameByIndex(this.options.dropdownOptions.atGroup);var h=this.element.find("[group-role='"+k+"']");if(h.length){h.after(this.uiAfter.menubutton("component"))}else{this.element.append(this.uiAfter.menubutton("component"))}}},_createItem:function(a){var f=this,g=a,d=a.type||"button",e=null;if(a==="-"){d="seperator"}else{if(a==="->"){d="grouper"}else{if(a===""){d="blank"}else{if(a==="more"){d="more"}}}}var c=this._createEl(d);e=a;if(d==="button"&&typeof a.icon!=="undefined"&&a.icon!=""){var b=this._getIcon(a.icon);delete e.icon;if(null!=b.ico1&&null==b.ico2){e.icons=b.ico1}else{if(null==b.ico1&&null!=b.ico2){e.icons=b.ico2+" right"}else{if(null!=b.ico1&&null!=b.ico2){e.icons=b.ico1+" left, "+b.ico2+" right"}}}}return{$el:c,coralType:d,options:e}},_align:function(){if(this.groupLength!=1){return}var b=this.options;if(b.align=="center"){var a=this._createEl("grouper").attr("grouper-role","center"),c=this._createEl("grouper").attr("grouper-role","right");this.element.prepend(a);this.element.find("[group-role='left']").removeClass("group-left").addClass("group-center").attr("group-role","center");this.element.find(".ctrl-toolbar-element").attr("group","center");this.element.append(c)}else{if(b.align=="right"){var c=this._createEl("grouper").attr("grouper-role","right");
this.element.find("[group-role='left']").removeClass("group-left").addClass("group-right").attr("group-role","right");this.element.find(".ctrl-toolbar-element").attr("group","right");this.element.prepend(c)}}},_appendItems:function(h,m,o){var g=this;if(!this.isLoaded){var l=0;var a=g._createGrouper(l,this.groupLength);this.element.append(a);$.each(m,function(j,k){if(k.coralType=="grouper"){l+=1;a=g._createGrouper(l,g.groupLength);g.element.append(k.$el.attr("grouper-role",a.attr("group-role")));g.element.append(a)}else{a.append(k.$el.attr("group",a.attr("group-role")));if(k.options&&k.options.frozen==true){k.$el.attr("data-frozen",true)}}});this._align()}else{var q=this._getGroupNameByIndex(o);var n=this.element.find("[group-role='"+q+"']");var c=n.find(".ctrl-toolbar-element:not(.coral-toolbar-separator)").length;if(null==h||h==c){for(var f in m){m[f].$el.attr("group",q);m[f].$el.appendTo(n)}}else{if(h==0){for(var e in m){m[e].$el.attr("group",q);m[e].$el.prependTo(n)}}else{for(var d in m){m[d].$el.attr("group",q);var p=n.find(".ctrl-toolbar-element:eq("+h+")");var b=p.attr("component-role");if(b){p[b]("component").before(m[d].$el)}else{p.before(m[d].$el)}}}}}},_initItems:function(a){var e=this;for(var c in a){if(a[c].coralType==="seperator"||a[c].coralType==="grouper"||a[c].coralType==="blank"||a[c].coralType==="more"){continue}var b=a[c].$el,f=a[c].coralType.toLowerCase(),d=a[c].options;d.componentCls=" coral-toolbar-item "+d.componentCls||"";if(a[c].coralType==="html"){b.attr("id",d.id).append(d.content);continue}if(e.options.title){d.title=true}b[f](d);b.off(".toolbaronclick").on(f+"onclick.toolbaronclick",function(i,h){h=h||{};h.id=h.id||i.currentTarget.id;$(i.currentTarget).attr("component-role")=="splitbutton";if(e.uiAfter.length){var g=$(i.currentTarget).attr("component-role");if(g=="splitbutton"||g=="button"){e.uiAfter.menubutton("hidePanel")}}e._trigger("onClick",i,h)});b.off(".toolbaronmouseenter").on(f+"onmouseenter.toolbaronmouseenter",function(i,h){var g=$(i.currentTarget).attr("component-role");
if(g=="splitbutton"||g=="menubutton"){$(i.currentTarget)[g]("hideAllMenus");$(i.currentTarget)[g]("showMenu")}})}},_createEl:function(b){var a;switch(b){case"button":a=$("<button type='button'></button>");break;case"checkbox":a=$("<input type='checkbox' />");break;case"textbox":case"combobox":a=$("<input type='text' />");break;case"datepicker":a=$("<input type='text' />");break;case"splitbutton":case"menubutton":a=$("<button type='button'></button>");break;case"seperator":a=$("<div class='coral-toolbar-item coral-toolbar-separator coral-toolbar-separator-horizontal'></div>");break;case"grouper":this.groupLength+=1;a=$("<div class='coral-toolbar-item coral-toolbar-grouper'></div>");break;case"html":a=$("<div class='coral-toolbar-item coral-toolbar-html'></div>");break;case"blank":a=$("<span class='coral-toolbar-item coral-toolbar-blank'></span>");break;case"more":a=this.uiAfter.menubutton("component");return a;break;default:a=$("<span class='coral-toolbar-item'></span>");break}return a.addClass("ctrl-toolbar-element")},_createGrouper:function(a,b){var c=$();if(b==1||b==3){switch(a){case 0:c=$("<span class='coral-toolbar-group group-left' group-role='left'></span>");break;case 1:c=$("<span class='coral-toolbar-group group-center' group-role='center'></span>");break;case 2:c=$("<span class='coral-toolbar-group group-right' group-role='right'></span>");break;default:c=$("<span class='coral-toolbar-group' group-role='default'></span>");break}}else{if(b==2){switch(a){case 0:c=$("<span class='coral-toolbar-group group-left' group-role='left'></span>");break;case 1:c=$("<span class='coral-toolbar-group group-right' group-role='right'></span>");break;default:c=$("<span class='coral-toolbar-group' group-role='default'></span>");break}}}return c},_getGroupNameByIndex:function(a){if(typeof a!=="number"){return"left"}if(this.groupLength==1){return"left"}else{if(this.groupLength==2){return a==0?"left":"right"}else{if(this.groupLength==3){switch(a){case 0:return"left";case 1:return"center";
case 2:return"right"}}}}},_getGrouper:function(){return this.element.find(".coral-toolbar-grouper")},_resetGrouper:function(){var a=this._getGrouper();if(a.length){a.width(1)}},_resetToolbarItems:function(){var b=this,a=this._getElements(2);this._resetGrouper();$.each(a,function(f,h){var e=$(h),d=b._getComponentByElement(e);d.css({left:""});if(d.hasClass("coral-menubutton-button-item")){var j=e.attr("group"),g=b.element.find("[group-role='"+j+"']");if(g.find("[data-frozen='true']").length){var c=g.find("[data-frozen='true']:eq(0)");var k=b._getComponentByElement(c);k.before(d.removeClass("coral-menubutton-button-item"))}else{g.append(d.removeClass("coral-menubutton-button-item"))}}});this.uiAfter.menubutton("hidePanel");this.uiAfter.menubutton("hide");this.uiBorder.css({width:"auto"})},_position:function(){if(!this.element.is(":visible")||!this.options.responsive){this._resetToolbarItems();this.component().addClass("coral-toolbar-initHidden");return}else{this.component().removeClass("coral-toolbar-initHidden")}var b=this,a=this.options;this._resetGrouper();this.totalWidth=this._totalWidth();if(a.isOverflow&&this.uiBox.width()>0){this.uiBorder.width(this.uiBox.width())}else{this.uiBorder.width(Math.max(this.totalWidth,this.uiBox.width()))}if(this._toolbarWidth()-this.totalWidth<0){this.uiAfter.menubutton("show")}else{this.uiAfter.menubutton("hide")}this._positionItems(this.element)},_positionItems:function(a){var c=this,b=this.options,f=this.options.margin,e=false,g=0,d=$(),h={right:"auto"};this._prePosition();this.element.find(".coral-toolbar-item:not(.coral-state-hidden)").each(function(i,j){var k=$(j);if(e){return true}if(d.length){g=g+d.outerWidth()+f}h.left=g+"px";k.css(h);d=k});this._handlerDropdownItems()},_handlerDropdownItems:function(){var b=this,a=this._filter(this._getElements(0),".ctrl-init-splitbutton,.ctrl-init-menubutton");b._hideMenus();$.each(a,function(f,g){var e=$(g),d=b._getComponentByElement(e);try{switch(e.attr("component-role")){case"splitbutton":if(d.hasClass("coral-menubutton-button-item")){e.splitbutton("menu").tieredmenu("option",{my:"left top",at:"right top",of:e.splitbutton("uiDropdownButton")})
}else{e.splitbutton("menu").tieredmenu("option",{my:"left top",at:"left bottom",of:e})}break;case"menubutton":if(d.hasClass("coral-menubutton-button-item")){e.menubutton("menu").tieredmenu("option",{my:"left top",at:"right top"})}else{e.menubutton("menu").tieredmenu("option",{my:"left top",at:"left bottom"})}break;default:break}}catch(c){console.log(" There is a error happened.")}finally{}})},_getComponentByElement:function(b){var a=$(),c=b.attr("component-role");if(c){a=b[c]("component")}else{a=b}return a},_filter:function(b,a){var c=[];$.each(b,function(e,f){var d=$(f);if(d.is(a)){c.push(d)}});return c},_prePosition:function(){var b=this,a=this.options,f=this.options.margin,h=0,e=false,g=[],d=$(),c=[];if(this.uiAfter.is(":visible")){c=this._getElements(3)}else{c=this._getElements(2)}var c=this._jion(b._getFrozenElements(),b._filter(c,":not([data-frozen='true'])"));$.each(c,function(m,o){var l=b._getComponentByElement($(o));var k=!l.hasClass("coral-menubutton-button-item");if(e){if(!k){return true}if(l.hasClass("coral-toolbar-grouper")||$(o).attr("data-frozen")=="true"){return true}g.push(l);return true}if(d.length&&d.is(":visible")){h=h+d.outerWidth()+f}if(!k){var n=b.element.find("[group-role='"+$(o).attr("group")+"']");if(n.attr("group-role")==$(o).attr("group")&&n.find("[data-frozen='true']").length){var j=n.find("[data-frozen='true']:eq(0)");if(j.attr("component-role")){j[j.attr("component-role")]("component").before(l.removeClass("coral-menubutton-button-item"))}else{j.before(l.removeClass("coral-menubutton-button-item"))}}else{l.removeClass("coral-menubutton-button-item").appendTo(n)}}if(h+l.outerWidth()>b._toolbarWidth()){e=true;if(l.hasClass("coral-toolbar-grouper")||$(o).attr("data-frozen")=="true"){return true}if(k){g.push(l)}else{b.uiAfter.menubutton("prepend",l)}return true}d=l});if(!this.isLoaded){b.uiAfter.menubutton("append",g)}else{b.uiAfter.menubutton("prepend",g)}this._setGrouperWidth()},_setGrouperWidth:function(){var f=this._getGrouper();var b=(this._toolbarWidth()-this._totalWidth(true,this.uiAfter.is(":visible"))-this.options.margin);
var e=this._getWidthByGroupRole("left");var c=this._getWidthByGroupRole("right");var a=(b-e+c)/2;var d=(b-a);if(b<0){f.width(1);return}if(f.length==1){f.width(b)}else{if(f.length==2){if(a>0&&d>0&&!this.uiAfter.is(":visible")){$(f[0]).width(a+1);$(f[1]).width(d+1)}else{$(f[1]).width(b+1);$(f[0]).width(1)}}}},_getWidthByGroupRole:function(e){var d=this.options,c=0,b=this.element.find("[group-role='"+e+"']"),a=b.find(".coral-toolbar-item");if(!b.length||!a.length){return 0}$.each(a,function(h,g){var f=$(g);c+=f.outerWidth()+d.margin;if(h==a.length-1){c-=d.margin}});return c},_toolbarWidth:function(){return this.uiBorder.innerWidth()},_setFrozenElements:function(){var b=this._getElements(3),a=false;$.each(b,function(d,e){var c=$(e);if(c.hasClass("coral-toolbar-after-element")){a=true}if(a&&!c.hasClass("coral-toolbar-grouper")){c.attr("data-frozen",true)}})},_getFrozenElements:function(){if(this.uiAfter.is(":visible")){return this.element.find("[data-frozen='true']")}else{return this.element.find("[data-frozen='true']:not(.coral-toolbar-after-element)")}},_getElements:function(b){var a=$(),c=this.element.find(".ctrl-toolbar-element"),d=this.uiAfter.menubutton("buttons").find(".ctrl-toolbar-element");a=this._jion(c,d);switch(b){case 0:a=this._filter(a,":not(.coral-toolbar-after-element,.coral-toolbar-grouper,.coral-toolbar-separator)");break;case 1:a=this._filter(a,":not(.coral-toolbar-after-element,.coral-toolbar-grouper)");break;case 2:a=this._filter(a,":not(.coral-toolbar-after-element)");break;case 3:break;default:break}return a},_getComponents:function(c,a){var b=$(),d=this.element.find(".coral-toolbar-item"),e=this.uiAfter.menubutton("buttonElements");b=this._jion(d,e);c=c||1;switch(c){case 0:b=this._filter(b,":not(.coral-toolbar-after,.coral-toolbar-grouper,.coral-toolbar-separator)");break;case 1:b=this._filter(b,":not(.coral-toolbar-after,.coral-toolbar-grouper)");break;case 2:b=this._filter(b,":not(.coral-toolbar-after)");break;case 3:break;default:break}if(!a){$itemAll=this._filter(b,".coral-state-hidden")
}return b},getTotalWidth:function(a){return this._totalWidth(a)},_totalWidth:function(c,b){var e=this,d=this.options,a=0;var g=$();if(b){g=this.element.find(".coral-toolbar-item:not(.coral-state-hidden)")}else{g=this.element.find(".coral-toolbar-item:not(.coral-state-hidden,.coral-toolbar-after)")}var f=this.uiAfter.menubutton("buttons").find(".coral-toolbar-item:not(.coral-state-hidden)");g.each(function(i,j){var h=$(j);a=a+h.outerWidth()+d.margin;if(i==g.length-1&&!f.length){a=a-d.margin}});if(c){return a-d.margin}this.uiAfter.menubutton("showPanel");f.each(function(i,j){var h=$(j);a=a+h.outerWidth()+d.margin;if(i==f.length-1){a=a-d.margin}});this.uiAfter.menubutton("hidePanel");return a},_getIcon:function(d){var c={ico1:null,ico2:null},b=[],a;if(d==null){return c}a=$.trim(d);if(a.indexOf(",")>=0){b=a.split(",");c.ico1=b[0]==""?null:b[0];c.ico2=b[1]==""?null:b[1]}else{c.ico1=a}return c},getLength:function(){return this._getElements(0).length},isExist:function(a){return this._getSubCoral(a)?true:false},_getGroupElementsLength:function(b){if(typeof b!=="number"||b>(this.groupLength-1)){return}var c=this._getGroupNameByIndex(b);var a=this.element.find("[group-role='"+c+"']");return a.find(".ctrl-toolbar-element:not(.coral-toolbar-separator)").length},add:function(b,e,d){if(typeof e!=="object"){return}if(typeof b==="string"){return this._addByParentId(b,e)}d=d||0;var c=this,a=parseInt(b);if(((null!=b)&&isNaN(a))||a<0||a>this._getGroupElementsLength(d)){return}if(!$.isArray(e)){e=[e]}if(0==this._getGroupElementsLength(d)){b=null}this._addItems(b,e,d);this._refresh()},_addByParentId:function(a,d){var c=this._getSubCoral(a);if(c){var b=c.$el;switch(c.type){case"splitbutton":b.splitbutton("menu").tieredmenu("add",null,d);break;case"menubutton":b.menubutton("menu").tieredmenu("add",null,d);break;case"tieredmenu":b.tieredmenu("add",a,d);break;default:break}}},getSubCoral:function(a){var b=this;if(typeof a==="string"){return b._getSubCoral(a)}else{return b._getSubCoralByIndex(a)
}},_getSubCoralByIndex:function(b){var c=this,a=parseInt(b);if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}return c._getSubCoral(a)},_findElementsByAttr:function(b,a,d){var c=this,e=[];$.each(b,function(f,h){var g=$(h);if(d==g.attr(a)){e.push(g)}});return e},_getSubCoral:function(a){var c=this,i=this._findElementsByAttr(this._getElements(0),"id",a),e=null,g=this._findElementsByAttr(this._getElements(0),"component-role","splitbutton"),d=this._findElementsByAttr(this._getElements(0),"component-role","menubutton"),b=null,h=null,f=null;if(typeof a==="number"){f=$(this._getElements(0)[a]);h={$el:f,type:f.attr("component-role")};return h}if(i.length){h={$el:i[0],type:i[0].attr("component-role")};return h}b=this._findSubCoralInMenuItems(g,a);if(g.length&&b){h={$el:b,type:"tieredmenu"};return h}b=this._findSubCoralInMenuItems(d,a);if(d.length&&b){h={$el:b,type:"tieredmenu"};return h}return h},_findSubCoralInMenuItems:function(b,c){if(!b.length){return}var a=null;$.each(b,function(e,h){var d=$(h),g=d.attr("component-role"),f=$(h)[g]("menu");if(f.find("[data-id='"+c+"']").length){a=f}});return a},removeAll:function(){var a=this;$.each(this._getElements(1),function(b,d){var c=$(d),e=c.attr("component-role");if(e){c[e]("destroy")}c.remove()});this._refresh()},remove:function(a){var b=this;if(typeof a==="string"){this._removeById(a)}else{this._removeByIndex(a)}this._refresh()},_removeById:function(e){var b=this,c=this._getSubCoral(e);if(c){var a=c.$el;if(a.hasClass("coral-toolbar-html")){a.remove();return}switch(c.type){case"tieredmenu":a.tieredmenu("removeItem",e);break;default:var d=a.attr("component-role");a[d]("destroy");a.remove();break}}},_removeByIndex:function(b){var a=parseInt(b);if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}var c=$(this._getElements(0)[a]);var d=c.attr("component-role");if(d){c[d]("component").remove()}c.remove()},update:function(b,a){var c=this;if(typeof b==="string"){c._updateById(b,a)}else{c._updateByIndex(b,a)}this._refresh()},_updateById:function(d,a){var c=this._getSubCoral(d);
if(c){var b=c.$el;switch(c.type){case"tieredmenu":b.tieredmenu("updateItem",d,a);break;case"button":b.button("update",a);break;case"splitbutton":b.splitbutton("button").button("update",a);break;case"menubutton":b.menubutton("button").button("update",a);break;default:break}}},_updateByIndex:function(c,b){var a=parseInt(c);if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}var e=this._getSubCoral(c);if(e){var d=e.$el;switch(e.type){case"button":d.button("update",b);break;case"splitbutton":d.splitbutton("button").button("update",b);break;case"menubutton":d.menubutton("button").button("update",b);break;default:break}}},component:function(){return this.uiBox},_uiBorder:function(){return this.uiBorder},disable:function(){this._setDisabled(true)},enable:function(){this._setDisabled(false)},_setDisabled:function(a){var c=this;var b=this._getElements(0);$.each(b,function(e,f){var d=$(f);if(d.hasClass("coral-toolbar-html")){return true}if(!d.attr("component-role")){return}if(a){d[d.attr("component-role")]("disable")}else{d[d.attr("component-role")]("enable")}});this.options.disabled=!!a},disableItem:function(a){var b=this;if(typeof a==="string"){b._disableItemById(a)}else{b._disableItemByIndex(a)}},_disableItemById:function(e){var b=this,d=this._getSubCoral(e);if(d){var a=d.$el;if(a.hasClass("coral-toolbar-html")){return}switch(d.type){case"tieredmenu":a.tieredmenu("disableItem",e);break;default:var c=$(this._findElementsByAttr(this._getElements(0),"id",e)[0]);if(!c.length){return}c[c.attr("component-role")]("disable");break}}},_disableItemByIndex:function(b){var c=this,a=parseInt(b);if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}var d=$(this._getElements(0)[a]);if(d.hasClass("coral-toolbar-html")){return false}if(!d.length){return false}d[d.attr("component-role")]("disable");return true},enableItem:function(a){var b=this;if(typeof a==="string"){b._enableItemById(a)}else{b._enableItemByIndex(a)}},_enableItemById:function(e){var b=this,d=this._getSubCoral(e);if(d){var a=d.$el;
if(a.hasClass("coral-toolbar-html")){return}switch(d.type){case"tieredmenu":a.tieredmenu("enableItem",e);break;default:var c=$(this._findElementsByAttr(this._getElements(0),"id",e)[0]);if(!c.length){return}c[c.attr("component-role")]("enable");break}}},_enableItemByIndex:function(b){var c=this,a=parseInt(b);if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}var d=$(this._getElements(0)[a]);if(d.hasClass("coral-toolbar-html")){return}if(!d.length){return false}d[d.attr("component-role")]("enable");return true},hide:function(a){var b=this;if(typeof a==="string"){b._hideById(a)}else{b._hideByIndex(a)}this._refresh()},hideAll:function(){var a=this;$.each(this._getElements(1),function(b,d){var c=$(d).attr("component-role");if(c){$(d)[c]("hide")}else{$(d).hide()}});this._refresh()},_hideById:function(e){var b=this,d=this._getSubCoral(e);if(d){var a=d.$el;if(a.hasClass("coral-toolbar-html")){a.hide();return}switch(d.type){case"tieredmenu":a.tieredmenu("hideItem",e);break;default:var c=$(this._findElementsByAttr(this._getElements(0),"id",e)[0]);if(!c.length){return}c[c.attr("component-role")]("hide");break}}},_hideByIndex:function(b){var c=this,a=parseInt(b);if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}var d=$(this._getElements(0)[a]);if(!d.length){return false}if(d.hasClass("coral-toolbar-html")){d.hide();return true}d[d.attr("component-role")]("hide");return true},show:function(a){var b=this;if(typeof a==="string"){b._showById(a)}else{b._showByIndex(a)}this._refresh()},showAll:function(){var a=this;$.each(this._getElements(1),function(b,d){var c=$(d).attr("component-role");if(c){$(d)[c]("show")}else{$(d).show()}});this._refresh()},_showById:function(e){var b=this,d=this._getSubCoral(e);if(d){var a=d.$el;if(a.hasClass("coral-toolbar-html")){a.show();return}switch(d.type){case"tieredmenu":a.tieredmenu("showItem",e);break;default:var c=$(this._findElementsByAttr(this._getElements(0),"id",e)[0]);if(!c.length){return}c[c.attr("component-role")]("show");break}}},_showByIndex:function(b){var d=this,a=parseInt(b);
if(isNaN(a)||a<0||a>(this.getLength()-1)){return false}var e=$(this._getElements(0)[a]);var c=e.attr("component-role");if(!e.length){return false}if(c){e[c]("show")}else{e.show()}return true},_destroy:function(){this.uiBox.replaceWith(this.element)},_setOption:function(a,c){var b=this;if(a==="id"||a==="name"){return}if(a==="disabled"){this._setDisabled(c)}this._super(a,c)},refresh:function(){this._refresh()},_refresh:function(){this._position();$.coral.refreshAllComponent(this.element)}});

/*!
 * 组件库4.0.1：按钮
 *
 * 依赖JS文件:
 *	   jquery.coral.core.js
 *	   jquery.coral.component.js
 */
(function(){var d,c="coral-button coral-component coral-state-default coral-corner-all",f="coral-button-text-icons coral-button-text-icon-primary coral-button-text-icon-secondary",b="coral-state-focus",e=function(){var g=$(this);setTimeout(function(){g.find(":coral-button").button("refresh")},1)},a=function(h){var g=h.name,i=h.form,j=$([]);if(g){g=g.replace(/'/g,"\\'");if(i){j=$(i).find("[name='"+g+"'][type=radio]")}else{j=$("[name='"+g+"'][type=radio]",h.ownerDocument).filter(function(){return !this.form})}}return j};$.component("coral.button",{version:"4.0.1",defaultElement:"<button>",options:{id:null,name:null,cls:null,title:false,disabled:null,text:true,label:null,icons:{primary:null,secondary:null},type:"button",width:null,countdown:false,countdownTime:3000,showCountdown:true,onCreate:null,onClick:null,onDblClick:null,onMouseEnter:null,onMouseLeave:null},_create:function(){this.options.icons=this._icons();this.element.addClass("ctrl-init ctrl-init-button");this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,e);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.prop("disabled")}else{this.element.prop("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title")||this.options.title;var i=this,g=this.options,j=this.type==="checkbox"||this.type==="radio",h=!j?"coral-state-active":"";if(g.id){this.element.attr("id",g.id)}if(g.name){this.element.attr("name",g.name)}if(g.label===null){g.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html())}this._hoverable(this.buttonElement);this.buttonElement.addClass(c).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(g.disabled){return}if(this===d){$(this).addClass("coral-state-active")}i._trigger("onMouseEnter",null,{id:this.id,label:i.options.label})}).bind("mouseleave"+this.eventNamespace,function(){if(g.disabled){return
}$(this).removeClass(h);i._trigger("onMouseLeave",null,{id:this.id,label:i.options.label})}).bind("click"+this.eventNamespace,function(l){if(g.disabled){l.preventDefault();l.stopImmediatePropagation()}else{if(g.once){i.element.button("disable")}if(g.countdown){var n=g.countdownTime/1000;var k=i.element.button("option","label");function m(){if(n<=0){i.element.button("enable");i.element.button("option","label",k)}else{i.element.button("option","label",k+"("+n+")");n--;setTimeout(function(){m()},1000)}}if($(document).find(i.element).length){i.element.button("disable");if(g.showCountdown){m()}else{i._delay(function(){i.element.button("enable");i.element.button("option","label",k)},g.countdownTime)}}}i._trigger("onClick",null,{id:this.id,label:i.options.label})}}).bind("dblclick"+this.eventNamespace,function(k){if(g.disabled){k.preventDefault();k.stopImmediatePropagation()}else{i._trigger("onDblClick",null,{id:this.id,label:i.options.label})}});this._on({focus:function(){this.buttonElement.addClass("coral-state-focus")},blur:function(){this.buttonElement.removeClass("coral-state-focus")}});if(j){this.element.bind("change"+this.eventNamespace,function(){i.refresh()})}if(this.type==="checkbox"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(g.disabled){return false}})}else{if(this.type==="radio"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(g.disabled){return false}$(this).addClass("coral-state-active");i.buttonElement.attr("aria-pressed","true");var k=i.element[0];a(k).not(k).map(function(){return $(this).button("component")[0]}).removeClass("coral-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(g.disabled){return false}$(this).addClass("coral-state-active");d=this;i.document.one("mouseup",function(){d=null})}).bind("mouseup"+this.eventNamespace,function(){if(g.disabled){return false}$(this).removeClass("coral-state-active")}).bind("keydown"+this.eventNamespace,function(k){var l=$.coral.keyCode;
if(g.disabled){return false}if(k.keyCode===l.SPACE||k.keyCode===l.ENTER){$(this).addClass("coral-state-active")}i._trigger("onKeyDown")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("coral-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(k){if(k.keyCode===$.coral.keyCode.SPACE){$(this).click()}})}}}if(g.width){this.buttonElement.outerWidth(g.width)}this._setOption("disabled",g.disabled);this._resetButton()},_icons:function(){var j=this.options.icons,i=null,l=null,k=null,g=null;if(j&&typeof j==="string"){i=j.split(",");if(i.length>0){l=$.trim(i[0]);g=h("right",l);if(null===g){k=h("left",l,true)}}if(i.length>1){l=$.trim(i[1]);k=((k===null)?h("left",l):k);if(null===g){g=h("right",l,true)}}}else{return j}function h(n,o,p){var m=o.split(" ");if($.inArray(n,m)>-1){m=$.grep(m,function(q,r){return q!==n});return m.join(" ")}if(p){return o}return null}return{primary:k,secondary:g}},_determineButtonType:function(){var g,i,h;if(this.element.is("[type=checkbox]")){this.type="checkbox"}else{if(this.element.is("[type=radio]")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){g=this.element.parents().last();i="label[for='"+this.element.attr("id")+"']";this.buttonElement=g.find(i);if(!this.buttonElement.length){g=g.length?g.siblings():this.element.siblings();this.buttonElement=g.filter(i);if(!this.buttonElement.length){this.buttonElement=g.find(i)}}this.element.addClass("coral-helper-hidden-accessible");h=this.element.is(":checked");if(h){this.buttonElement.addClass("coral-state-active")}this.buttonElement.prop("aria-pressed",h)}else{this.buttonElement=this.element}},component:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("coral-helper-hidden-accessible");this.buttonElement.removeClass(c+" ui-state-active "+f).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".coral-button-text").html());
if(!this.hasTitle){this.buttonElement.removeAttr("title")}},_setOption:function(g,h){this._super(g,h);if(g==="disabled"){this.component().toggleClass("coral-state-disabled",!!h);this.element.prop("disabled",!!h);if(h){if(this.type==="checkbox"||this.type==="radio"){this.buttonElement.removeClass("coral-state-focus")}else{this.buttonElement.removeClass("coral-state-focus coral-state-active")}}return}this._resetButton()},update:function(g){if(typeof g==="string"){this.element.find(".coral-button-text").html(g)}},refresh:function(){var g=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("coral-button-disabled");if(g!==this.options.disabled){this._setOption("disabled",g)}if(this.type==="radio"){a(this.element[0]).each(function(){if($(this).is(":checked")){$(this).button("component").addClass("coral-state-active").attr("aria-pressed","true")}else{$(this).button("component").removeClass("coral-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("coral-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("coral-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var k=this.buttonElement.removeClass(f),i=$("<span></span>",this.document[0]).addClass("coral-button-text").html(this.options.label).appendTo(k.empty()).text(),h=this.options.icons,g=h.primary&&h.secondary,j=[];if(h.primary||h.secondary){if(this.options.text){j.push("coral-button-text-icon"+(g?"s":(h.primary?"-primary":"-secondary")))}if(h.primary){k.prepend("<span class='coral-button-icon-primary icon "+h.primary+"'></span>")}if(h.secondary){k.append("<span class='coral-button-icon-secondary icon "+h.secondary+"'></span>")}if(!this.options.text){j.push(g?"coral-button-icons-only":"coral-button-icon-only");if(!this.hasTitle){k.attr("title",$.trim(i))}}}else{j.push("coral-button-text-only")
}if(this.hasTitle){k.attr("title",$.trim(i))}k.addClass(j.join(" "))}});$.component("coral.buttonset",{version:"4.0.1",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(coral-button)"},_create:function(){this.element.addClass("coral-buttonset")},_init:function(){this.refresh()},_setOption:function(g,h){if(g==="disabled"){this.buttons.button("option",g,h)}this._super(g,h)},refresh:function(){var h=this.element.css("direction")==="rtl",g=this.element.find(this.options.items),i=g.filter(":coral-button");g.not(":coral-button").button();i.button("refresh");this.buttons=g.map(function(){return $(this).button("component")[0]}).removeClass("coral-corner-all coral-corner-left coral-corner-right").filter(":first").addClass(h?"coral-corner-right":"coral-corner-left").end().filter(":last").addClass(h?"coral-corner-left":"coral-corner-right").end().end()},_destroy:function(){this.element.removeClass("coral-buttonset");this.buttons.map(function(){return $(this).button("component")[0]}).removeClass("coral-corner-left coral-corner-right").end().button("destroy")}})})();

/*!
 * 组件库4.0：下拉按钮
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$.component("coral.splitbutton",$.coral.button,{version:"4.0.2",componentName:"splitbutton",castProperties:["menuOptions","dataCustom"],options:{id:null,name:null,label:null,cls:null,icons:{primary:null,secondary:null},width:null,text:true,disabled:false,menuOptions:{autoDisplay:false,popup:true},data:null,url:null,onCreate:null,onClick:null,onDblClick:null},component:function(){var a=this;return this.uiBox},uiBorder:function(){return this.uiBorder},uiDropdownButton:function(){return this.dropdownButton},menu:function(){return this.uiMenu},_create:function(){var a=this;this._initElements();this._super()},_initElements:function(){var e=this,d=this.options,c=this.options.menuOptions,f=this.options.data,a=this.options.url;this.element.addClass("ctrl-init ctrl-init-splitbutton coral-splitbutton-element");this.dropdownButton=$("<button class='coral-splitbutton-dropdownbutton' type='button'></button>").uniqueId();this.uiBorder=$('<span class="coral-splitbutton-border"></span>');this.uiBox=$('<span class="coral-splitbutton"></span>');this.uiBox.append(this.uiBorder);this.uiMenu=$('<ul class="coral-splitbutton-menu"></ul>');this.uiBox.insertAfter(this.element);this.uiBorder.append(this.element).append(this.dropdownButton);this.uiMenu.appendTo($(document.body));if(d.width){this.uiBox.css({width:d.width})}if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}else{this.options.id=this.element.uniqueId()}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name")}else{if(this.options.name){this.element.attr("name",this.options.name)}}this.triggerId=this.dropdownButton.attr("id");this._on(this.element,{buttononclick:function(h,g){e._trigger("onClick",h,g)}});this.dropdownButton.button({label:"下拉按钮",text:false,icons:"cui-icon-arrow-down3",onClick:function(i,h){if(!e._getToolbar().length||e._getToolbar().toolbar("option","clickToDisplay")==0){return
}if(!e._getToolbar().length||!e._getToolbar().toolbar("option","autoDisplay")){return}var g=e._getToolbar(true);if(g.length){g.toggleClass("coral-toolbar-click-active")}},onMouseEnter:function(i,h){if(!e._getToolbar().length||!e._getToolbar().toolbar("option","autoDisplay")){return}var g=e._getToolbar(true);if(g.hasClass("coral-toolbar-click-active")){if($(".coral-tieredmenu:visible").length){e._hideMenus()}e.uiMenu.tieredmenu("show")}}});var b={};if(null!=f){b.data=f}if(null!=a){b.url=a}c=$.extend({},b,d.menuOptions,{id:this.element.attr("id")+"_tieredmenu",trigger:this.dropdownButton,of:this.element});this.uiMenu.tieredmenu(c);if(e._getToolbar().length&&e._getToolbar().toolbar("option","autoDisplay")){this.uiMenu.tieredmenu("component").bind("mouseleave",function(){e._hideMenus()})}this._on(this.uiMenu,{tieredmenuonclick:function(h,g){e._trigger("onClick",h,g)}})},_getToolbar:function(b){var d=this,c=this.options,a=$();if(this.element.hasClass("ctrl-toolbar-element")){a=b?this.element.parents(".coral-toolbar:eq(0)"):this.element.parents(".ctrl-init-toolbar:eq(0)")}return a},_hideMenus:function(){$(".coral-tieredmenu").hide()},hideAllMenus:function(){$(".coral-tieredmenu").hide()},showMenu:function(){this.uiMenu.tieredmenu("show")},_setOption:function(a,c){if(a==="id"||a==="name"){return}var b=this;if(a==="disabled"){this.element.toggleClass("coral-state-disabled",c);this.dropdownButton.button("option","disabled",c)}this._super(a,c)},_destroy:function(){this.uiBox.replaceWith(this.element);this.uiMenu.parent().remove();this.element.removeClass("ctrl-init ctrl-init-splitbutton coral-splitbutton-element")}});

/*!
 * 组件库4.0：下拉按钮
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$(document).unbind(".coral-menubutton").bind("mousedown.coral-menubutton mousewheel.coral-menubutton",function(a){if($(a.target).closest("span.coral-menubutton,.coral-menubutton-buttons").length){return}$(".coral-menubutton-buttons").hide()});$.component("coral.menubutton",$.coral.button,{version:"4.0.2",castProperties:["menuOptions"],options:{id:null,name:null,label:null,cls:null,icons:{primary:null,secondary:"cui-icon-arrow-down3"},width:null,text:true,disabled:false,renderType:"menu",menuOptions:{autoDisplay:false,popup:true},data:null,url:null,method:"get",position:{my:"left top",at:"left bottom"},onCreate:null,onClick:null,onDblClick:null,onLoad:null},showPanel:function(){var e=this,d=this.options;var a=$.extend(d.position,{of:this.element});var b=this.uiButtons.siblings(".coral-front:visible").map(function(){return +$(this).css("z-index")}).get(),c=Math.max.apply(null,b);if(c>=+this.uiButtons.css("z-index")){this.uiButtons.css("z-index",c+1)}this.uiButtons.css({position:"absolute",left:"",top:""}).position(a).show()},hidePanel:function(){this.uiButtons.hide()},_create:function(){this._initElements();this._super()},_getToolbar:function(b){var d=this,c=this.options,a=$();if(this.element.hasClass("ctrl-toolbar-element")){a=b?this.element.parents(".coral-toolbar:eq(0)"):this.element.parents(".ctrl-init-toolbar:eq(0)")}return a},_hideMenus:function(){$(".coral-tieredmenu").hide()},hideAllMenus:function(){$(".coral-tieredmenu").hide()},showMenu:function(){this.uiMenu.tieredmenu("show")},_initElements:function(){var b=this,a=this.options;this.element.addClass("ctrl-init ctrl-init-menubutton coral-menubutton-element");this.uiBorder=$('<span class="coral-menubutton-border"></span>');this.uiBox=$('<span class="coral-menubutton"></span>');this.uiBox.append(this.uiBorder);this.uiBox.insertAfter(this.element);this.uiBorder.append(this.element);if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")
}else{if(this.options.id){this.element.attr("id",this.options.id)}else{this.options.id=this.element.uniqueId().attr("id")}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name")}else{if(this.options.name){this.element.attr("name",this.options.name)}}this.options.onClick=function(f,d){if(a.renderType=="button"){if(!b.uiButtons.is(":visible")){b.showPanel()}else{b.hidePanel()}}if(!b._getToolbar().length||!b._getToolbar().toolbar("option","autoDisplay")){return}var c=b._getToolbar(true);if(c.length){c.toggleClass("coral-toolbar-click-active")}},this.options.onMouseEnter=function(f,d){if(!b._getToolbar().length||!b._getToolbar().toolbar("option","autoDisplay")){return}if(a.renderType=="button"){return}var c=b._getToolbar(true);if(c.hasClass("coral-toolbar-click-active")){if($(".coral-tieredmenu:visible").length){b._hideMenus()}b.uiMenu.tieredmenu("show")}};this._on(this.element,{buttononclick:function(d,c){b._trigger("onClick",d,c)}});if(a.renderType=="button"){this.uiButtons=$("<div class='coral-menubutton-buttons coral-front'></div>").appendTo($(document.body));this._loadData()}else{this.uiMenu=$('<ul class="coral-menubutton-menu"></ul>').appendTo($(document.body));this._renderMenu()}},_renderMenu:function(){var e=this,d=this.options,c=this.options.menuOptions,f=this.options.data,a=this.options.url;var b={};if(null!=f){b.data=f}if(null!=a){b.url=a}c=$.extend({},b,d.menuOptions,{id:this.element.attr("id")+"_tieredmenu",trigger:this.element,of:this.element});this.uiMenu.tieredmenu(c);if(e._getToolbar().length&&e._getToolbar().toolbar("option","autoDisplay")){this.uiMenu.tieredmenu("component").bind("mouseleave",function(){e._hideMenus()})}this._on(this.uiMenu,{tieredmenuonclick:function(h,g){e._trigger("onClick",h,g)}})},_loadData:function(){var b=this,a=this.options;if(a.url){$.ajax({type:a.method,url:a.url,data:{},dataType:"json",success:function(c){b._initData(c)},error:function(){$.alert("Json Format Error!")}})}else{if(a.data){this._initData(a.data)
}}},_initData:function(b){var a=this;if(typeof b==="object"){this._addItems(null,b)}a._trigger("onLoad",null,{})},_addItems:function(d,g){if(typeof g!=="object"){return}var f=this,c=[],b=g.length;for(var e=0;e<b;e++){var a=g[e];if(!$.isEmptyObject(a)){c.push(f._createButton(a))}}this._appendItems(d,c);this._initItems(c)},_createButton:function(a){return{button:$("<button type='button'></button>").addClass("coral-menubutton-button-item"),options:a}},_appendItems:function(b,a){for(var c in a){a[c].button.appendTo(this.uiButtons)}},_initItems:function(a){var f=this;for(var d in a){var c=a[d].button,e=a[d].options;c.button(e);var b={};b.buttononclick=function(h,g){f._trigger("onClick",h,g)};f._on(c,b)}},add:function(a){},prepend:function(d){if(!d instanceof jQuery){return}var e=this,a=d.length;if(!(d instanceof Array)){d=[d]}for(var c=a-1;c>-1;c--){var b=d[c];b.css({margin:"",left:"",right:""}).removeClass("coral-menubutton-button-item").addClass("coral-menubutton-button-item").prependTo(e.uiButtons)}},append:function(d){if(!d instanceof jQuery){return}var e=this,a=d.length;if(!(d instanceof Array)){d=[d]}for(var c=a-1;c>-1;c--){var b=d[c];b.css({margin:"",left:"",right:""}).removeClass("coral-menubutton-button-item").addClass("coral-menubutton-button-item").prependTo(e.uiButtons)}},pop:function(){var c=this,b=this.options;if("button"!=b.renderType){return $()}var a=this.uiButtons.find(".coral-menubutton-button-item:eq(0)");if(a.length){return a.removeClass("coral-menubutton-button-item")}else{return $()}},component:function(){return this.uiBox},border:function(){return this.uiBorder},buttons:function(){return this.uiButtons},buttonElements:function(){return this.uiButtons.children()},menu:function(){return this.uiMenu},_bindEvents:function(){},_setOption:function(a,c){var b=this;if(a==="id"||a==="name"){return}if(a==="disabled"){this.element.toggleClass("coral-state-disabled",c)}this._super(a,c)},_destroy:function(){var a=this.options;this.uiBox.replaceWith(this.element);
if(a.renderType=="buttons"){this.uiButtons.remove()}else{this.uiMenu.parent().remove()}this.element.children().remove();this.element.removeClass("ctrl-init ctrl-init-menubutton coral-menubutton-element")}});

/*!
 * 组件库4.0：下拉树按钮
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$.component("coral.treebutton",$.coral.button,{version:$.coral.version,castProperties:["treeOptions"],options:{id:null,name:null,label:null,cls:null,position:{my:"left top",at:"left bottom",collision:"none"},width:null,text:true,disabled:false,multiple:false,treeOptions:{id:null,name:null,data:null,showLine:false,showIcon:false,checkable:true},onCreate:null,onClick:null,onCheck:null,onSelect:null},tree:function(){return this.uiTree},_create:function(){var a=this;this._super();this._initElements()},_initElements:function(){var c=this,b=this.options,d=this.options.treeOptions;this.element.addClass("coral-treebutton-element").uniqueId();this.uiTree=$("<ul>").attr("id",$(this.element).attr("id")+"_tree").addClass("coral-treebutton-panel coral-front").appendTo("body");this.element.on("click",function(g,f){c._showtree()});this._on(this.document,{mousedown:function(e){if(e.isDefaultPrevented()){return}c._hidetree()}});this.uiTree.unbind().bind("mousedown",function(f){f.preventDefault()});var a={checkable:this.options.multiple};d=$.extend({},a,b.treeOptions,{id:$(this.element).attr("id")+"_tree"});this.uiTree.tree(d)},_bindEvents:function(){},_setOption:function(a,c){var b=this;this._super(a,c)},_showtree:function(b){var d=this.uiTree;d.show();var a=d.siblings(".coral-front:visible").map(function(){return +$(this).css("z-index")}).get(),c=Math.max.apply(null,a);if(c>=+d.css("z-index")){d.css("z-index",c+1)}d.position($.extend({of:this.element},this.options.position))},_hidetree:function(){this.uiTree.hide()},disabledNode:function(d){var b=this.uiTree.tree("getNodesByParam","id",d);for(var c=0,a=b.length;c<a;c++){this.uiTree.tree("setChkDisabled",b[0],true)}},undisabledNode:function(d){var b=this.uiTree.tree("getNodesByParam","id",d);for(var c=0,a=b.length;c<a;c++){this.uiTree.tree("setChkDisabled",b[0],false)}},_destroy:function(){this.uiTree.remove();this.element.removeClass("ctrl-init ctrl-init-treebutton coral-treebutton-element")
}});

(function(){var b=false,a=true;$(window).unbind(".coral-panel").bind("resize.coral-panel",function(){$.coral.beforeDoOverflow();if(!a){return}if(b!==false){clearTimeout(b)}b=setTimeout(function(){a=false;$.coral.refreshAllComponent("body");b=false;a=true},200)});$.component("coral.panel",{version:"4.0.2",options:{id:null,title:null,iconCls:null,width:"auto",height:"auto",left:null,top:null,cls:null,headerCls:null,bodyCls:null,style:{},href:null,cache:true,fit:false,border:true,doSize:true,showHeader:true,showTitle:true,content:null,collapsible:false,showNavButton:false,minimizable:false,maximizable:false,closable:false,collapsed:false,minimized:false,maximized:false,closed:false,tools:null,url:null,loadtext:"加载中，请耐心等候...",loadingMessage:"Loading...",extractor:function(e){var d=/<body[^>]*>((.|[\n\r])*)<\/body>/im;var c=d.exec(e);if(c){return c[1]}else{return e}},beforeOpen:$.noop,beforeClose:$.noop,beforeDestroy:$.noop,beforeCollapse:$.noop,beforeExpand:$.noop,onLoad:$.noop,onOpen:$.noop,onClose:$.noop,onDestroy:$.noop,onResize:$.noop,onMove:$.noop,onMaximize:$.noop,onRestore:$.noop,onMinimize:$.noop,onCollapse:$.noop,onExpand:$.noop},_create:function(){this.originalTitle=this.element.attr("title");this.element.removeAttr("title").addClass("ctrl-init ctrl-init-panel");this._createWrapper();this.isLoaded=false;this.element.appendTo(this.uiPanel);this._addHeader();this._setBorder();if(this.options.doSize==true){this.uiPanel.css("display","block");this.resizePanel()}if(this.options.closed==true||this.options.minimized==true){this.close()}else{this.open()}},_createWrapper:function(){var c=this;this.element.addClass("coral-panel-body");this.uiPanel=$('<div class="coral-panel"></div>').insertBefore(this.element)},_fit:function(c){return $.coral.panel.fit(this.uiPanel,c)},resizePanel:function(f){var e=this.options,d=this.uiPanel,g=d.children("div.coral-panel-header"),c=d.children("div.coral-panel-body");if(f){$.extend(e,{width:f.width,height:f.height,left:f.left,top:f.top})
}e.fit?$.extend(e,this._fit()):this._fit(false);d.css({left:e.left,top:e.top});if(!isNaN(e.width)){d.outerWidth(e.width)}else{d.width("auto")}g.add(c).outerWidth(d.width());if(!isNaN(e.height)){d.outerHeight(e.height);c.outerHeight(d.height()-g.outerHeight())}else{c.height("auto");d.css("height","")}this._doResize();if(this.toolbarEl){this.toolbarEl.toolbar("refresh")}this._trigger("onResize",null,{width:e.width,height:e.height})},_setBorder:function(){var e=this.options,d=this.uiPanel,f=this.header(),c=this.body();if(!$.isEmptyObject(e.style)){d.css(e.style)}if(e.border){f.removeClass("coral-panel-header-noborder");c.removeClass("coral-panel-body-noborder")}else{f.addClass("coral-panel-header-noborder");c.addClass("coral-panel-body-noborder")}f.addClass(e.headerCls);c.addClass(e.bodyCls)},_addHeader:function(){var c=this.options,d=this.uiPanel,i=this;if(c.tools&&typeof c.tools=="string"){d.find(">div.coral-panel-header>div.coral-panel-tool .coral-panel-tool-a").appendTo(c.tools)}d.children("div.coral-panel-header").remove();if(c.title&&c.showHeader){var h=$('<div class="coral-panel-header"></div>').prependTo(d);this.toolbarEl=$("<div></div>");this.toolbarEl.appendTo(h);var k=[];var m={type:"html",content:c.title},l={type:"button",icons:"cui-icon-arrow-up3 coral-panel-tool-collapse",label:"collapse",text:false,onClick:function(){if(c.collapsed===true){i.expand(true)}else{i.collapse(true)}}},j={type:"button",icons:"cui-icon-minus3 coral-panel-tool-min",label:"minimize",text:false,onClick:function(){i.minimize()}},g={type:"button",icons:"cui-icon-enlarge7 coral-panel-tool-max",label:"maximize",text:false,onClick:function(){if(c.maximized===true){i.restore()}else{i.maximize()}}},e={type:"button",icons:"cui-icon-cross2 coral-panel-tool-close",label:"close",text:false,onClick:function(){i.close()}};var f={data:k};if(c.toolbarOptions){$.each(c.toolbarOptions.data,function(n,o){if(o==="title"){c.toolbarOptions.data[n]=m}if(o==="collapse"){c.toolbarOptions.data[n]=l}if(o==="minimize"){c.toolbarOptions.data[n]=j
}if(o==="maximize"){c.toolbarOptions.data[n]=g}if(o==="close"){c.toolbarOptions.data[n]=e}});$.extend(true,f,c.toolbarOptions)}else{if(c.showTitle){k.push(m)}k.push("->");if(c.collapsible){k.push(l)}if(c.minimizable){k.push(j)}if(c.maximizable){k.push(g)}if(c.closable){k.push(e)}}this.toolbarEl.toolbar(f);d.children("div.coral-panel-body").removeClass("coral-panel-body-noheader")}else{d.children("div.coral-panel-body").addClass("coral-panel-body-noheader")}},toolbar:function(){return this.toolbarEl},_loadData:function(){var d=this.options,c=this;if(d.url){if(!c.isLoaded||!d.cache){c.isLoaded=false;c.element.html("");$(this.element).loading({position:"inside",text:this.options.loadtext});if(this.xhr){this.xhr.abort()}this.xhr=$.ajax(this._ajaxSettings());this.xhr.success(function(e){c.setContent(d.extractor.call(c.element,e));c._trigger("onLoad",null,arguments);c.isLoaded=true}).complete(function(f,e){if(f===c.xhr){c.xhr=null}})}}else{if(d.content){if(!c.isLoaded){c.setContent(d.content);c.isLoaded=true}}}},_ajaxSettings:function(){var d=this.options,c=this;return{url:d.url,cache:false,dataType:"html"}},_doResize:function(){$.coral.refreshAllComponent(this.element)},_destroy:function(c){if(c!=true){if(this._trigger("beforeDestroy")==false){return}}if(this.originalTitle){this.element.attr("title",this.originalTitle)}this.element.removeClass("coral-panel-body").detach();this.element.insertAfter(this.component());this.component().remove();this._trigger("onDestroy")},component:function(){return this.uiPanel},panel:function(){return this.uiPanel},getOptions:function(){return this.options},header:function(){return this.uiPanel.find(">div.coral-panel-header")},body:function(){return this.uiPanel.find(">div.coral-panel-body")},setTitle:function(c){this.options.title=c;this.header().find("div.coral-panel-title").html(c)},setContent:function(c){this.element.children().remove();this.element.html(c);if($.parser){$.parser.parse(this.element)}},open:function(c){var e=this.options,d=null;
if(c!=true){if(this._trigger("beforeOpen",null)===false){return}}this.uiPanel.show();e.closed=false;e.minimized=false;d=this.uiPanel.children(".coral-panel-header").find("a.coral-panel-tool-restore");if(d.length){e.maximized=true}this._trigger("onOpen");if(e.maximized===true){e.maximized=false;this.maximize()}if(e.collapsed===true){e.collapsed=false;this.collapse()}if(!e.collapsed){this._loadData();this._doResize()}},close:function(e){var d=this.options;var c=this.uiPanel;if(e!=true){if(this._trigger("beforeClose",null)==false){return}}this._fit(false);c.hide();d.closed=true;this._trigger("onClose")},refresh:function(c){this.isLoaded=false;if(c){this.options.url=c}this._loadData()},reload:function(c){this.refresh(c)},resize:function(c){this.resizePanel(c)},move:function(c){var d=this.options;if(c){if(c.left!=null){d.left=c.left}if(c.top!=null){d.top=c.top}}this.uiPanel.css({left:d.left,top:d.top});this._trigger("onMove",null,{left:d.left,top:d.top})},maximize:function(){var c=this.options;if(c.maximized===true){return}this.uiPanel.children("div.coral-panel-header").find("a.coral-panel-tool-max").addClass("coral-panel-tool-restore").addClass("cui-icon-shrink7").removeClass("cui-icon-enlarge7");if(!this.original){this.original={width:c.width,height:c.height,left:c.left,top:c.top,fit:c.fit}}c.left=0;c.top=0;c.fit=true;this.resizePanel();c.minimized=false;c.maximized=true;this._trigger("onMaximize")},minimize:function(){this._fit(false);this.uiPanel.hide();this.options.minimized=true;this.options.maximized=false;this._trigger("onMinimize")},restore:function(){if(this.options.maximized===false){return}this.uiPanel.show();this.uiPanel.children("div.coral-panel-header").find("a.coral-panel-tool-max").removeClass("coral-panel-tool-restore").addClass("cui-icon-enlarge7").removeClass("cui-icon-shrink7");$.extend(this.options,this.original);this.resizePanel();this.options.minimized=false;this.options.maximized=false;this.original=null;this._trigger("onRestore")},collapse:function(d){var f=this.options,c=this.body(),e=this;
if(f.collapsed===true){return}c.stop(true,true);if(e._trigger("beforeCollapse")===false){return}this.header().find("a.coral-panel-tool-collapse").addClass("coral-panel-tool-expand");if(d===true){c.slideUp("normal",function(){f.collapsed=true;e._trigger("onCollapse")})}else{c.hide();f.collapsed=true;e._trigger("onCollapse")}},expand:function(d){var f=this.options,c=this.body(),e=this;if(f.collapsed===false){return}c.stop(true,true);if(e._trigger("beforeExpand")===false){return}this.header().find("a.coral-panel-tool-collapse").removeClass("coral-panel-tool-expand");if(d===true){c.slideDown("normal",function(){f.collapsed=false;e._trigger("onExpand");e._loadData();e._doResize()})}else{c.show();f.collapsed=false;e._trigger("onExpand");e._loadData();e._doResize()}}});$.coral.panel.fit=function(e,c){c=(c==undefined?true:c);var d=e.parent()[0];d=$(d);if(c){if(!d.hasClass("coral-panel-noscroll")){d.addClass("coral-panel-noscroll");if(d.attr("tagName")=="BODY"){$("html").addClass("coral-panel-fit")}}}else{if(d.hasClass("coral-panel-noscroll")){d.removeClass("coral-panel-noscroll");if(d.attr("tagName")=="BODY"){$("html").removeClass("coral-panel-fit")}}}return{width:d.width(),height:d.height()}}})();

/*!
 * 组件库4.0：下拉框
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 *    jquery.coral.panel.js
 *    jquery.validatehelper.js
 *    jquery.coral.control.js
 */
(function(){$(document).unbind(".coral-combobox").bind("mousedown.coral-combobox mousewheel.coral-combobox",function(g){var f=$(g.target).closest(".coral-combo-panel").length;var h=$(g.target).closest(".coral-combo").length;var d=$(g.target).closest(".coral-button").length;if(f||(h&&!d)){return}a()});function a(b,c){$(".coral-combo-wrapper").not(b).hide();$(".coral-combo-iframePanel:visible").not(c).hide()}$.component("coral.combo",$.coral.inputbase,{castProperties:["triggers"],version:"4.0.2",options:{panelRenderOnShow:false,popupDialog:false,showStar:true,showDirection:"down",labelField:null,starBefore:false,isInited:false,id:null,name:null,showOnFocus:true,iframePanel:false,buttons:[],forceSelection:true,width:"auto",height:22,placeholder:"",cls:"",required:false,errMsg:null,errMsgPosition:"leftBottom",isLabel:false,panelWidth:null,panelHeight:"auto",panelComponentCls:"",position:{my:"left top",at:"left bottom",collision:"none"},maxPanelHeight:200,multiple:false,separator:",",valueTextSeparator:"-",postMode:"value",editable:false,readonly:false,readonlyInput:true,disabled:false,clearOnLoad:true,hasArrow:true,value:"",text:"",delay:200,zIndex:10000,enableHighlight:false,enablePinyin:false,showClose:false,enableFilter:false,enterFilter:true,query:null,filter:function(g,i){var d=$(this).attr("component-role"),e=$(this)[d]("option"),b=e.textField,c=e.valueField,h=(i[b]).toLowerCase(),f=(i[c]).toString().toLowerCase();g=g.toLowerCase();if(h.indexOf(g)>-1){return"text"}if(e.enablePinyin===true){if(pinyinEngine.toPinyin(h,false,"").indexOf(g)>-1){return true}}if(f.indexOf(g)>-1){return true}else{return false}},onKeyUp:null,onKeyDown:null,onEnter:null,onBlur:null,onClick:null,onValidError:null,onValidSuccess:null,onShowPanel:$.noop,onHidePanel:$.noop,onChange:$.noop,triggers:null,excluded:false},_addCacheItem:function(b){if(typeof b!=="object"){return
}if(typeof this.cache==="undefined"){this.cache={}}this.cache=$.extend({},this.cache,b)},_getCacheItem:function(b){if(typeof b!=="string"){return}if(this.cache&&this.cache[b]){return this.cache[b]}else{return null}},_removeCacheItem:function(b){if(this.cache&&this.cache[b]){delete this.cache[b]}},_create:function(){this._prepareInit();this._initCombo();this._setDefaultValue();this._initState();this._initData();this._bindEvent()},_prepareInit:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.panelRendered=false;this.dataLoaded=false;this.search=false;this.isInit=false;this.isLoaded=false;this.isInited=false;this.currentValues=[];this.cache={};if(this.options.enableSearch===true){this.options.readonlyInput=false}if(this.options.popupDialog||this.options.enableFilter){this.options.readonlyInput=true}this.element.hide();if(this.element.attr("id")){if(this.element.attr("id")!=this.options.id){this.options.id=this.element.attr("id")}}else{if(this.options.id){this.element.attr("id",this.options.id)}}if(!this.element.attr("id")){this.options.id=this.element.uniqueId().attr("id")}if(this.element.attr("name")&&this.options.name){if(this.element.attr("name")!=this.options.name){this.options.name=this.element.attr("name")}}else{if(!this.options.name&&this.element.attr("name")){this.options.name=this.element.attr("name")}}if(this.element.attr("value")&&this.options.value){if(this.element.attr("value")!=this.options.value){this.options.value=this.element.attr("value")}}else{if(!this.options.value&&this.element.attr("value")){this.options.value=this.element.attr("value")}}},_initCombo:function(){var d=null,c=null,f="",e="",b="";this.uiCombo={combo:null,panel:null};this.previousValue=null;this.uiCombo.combo=$("<span class='coral-combo coral-textbox'></span>").insertAfter(this.element);this.element.appendTo(this.uiCombo.combo);
if(this.options.hasArrow==true){if(this.options.showDirection=="down"){b="<span class='coral-combo-arrow coral-icon-arrow cui-icon-arrow-down3'></span>"}if(this.options.showDirection=="up"){b="<span class='coral-combo-arrow coral-icon-arrow cui-icon-arrow-up3'></span>"}}if(this.options.showClose&&!this.options.required){f="<span class='coral-input-clearIcon cui-icon-cross2'></span>"}this.elementBorder=$("<span class='coral-combo-border coral-textbox-border coral-corner-all'>"+f+b+"</span>").appendTo(this.uiCombo.combo);if(this.options.labelField){this.uiLabel=$('<label class="coral-label">'+this.options.labelField+"</label>");this.elementBorder.before(this.uiLabel);this.uiCombo.combo.addClass("coral-hasLabel")}this.uiCombo.textbox=$("<input type='text' autocomplete='off' class='coral-combo-text coral-combo-default coral-textbox-default tabbable'>").appendTo(this.elementBorder);if(this.options.name){this.element.removeAttr("name").attr("orgname",this.options.name);e=" name='"+this.options.name+"'"}c=$("<input type='hidden' "+e+" class='coral-combo-value'>").appendTo(this.uiCombo.combo);this.uiCombo.panel=$("<div class='coral-combo-panel "+this.options.panelComponentCls+"'></div>").appendTo("body");if(this.options.iframePanel){this.uiCombo.iframePanel=$("<iframe class='coral-combo-iframePanel' style='position:absolute;display:none;'></iframe>").appendTo("body")}this.uiCombo.pContent=$("<div class='coral-combo-content'></div>").appendTo(this.uiCombo.panel);if(this.options.enableFilter){$("<div class='coral-combo-filter'><span class='coral-combo-filter-border'><input type='text' class='coral-combo-filterbox'></span><span class='coral-combo-search cui-icon-search2'></span></div>").appendTo(this.uiCombo.panel)}var g="absolute";if(this.options.popupDialog){g="";this.uiCombo.popupDialog=$("<div class='coral-combo-popup-dialog'></div>").appendTo("body");this.uiCombo.popupInputbox=$("<input type='text' />").appendTo(this.uiCombo.popupDialog)}if(this.options.hasArrow==false){this.elementBorder.css({"padding-right":0});
this.uiCombo.textbox.css({"padding-right":0});this.uiClose().css({right:0})}this.uiCombo.panel.css({position:g}).addClass("coral-combo-wrapper "+this.options.cls+"-panel coral-front").hide();this.uiCombo.textbox.attr("placeholder",this.options.placeholder);this._showPlaceholder();if(this.options.buttons.length>0){this._createButtonPanel()}},_initState:function(){this.options.isLabel===true?this._setIsLabel(this.options.isLabel):this._setReadonly(this.options.readonly);if(!this.options.readonly){this.uiCombo.textbox.prop("readonly",this.options.readonlyInput)}this._setDisabled(this.options.disabled);this.resize()},_initData:$.noop,_setDefaultValue:function(){if(!this.options.value){this.originalValue="";return}else{this.setValue(this.options.value);this.originalValue=this.getValue()}},_showPlaceholder:function(c){if($.support.placeholder||this.component().find(".coral-textbox-placeholder-label").length){return}c=c?c:this.options.placeholder;var b=$("<span class='coral-textbox-placeholder-label'>"+c+"</span>");$(this.uiCombo.textbox).after(b)},_hidePlaceholder:function(){if($.support.placeholder){return}this.component().find(".coral-textbox-placeholder-label").remove()},_setIsLabel:function(b){var c=this;if(true===b){this.component().removeClass("coral-readonly");this.component().addClass("coral-isLabel");this.uiCombo.textbox.prop("readonly",true);if(this.options.emptyText&&""===this.getValue()){this.uiCombo.textbox.val("")}this.hidePanel();this.uiCombo.textbox.removeAttr("placeholder")}else{this.component().removeClass("coral-isLabel coral-readonly");this.uiCombo.textbox.prop("readonly",this.options.readonlyInput);this.options.readonly=false;this.uiCombo.textbox.attr("placeholder",this.options.placeholder)}this.options.isLabel=!!b},_setReadonly:function(b){if(b){this.element.prop("readonly",true);this.uiCombo.textbox.prop("readonly",true);this.uiCombo.combo.find(".coral-combo-value").prop("readonly",true)}else{$(this.element).prop("readonly",false);this.uiCombo.textbox.prop("readonly",false);
this.uiCombo.combo.find(".coral-combo-value").prop("readonly",false)}this.options.readonly=!!b;this.uiCombo.combo.removeClass("coral-isLabel");this.uiCombo.combo.toggleClass("coral-readonly",this.options.readonly)},_setDisabled:function(b){if(b){this.element.prop("disabled",true);this.uiCombo.combo.find(".coral-combo-value").prop("disabled",true);this.uiCombo.combo.find(".coral-combo-text").prop("disabled",true)}else{$(this.element).prop("disabled",false);this.uiCombo.combo.find(".coral-combo-value").prop("disabled",false);this.uiCombo.combo.find(".coral-combo-text").prop("disabled",false)}this.options.disabled=!!b;this.uiCombo.combo.toggleClass(this.componentFullName+"-disabled coral-state-disabled",this.options.disabled)},_selectPrev:$.noop,_selectNext:$.noop,_doEnter:$.noop,_doQuery:$.noop,_addHighlight:function(c,b){if(b===""||!c.length||!this.options.enableHighlight){return}c=$(c);var e="",f=b.replace(/[\s]+/g," ").split(" "),d;c.each(function(h,j){var g=$(j),k=$(j).parent(),i=$(j).html();if(i==b){return}if(g.hasClass(".coral-combobox-item-selected")){k.html(that._getTextFromHTML(i));return}if(!g.children("input").length){for(var l=0;l<f.length;l++){d=new RegExp(""+f[l]+"","gmi");i=i.replace(d,'<span class="coral-keyword-highlight">'+f[l]+"</span>")}g.html(i)}})},_getTextFromHTML:function(b){if(typeof b==="undefined"){return}b=b.replace(/<\/?[^>]*>/g,"");b=b.replace(/[ | ]*\n/g,"\n");b=b.replace(/&nbsp;/ig,"");return b},_clearValues:function(h){var e=this.options.valueField,c=this.currentValues,g=c.length,f,d,b=0;for(f=0;f<g;f++){for(d=0;d<h.length;d++){if(c[f]==h[d][e]){b+=1;break}}}if(b!=g){return true}else{return false}},_removeHighlight:function(b){if(!b.length||!this.options.enableHighlight){return}b=$(b);var c=this;b.each(function(d,f){var g=$(f).parent();var e=g.html();g.html(c._getTextFromHTML(e))})},focus:function(){var c=this;if(this.options.disabled||this.options.readonly||this.options.isLabel){return false}this.uiCombo.textbox.focus();if(!this.dataLoaded){var b={focus:{param:null}};
this._addCacheItem(b);return true}return true},_bindEvent:function(){var f=this,e=this.options,h=this.uiCombo.combo,b=this.uiCombo.panel,g=this.uiCombo.iframePanel;if(this.options.disabled){this.element.addClass("coral-state-disabled")}this._off(f.component());var c,d;this._on({"mouseenter.coral-combo-border":function(i){if(f.component().hasClass("coral-isLabel")||f.component().hasClass("coral-readonly")){return}f.uiCombo.combo.addClass("coral-textbox-hover");this._updateTitle()},"mouseleave.coral-combo-border":function(i){if(f.component().hasClass("coral-isLabel")||f.component().hasClass("coral-readonly")){return}f.uiCombo.combo.removeClass("coral-textbox-hover")},"keydown.coral-combo-text":function(i){this._doKeyDown(i,false)},"keyup.coral-combo-text":function(i){if(this.options.readonly||this.options.isLabel){return}this._trigger("onKeyUp",i,{})},"blur.coral-combo-text":function(i){this._setHv(i,"blur")},"focusin.coral-combo-text":function(i){if(this.options.readonly||this.options.isLabel){return}this.component().addClass("coral-state-focus");if(!c){this._trigger("onFocus",i)}},"focusout.coral-combo-text":function(i){if(this.cancelBlur){delete this.cancelBlur;return}if(this.options.readonly||this.options.isLabel){return}this._delay(function(){if(c){c=false;return}this.component().removeClass("coral-state-focus");if(d){d=false;return}this.hidePanel();this._trigger("onBlur",i)},100)},"click.coral-combo-text":function(i){if(f.component().hasClass("coral-isLabel")||f.component().hasClass("coral-readonly")){if(this.options.hasArrow==true&&!this.options.readOnlyInput){return}}if(f.component().hasClass("coral-state-focus")){if(this.options.popupDialog&&this.options.showOnFocus===true){this.uiCombo.popupDialog.dialog("open")}else{if(b.is(":visible")){this.hidePanel()}else{this.showPanel()}}}if(this.options.enableFilter){d=true}f._trigger("onClick",i)},"mousedown.coral-combo-arrow":function(i){if(this.component().hasClass("coral-isLabel")||this.component().hasClass("coral-readonly")){return
}if(this.component().hasClass("coral-state-focus")){c=true}},"click.coral-combo-arrow":function(i){a(b,g);if(f.component().hasClass("coral-isLabel")||f.component().hasClass("coral-readonly")){return}if(f.component().hasClass("coral-state-focus")){c=true}if(this.options.enableFilter){d=true}this.focus();if(f.options.popupDialog){f.uiCombo.popupDialog.dialog("open")}else{if(b.is(":visible")){f.hidePanel()}else{f.showPanel()}}},"click.coral-input-clearIcon":function(i){if(this.component().hasClass("coral-state-focus")){c=true}this.clear();if(this.options.placeholder){this._showPlaceholder()}},combogridonshowpanel:function(i){f._removeGridHighlights();f._scrollTo(f.getValue());f.grid().grid("refresh")}});this._on(this.uiCombo.panel.find(".coral-combo-filterbox"),{keydown:function(i){this._doKeyDown(i,true)}});this._on(this.uiCombo.panel.find(".coral-combo-search"),{click:function(i){i.preventDefault();this._filter(i,true);return false}});this._on(this.uiCombo.panel.find(".coral-combo-filterbox"),{focusout:function(i){this._delay(function(){this.hidePanel()},100)}})},_updateTitle:function(){var b=$("<span style = 'visibility: hidden'>"+this.getText()+"</span>").appendTo("body");if(this.component().outerWidth()<b.width()){this.component().attr("title",this.getText())}b.remove()},_doKeyDown:function(g,c){var d=this.options,b=this.panel();this.previousValue=$(g.target).val();if(d.readonly||d.isLabel){return}var f=$.coral.keyCode;switch(g.keyCode){case f.TAB:break;case f.ENTER:g.preventDefault();this._doEnter(g);this._setHv(g);this._trigger("onEnter",g,{});break;case f.ESCAPE:this.hidePanel();break;case f.UP:g.preventDefault();if(d.readonly===false){if(!b.is(":visible")){this.showPanel()}else{if(d.onSelectPrev){this._trigger("onSelectPrev",g)}else{this._selectPrev(g)}}}break;case f.DOWN:g.preventDefault();if(d.readonly===false){if(!b.is(":visible")){this.showPanel()}else{if(d.onSelectNext){this._trigger("onSelectNext",g)}else{this._selectNext(g)}}}break;default:this._filter(g,c);
break}this._hidePlaceholder();this._trigger("onKeyDown",g)},_setHv:function(h,d){var i=$(h.target),c=[],b=i.val();if(this.options.multiple){b=b.split(this.options.separator)}else{b=[b]}this._showItems();var g=true;if(d=="blur"){g=b.toString()!=this.previousValue}if(g){var f=this.options.textField,k=this.options.valueField;var j=this._checkMathch(b,true);if(!j){i.val("");this.setValues([""])}else{this.setValues(j.valarr)}}},_searchFilter:$.noop,_filter:function(g,c){var f=this,d=this.options,b=this.panel();if(f.timer){clearTimeout(f.timer)}if(!b.is(":visible")){f.showPanel()}f.timer=setTimeout(function(){var j=$(g.target).val();if(c){j=b.find(".coral-combo-filterbox").val()}if(f.options.multiple){j=j.split(d.separator)}else{j=[j]}if(j==f.previousValue){return}if(d.query){d.query.call(f.element,j)}else{f.search=true;f._doQuery(j)}var i=f.options.textField,h=f.options.valueField;if(!c){var e=f._checkMathch(j,false);f.setValues(e.valarr,false,true)}f.resizeIframePanel()},d.delay);return false},_formatValue:function(b){return b},_setOption:function(b,c){if(b==="id"||b==="name"){return}if(b==="readonly"){this._setReadonly(c)}if(b==="disabled"){this._setDisabled(c)}if(b==="data"){this.data=c}this._super(b,c);if(b==="isLabel"){this._setIsLabel(c);return}},_destroy:function(){this.panel().remove();if(this.options.iframePanel){this.uiCombo.iframePanel.remove()}this.component().replaceWith(this.element);if(this.options.name){this.element.removeAttr("orgname").attr("name",this.options.name)}this.element.show();this.element.css(this.originalCss)},component:function(){return this.uiCombo.combo},panel:function(){return this.uiCombo.panel},uiArrow:function(){return this.uiCombo.combo.find("span.coral-combo-arrow")},uiClose:function(){return this.uiCombo.combo.find("span.coral-input-clearIcon")},uiBorder:function(){return this.component().find("span.coral-combo-border")},resize:function(f){var g=this.options,h=this.uiCombo.combo,d=this.uiCombo.panel,c=this.elementBorder;if(f){g.width=f
}if(g.width=="auto"||g.width=="item"){return}if(isNaN(g.width)){var e=this.element.parent(":first"),b=null;f=this.element.outerWidth();if(e&&e.get(0).tagName!=="BODY"){b=e.outerWidth();if(b<f){f=b}}g.width=f}h.outerWidth(g.width)},resizeIframePanel:function(){var d=this.options,b,f=this.uiCombo.combo,c=this.uiCombo.panel,e=this.uiCombo.iframePanel||$();b=c.height();e.css("height",b)},_initPanel:function(){var e=this.options,f=this.uiCombo.combo,c=this.elementBorder,b=this.uiCombo.panel,d=e.panelHeight;if(!this.panelRendered){this._renderItems(this.options.data);this.uiCombo.pContent.html(this.lazyPanelHtml);this.panelRendered=true;this.lazyPanelHtml=""}b.css("width",(e.panelWidth?e.panelWidth:c.outerWidth()));b.css("height",d);if(isNaN(d)){this.uiCombo.pContent.css({"max-height":e.maxPanelHeight+"px"});this.uiCombo.popupDialogTree&&this.uiCombo.popupDialogTree.css({"max-height":e.maxPanelHeight+"px"})}if(this.options.enableFilter&&!isNaN(d)){this.uiCombo.pContent.height(e.panelHeight-30)}else{if(d=="auto"){this.uiCombo.pContent.height("")}else{this.uiCombo.pContent.height(d-2)}}if(this.options.iframePanel){this.uiCombo.iframePanel.css("height",b.outerHeight())}},showPanel:function(){var g=this,b=this.options,d=this.uiCombo.combo,f=this.elementBorder,j=this.options.showDirection,c=this.uiCombo.panel,e=this.uiCombo.iframePanel||$();if(c.is(":hidden")){var i=$(".coral-front:visible").map(function(){return +$(this).css("z-index")}).get(),h=Math.max.apply(null,i);if(h>=+c.css("z-index")){c.css("z-index",h+1);if(this.options.iframePanel){e.css("z-index",h)}}if(!this._PanelInited){this._initPanel()}this._PanelInited=true;c.show(0,function(){g.resizeIframePanel();e.show();(function k(){if(c.is(":visible")){c.css({left:$.coral.getLeft(c,f),top:$.coral.getTop(c,f,j),width:(b.panelWidth?b.panelWidth:f.outerWidth())});if(g.options.iframePanel){e.css({left:$.coral.getLeft(e,f),top:$.coral.getTop(e,d,j),width:(b.panelWidth?b.panelWidth:f.outerWidth())})}setTimeout(k,200)}})();g.uiCombo.panel.find(".coral-combo-filterbox").focus();
g._trigger("onShowPanel",null,{})})}if(b.enableFilter){this.setValues(this.getValues())}},hidePanel:function(){this.uiCombo.panel.hide();if(this.uiCombo.iframePanel){this.uiCombo.iframePanel.hide()}this._trigger("onHidePanel",null,{})},disable:function(){this._setDisabled(true)},enable:function(){this._setDisabled(false)},show:function(){this._super()},hide:function(){this._super();this.hidePanel()},hideErrors:function(){$.validate.hideErrors(this.uiBorder());this.component().removeClass("coral-combo-error")},clear:function(){this.setValues([],true,false)},getOldText:function(){return this.oldText},reset:function(){this.setValue(this.originalValue)},getText:function(){return this.uiCombo.combo.find("input.coral-combo-text").val()},_setText:function(b){var c=this.uiCombo.combo.find("input.coral-combo-text");c.val(b);this.previousValue=b},setText:function(b){this._setText(b)},getValues:function(){var b=[];if(!this.dataLoaded){return this.currentValues}this.uiCombo.combo.find("input.coral-combo-value").each(function(){b.push($(this).val())});return b},setValues:function(b,h,g){var t=this.getValues(),k=null,l=this.options,p=0,f=[],e=[];b=b||[];this.oldValues=t;var r=[],u="",n="";this.uiCombo.combo.find("input.coral-combo-value").remove();for(p=0;p<b.length;p++){u="";n="";if(this.options.name){u=" name='"+this.options.name+"' "}r.push("<input type='hidden' "+u+" value='"+this._formatValue(b[p])+"' class='coral-combo-value' />")}this.uiCombo.combo.append(r.join(""));for(p=0;p<t.length;p++){f[p]=t[p]}for(p=0;p<b.length;p++){for(var o=0;o<f.length;o++){if(b[p]==f[o]){e.push(b[p]);f.splice(o,1);break}}}if(b.length){if(this.options.placeholder){this._hidePlaceholder()}}if(l.width=="item"){var c=$("<div style = 'visibility:hidden;'><span>"+this.getText()+"</span></div>").appendTo("body"),d=this.component().find(".coral-textbox-default");var s=parseInt(d.css("padding-left"))+parseInt(d.css("padding-right")),q=this.uiArrow().outerWidth()+2*parseInt(this.uiArrow().css("right")),m=c.find("span").outerWidth()+s+q;
this.resize(m);c.remove();l.width="item"}if((e.length!=b.length||b.length!=t.length)&&(!g)&&h){if(this.options.multiple){this._trigger("onChange",null,{value:b,newValue:b,newText:this.getText(),text:this.getText(),oldValue:t,oldText:this.getOldText()})}else{this._trigger("onChange",null,{value:b[0],newValue:b[0],newText:this.getText(),text:this.getText(),oldValue:t[0],oldText:this.getOldText()})}}},getValue:function(){return this.getValues().join(this.options.separator)},setValue:function(d,b,c){d=d||"";d=d.split(this.options.separator);this.setValues(d,b)},getSelectedItems:function(){var e=this.getValues(),h=[];var c=this.options.data;for(var d=0;d<e.length;d++){for(var b=0;b<c.length;b++){var g=c[b];if(e[d]==g.id){for(var f in g){h.push(f+"="+g[f]+"\n")}}}}return h},refresh:function(){this.destroy();this.component().remove();this._create()}})})();

(function(){var a=0;$.component("coral.combobox",$.coral.combo,{version:"4.0.3",castProperties:["data","buttons"],options:{cls:"",valueField:"value",textField:"text",panelRenderOnShow:false,mode:"local",method:"post",url:null,data:[],buttons:[],width:"auto",showText:true,emptyText:null,postMode:"value",formatter:function(c){var b=$(this).combobox("option","textField");return c[b]},loader:function(g,f,d){var e=this,b=$(this),c=b.combobox("option","url");if(!c){return false}$.ajax({type:b.combobox("option","method"),url:c,data:g,dataType:"json",success:function(h){f(h)},error:function(){d.apply(this,arguments)}});return false},beforeLoad:$.noop,onLoad:$.noop,onError:$.noop,onShowPanel:$.noop,beforeSelect:$.noop,onSelect:$.noop,unSelect:$.noop},_create:function(){var b=this,e=null;var d=new Date();this.data=this.data||[];a++;b.options.itemIdPrefix="combobox_i"+a;this.element.addClass("coral-form-element-combobox coral-validation-combobox ctrl-form-element");var c=$.coral.toFunction(this.options.onShowPanel);e=function(f){c.apply(b.element,[f]);b._scrollTo(b.getValue())};this.options.onShowPanel=e;this._super();this._on(this.uiCombo.panel,{mouseover:function(f){$(f.target).closest(".coral-combobox-item").addClass("coral-combobox-item-hover")},mouseout:function(f){$(f.target).closest(".coral-combobox-item").removeClass("coral-combobox-item-hover")},mousedown:function(j){this.cancelBlur=true;this._delay(function(){delete this.cancelBlur});var g=$(j.target).closest(".coral-combobox-item"),h=g.attr("value");if($(j.target).closest(".coral-combo-filterbox").length){return}if(!g.length||g.hasClass("coral-combobox-item-disabled")){return false}var f=this.getRowIndex(h);if(false===this._trigger("beforeSelect",null,[{item:this.options.data[f]},{data:this.options.data[f]}])){return false}if(this.options.multiple){this.oldText=this.uiCombo.textbox.val();if(""===h){this.clear();this.hidePanel();this.select(h)}else{if(this.options.emptyText){this.unselect("")}if(g.hasClass("coral-combobox-item-selected")){this.unselect(h);
g.removeClass("coral-combobox-item-selected")}else{this.select(h)}}}else{this.oldText=this.uiCombo.textbox.val();this.hidePanel();this.select(h)}return false}});if(this.options.isLabel&&this.options.emptyText&&""===this.getValue()){this.uiCombo.textbox.val("")}},_initData:function(){if(this.options.url){return this._request(this.options.url)}if(this.options.data.length){return this.loadData(this.options.data)}return this.loadData(this._transformData())},_renderItems:function(w){var m=this.options,k=this.panel(),g=this,d={},p=[],l=[],r,b="",e=$.coral.toFunction(this.options.formatter),h=$.coral.toFunction(this.options.itemattr);for(r=0;r<w.length;r++){var f=w[r],j=f[m.valueField],n=f[m.textField],u=!!f.hidden==true?"hidden":"",t="",c=n;if(e){c=e.call(this.element,w[r])}if($.isFunction(h)){var o=h.apply(this.element[0],[{item:w[r]}]);if(!$.isEmptyObject(o)){if(o.hasOwnProperty("style")){t+=o.style;delete o.style}if(o.hasOwnProperty("class")){u+=" "+o["class"];delete o["class"]}try{delete o.role}catch(q){}for(attrName in o){if(o.hasOwnProperty(attrName)){b+=" "+attrName+"="+o[attrName]}}}l.push("<div class='coral-combobox-item "+u+b+"' style='"+t+"' id='"+this.options.itemIdPrefix+"_"+r+"' value='"+j+"'>"+c+"</div>")}else{l.push("<div class='coral-combobox-item "+u+" ' id='"+this.options.itemIdPrefix+"_"+r+"' value='"+j+"'>"+c+"</div>")}if(f.selected&&$.inArray(j,p)===-1){p.push(this.getModeValue(j,n))}}this.lazyPanelHtml=l.join("");return p},loadData:function(f,g,l){var b=this.options,c=this.panel(),h=this,d=l||"onLoad",n=$.coral.toFunction(this.options.formatter),i={},e=[],j=false,k=null;if(!(f instanceof Array)){f=[]}this.data=(f||[]);if(b.clearOnLoad){j=h._clearValues(this.data)}this.uiCombo.pContent.empty();if(this.options.emptyText){if(!(f.length>0&&""===f[0][this.options.valueField])){i[this.options.valueField]="";i[this.options.textField]=this.options.emptyText;f.unshift(i)}}var m=[];if(!this.options.panelRenderOnShow){e=this._renderItems(this.data);this.uiCombo.pContent.html(this.lazyPanelHtml);
this.panelRendered=true}if(this.currentValues.length&&!j){e=this.currentValues}if(!this.isInit){this.isInit=true;this.originalValue=e.join(",")}this.dataLoaded=true;if(b.multiple){this.setValues(e,false,g)}else{e=e.length?[e[0]]:[];this.setValues(e,false,g)}this._trigger(d,null,[f])},localFilter:function(g){var f=this.getData(),e=this.panel().find(".coral-combobox-item");for(var c=0;c<f.length;c++){$(e[c]).hide();if(g.apply(this.element,[f[c]])){var b=f[c][this.options.valueField];var d=f[c][this.options.textField];$(e[c]).show()}}},_scrollTo:function(e){var b=this.panel().find(".coral-combo-content"),c;var d=this.getEl(e);if(d.length){if(d.position().top<=0){c=b.scrollTop()+d.position().top;b.scrollTop(c)}else{if(d.position().top+d.outerHeight()>b.height()){c=b.scrollTop()+d.position().top+d.outerHeight()-b.height();b.scrollTop(c)}}}},_transformData:function(){var b=this.options;var c=[];$(">option",this.element).each(function(){var d={};d[b.valueField]=$(this).attr("value")!==undefined?$(this).attr("value"):$(this).html();d[b.textField]=$(this).html();d.selected=$(this).attr("selected");c.push(d)});return c},_showItems:function(){this.uiCombo.panel.find(".coral-combobox-item").show()},_doQuery:function(e){var c=this.options,n=this.options.filter;if(c.mode=="remote"){this._request(null,{q:e},true)}else{var d=this.panel();var g=this.getData(),o=d.find(".coral-combobox-item");o.hide();this._removeHighlight(this.uiCombo.pContent.find("span.coral-keyword-highlight"));this.uiCombo.pContent.find(".coral-combobox-item-selected").removeClass("coral-combobox-item-selected");this.uiCombo.pContent.find(".coral-item-focus").removeClass("coral-item-focus");for(var h=0;h<g.length;h++){var k=pinyinEngine.toPinyin(g[h][c.textField],false,"");for(var f=0;f<e.length;f++){var b=n.apply(this.element,[e[f],g[h]]);if(b){var l=g[h][c.valueField].toString();var m=g[h][c.textField];if(m.indexOf(e[f])>-1||l.indexOf(e[f])>-1||k.indexOf(e[f])>-1){$(o[h]).show();if(m==e[f]){$(o[h]).addClass("coral-combobox-item-selected");
this._removeHighlight($(o[h]).find("span.coral-keyword-highlight"))}else{if(b=="text"){this._addHighlight($(o[h]),e[f])}}}}}}}},_checkMathch:function(q,r){var b=[],p=[];var c=this.options,e=c.textField,s=c.valueField;var o=0;if(r){this._showItems()}var d=false;var l=this.data,h="",f={},m=0,k,g;if(c.multiple){for(k=0;k<q.length;k++){for(g=0;g<l.length;g++){if(l[g][e]!=q[k]&&l[g][s]!=q[k]){f[k.toString()]=true}if(l[g][e]==q[k]){h=this.getModeValue(l[g][s],l[g][e]);b.push(h);d=true;break}}if(!d&&!c.forceSelection){if((!f[k.toString()]&&!r)||r){b.push(q[k]);p.push(q[k])}}d=false}}else{var n=-1;for(k=0;k<l.length;k++){if(l[k][e]==q[0]){n=n===-1?k:n;d=true}if(l[k][e]!=q[0]&&l[k][s]!=q[0]){f["0"]=true}}if(d){h=this.getModeValue(l[n][s],l[n][e]);b.push(h)}if(!d&&!c.forceSelection){if((!f["0"]&&!r)||r){b.push(q[0]);p.push(q[0])}}}return{valarr:b,textarr:p}},_request:function(d,e,g){var h=this,b={},f=[],c=this.options.loader,j=false;if(!d&&!h.options.url){d=[]}else{if(!d&&h.options.url){d=h.options.url}}if(typeof(d)!=="string"){b=d;if(b.data){f=b.data}else{if(b.url){d=b.url;h.options.url=b.url;j=true}else{if(b instanceof Array){f=d}else{if(!b.url&&!b.data&&!h.options.url){f=[]}else{if(!b.url&&!b.data&&h.options.url){d=h.options.url;j=true}}}}}}else{h.options.url=d;j=true}if(j){e=e||{};if(this._trigger("beforeLoad",null,[e])==false){return}c.apply(this.element,[e,function(l){var k=b.onLoad;h.loadData(l,g,k);h._loadedHandler()},function(){h._trigger("onError",null,arguments)}])}else{var i=b.onLoad;h.loadData(f,g,i)}},_loadedHandler:function(){var c=this;var b=this._getCacheItem("setValues");if(b){this.setValues(b.values,b.triggerOnChange,b.remainText);this._removeCacheItem("setValues")}var d=this._getCacheItem("focus");if(d){this._removeCacheItem("focus")}},_selectItems:function(c,h){var e=this.panel(),f=null,g=null,d=e.find(".coral-item-focus:visible"),b=":last";if(c){b=":first"}d.removeClass("coral-item-focus");if(d.length){g=d.attr("value")}else{d=f=e.find(".coral-combobox-item-selected:visible"+b);
if(f.length){g=f.attr("value")}}if(h=="prev"){if(d.prevAll(":visible").length===0){d=e.find(".coral-combobox-item:visible:last");d.addClass("coral-item-focus")}else{d.prevAll(":visible:eq(0)").addClass("coral-item-focus")}}else{if(d.nextAll(":visible").length===0){d=e.find(".coral-combobox-item:visible:first");d.addClass("coral-item-focus")}else{d.nextAll(":visible:eq(0)").addClass("coral-item-focus")}}return g},_selectPrev:function(){var b=this.panel(),e=this._selectItems(true,"prev"),d=b.find('.coral-combobox-item[value="'+e+'"]'),c=null,f=null;if(d.length){c=d.prevAll(":visible:eq(0)")}else{d=b.find(".coral-combobox-item:visible:last")}if(null!==c&&c.length===0){c=b.find(".coral-combobox-item:visible:last")}f=!!c?c.attr("value"):d.attr("value");this.select(f);this._scrollTo(f)},_selectNext:function(){var b=this.panel(),e=this._selectItems(true,"next"),d=b.find('.coral-combobox-item[value="'+e+'"]'),c=null,f=null;if(d.length){c=d.nextAll(":visible:eq(0)")}else{d=b.find(".coral-combobox-item:visible:first")}if(c&&c.length==0){c=b.find(".coral-combobox-item:visible:first")}f=c?c.attr("value"):d.attr("value");this.select(f);this._scrollTo(f)},_doEnter:function(j){var c=this.panel(),l=this.getValues(),m=c.find(".coral-item-focus:visible"),g,f=this.getData(),b=this.options,k=m.attr("value");if(k){var d="",h=0;for(g=0;g<f.length;g++){if(k==f[g][b.valueField]){h=g}}d=this.getModeValue(k,f[h][b.textField]);if(this.options.multiple){if($.inArray(d,l)==-1){this.select(k)}else{this.unselect(k)}}else{this.hidePanel()}}},_formatValue:function(g){var f=this.getData(),e=this.options,c=e.valueField,b=e.textField,d=0,h=null;if("text"===e.postMode||"value-text"===e.postMode){for(d=0;d<f.length;d++){h=f[d];if(""!=g&&g==h[c]){if("text"===e.postMode){return h[b]}if("value-text"===e.postMode){return g+e.valueTextSeparator+h[b]}}}}return g},_destroy:function(){this.element.removeClass("coral-validation-combobox");this.element.removeClass("coral-form-element-combobox");this._super()},_getOnlyValues:function(){var f=this.getData(),b=this.options,c=[],g=0;
if(!this.currentValues||(!this.currentValues[0]&&this.currentValues.length===1)){return c}for(;g<this.currentValues.length;g++){var h=this.currentValues[g],e=0,k=b.valueField,d=b.textField,l=null;if("value-text"===b.postMode){h=h.split(b.valueTextSeparator)[0];c.push(h)}if("value"===b.postMode){c.push(h)}if("text"===b.postMode){for(;f&&e<f.length;e++){l=f[e];if(l[d]==h){c.push(l[k]);break}}}}return c},_getCurrentValues:function(){var e=this.getData(),d=this.options,c=[],b=0;if(!this.currentValues||(!this.currentValues[0]&&this.currentValues.length===1)){return c}return this.currentValues},getData:function(){return this.data||[]},setValues:function(b,n,e){var m=this.options,u=this.getData(),h=this.panel(),p=e,r=0,q=0,t=this.getValues()||[],g=[],k=[],s=null,o=null,l=null;if(typeof(p)=="object"){e=p.remainText;n=p.triggerOnChange}this.currentValues=b;if(!this.dataLoaded){return}h.find(".coral-combobox-item-selected").removeClass("coral-combobox-item-selected");for(r=0;r<b.length;r++){o=b[r];l=o;var d=this.getRowIndex(o);if(d>-1){l=u[d][m.textField];s=u[d][m.valueField];var c=this._getItemByIndex(d).addClass("coral-combobox-item-selected");if(m.emptyText&&""==o){this.uiCombo.textbox.attr("placeholder",m.emptyText);this._showPlaceholder(m.emptyText);l=""}else{this._hidePlaceholder()}k.push(l);g.push(o)}else{if(d<0&&!m.forceSelection){k.push(l);g.push(o)}}}if(!e){this._setText(k.join(m.separator))}var f=this._getMinus(g,b);if((f.length&&g.length)||!g.length){k=k.concat(f);if(!e){this._setText(k.join(m.separator))}g=b}this._super(g,n,e)},_getMinus:function(d,c){var e=[];$.each(c,function(b,f){if($.inArray(f,d)==-1){e.push(f)}});return e},getEl:function(c){var b=this.getRowIndex(c);var d=b;return $("#"+this.options.itemIdPrefix+"_"+d)},_getItemByIndex:function(b){var c=b;return $("#"+this.options.itemIdPrefix+"_"+c)},getRowIndex:function(f){var d=this.options,e=this.getData(),b=d.postMode;for(var c=0;c<e.length;c++){if(b=="value"){if(e[c][d.valueField]==f){return c}}if(b=="text"){if(e[c][d.textField]==f){return c
}}if(b=="value-text"){if(e[c][d.valueField]==f.split(d.valueTextSeparator)[0]){return c}}}return -1},clear:function(){var b=this.panel();this._super();b.find(".coral-combobox-item-selected").removeClass("coral-combobox-item-selected");b.find(".coral-item-focus").removeClass("coral-item-focus")},reload:function(b){this._request(b)},select:function(g){var e=this.options,f=this.getData(),d,b;g=$.trim(g);if(e.multiple){b=this.getValues()}else{b=[]}var c="",h=0;for(d=0;d<f.length;d++){if(g==f[d][e.valueField]){h=d}}c=this.getModeValue(g,f[h][e.textField]);for(d=0;d<b.length;d++){if(b[d]==c){return}}b.push(c);this.setValues(b,true,false);this._trigger("onSelect",null,[{item:f[h],value:g,text:f[h][e.textField]}])},getModeValue:function(c,d){var b;if(this.options.postMode=="value"){b=c}if(this.options.postMode=="text"){b=d}if(this.options.postMode=="value-text"){b=c+"-"+d}return b},unselect:function(f){var d=this.options,e=this.getData(),b=this.getValues(),c;var g=0;for(c=0;c<e.length;c++){if(f==e[c][d.valueField]){g=c}}if(this.options.postMode=="value"){f=f}if(this.options.postMode=="text"){f=e[g][d.textField]}if(this.options.postMode=="value-text"){f=f+"-"+e[g][d.textField]}for(c=0;c<b.length;c++){if(b[c]==f){b.splice(c,1);this.setValues(b,true,false);this._trigger("onSelect",null,[{item:e[g],value:f,text:e[g][d.textField]}]);break}}},showPanel:function(){this._removeHighlight(this.uiCombo.pContent.find("span.coral-keyword-highlight"));var b=0,c;this._super();if(!this.hideValueArr){return}for(;b<this.hideValueArr.length;b++){c=this.hideValueArr[b];this.uiCombo.pContent.find('.coral-combobox-item[value="'+c+'"]').hide()}},addOption:function(g){var j=this,e=0,h=null,d=this.options.valueField,b=this.options.textField,c=g[d],f=g[b];if(!(d in g)||!(b in g)){if($.message){$.message("JSON格式不正确!")}return false}for(e=0;e<this.data.length;e++){if((g[d]==this.data[e][d])||(g[b]==this.data[e][b])){if($.message){$.message("当前选项已存在!")}return false}}h=$('<div class="coral-combobox-item"></div>');
h.attr("value",c);if(this.options.formatter){h.html(this.options.formatter.call(this.element,g))}else{h.html(f)}if(this.data.length>0&&""==this.data[0][d]){this.data.splice(1,0,g);h.insertAfter(this.uiCombo.pContent.find(":first-child"))}else{this.data.unshift(g);h.prependTo(this.uiCombo.pContent)}return true},removeOption:function(d){var f=null,e=null,c=0,b=this.options.valueField,g=null;if(typeof d==="number"){if(d>this.data.length){return}f=this.data[c];g=d}if(typeof d==="string"){e=d}if(typeof d==="object"){if(!(b in d)){return}e=d[b]}if(e!==null){for(;c<this.data.length;c++){if(e==this.data[c][b]){f=this.data[c];g=c;break}}}if(g!==null){this.data.splice(g,1);this.uiCombo.pContent.find('.coral-combobox-item[value="'+e+'"]').remove()}},clearOptinons:function(){this.uiCombo.pContent.empty();this.clear()},showOption:function(b){var c;if(typeof b==="number"){c=this.uiCombo.pContent.find(".coral-combobox-item:eq("+b+")")}else{if(typeof b==="string"){c=this.uiCombo.pContent.find('.coral-combobox-item[value="'+b+'"]')}else{if(typeof b==="object"){if(!(this.options.valueField in b)){return}c=this.uiCombo.pContent.find('.coral-combobox-item[value="'+b[this.options.valueField]+'"]')}else{this.uiCombo.pContent.find(".coral-combobox-item").removeClass("hidden");this.hideValueArr=null}}}if(c&&c.length>0){c.removeClass("hidden");if(this.hideValueArr){this.hideValueArr.splice($.inArray(c.attr("value"),this.hideValueArr),1)}}},hideOption:function(b){if(!this.hideValueArr){this.hideValueArr=[]}var c;if(typeof b==="number"){c=this.uiCombo.pContent.find(".coral-combobox-item:eq("+b+")")}else{if(typeof b==="string"){c=this.uiCombo.pContent.find('.coral-combobox-item[value="'+b+'"]')}else{if(!(this.options.valueField in b)){return}c=this.uiCombo.pContent.find('.coral-combobox-item[value="'+b[this.options.valueField]+'"]')}}if(c&&c.length>0){c.addClass("hidden");this.hideValueArr.push(c.attr("value"))}}})})();

$.component("coral.combotree",$.coral.combo,{version:"4.0.3",castProperties:["data","rootNode","buttons"],options:{valueField:"id",textField:"name",panelRenderOnShow:false,mode:"local",method:"post",url:null,data:null,buttons:[],postMode:"value",multiple:false,simpleDataEnable:false,simpleDataIdKey:"id",simpleDataPIdKey:"pId",simpleDataRootPId:null,rootNode:false,radioType:"level",showRootNode:true,allowPushParent:true,traversal:false,cascadeCheck:false,formatter:function(b){var a=$(this).combotree("option","textField");return b[a]},loader:function(f,e,c){var d=this,a=$(this),b=a.combotree("option","url");if(!b){return false}$.ajax({type:a.combotree("option","method"),url:b,data:f,dataType:"json",success:function(g){e(g)},error:function(g){c.apply(this,arguments)}})},beforeClick:null,beforeLoad:$.noop,onLoad:$.noop,onError:$.noop,onSelect:$.noop,unSelect:$.noop,onExpand:null,onClick:null},tree:function(){return $("#"+$(this.element).attr("id")+"_tree")},_filterLocalTree:function(a){var c=this,b=$("#"+$(this.element).attr("id")+"_tree");b.tree("filterNodesByParam",a)},_create:function(){var a=this,b=null;this.element.addClass("coral-form-element-combotree coral-validation-combotree coral-combobox-f ctrl-form-element");b=function(){};this.options.onShowPanel=b;this._super();if(this.options.popupDialog){this.uiCombo.popupInputbox=this.uiCombo.popupInputbox.textbox({componentCls:"coral-combo-popup-input",icons:[{icon:"cui-icon-search2",click:function(d,c){a._filterLocalTree({name:c.value})}}],onKeyUp:function(d,c){a._filterLocalTree({name:c.value});d.stopPropagation()}});this.uiCombo.popupDialog.dialog({autoOpen:false,title:"下拉树",height:"auto",width:"auto",modal:true,resizable:false,buttons:{"确定":function(f){var c=$.data(a.uiCombo.popupInputbox,"value"),d=$.data(a.uiCombo.popupInputbox,"text");if(c){a.setValues(c,true,d)}$(this).dialog("close")},"关闭":function(c){$(this).dialog("close")}}})}this.uiCombo.panel.unbind().bind("mouseover",function(c){$(c.target).closest(".coral-combobox-item").addClass("coral-combobox-item-hover")
}).bind("mouseout",function(c){$(c.target).closest(".coral-combobox-item").removeClass("coral-combobox-item-hover")}).bind("mousedown",function(c){a.cancelBlur=true;a._delay(function(){delete a.cancelBlur});return false})},_getSetting:function(){var b=this;var a={simpleDataEnable:this.options.simpleDataEnable,simpleDataIdKey:this.options.simpleDataIdKey,simpleDataPIdKey:this.options.simpleDataPIdKey,simpleDataRootPId:this.options.simpleDataRootPId,checkable:this.options.multiple,radioType:this.options.radioType,showRootNode:this.options.showRootNode,rootNode:this.options.rootNode,chkboxType:this.options.cascadeCheck?{Y:"",N:""}:{Y:"ps",N:"ps"},beforeClick:function(e,d){if(!b.options.allowPushParent&&d.isParent){return false}var c=$.coral.toFunction(b.options.beforeClick);if(!b.options.multiple){if($.isFunction(c)){return c(e,d)}return true}else{return false}},onClick:function(k,j,h,g){var d=[];var c=[];d.push(h.name);c.push(h.id);if(b.options.traversal){var f=h.getParentNode();while(!!f){d.push(f.name);f=f.getParentNode()}}if(b.options.popupDialog){$.data(b.uiCombo.popupInputbox,"value",c.reverse());$.data(b.uiCombo.popupInputbox,"text",d.reverse())}else{b.setValues(c.reverse(),true,d.reverse())}if(!b.options.multiple&&!h.isParent||!b.options.multiple&&b.options.allowPushParent){b.hidePanel()}b._trigger("onNodeClick",k,{treeId:j,node:h,clickFlag:g});return false},beforeCheck:function(e,d){var c=b._trigger("beforeNodeCheck",null,{treeId:e,node:d});if(!c){return false}},onCheck:function(m,k,j){var g=[];var f=[];var d=$("#"+k).tree("getCheckedNodes",true);for(var h=0,c=d.length;h<c;h++){if(b.options.cascadeCheck||!d[h].getCheckStatus().half){if(!b.options.allowPushParent&&d[h].isParent){continue}g.push(d[h].name);f.push(d[h].id)}}if(b.options.popupDialog){$.data(b.uiCombo.popupInputbox,"value",f);$.data(b.uiCombo.popupInputbox,"text",g)}else{b.setValues(f,true,g)}b._trigger("onNodeCheck",m,{treeId:k,node:j})},onLoad:function(k,j,o,f){var p=[],m=[],h,d=[],n=false,g=$("#"+j).tree("getNodes"),c=$("#"+j).tree("transformToArray",g);
if(b.options.clearOnLoad){n=b._clearValues(c)}if(b.options.multiple){d=$("#"+j).tree("getCheckedNodes",true);for(h=0,l=d.length;h<l;h++){if(b.options.cascadeCheck||!d[h].getCheckStatus().half){if(!b.options.allowPushParent&&d[h].isParent){continue}p.push(d[h].name);m.push(d[h].id)}}}else{d=$("#"+j).tree("getSelectedNodes")}if(b.currentValues.length&&!n){m=b.currentValues}if(!b.isInit){b.isInit=true;b.originalValue=m.join(",")}b.dataLoaded=true;b.setValues(m);b.isLoaded=true;b._trigger("onLoad",k,{treeId:j,treeNode:o,msg:f})},onExpand:function(f,d,c){b._trigger("onExpand",f,[{treeId:d,node:c}])}};return a},setPopupInput:function(a){this.uiCombo.popupInputbox.textbox("setValue",a.join(this.options.separator))},_initData:function(){var a=$('<ul id="'+$(this.element).attr("id")+'_tree"></ul>');if(this.options.popupDialog){a.appendTo(this.uiCombo.popupDialog);this.uiCombo.popupDialogTree=a}else{a.appendTo(this.uiCombo.pContent)}this.uiCombo.panel.unbind().bind("mousedown",function(h){h.preventDefault()});var g=this._getSetting();if(typeof this.options.url=="string"&&this.options.url!==""){$.extend(g,{asyncEnable:true,asyncUrl:this.options.url,asyncAutoParam:"id,name"})}a.tree(g,this.options.data);var e=[];var d=[];var c=$("#"+$(this.element).attr("id")+"_tree").tree("getCheckedNodes",true);for(var f=0,b=c.length;f<b;f++){if((c[f].getCheckStatus()!=null)&&(this.options.cascadeCheck||!c[f].getCheckStatus().half)){e.push(c[f].name);d.push(c[f].id)}}if(d.length>0){this.setValues(d,false,e)}},_renderItems:function(a){},_scrollTo:function(d){var a=this.panel();var c=a.find('div.coral-combobox-item[value="'+d+'"]');if(c.length){if(c.position().top<=0){var b=a.scrollTop()+c.position().top;a.scrollTop(b)}else{if(c.position().top+c.outerHeight()>a.height()){var b=a.scrollTop()+c.position().top+c.outerHeight()-a.height();a.scrollTop(b)}}}},_request:function(a,h,e){var d=this,c={},f=[],b=this.options.loader,g=false;if(!a&&!d.options.url){a=[]}else{if(!a&&d.options.url){a=d.options.url
}}if(typeof(a)!=="string"){c=a;if(c.data){f=c.data}else{if(c.url){a=c.url;d.options.url=c.url;g=true}else{if(c instanceof Array){f=a}else{if(!c.url&&!c.data&&!d.options.url){f=[]}else{if(!c.url&&!c.data&&d.options.url){a=d.options.url;g=true}}}}}}else{d.options.url=a;g=true}if(g){h=h||{};if(this._trigger("beforeLoad",null,[h])==false){return}b.apply(this.element,[h,function(j){d.loadData(j,e);d._trigger($.isFunction(c.onLoad)?c.onLoad:"onLoad",null,[j])},function(){d._trigger("onError",null,arguments)}])}else{d.loadData(f,e);d._trigger($.isFunction(c.onLoad)?c.onLoad:"onLoad",null,[f])}},getTree:function(){return $("#"+$(this.element).attr("id")+"_tree")},loadData:function(d,b){var c=this.getTree();c.tree("reload",d);var a=c.tree("getNodes");$.each(a,function(e,f){c.tree("expandNode",f,true)});this.dataLoaded=true;this.setValues(this.currentValues)},getData:function(){return this.getTree().tree("getNodes")||[]},setComboValues:function(a,b){this.setValues(a,false,b)},_setCombotree:function(b,e){b=this.currentValues;var d=this.options;var f=[];var a=$(this.element).attr("id");$("#"+a+"_tree").tree("cancelSelectedNode");if(d.multiple){$("#"+a+"_tree").tree("checkAllNodes",false);for(i in b){var c=$("#"+a+"_tree").tree("getNodeByParam","id",b[i]);if(c){$("#"+a+"_tree").tree("checkNode",c,true,!d.cascadeCheck)}if(!e){var c=$("#"+a+"_tree").tree("getNodeByParam","id",b[i]);if(c){f.push(c.name)}else{f.push(b[i])}}}}else{for(i in b){var c=$("#"+a+"_tree").tree("getNodeByParam","id",b[i]);$("#"+a+"_tree").tree("selectNode",c);if(!e){var c=$("#"+a+"_tree").tree("getNodeByParam","id",b[i]);if(c){f.push(c.name)}else{f.push(b[i])}}}}if(!e){e=f}return e},setValues:function(a,f,e){this.currentValues=a;var c=this._setCombotree(a,e);var d=this.options,b=[];e=typeof e=="boolean"?e:false;if(!e){this._setText(c.join(d.separator))}this._super(a,f,e)},setValue:function(b,c,a){b=b.split(this.options.separator);this.setValues(b,false,a)},_getOnlyValues:function(){var e=this.getData(),c=this.options,b=[],a=0;
if(!this.currentValues||(!this.currentValues[0]&&this.currentValues.length===1)){return b}for(;a<this.currentValues.length;a++){var d=this.currentValues[a];if("value"===c.postMode){b.push(d)}}return b},_showItems:function(){var b=this.tree().tree("getNodes");var a=this.tree().tree("transformToArray",b);this.tree().tree("showNodes",a,{showParents:true})},_doQuery:function(c){if(c==""){return}var b=this.options,d=[],f=b.textField,s=b.valueField,p=this.options.filter;if(b.mode=="remote"){this._request(null,{q:c},true)}else{var e=this.tree().tree("getNodes");var k=this.tree().tree("transformToArray",e);this.tree().tree("hideNodes",k);for(var h=0;h<k.length;h++){var m=pinyinEngine.toPinyin(k[h][f],false,"");for(var g=0;g<c.length;g++){var a=p.apply(this.element,[c[g],k[h]]);if(a){var n=k[h][s];var o=k[h][f];if(o.indexOf(c[g])>-1||m.indexOf(c[g])>-1){d.push(k[h]);this.tree().tree("showNodes",d,{showParents:true});this.tree().tree("expandNode",d[0].getParentNode(),true,false,false)}}}}}},_checkMathch:function(r,s){var a=[],p=[],v=[],q=[],b=[],m,g,f,n,u=this.options,d=u.textField,t=u.valueField;if(s){this._showItems()}var c=false;var e={};if(u.multiple){this.tree().tree("checkAllNodes",false);for(m=0;m<r.length;m++){if(s){if(this.options.forceSelection&&$.trim(r[m])===""){continue}}var b=this.tree().tree("getNodesByParam",d,r[m],null);if(!b.length){e[m.toString()]=true}for(g=0;g<b.length;g++){if(u.cascadeCheck||!b[g].isParent){a.push(b[g][t]);p.push(b[g][d]);c=true;break}}if(!c&&!this.options.forceSelection){if((!e[m.toString()]&&!s)||s){a.push(r[m]);p.push(r[m])}}c=false}for(n=0;n<a.length;n++){var b=this.tree().tree("getNodesByParam",t,a[n],null);if(b.length){this.tree().tree("checkNode",b[0],true,!u.cascadeCheck)}}var b=this.tree().tree("getCheckedNodes",true);for(f=0,l=b.length;f<l;f++){if(u.cascadeCheck||!b[f].getCheckStatus().half){if(!u.allowPushParent&&b[f].isParent){continue}if($.inArray(b[f][t],a)==-1){p.push(b[f][d]);a.push(b[f][t])}}}}else{var b=this.tree().tree("getNodesByParam",d,r[0],null);
var o=-1;for(m=0;m<b.length;m++){o=o===-1?m:o;c=true}if(c){a.push(b[o][t]);p.push(b[o][d])}if(!c&&!this.options.forceSelection){a.push(r[0]);p.push(r[0])}}return{valarr:a,textarr:p}},clear:function(){this._super();if(this.options.multiple){$("#"+$(this.element).attr("id")+"_tree").tree("checkAllNodes",false)}},_formatValue:function(f){var e;if(this.options.multiple){e=this.getTree().tree("getCheckedNodes",true)}else{e=this.getTree().tree("getSelectedNodes")}var d=this.options,b=d.valueField,a=d.textField,c=0,g=null;if("text"===d.postMode||"value-text"===d.postMode){for(c=0;c<e.length;c++){g=e[c];if(""!=f&&f==g[b]){if("text"===d.postMode){return g[a]}if("value-text"===d.postMode){return f+d.valueTextSeparator+g[a]}}}}return f},reload:function(a){this._request(a)},_destroy:function(){var a=this;this.element.removeClass("coral-validation-combotree");this.element.removeClass("coral-form-element-combotree");if(this.options.popupDialog){this.uiCombo.popupDialog.dialog("forceDestroy")}this._super()}});

$.component("coral.combogrid",$.coral.combo,{version:"4.0.3",castProperties:["colNames","colModel","data","buttonOptions","gridOptions","buttons"],options:{colNames:[],colModel:[],valueField:"id",textField:"name",panelRenderOnShow:false,multiple:false,selarrrow:[],buttons:[],url:null,panelWidth:500,panelHeight:220,sortable:false,data:[],onSelectRow:null,onSelectAll:null,onSortableColums:null,onLoad:$.noop,onComplete:null,pager:false,buttonOptions:null,gridOptions:{}},grid:function(){return $("#combo_grid_"+$(this.element).attr("id"))},button:function(){if(null!==this.options.buttonOptions){return this.$button}},_destroy:function(){this.element.removeClass("coral-validation-combogrid");this.element.removeClass("coral-form-element-combogrid");this.grid().grid("destroy");this._super()},_showItems:function(){var f=[],h=[],g=[],c=[];var b=this.options.textField,d=this.options.valueField,e={};var a=this.grid();e.filters="{}";a.grid("option","localonce",true);$.extend(a.grid("option","postData"),e);a.grid("reload",{page:1})},_doQuery:function(b){var a=this.options,h=this.grid();var c=a.textField;var g=h.grid("option","colModel"),e=[],l=[];for(var f in g){var k=g[f];if("cb"==k.name||"rn"==k.name){continue}}for(var d=0;d<b.length;d++){l.push('{"field":"'+c+'","op":"cn","data":"'+b[d]+'"}')}e.filters='{"groupOp":"OR","rules":['+l.join(",")+"]}";h.grid("option","localonce",true);$.extend(h.grid("option","postData"),e);h.grid("reload",{page:1})},_checkMathch:function(o,n){var e=[],m=[],f=[],k=[];var p=this.options.textField,a=this.options.valueField,t={},b=0,s,r;var g=this.grid();if(n){this._showItems()}var u=this.grid().grid("option","data");var l=false;var c={};if(this.options.multiple){for(s=0;s<o.length;s++){for(r=0;r<u.length;r++){if(u[r][p]!=o[s]&&u[r][a]!=o[s]){c[s.toString()]=true}if(u[r][p]==o[s]){m.push(u[r][a]);f.push(u[r][p]);l=true;break}}if(!l&&!this.options.forceSelection){if((!c[s.toString()]&&!n)||n){m.push(o[s]);f.push(o[s])}}l=false}var d=this._getOnlyValues();
var q=this._getOnlyTexts();for(s=0;s<o.length;s++){for(r=0;r<q.length;r++){if(q[r]==o[s]&&$.inArray(q[r],f)===-1){m.push(d[r]);f.push(q[r])}}}}else{var h=-1;for(s=0;s<u.length;s++){if(u[s][p]==o[0]){h=h===-1?s:h;l=true}}if(l){m.push(u[h][a]);f.push(u[h][p])}if(!l&&!this.options.forceSelection){if((!c["0"]&&!n)||n){m.push(o[0]);f.push(o[0])}}}return{valarr:m,textarr:f}},reload:function(b){this.cache.isReload=true;var a=this.grid(),d=this,c={},f=false,e=[];if(!b&&!this.options.url){b=[]}else{if(!b&&this.options.url){b=this.options.url}}if(typeof(b)!=="string"){c=b;if(c.data){e=c.data}else{if(c.url){b=c.url;f=true}else{if(b instanceof Array){e=b}else{if(!c.url&&!c.data&&!this.options.url){e=[]}else{if(!c.url&&!c.data&&this.options.url){b=this.options.url;f=true}}}}}}else{this.options.url=b;f=true}if($.isFunction(c.onLoad)){this.cache.onLoad=c.onLoad}if(c.postData){}a.grid("reload",b)},_removeGridHighlights:function(){this._removeHighlight(this.grid().find(".coral-grid-btable tr td > span.coral-keyword-highlight"))},_addGridHighlights:function(){this._addHighlight(this.grid().find(".coral-grid-btable .jqgrow").children("td"),this.uiCombo.textbox.val())},_updateGridData:function(e){var b=this;var d=this.grid().grid("getRowData",e.rowId);var c=this._getTextFromHTML(d[this.options.valueField]);var f=this._getTextFromHTML(d[this.options.textField]);var a=$.inArray(c,this.gridValueArr);if(!this.options.multiple){this.gridValueArr=[c];this.gridTextArr=[f];this.gridRowIdArr=[e.rowId];return}if(!e.status){if(a!=-1){this.gridValueArr.splice(a,1);this.gridTextArr.splice(a,1);this.gridRowIdArr.splice(a,1)}}else{if(a==-1){this.gridValueArr.push(c);this.gridTextArr.push(f);this.gridRowIdArr.push(e.rowId)}}},_create:function(){var a=this,c=null,b;this.element.addClass("coral-form-element-combogrid coral-validation-combogrid");this._super();this.panelRendered=true;if(null!==this.options.buttonOptions){this.$button=this._getButtonEl();this.component().append(this.$button).addClass("coral-combogrid-hasButton");
this.$button.button(this.options.buttonOptions)}this.uiCombo.panel.unbind().bind("mousedown",function(f){a.cancelBlur=true;a._delay(function(){delete a.cancelBlur});var d=$(f.target).closest(".coral-grid-pager").length;if(d==1){return true}else{return false}})},_initCombo:function(){this._super();var a=$();if(this.options.pager){grid=$('<div id="combo_grid_'+$(this.element).attr("id")+'"><div class="combo_grid_'+$(this.element).attr("id")+'"></div></div>').appendTo(this.uiCombo.pContent)}else{grid=$('<div id="combo_grid_'+$(this.element).attr("id")+'"></div>').appendTo(this.uiCombo.pContent)}this.gridValueArr=[];this.gridTextArr=[];this.gridRowIdArr=[];goptions={fitStyle:"fill",keyName:this.options.valueField,sortable:this.options.sortable,colModel:this.options.colModel,colNames:this.options.colNames,multiselect:this.options.multiple,sortname:this.options.sortname,width:"auto"};goptions=$.extend({},goptions,this.options.gridOptions);if(null!=this.options.url){goptions.url=this.options.url;goptions.datatype="json"}else{goptions.data=this.options.data;goptions.datatype="local"}this._on(grid,{gridonselectrow:function(d,c){var b=this._getOnlyValues();if(this.options.multiple){if($.inArray(c.rowId,b)==-1){b.push(c.rowId)}else{b.splice($.inArray(c.rowId,b),1)}}else{b=[c.rowId]}this.setValues(b,true,false);if(!this.options.multiple&&d.originalEvent&&d.originalEvent.type=="click"){this.hidePanel()}},gridonselectall:function(d,c){var b=c.status?c.aRowIds.concat():[];this.setValues(b,true,false)},gridonload:function(k,h){var c=this,j=false,g=h.data;if(c.options.clearOnLoad){j=c._clearValues(g)}this._addGridHighlights();this.dataLoaded=true;var d=this.grid().grid("option","selarrrow").concat();for(var b=0;b<d.length;b++){this.grid().grid("setSelection",d[b],false)}var f=this._getOnlyValues();$.each(f,function(l,e){c.grid().grid("setSelection",e,false,null)});if(j==true){this.currentValues=[]}if(!this.search){this.setValues(this.currentValues);this.search=false}if(this.cache.isReload){this.cache.isReload=false;
this._trigger(this.cache.onLoad||"onLoad",null,[h]);delete this.cache.onLoad}}});grid.grid(goptions);grid.grid("refresh")},_getButtonEl:function(){return $("<button type='button'></button>").addClass("coral-combogrid-button")},_getRowDataByColName:function(f){var d=this,c=this.options,a=this.grid(),b=a.grid("option","data"),e=[];if(typeof f==="string"){f=[f]}$.each(b,function(h,l){var g={};for(var j in f){var k=f[j];g[k]=l[k]}e.push(g)});return e},_getTextArrByValueArr:function(h){var f=this,a=this.options,k=this.options.valueField,c=this.options.textField,b=this._getRowDataByColName([k,c]),j=[];for(var d in h){var g=h[d],e=false;$.each(b,function(i,l){if(g==l[k]){j.push(l[c]);e=true}});if(!e){j.push(h[d])}}return j},setValues:function(n,h,o){var p=this.grid();var e=p.grid("option","selarrrow").concat();for(var g=0;g<e.length;g++){p.grid("setSelection",e[g],false)}if(!this.dataLoaded){var j={setValues:{values:n,text:o,triggerOnChange:h}};this._addCacheItem(j)}var a=this.options;var l=[];l=this._getTextArrByValueArr(n);o=typeof o=="boolean"?o:false;if(!o){this._setText(l.join(a.separator))}this.currentValues=n;this.currentTexts=l;var m=n.concat();m.sort();for(var g=0;g<m.length;g++){if(m[g]!==m[g+1]&&g!=m.length||g==m.length){p.grid("setSelection",m[g],false)}}if(a.width=="item"){var c=$("<div style = 'visibility:hidden;'><span>"+this.getText()+"</span></div>").appendTo("body"),k=this.component().find(".coral-textbox-default");var d=parseInt(k.css("padding-left"))+parseInt(k.css("padding-right")),f=this.uiArrow().outerWidth()+2*parseInt(this.uiArrow().css("right")),b=c.find("span").outerWidth()+d+f;this.resize(b);c.remove();a.width="item"}this._super(n,h,false)},_getOnlyValues:function(){var e=this.getData(),a=this.options,b=[],f=0;if(!this.currentValues||(!this.currentValues[0]&&this.currentValues.length===1)){return b}for(;f<this.currentValues.length;f++){var g=this.currentValues[f],d=0,h=a.valueField,c=a.textField,k=null;if("value-text"===a.postMode){b.push(g.split(a.valueTextSeparator)[0])
}if("value"===a.postMode){b.push(g)}if("text"===a.postMode){for(;e&&d<e.length;d++){k=e[d];if(k[c]==g){b.push(k[h]);break}}}}return b},_getOnlyTexts:function(){return this.currentTexts||[]},getData:function(){return this.grid().grid("option","data")||[]},_selectPrev:function(){var d=this,c=null,a=0,e=d.grid().grid("getDataIDs");selarrrow=d.grid().grid("option","selarrrow").concat();valueFirst=d.getValues()[0];d.selectedRow=d.selectedRow||valueFirst;if(d.options.multiple){if(d.selectedRow){for(var b=e.length;b>=0;b--){if(d.selectedRow==e[b]){a=(b==0?(e.length-1):(b-1));d.selectedRow=e[a];break}}if($.inArray(d.selectedRow,selarrrow)==-1){d.grid().grid("setSelection",d.selectedRow)}}else{d.selectedRow=e.length;d.grid().grid("setSelection",e.length)}d._scrollTo(d.selectedRow)}else{c=d.grid().grid("option","selrow");if(c){a=d.grid().grid("getInd",c);if(a>=0){d.grid().grid("setSelection",e[a-2])}}else{d.grid().grid("setSelection",e.length)}}d._scrollTo(c)},_selectNext:function(){var d=this,c=null,a=0,e=d.grid().grid("getDataIDs");selarrrow=d.grid().grid("option","selarrrow").concat();valueFirst=d.getValues()[0];d.selectedRow=d.selectedRow||valueFirst;if(d.options.multiple){if(d.selectedRow){for(var b=0;b<e.length;b++){if(d.selectedRow==e[b]){a=(b==e.length-1?0:(b+1));d.selectedRow=e[a];break}}if($.inArray(d.selectedRow,selarrrow)==-1){d.grid().grid("setSelection",d.selectedRow)}}else{d.selectedRow=e[0];d.grid().grid("setSelection",e[0])}d._scrollTo(d.selectedRow)}else{c=d.grid().grid("option","selrow");if(c){a=d.grid().grid("getInd",c);if(a<e.length){d.grid().grid("setSelection",e[a])}}else{d.grid().grid("setSelection",e[0])}d._scrollTo(c)}},_doEnter:function(){if(!this.uiCombo.panel.is(":visible")){return}if(this.options.multiple){this.grid().grid("setSelection",this.selectedRow)}else{this.hidePanel()}},_scrollTo:function(d){var a=this.panel();var c=a.find('.coral-row-ltr[id="'+d+'"]');if(c.length){if(c.position().top<=0){var b=a.find(".coral-grid-rows-view").scrollTop()+c.position().top-c.outerHeight();
a.find(".coral-grid-rows-view").scrollTop(b)}else{if(c.position().top+c.outerHeight()>a.find(".coral-grid-rows-view").height()){var b=a.find(".coral-grid-rows-view").scrollTop()+c.position().top+c.outerHeight()-a.find(".coral-grid-rows-view").height();a.find(".coral-grid-rows-view").scrollTop(b)}}}}});

var datepicker_instActive;$.component("coral.datepicker",{version:"4.0.2",componentName:"datepicker",componentFullName:"coral-datepicker",initialized:false,_curInst:null,_keyEvent:false,_disabledInputs:[],_datepickerShowing:false,_inDialog:false,_mainDivId:"coral-datepicker-divId",_inlineClass:"coral-datepicker-inline",_appendClass:"coral-datepicker-append",_triggerClass:"coral-datepicker-trigger",_dialogClass:"coral-datepicker-dialog",_disableClass:"coral-datepicker-disabled",_unselectableClass:"coral-datepicker-unselectable",_currentClass:"coral-datepicker-current-day",_dayOverClass:"coral-datepicker-days-cell-over",regional:[],options:{showOn:"button",showAnim:"fadeIn",showOptions:{},iframePanel:false,dateFormat:"yyyy-MM-dd",timeFormat:"HH:mm:ss",formatOptions:{ymdFormat:["dd","MMdd","yyyyMM","yyyyMMdd"],ymFormat:["yyyy","yyyyMM"],yFormat:["yyyy"]},firstDay:1,isRTL:false,showMonthAfterYear:true,defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:true,changeYear:true,complete:true,yearRange:"c-30:c+30",showOtherMonths:true,selectOtherMonths:true,showWeek:false,calculateWeek:function(a){var b,c=new Date(a.getTime());c.setDate(c.getDate()+4-(c.getDay()||7));b=c.getTime();c.setMonth(0);c.setDate(1);return Math.floor(Math.round((b-c)/86400000)/7)+1},shortYearCutoff:"+10",validDate:true,model:"datepicker",minDate:null,maxDate:null,minTime:null,maxTime:null,duration:"fast",beforeShowDay:null,beforeShow:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:true,autoSize:false,disabled:false,isLabel:false,readonly:false,showClose:false,value:null,required:false,showStar:true,starBefore:false,errMsg:null,errMsgPosition:"leftBottom",startDateId:null,endDateId:null,onSelect:null,onChange:null,onFormatError:null,onFormatWarn:null,srcDateFormat:null,zIndex:null,name:null,triggers:null,excluded:false},markerClassName:"hasDatepicker",maxRows:4,extendRemove:function(c,b){$.extend(c,b);
for(var a in b){if(b[a]==null){c[a]=b[a]}}return c},bindHover:function(c){var b=this;var a="button, .coral-datepicker-prev, .coral-datepicker-next, .coral-datepicker-calendar td a, .menuTimeSel";var d="#coral-datepicker-divId";return c.delegate(a,"mouseout",function(){$(this).removeClass("coral-state-hover");if(this.className.indexOf("coral-datepicker-prev")!==-1){$(this).removeClass("coral-datepicker-prev-hover")}if(this.className.indexOf("coral-datepicker-next")!==-1){$(this).removeClass("coral-datepicker-next-hover")}}).delegate(a,"mouseover",{element:b},b.datepicker_handleMouseover)},datepicker_handleMouseover:function(b){var a=b.data?b.data.element:b;if(!a.isDisabled()){$(this).parents(".coral-datepicker-calendar").find("a").removeClass("coral-state-hover");$(this).addClass("coral-state-hover");if(this.className.indexOf("coral-datepicker-prev")!==-1){$(this).addClass("coral-datepicker-prev-hover")}if(this.className.indexOf("coral-datepicker-next")!==-1){$(this).addClass("coral-datepicker-next-hover")}}},widget:function(){return this.dpDiv},_create:function(){var e,d;e=this.element[0].nodeName.toLowerCase();d=(e==="div"||e==="span");this.regional[""]={closeText:"关闭",prevText:"上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["1","2","3","4","5","6","7","8","9","10","11","12"],monthNamesShort:["1","2","3","4","5","6","7","8","9","10","11","12"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",yearSuffix:"年",monthSuffix:"月"};$.extend(this.options,this.regional[""]);var b=this.options;if(b.dateFormat!=null&&b.srcDateFormat==null){b.srcDateFormat=b.dateFormat}this.regional.en=$.extend(true,{},this.regional[""]);this.regional["en-US"]=$.extend(true,{},this.regional.en);var a=$("body").find("#coral-datepicker-divId");this.dpDiv=$("#coral-datepicker-divId").length?$("#coral-datepicker-divId"):this.bindHover($("<div id='"+this._mainDivId+"' class='coral-datepicker coral-component coral-component-content coral-helper-clearfix coral-corner-all'></div>"));
this.iframePanel=$("<iframe class='coral-datepicker-iframePanel' style='position:absolute;height:auto;'></iframe>");if(!this.initialized){$(document).mousedown({that:this},this._checkExternalClick);this.initialized=true}if($("#"+this._mainDivId).length===0){$("body").append(this.dpDiv)}this.prepareInit(this.options);this._initElement();if(b.startDateId){$("#"+b.startDateId).datepicker("option","endDateId",this.element[0].id);var c=$("#"+b.startDateId).datepicker("getValue");$("#"+this.element[0].id).datepicker("option","minDate",c)}if(e==="input"){this.connect()}else{if(d){this.inline()}}$(document).off(".coral-datepicker").on("mousedown.coral-datepicker","#"+this._mainDivId,function(f){if($(f.target).hasClass("menuTimeSel")){f.stopPropagation();return}f.stopPropagation()})},component:function(){return this.element.parent().parent()},_initElement:function(){var a=this.options,d=a.id,c=this.element.attr("name")||a.name||"",m=a.value,e=a.width,n=a.height,o=a.cls,h=a.labelField,l=a.showClose,g="",k=a.componentCls;this.originalValue=m;if(c){this.element.removeAttr("name")}if(l){g="<span class='coral-input-clearIcon cui-icon-cross2'></span>"}var i=$("<input id='"+d+"_srcval' name='"+c+"' type='hidden' value='"+(m==null?"":m)+"'>");var j=$("<span id='"+d+"_eleBorder' class='coral-textbox-border coral-corner-all'>"+g+"</span>");var b=$("<span id='"+d+"_eleComp' class='coral-textbox'></span>");this.element.addClass("coral-textbox-default coral-validation-datepicker");this.element.addClass("coral-form-element-datepicker ctrl-init ctrl-form-element ctrl-init-datepicker");if(n!=null){b.outerHeight(n);this.element.outerHeight("100%")}if(e!=null){b.outerWidth(e)}b.insertAfter(this.element).addClass(k);i.appendTo(j);this.element.appendTo(j).addClass(o);j.appendTo(b);if(a.iframePanel){this.iframePanel.appendTo("body").hide()}if(null!=h){var f=$('<label class="coral-label">'+h+"</label>");j.before(f);b.addClass("coral-hasLabel")}},prepareInit:function(a){var c=this.element[0];a=a||{};
if(!c.id){if(a.id){c.id=a.id}else{}a.id=$(c).uniqueId().attr("id")}else{if(a.id){c.id=a.id}else{a.id=$(c).uniqueId().attr("id")}}if(!c.name){if(a.name){c.name=a.name}a.name=$(c).attr("name")}else{if(a.name){c.name=a.name}else{a.name=$(c).attr("name")}}a.value=$(c).val()||a.value||"";var b=(c.nodeName.toLowerCase()==="div"||c.nodeName.toLowerCase()==="span");this._newInst($(c),b)},_newInst:function(b,a){var c=b[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");this.dpDiv.css({display:"none"});b.attr("component-role",this.componentName);this.inst={id:c,input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:a,isShow:false,dpDiv:(!a?this.dpDiv:this.bindHover($("<div class='"+this._inlineClass+" coral-datepicker coral-datepicker-panel coral-component coral-component-content coral-helper-clearfix coral-corner-all'></div>")))};$.extend(this.options,this.inst)},connect:function(){var c=this.options,d=this.element[0],a=$(d),b=this;c.append=$([]);c.trigger=$([]);if(a.hasClass(this.markerClassName)){return}this._attachments(a);a.addClass(this.markerClassName).keydown({that:b},this._doKeyDown).keypress({that:b},this._doKeyPress).keyup({that:b},this._doKeyUp);this._autoSize();if(c.disabled){this.disable()}if(c.readonly){this.readonly(c.readonly)}if(c.isLabel){this.isLabel(c.isLabel)}},_processDefaultDate:function(h,b){var a=this.options;if(b==""){a.selectedDay=a.currentDay=null;a.selectedMonth=a.currentMonth=null;a.selectedYear=a.currentYear=null;a.currentHur=null;a.currentMiu=null;a.currentSed=null;a.input.val("");return null}var c=a.dateFormat;var g=null;try{g=h.parseDate(c,b,h._getFormatConfig())}catch(i){return null}a.selectedDay=a.currentDay=g.getDate();a.selectedMonth=a.currentMonth=g.getMonth();a.selectedYear=a.currentYear=g.getFullYear();a.currentHur=g.getHours();a.currentMiu=g.getMinutes();a.currentSed=g.getSeconds();var f=h._daylightSavingAdjustWidthTime(new Date(a.currentYear,a.currentMonth,a.currentDay),[a.currentHur,a.currentMiu,a.currentSed]);
var d="";if(!a.value&&b){a.value=b}if(a.value!=""){var j=this.getFormatter(a.value,a.dateFormat,this._getFormatConfig());d=this.completeFormate(j,c);d=this.formatDate(d,f,this._getFormatConfig())}a.input.val(d);return f},_attachments:function(f){var e=this,a=this.options;var h,g,j,d=a.appendText,c=a.isRTL;if(a.append){a.append.remove()}if(d){a.append=$("<span class='"+this._appendClass+"'>"+d+"</span>");f[c?"before":"after"](a.append)}f.unbind("focus",this.show);f.unbind("blur");f.parent().unbind("mouseleave");f.parent().unbind("mouseenter");f.unbind(".attachments");if(a.trigger){a.trigger.remove()}var b=a.value;if(""==f.parent().find("input[type='hidden']").val()&&typeof b==="string"&&b!=""){e._processDefaultDate(e,b);e._setHiddenInputValue()}else{var i=e._getHiddenInputValue();e._processDefaultDate(e,i)}f.parent().find(".coral-input-clearIcon").unbind("click").bind("click",function(k){e._clearDate()});h=a.showOn;f.focus(function(k){if(h==="focus"||h==="both"){e.show(k)}});if(h==="button"||h==="both"){g=a.buttonText;a.trigger=$("<span/>").addClass("coral-icon-calendar cui-icon-calendar4");f[c?"before":"after"](a.trigger);if(a.isLabel==true){f.parent().addClass("coral-datepicker-no-close")}a.trigger.click(function(k){if(e._datepickerShowing&&e._lastInput===f[0]){e.hide()}else{if(e._datepickerShowing&&e._lastInput!==f[0]){e.hide()}}e.show();return false})}f.blur(function(k){e._inputBlur(a,k)});f.parent().mouseleave(function(){if(a.readonly||a.isLabel||a.disabled){return}f.parent().parent().removeClass("coral-textbox-hover")});f.parent().mouseenter(function(){if(a.readonly||a.isLabel||a.disabled){return}f.parent().parent().addClass("coral-textbox-hover")});f.bind("keyup.attachments",function(k){switch(k.keyCode){case 9:e.show(k);break}})},_autoSize:function(){var a=this.options;if(a.autoSize&&!a.inline){var f,h,g,d,c=new Date(2009,12-1,20),b=a.dateFormat;if(b.match(/[DM]/)){f=function(i){h=0;g=0;for(d=0;d<i.length;d++){if(i[d].length>h){h=i[d].length;g=d}}return g};var e=b.match(/MM/)?"monthNames":"monthNamesShort",j=b.match(/DD/)?"dayNames":"dayNamesShort";
c.setMonth(f(a.matchMM));c.setDate(f(a.amtchDD)+20-c.getDay())}a.input.attr("size",this._formatDate(c).length)}},inline:function(){var b=this.element[0],a=this.options,c=$(b);if(c.hasClass(this.markerClassName)){return}c.addClass(this.markerClassName).append(a.dpDiv);this._setDate(this._getDefaultDate(),true);this.update();this._updateAlternate();if(a.disabled){this.disable(b)}a.dpDiv.css("display","block")},dialog:function(c,f,l,g){var h=this.element[0],e=this;var b,k,d,j,i,a=this._dialogInst;if(!a){this.uuid+=1;b="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+b+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown({that:e},this._doKeyDown);$("body").append(this._dialogInput);this._newInst(this._dialogInput,false);this._dialogInst=a;inst.options={}}e.extendRemove(inst.options,l||{});c=(c&&c.constructor===Date?this._formatDate(inst,c):c);this._dialogInput.val(c);this._pos=(g?(g.length?g:[g.pageX,g.pageY]):null);if(!this._pos){k=document.documentElement.clientWidth;d=document.documentElement.clientHeight;j=document.documentElement.scrollLeft||document.body.scrollLeft;i=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(k/2)-100+j,(d/2)-150+i]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.options.onSelect=f;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this.show();if($.blockUI){$.blockUI(this.dpDiv)}return this},_destroy:function(){var d,b=this.options,c=this.element[0],a=$(c);$(c).parent().parent().replaceWith(a);if(!a.hasClass(this.markerClassName)){return}d=c.nodeName.toLowerCase();$.removeData(c,"inited");b.isShow=false;if(d==="input"){b.append.remove();b.trigger.remove();a.removeClass(this.markerClassName).unbind(".field").unbind(".restrictInput").unbind("blur").unbind("focus").unbind("keydown").unbind("keypress").unbind("keyup").unbind("datepickeronblur").unbind("datepickeronchange").unbind("datepickeronkeydown").unbind("datepickeronkeyup").unbind("datepickeronstatus").unbind("onOptionChange")
}else{if(d==="div"||d==="span"){a.removeClass(this.markerClassName).empty()}}$(c).val("");$(c).removeAttr("value");a.removeAttr("component-role").removeClass("coral-textbox-default coral-validation-datepicker coral-form-element-datepicker ctrl-init ctrl-form-element ctrl-init-datepicker").removeAttr("data-options")},enable:function(){var d=this.element[0],b=this.options,e,c,a=$(d);if(!a.hasClass(this.markerClassName)){return}e=d.nodeName.toLowerCase();if(e==="input"){d.disabled=false;b.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""});a.parent().parent().removeClass("coral-state-disabled")}else{if(e==="div"||e==="span"){c=a.children("."+this._inlineClass);c.children().removeClass("coral-state-disabled");c.find("select.coral-datepicker-month, select.coral-datepicker-year").prop("disabled",false)}}this._disabledInputs=$.map(this._disabledInputs,function(f){return(f===d?null:f)})},disable:function(){var d=this.element[0],e,c,b=this.options,a=$(d);if(!a.hasClass(this.markerClassName)){return}e=d.nodeName.toLowerCase();if(e==="input"){d.disabled=true;b.trigger.css({opacity:"0.5",cursor:"default"});a.parent().parent().addClass("coral-state-disabled")}else{if(e==="div"||e==="span"){c=a.children("."+this._inlineClass);c.children().addClass("coral-state-disabled");c.find("select.coral-datepicker-month, select.coral-datepicker-year").prop("disabled",true)}}this._disabledInputs=$.map(this._disabledInputs,function(f){return(f===d?null:f)});this._disabledInputs[this._disabledInputs.length]=d},readonly:function(b){var d=this.element[0],c,a=$(d);if(!a.hasClass(this.markerClassName)){return}$(d).parent().parent().removeClass("coral-isLabel");$(d).parent().parent().toggleClass("coral-readonly",b);this._readonly(d,b)},_readonly:function(c,a){var d=c.nodeName.toLowerCase(),b=this.options;if(d==="input"&&a){c.readOnly=true;b.trigger.filter("button").each(function(){this.readOnly=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})
}if(d==="input"&&!a){if(this.isIsLabel()){return}c.readOnly=false;b.trigger.filter("button").each(function(){this.readOnly=false}).end().filter("img").css({opacity:"1.0",cursor:""})}},isReadonly:function(){if(this.options.readonly){return this.options.readonly}return false},isIsLabel:function(){if(this.options.isLabel){return this.options.isLabel}return false},isLabel:function(b){var e=this.element[0],d,a=$(e),c=this.options;if(!a.hasClass(this.markerClassName)){return}var f=c.id;if(b){a.parent().removeClass("coral-datepicker-no-close");a.parent().parent().removeClass("coral-readonly");a.parent().parent().addClass("coral-isLabel")}else{a.parent().parent().removeClass("coral-isLabel coral-readonly");a.parent().addClass("coral-datepicker-no-close")}this.options.readonly=b;this.options.isLabel=b;this._readonly(e,b)},isDisabled:function(){var b=this.element[0];if(!b){return false}for(var a=0;a<this._disabledInputs.length;a++){if(this._disabledInputs[a]===b){return true}}return false},_setOption:function(l,k){this._super(l,k);var g=this;var e,d,f,c,b=this.options;d=this.getDate(true);f=this._getMinMaxDate("min");c=this._getMinMaxDate("max");var a=this._getHiddenInputValue();if(l=="value"){if(k){var j=this.getFormatter(k,b.dateFormat,this._getFormatConfig());var h=this.parseDate(j,k);var i=b.srcDateFormat;if(this._checkDateRange(h)===2){k=this.formatDate(i,f,this._getFormatConfig())}if(this._checkDateRange(h)===1){k=this.formatDate(i,c,this._getFormatConfig())}}d=g._processDefaultDate(g,k)}if(f!==null&&l=="dateFormat"){b.minDate=this._formatDate(f)}if(c!==null&&l=="dateFormat"){b.maxDate=this._formatDate(c)}if(l=="disabled"){if(k){this.disable()}else{this.enable()}}if(l=="readOnly"){this.readonly(k)}if(l=="isLable"){this.isLabel(k)}if(l=="showAnim"){return}if(l==="startDateId"){$("#"+k).datepicker("option","endDateId",b.id)}this._attachments(this.element);this._autoSize();this._setDate(d);if(b.isShow){this.update()}this._updateAlternate();this._setHiddenInputValue();if(l=="value"){this._setStartEnd(a,k)
}},valid:function(){var b=this.element[0];var a={hasTips:false,element:$(b)};return($.validate.validateField(null,a).length>0?false:true)},change:function(a,b){var c=this.element[0];this.option(a,b)},refresh:function(){var b=this.element[0],a=this.options;if(a){this.update()}},reset:function(){var a=this.elment[0];$(a).datepicker("option","value",this.originalValue)},setValue:function(a){var b=this.element[0];$(b).datepicker("option","value",a)},getValue:function(a){var c=this.element[0];var b=this.getDateValue();return b},setDate:function(a){var c=this.element[0],b=this.options;if(b){this._setDate(a);this.update();this._updateAlternate();this._setHiddenInputValue()}},getDate:function(a){var c=this.element[0],b=this.options;if(b&&!b.inline){this._setDateFromField(b,a)}return(b?this._getDate():null)},getDateValue:function(){var b=this.element[0],a=this.options;return this._getHiddenInputValue()},_doKeyDown:function(c){var h=c.data.that,i,f,d,b=h.options,g=true,e=b.dpDiv.is(".coral-datepicker-rtl");var a=h._getHiddenInputValue();b._keyEvent=true;if(h._datepickerShowing){switch(c.keyCode){case 9:h.hide();g=false;break;case 13:d=$("td."+h._dayOverClass+":not(."+h._currentClass+")",b.dpDiv);if(d[0]){h._selectDay(c.target,b.selectedMonth,b.selectedYear,d[0])}i=b.onSelect;if(i){f=h._formatDate()}else{h.hide()}case 27:h.hide();break;case 33:h._adjustDate(c.target,(c.ctrlKey?-b.stepBigMonths:-b.stepMonths),"M");break;case 34:h._adjustDate(c.target,(c.ctrlKey?+b.stepBigMonths:+b.stepMonths),"M");break;case 35:if(c.ctrlKey||c.metaKey){h._clearDate()}g=c.ctrlKey||c.metaKey;break;case 36:if(c.ctrlKey||c.metaKey){h._gotoToday(c.target)}g=c.ctrlKey||c.metaKey;break;case 37:if(c.ctrlKey||c.metaKey){h._adjustDate(c.target,(e?+1:-1),"D")}g=c.ctrlKey||c.metaKey;if(c.originalEvent.altKey){h._adjustDate(c.target,(c.ctrlKey?-b.stepBigMonths:-b.stepMonths),"M")}break;case 38:if(c.ctrlKey||c.metaKey){h._adjustDate(c.target,-7,"D")}g=c.ctrlKey||c.metaKey;break;case 39:if(c.ctrlKey||c.metaKey){h._adjustDate(c.target,(e?-1:+1),"D")
}g=c.ctrlKey||c.metaKey;if(c.originalEvent.altKey){h._adjustDate(c.target,(c.ctrlKey?+b.stepBigMonths:+b.stepMonths),"M")}break;case 40:if(c.ctrlKey||c.metaKey){h._adjustDate(c.target,+7,"D")}g=c.ctrlKey||c.metaKey;break;default:g=false}}else{if(c.keyCode===36&&c.ctrlKey){h.show()}else{g=false;switch(c.keyCode){case 9:case 13:h._setHiddenInputValue();f=h._getHiddenInputValue();h._setStartEnd(a,f);h._change(a,f);break}}}h._trigger("onKeyDown",c,[{oldValue:a,value:b.input.val()}]);if(g){c.preventDefault();c.stopPropagation()}},_setStartEnd:function(b,d){var c=this.options;if(b==d){return}var e=c.startDateId;var a=c.endDateId;if(e){$("#"+e).datepicker("option","maxDate",d)}if(a){$("#"+a).datepicker("option","minDate",d)}},_change:function(a,c,b){if(a!=c){this._trigger("onChange",b,[{oldValue:a,newValue:c,value:c}])}},_doKeyPress:function(a){},_doKeyUp:function(g){var f=g.data.that,c,e=f.options;var b=f._getHiddenInputValue();if(e.input.val()!==e.lastVal){try{if(e.input.val()==""){e.selectedDay=null;e.drawMonth=e.selectedMonth=null;e.drawYear=e.selectedYear=null;e.currentDay=null;e.currentMonth=null;e.currentYear=null;e.currentHur=null;e.currentMiu=null;e.currentSed=null}c=f.parseDate(e.dateFormat,e.input?e.input.val():null),f._getFormatConfig();e.input.addClass("isEdit");if(c&&f._checkDateRange(c)===0){f._setDateFromField();f._updateAlternate()}var a=e.input.val()}catch(d){var a=e.input.val()}f._trigger("onKeyUp",g,[{oldValue:b,value:e.input.val()}])}return true},_checkDateRange:function(a){var c,d,b=this.options,c=this._getMinMaxDate("min");d=this._getMinMaxDate("max");if(d!=null&&a>d){return 1}if(c!=null&&a<c){return 2}return 0},_srcDateFormatSeparator:function(a){var b="/";if(a.indexOf("/")>-1){return b}if(a.indexOf("-")>-1){b="-";return b}},_setHiddenInputValue:function(){var f=this.options;if(f.input.val()==""){f.input.parent().find("input[type='hidden']").val("");return}var a=f.dateFormat;var e=e||f.srcDateFormat;var h=this._srcDateFormatSeparator(e);if(f.currentYear==null||f.currentMonth==null){f.input.parent().find("input[type='hidden']").val("");
return}var c=this._daylightSavingAdjustWidthTime(new Date(f.currentYear,f.currentMonth,f.currentDay),[f.currentHur,f.currentMiu,f.currentSed]);var g=this.getFormatter(f.input.val(),f.dateFormat,this._getFormatConfig()),d=this.completeFormate(g,a);if(f.complete){b=this.formatDate(e,c,this._getFormatConfig())}else{if(e.indexOf("-")>-1||e.indexOf("/")>-1){d=(d.indexOf("y")>-1&&d.indexOf("M")>-1&&d.indexOf("d")>-1)?e:d;var b=this.formatDate(d,c,this._getFormatConfig());if(b.indexOf("-")>-1){var b=b.indexOf(h)==-1?b.replace(/-/gm,h):b}else{if(b.indexOf("/")>-1){var b=b.indexOf(h)==-1?b.replace(/\//gm,h):b}}}else{d=d.indexOf("-")>-1?d.replace(/-/gm,""):d.replace(/\//gm,"");if(d.indexOf("y")>-1){if(d.indexOf("d")==-1&&d.indexOf("y")>-1&&d.indexOf("M")>-1){e=(e.split(" "))[0];d=e.replace(/d/gm,"")}if(d.indexOf("y")>-1&&d.indexOf("M")>-1&&d.indexOf("d")>-1){d=e}else{d=d}}b=this.formatDate(d,c,this._getFormatConfig())}}f.input.parent().find("input[type='hidden']").val(b)},_getHiddenInputValue:function(){var a=this.options;var b=a.id;return a.input.parent().find("input[type='hidden']").val()},_createEditFormat:function(b){var a="";if(b!=null){if(this._isYearMonthMode(b)){a+="yyyy-MM"}else{if(this._isYearMode(b)){a+="yyyy"}else{a+="yyyy-MM-dd"}}if(this._hasTime(b)){a+=" HH:mm:ss"}}return a},completeFormate:function(e,b){var j,i,h=null,d;var a=this.options;var m=b.indexOf("H")>-1?(b.split(" "))[0]:b;if(a.complete){return b}else{if(m.indexOf("d")==-1){if(m.indexOf("d")==-1&&e.indexOf("M")==-1){return e}return m}if(m.indexOf("d")>-1){var l=m.indexOf("y"),k=m.indexOf("d"),g=m.substr(k+2,m.length),f=m.substr(0,k-1),c=m.substr(0,k+2);if(e.length==2){return e}if(e.indexOf("y")>-1&&e.indexOf("d")>-1&&e.indexOf("M")>-1){return b}if(e.indexOf("d")==-1){if(e.indexOf("M")==-1){return e}if(k==0){d=g}if(k==8){d=f}if(k==3){d=f+g}}else{if(e.indexOf("y")==-1){if(l==0){d=m.substr(l+5,5)}if(l==6){d=m.substr(0,l-1)}}}}return d}},_inputBlur:function(h){this.component().removeClass("coral-state-focus");
var g=this.options;var a=g.dateFormat;if(this.isReadonly()||this.isIsLabel()){return}var c=this._getHiddenInputValue();var f="";var b=this._daylightSavingAdjustWidthTime(new Date(g.currentYear,g.currentMonth,g.currentDay),[g.currentHur,g.currentMiu,g.currentSed]);if((typeof g.currentYear!="undefined"||g.currentYear!=null)&&!g.isShow){var d=this.getFormatter(g.input.val(),g.dateFormat,this._getFormatConfig());if(""!=g.input.val()){f=this.completeFormate(d,a);f=this.formatDate(f,b,this._getFormatConfig())}g.input.val(f);this._setHiddenInputValue();this._setStartEnd(c,f);this._change(c,f,null);this._trigger("onBlur",h,[{value:f}])}},focus:function(c){var a=c.target||this.elment[0],b=this.options;if(a.nodeName.toLowerCase()!=="input"){a=$("input",a.parentNode)[0]}if(this.isDisabled()||this._lastInput===a||this.isReadonly()||this.isIsLabel()){return false}b.input.focus();return true},show:function(d){var m,k=this,b=this.options;if(d){m=d.target}else{m=this.element[0]}if(m.nodeName.toLowerCase()!=="input"){m=$("input",m.parentNode)[0]}if(k.isDisabled()||k._lastInput===m||k.isReadonly()||k.isIsLabel()){return}var h,l,g,j,c,i;if($.coral._curInst&&$.coral._curInst!==b){$.coral._curInst.dpDiv.stop(true,true);if(b&&k._datepickerShowing){k.hide()}}h=b.beforeShow;l=h?h.apply(m,[m,b]):{};if(l===false){return}k.extendRemove(b,l);b.lastVal=null;k._lastInput=m;k._setDateFromField();if(k._inDialog){m.value=""}if(!k._pos){k._pos=k._findPos(m);k._pos[1]+=m.offsetHeight}g=false;$(m).parents().each(function(){g|=$(this).css("position")==="fixed";return !g});j={left:k._pos[0],top:k._pos[1]};k._pos=null;b.dpDiv.empty();b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});k.iframePanel.css({position:"absolute",display:"block",top:"-1000px"});k.update();var a=$(b.dpDiv),o=k.iframePanel,e=a.width(),n=a.height();j=k._checkOffset(j,g);b.dpDiv.css({position:(k._inDialog&&$.blockUI?"static":(g?"fixed":"absolute")),display:"none",left:j.left+"px",top:j.top+"px"});k.iframePanel.css({position:(k._inDialog&&$.blockUI?"static":(g?"fixed":"absolute")),display:"none",left:j.left+"px",top:j.top+"px",width:e,height:n});
if(!b.isShow){b.isShow=true;if(!b.inline){c=b.showAnim;i=b.duration;if(b.zIndex!=null){b.dpDiv.zIndex(b.zIndex+1);k.iframePanel.zIndex(b.zIndex)}k._datepickerShowing=true;if($.effects&&$.effects.effect[c]){b.dpDiv.show(c,b.showOptions,i)}else{b.dpDiv[c||"show"](c?i:null)}k.iframePanel.show(c);if(k._shouldFocusInput()){b.input.focus()}k._curInst=b;$.coral._curInst=k._curInst}(function f(){var p=$(m).parent().parent();if(b.isShow){a.css({left:$.coral.getLeft(a,p),top:$.coral.getTop(a,p)});o.css({left:$.coral.getLeft(a,p),top:$.coral.getTop(a,p)});setTimeout(f,200)}})()}b.dpDiv.find("#dpTimeSpinner").spinner("setValue",b.dpDiv.find("#dpTimeHour").val())},_updateDateTime:function(){var k=this,n,f,j,h=[],l,i,m,a=this.options;if(a.model=="timepicker"){var c=new Date();h.push(c.getFullYear(),c.getMonth(),c.getDate());var e=a.minTime?h.join("-")+" "+a.minTime:null,b=a.maxTime?h.join("-")+" "+a.maxTime:null;var d=new Date(e),g=new Date(b);l=new Date(c.getFullYear(),c.getMonth(),c.getDate());i=m=l}else{var e=this._getMinMaxDate("min");var b=this._getMinMaxDate("max");var d=new Date(e),g=new Date(b);l=new Date(a.selectedYear,a.selectedMonth,a.selectedDay),i=new Date(d.getFullYear(),d.getMonth(),d.getDate()),m=new Date(g.getFullYear(),g.getMonth(),g.getDate())}a.dpDiv.find("#coral-timePanel").find("#dpTimeHour").spinner({max:24,min:0,step:1,vertical:true,onSpin:function(q,p){var o=$(this).spinner("getValue");n=p.value;if(new Date(l).getTime()==new Date(i).getTime()&&(e&&n<d.getHours())||(b&&n>g.getHours())){$(this).find("#dpTimeHour").val(o);return false}k._selectTime(n)}});a.dpDiv.find("#coral-timePanel").find("#dpTimeMinute").spinner({max:60,min:0,step:1,vertical:true,onSpin:function(r,q){var p=$(this).spinner("getValue");f=q.value;var o=a.dpDiv.find("#dpTimeHour").val();if(new Date(l).getTime()==new Date(i).getTime()&&(e&&f<d.getMinutes()&&o<=d.getHours())||(b&&f>=g.getMinutes()&&o>=g.getHours())){$(this).find("#dpTimeMinute").val(p);return false}k._selectTime(null,q.value)}});
a.dpDiv.find("#coral-timePanel").find("#dpTimeSecond").spinner({max:60,min:0,step:1,vertical:true,onSpin:function(s,q){var p=$(this).spinner("getValue");j=q.value;var o=a.dpDiv.find("#dpTimeHour").val(),r=a.dpDiv.find("#dpTimeMinute").val();if(new Date(l).getTime()==new Date(i).getTime()&&(e&&j<d.getSeconds()&&o<=d.getHours()&&r<=d.getMinutes())||(b&&j>g.getSeconds()&&o>=g.getHours()&&r>=g.getMinutes())){$(this).find("#dpTimeSecond").val(p);return false}k._selectTime(null,null,q.value)}})},update:function(){var e=this.options,d=this;this.maxRows=4;datepicker_instActive=e;if(e.model=="datepicker"){e.dpDiv.empty().append(this._generateHTML()).append(this._generateTimePanel());e.dpDiv.find("#timepicker").find(".icon-checkmark").hide()}else{e.dpDiv.empty().append(this._generateTimePanel())}this._updateDateTime();this._attachHandlers();this._attachTimeHandlers();var g,a=this._getNumberOfMonths(),f=a[1],c=17,b=e.dpDiv.find("."+this._dayOverClass+" a");if(b.length>0){this.datepicker_handleMouseover.apply(b.get(0),[d])}e.dpDiv.removeClass("coral-datepicker-multi-2 coral-datepicker-multi-3 coral-datepicker-multi-4").width("");if(f>1){e.dpDiv.addClass("coral-datepicker-multi-"+f).css("width",(c*f)+"em")}e.dpDiv[(a[0]!==1||a[1]!==1?"add":"remove")+"Class"]("coral-datepicker-multi");e.dpDiv[(e.isRTL?"add":"remove")+"Class"]("coral-datepicker-rtl");if(e===this._curInst&&this._datepickerShowing&&this._shouldFocusInput()){}if(e.yearshtml){g=e.yearshtml;setTimeout(function(){if(g===e.yearshtml&&e.yearshtml){e.dpDiv.find("select.coral-datepicker-year:first").replaceWith(e.yearshtml)}g=e.yearshtml=null},0)}},_shouldFocusInput:function(){var a=this.options;return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(e,d){var a=this.options,f=a.dpDiv.outerWidth(),i=a.dpDiv.outerHeight(),h=a.input?a.input.outerWidth():0,b=a.input?a.input.outerHeight():0,g=document.documentElement.clientWidth+(d?0:$(document).scrollLeft()),c=document.documentElement.clientHeight+(d?0:$(document).scrollTop());
e.left-=a.isRTL?(f-h):0;e.left-=(d&&e.left===a.input.offset().left)?$(document).scrollLeft():0;e.top-=(d&&e.top===(a.input.offset().top+b))?$(document).scrollTop():0;e.left-=Math.min(e.left,(e.left+f>g&&g>f)?Math.abs(e.left+f-g):0);e.top-=Math.min(e.top,(e.top+i>c&&c>i)?Math.abs(i+b):0);return e},_findPos:function(d){var a,c=this.options,b=c.isRTL;while(d&&(d.type==="hidden"||d.nodeType!==1||$.expr.filters.hidden(d))){d=d[b?"previousSibling":"nextSibling"]}a=$(d).offset();return[a.left,a.top]},hide:function(c){var c=this.element[0],e=this,b,g,f,a,d=this._curInst;if(!d||(c&&d!==this.options)){return}d.isShow=false;if(this._datepickerShowing){b=d.showAnim;g=d.duration;f=function(){e._tidyDialog(d)};if($.effects&&($.effects.effect[b]||$.effects[b])){d.dpDiv.hide(b,d.showOptions,g,f)}else{d.dpDiv[(b==="slideDown"?"slideUp":(b==="fadeIn"?"fadeOut":"hide"))]((b?g:null),f)}this.iframePanel.hide();if(!b){f()}this._datepickerShowing=false;a=d.onClose;if(a){a.apply((d.input?d.input[0]:null),[(d.input?d.input.val():""),d])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".coral-datepicker-calendar")},_checkExternalClick:function(d){var c=d.data.that;if(!c._curInst){return}var a=$(d.target),b=c.options;if(d.isDefaultPrevented()){return}if(((a[0].id!==c._mainDivId&&a.parents("#"+c._mainDivId).length===0&&!a.hasClass(c.markerClassName)&&!a.closest("."+c._triggerClass).length&&c._datepickerShowing&&!(c._inDialog&&$.blockUI)))||(a.hasClass(c.markerClassName)&&c._curInst!==b)){c.hide()}},_adjustDate:function(e,d,c){var b=$(e),a=this.options;if(this.isDisabled(b[0])||this.isReadonly()||this.isIsLabel()){return}this._adjustInstDate(d+(c==="M"?a.showCurrentAtPos:0),c);this.update()},_gotoToday:function(g){var e=this,b,f=$(g),d=this.options;var a=this._hasTime(d.dateFormat);if(d.gotoCurrent&&d.currentDay){d.selectedDay=d.currentDay;
d.drawMonth=d.selectedMonth=d.currentMonth;d.drawYear=d.selectedYear=d.currentYear}else{b=new Date();if(!a){b.setHours(0,0,0,0)}if(e._checkDateRange(b)===1){return}else{if(e._checkDateRange(b)===2){return}}d.selectedDay=b.getDate();d.drawMonth=d.selectedMonth=b.getMonth();d.drawYear=d.selectedYear=b.getFullYear();d.currentHur=b.getHours();d.currentMiu=b.getMinutes();d.currentSed=b.getSeconds()}this._notifyChange();if(!a){var c=d.dpDiv.children("table").find(".coral-datepicker-today");this._selectDay(g,+c.attr("data-month"),+c.attr("data-year"),c[0])}else{this._selectDateTime()}this._updateDateTime()},_selectMonthYear:function(c,j,h,i){var g=$(c),f=this,b=this.options;var d=this._isYearMonthMode(b.dateFormat);var e=this._isYearMode(b.dateFormat);if(d===true){b["draw"+(h==="M"?"Month":"Year")]=parseInt(h==="M"?$(j).attr("data-month"):j.options[j.selectedIndex].value,10)}else{if(e===true){b.drawYear=parseInt(h==="Y"?$(j).attr("data-year"):j.options[j.selectedIndex].value,10)}else{b["draw"+(h==="M"?"Month":"Year")]=parseInt(j.options[j.selectedIndex].value,10)}}b["selected"+(h==="M"?"Month":"Year")]=b["draw"+(h==="M"?"Month":"Year")];var a=this._getHiddenInputValue();if(d===true&&h==="M"){this._setMonthYearValue(this)}if(e===true){this._setMonthYearValue(this)}var k=this._getHiddenInputValue();this._notifyChange();if(i){f._setStartEnd(a,k);f._change(a,k,null)}this._adjustDate(g)},_setMonthYearValue:function(d){var c=this.options,a=c.dateFormat;if(d._isYearMonthMode(a)){c.currentYear=c.selectedYear;c.currentMonth=c.selectedMonth;c.currentDay=c.selectedDay=1}if(d._isYearMode(a)){c.currentYear=c.selectedYear;c.currentMonth=c.selectedMonth=1;c.currentDay=c.selectedDay=1}var b=d._formatDate();if(c.input){c.input.val(b)}d._setHiddenInputValue()},_selectDay:function(e,i,k,f){var a=this.options,g,d,j=$(e);if($(f).hasClass(this._unselectableClass)||this.isDisabled()||this.isReadonly()||this.isIsLabel()){return}a.selectedDay=a.currentDay=$("a",f).html();a.selectedMonth=a.currentMonth=i;
a.selectedYear=a.currentYear=k;var c=a.dateFormat;this._autoFixInput(this);var l=a.dpDiv.find("#dpTimeHour").val();var b=a.dpDiv.find("#dpTimeMinute").val();var h=a.dpDiv.find("#dpTimeSecond").val();a.currentMiu=b;a.currentSed=h;this._selectDate(e,this._formatDate(a.currentDay,a.currentMonth,a.currentYear));$(f).parent().parent().find("a").removeClass("coral-state-active");$(f).children("a").addClass("coral-state-active");this.update()},_clearDate:function(){this._setDate("")},clearError:function(){var a=this.element[0];$(".coral-validate-state-error").remove();$(".coral-errorIcon").remove();$(".coral-validate-error").removeClass("coral-validate-error");$(a).prop("isError",false)},_selectDate:function(h,b){var d,g=$(h),f=this.options;var a=f.dateFormat;b=(b!=null?b:this._formatDate());if(f.input){f.input.val(b)}this._updateAlternate();if(f.inline){this.update()}else{this._lastInput=f.input[0];if(typeof(f.input[0])!=="object"){f.input.focus()}this._lastInput=null;var c=this._getHiddenInputValue();this._setHiddenInputValue();var e=this._getHiddenInputValue();if(e!==c){this._setStartEnd(c,e);this._change(c,e,null)}}this._trigger("onSelect",null,[{oldValue:c,newValue:e}])},_attachTimeHandlers:function(){var e=this,d="",c=this.options;var b=this._getHiddenInputValue();this._setHiddenInputValue();var d=this._getHiddenInputValue();function a(f,i){var g=i?(function(){var h=0;f.children(":visible").each(function(j){h+=$(this).outerHeight(true)});return h})():0;f.height(g)}c.dpDiv.find("#timePanel").bind("mousedown",function(f){var g=c.dpDiv.find("#datepicker"),h=c.dpDiv.find("#timepicker");if(g.hasClass("in")){a(g,true);a(g,false);a(h,true);setTimeout(function(){h.css("height","auto")},350)}else{a(h,true);a(g,true);a(h,false);setTimeout(function(){g.css("height","auto")},350)}g.toggleClass("in");f.preventDefault()});this._verifyInput(c.dpDiv.find("#dpTimeHour"),"H");this._verifyInput(c.dpDiv.find("#dpTimeMinute"),"m");this._verifyInput(c.dpDiv.find("#dpTimeSecond"),"s")},_autoFixInput:function(i){var g=0,a=this.options;
var f=i._getMinMaxDate("min");var b=i._getMinMaxDate("max");var j=a.dpDiv.find("#dpTimeHour").val();var c=a.dpDiv.find("#dpTimeMinute").val();var h=a.dpDiv.find("#dpTimeSecond").val();j=j.replace(/[^0-9]/g,"");if(j==""){j=a.currentHur}c=c.replace(/[^0-9]/g,"");if(c==""){c=a.currentMiu}h=h.replace(/[^0-9]/g,"");if(h==""){h=a.currentSed}var e=new Date(a.currentYear,a.currentMonth,a.currentDay,j,c,h);var d=e;if(i._checkDateRange(e)===1){d=b}else{if(i._checkDateRange(e)===2){d=f}}a.dpDiv.find("#dpTimeHour").val(d.getHours()||"00");a.dpDiv.find("#dpTimeMinute").val(d.getMinutes()||"00");a.dpDiv.find("#dpTimeSecond").val(d.getSeconds()||"00")},_verifyInput:function(b,d){var e=this,c=0,a=59;a=d=="H"?23:a;b.change(function(){e._autoFixInput(e)}).bind("paste",function(){e._autoFixInput(e)})},_selectTime:function(b,d,c){var e=this.options;var a=b||e.dpDiv.find("#dpTimeHour").val();var f=d||e.dpDiv.find("#dpTimeMinute").val();var c=c||e.dpDiv.find("#dpTimeSecond").val();e.currentHur=a;e.currentMiu=f;e.currentSed=c;e.input.val(this._formatDate());this._setHiddenInputValue()},_selectDateTime:function(){var b=this._getHiddenInputValue(),a=this.options;var k=a.dpDiv.find("#dpTimeHour").val();var d=a.dpDiv.find("#dpTimeMinute").val();var i=a.dpDiv.find("#dpTimeSecond").val();a.currentHur=k;a.currentMiu=d;a.currentSed=i;var h=this._getMinMaxDate("min"),c=this._getMinMaxDate("max");var g=new Date();if(!a.selectedYear){a.currentDay=a.selectedDay=g.getDate();a.currentMonth=a.selectedMonth=g.getMonth();a.currentYear=a.selectedYear=g.getFullYear();var f=new Date(a.currentYear,a.currentMonth,a.currentDay,k,d,i);if(!(h||c)){a.input.val(f)}else{if(this._checkDateRange(f)===1){a.selectedDay=c.getDate();a.selectedMonth=c.getMonth();a.selectedYear=c.getFullYear()}else{if(this._checkDateRange(f)===2){a.selectedDay=h.getDate();a.selectedMonth=h.getMonth();a.selectedYear=h.getFullYear()}}}}a.input.val(this._formatDate());this._setHiddenInputValue();this._updateAlternate();var e=this._getHiddenInputValue();
this._setStartEnd(b,e);this._change(b,e,null);var j=$(a.input[0]);this.hide()},_hasTime:function(a){var b=(a+"");if(b.indexOf("H")!=-1||b.indexOf("m")!=-1||b.indexOf("s")!=-1){return true}return false},_hasHur:function(a){var b=(a+"");if(b.indexOf("H")!=-1){return true}return false},_hasMin:function(a){var b=(a+"");if(b.indexOf("m")!=-1){return true}return false},_hasSec:function(a){var b=(a+"");if(b.indexOf("s")!=-1){return true}return false},_isYearMonthMode:function(a){if(!this._hasTime(a)){return a.indexOf("M")!=-1&&a.indexOf("y")!=-1&&a.indexOf("d")==-1}return false},_isYearMode:function(a){if(!this._hasTime(a)){return a.indexOf("y")!=-1&&a.indexOf("M")==-1&&a.indexOf("d")==-1}return false},_updateAlternate:function(){var e=this.options,d,c,a,b=e.altField;if(b){d=e.altFormat||e.dateFormat;c=this._getDate();a=this.formatDate(d,c,this._getFormatConfig());$(b).each(function(){$(this).val(a)})}},noWeekends:function(b){var a=b.getDay();return[(a>0&&a<6),""]},getFormatter:function(m,l,n){var h=null,o=null,a=this.options;if(l.indexOf("y")>-1&&l.indexOf("M")>-1&&l.indexOf("d")>-1){h="ymdFormat"}if(l.indexOf("y")>-1&&l.indexOf("M")>-1&&l.indexOf("d")==-1){h="ymFormat"}if(l.indexOf("y")>-1&&l.indexOf("M")==-1&&l.indexOf("d")==-1){h="yFormat"}var c="yyyy-MM-dd";var j=a.formatOptions;var m=(typeof m==="object"?m.toString():m+"");if(m===""){return null}var k=m.split(" ");if(k[0].indexOf("/")>-1||k[0].indexOf("-")>-1){var b=k[0].indexOf("/")>-1?k[0].split("/"):k[0].split("-");for(var g=0;g<b.length;g++){if(b[g].length%2!=0){b[g]="0"+b[g]}k[0]=b.join("-")}}var e=k[0].indexOf("/")>-1?k[0].replace(/\//g,""):k[0].replace(/-/g,"");var f=k[0].split("/").length-1,d=k[0].split("-").length-1;for(var g=0;g<j[h].length;g++){if(j[h][g].length==e.length){o=j[h][g]}}return(o?o:l)||null},configDateFormat:function(f,g,j){var c=f;var h=f.split(" ");var b=h[1]||"";var e=g.split(" ");if(e[0].indexOf("/")>-1||e[0].indexOf("-")>-1){var a=e[0].indexOf("/")>-1?e[0].split("/"):e[0].split("-");for(var d=0;
d<a.length;d++){if(a[d].length%2!=0){a[d]="0"+a[d]}e[0]=a.join("-")}}f=this.getFormatter(e[0],h[0],j);f+=c.substr(h[0].length,c.length);e[0]=e[0].indexOf("/")>-1?e[0].replace(/\//g,""):e[0].replace(/-/g,"");g=e.join(" ");return{format:f,value:g}},parseDate:function(x,s,d){var o=this.options,f;if(x==null||s==null){throw"Invalid arguments"}d=d||{};s=(typeof s==="object"?s.toString():s+"");if(s===""){return null}if(o.model=="timepicker"){var B=new Date(),j=[];x="yyyy-MM-dd "+o.timeFormat;j.push(B.getFullYear());j.push(B.getMonth()+1);j.push(B.getDate());s=j.join("-")+" "+s}f=this.configDateFormat(x,s,d);x=f.format;s=f.value;var c=this._hasTime(x);var i,u,b,y=0,l=(d?d.shortYearCutoff:null)||this.options.shortYearCutoff,e=(typeof l!=="string"?l:new Date().getFullYear()%100+parseInt(l,10)),q=(d?d.dayNamesShort:null)||this.options.dayNamesShort,C=(d?d.dayNames:null)||this.options.dayNames,a=(d?d.monthNamesShort:null)||this.options.monthNamesShort,h=(d?d.monthNames:null)||this.options.monthNames,o=d.opts,k=-1,D=-1,w=-1,n=-1,E=-1,p=-1,A=-1,v=false,B,r=function(H){var I=(i+1<x.length&&x.charAt(i+1)===H);if(I){i++}return I},g=function(H){var I=1;while(i+1<x.length&&x.charAt(i+1)==H){I++;i++}return I},G=function(J){var H=r(J),K=(J==="@"?14:(J==="!"?20:(J==="y"&&H?4:(J==="o"?3:2)))),M=(J==="y"?K:1),L=new RegExp("^\\d{"+M+","+K+"}"),I=s.substring(y).match(L);if(!I){throw"Missing number at position "+y}y+=I[0].length;return parseInt(I[0],10)},F=function(I,J){if(y>s.length||y==s.length){return -1}var K=new RegExp("^\\d{1,"+J+"}"),H=s.substring(y).match(K);if(!H){throw"Missing number at position "+y}y+=H[0].length;return parseInt(H[0],10)},m=function(I,J,L){var H=-1,K=$.map(r(I)?L:J,function(N,M){return[[M,N]]}).sort(function(N,M){return -(N[1].length-M[1].length)});$.each(K,function(N,O){var M=O[1];if(s.substr(y,M.length).toLowerCase()===M.toLowerCase()){H=O[0];y+=M.length;return false}});if(H!==-1){return H+1}else{throw"Unknown name at position "+y}},t=function(){if(""!==s.charAt(y)&&s.charAt(y)!==x.charAt(i)){return;
throw"Unexpected literal at position "+y}y++};for(i=0;i<x.length;i++){if(v){if(x.charAt(i)==="'"&&!r("'")){v=false}else{t()}}else{switch(x.charAt(i)){case"d":var z=g("d");w=F("d",z);break;case"M":z=g("M");D=F("M",z);break;case"y":z=g("y");k=F("y",z);break;case"H":z=g("H");E=F("H",z);break;case"m":z=g("m");p=F("m",z);break;case"s":z=g("s");A=F("s",z);break;default:t()}}}if(w==-1){w=1;if(D==-1){D=1}}if(w!=-1&&D==-1){D=new Date().getMonth()+1}if(k===-1){k=new Date().getFullYear()}else{if(k<100){k+=new Date().getFullYear()-new Date().getFullYear()%100+(k<=e?0:-100)}}if(n>-1){D=1;w=n;do{u=this._getDaysInMonth(k,D-1);if(w<=u){break}D++;w-=u}while(true)}k=(k==-1?1:k);E=(E==-1?0:E);p=(p==-1?0:p);A=(A==-1?0:A);B=this._daylightSavingAdjustWidthTime(new Date(k,D-1,w),[E,p,A]);if((B.getFullYear()!==k||B.getMonth()+1!==D||B.getDate()!==w)||(c&&(B.getHours()!==E||B.getMinutes()!==p||B.getSeconds()!==A))){throw"Invalid date"}return B},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(n,p,b){if(!p){return""}var f,h=this.options,i=(b?b.dayNamesShort:null)||this.options.dayNamesShort,q=(b?b.dayNames:null)||this.options.dayNames,a=(b?b.monthNamesShort:null)||this.options.monthNamesShort,g=(b?b.monthNames:null)||this.options.monthNames,k=function(s){var t=(f+1<n.length&&n.charAt(f+1)===s);if(t){f++}return t},e=function(s){var t=1;while(f+1<n.length&&n.charAt(f+1)==s){t++;f++}return t},c=function(u,v,s){var t=""+v;if(k(u)){while(t.length<s){t="0"+t}}return t},j=function(s,u,t,v){return(k(s)?v[u]:t[u])},d="",r="",l="",m=false;if(h.model=="timepicker"){n="yyyy-MM-dd "+h.timeFormat}if(p){for(f=0;f<n.length;f++){if(m){if(n.charAt(f)==="'"&&!k("'")){m=false}else{d+=n.charAt(f)}}else{switch(n.charAt(f)){case"d":d+=c("d",p.getDate(),2);
break;case"D":d+=j("D",p.getDay(),i,q);break;case"M":var o=e("M");if(o==4){d+=g[p.getMonth()]}else{if(o==3){d+=g[p.getMonth()]}else{if(o==2){d+=(p.getMonth()+1>9?p.getMonth()+1:"0"+(p.getMonth()+1))}else{if(o==1){d+=p.getMonth()+1}}}}break;case"y":o=e("y");if(o==4){d+=p.getFullYear()}else{if(o==3){d+=(p.getFullYear()+"").substring(1,4)}else{if(o==2){d+=((p.getYear()%100<10?"0":"")+p.getYear()%100)}else{if(o==1){d+=p.getYear()%100}}}}break;case"H":o=e("H");if(o==2){d+=(p.getHours()>9?p.getHours():"0"+(p.getHours()))}else{if(o==1){d+=p.getHours()}}break;case"m":o=e("m");if(o==2){d+=(p.getMinutes()>9?p.getMinutes():"0"+(p.getMinutes()))}else{if(o==1){d+=p.getMinutes()}}break;case"s":o=e("s");if(o==2){d+=(p.getSeconds()>9?p.getSeconds():"0"+(p.getSeconds()))}else{if(o==1){d+=p.getSeconds()}}break;case"W":o=e("W");if(o==2){d+=(b.calculateWeek(p)>9?b.calculateWeek(p):"0"+b.calculateWeek(p))}else{if(o==1){d+=b.calculateWeek(p)}}break;case"w":d+=p.getDay();break;default:d+=n.charAt(f)}}}}if(h.model=="timepicker"){d=d.substring(d.indexOf(" ")+1,d.length)}return d},_possibleChars:function(e){var d,c="",b=false,a=function(f){var g=(d+1<e.length&&e.charAt(d+1)===f);if(g){d++}return g};for(d=0;d<e.length;d++){if(b){if(e.charAt(d)==="'"&&!a("'")){b=false}else{c+=e.charAt(d)}}else{switch(e.charAt(d)){case"d":case"m":case"y":case"@":case"H":case"M":case"s":c+="0123456789";break;case"D":case"W":return null;case"'":if(a("'")){c+="'"}else{b=true}break;default:c+=e.charAt(d)}}}return c},_setDateFromField:function(b){var a=this.options;var f=a.dateFormat,d=a.lastVal=a.input?a.input.val():null,e=this._getDefaultDate(),h=e,g=a.input.val(),i=this._getFormatConfig();try{h=this.parseDate(f,g,i)||e}catch(c){h=e}a.selectedDay=h.getDate();a.drawMonth=a.selectedMonth=h.getMonth();a.drawYear=a.selectedYear=h.getFullYear();a.currentDay=h.getDate();a.currentMonth=h.getMonth();a.currentYear=h.getFullYear();a.currentHur=h.getHours();a.currentMiu=h.getMinutes();a.currentSed=h.getSeconds();this._adjustInstDate()
},_getDefaultDate:function(){var a=this.options;return this._restrictMinMax(this._determineDate(a.defaultDate,new Date()))},_determineDate:function(e,d){var i=this,h=[],a=this.options;var f=function(n){var m=new Date();m.setDate(m.getDate()+n);return m},j=function(n){try{var o="yyyy-MM-dd";var v=a.srcDateFormat;if(i._isYearMonthMode(v)){o="yyyy-MM"}if(i._isYearMode(v)){o="yyyy"}if((n+"").length>10&&i._hasTime(v)){o+=" HH:mm:ss"}o=a.dateFormat;return i.parseDate(o,n,i._getFormatConfig())}catch(q){}var m=(n.toLowerCase().match(/^c/)?i._getDate():null)||new Date(),t=m.getFullYear(),r=m.getMonth(),u=m.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,p=s.exec(n);while(p){switch(p[2]||"d"){case"d":case"D":u+=parseInt(p[1],10);break;case"w":case"W":u+=parseInt(p[1],10)*7;break;case"m":case"M":r+=parseInt(p[1],10);u=Math.min(u,i._getDaysInMonth(t,r));break;case"y":case"Y":t+=parseInt(p[1],10);u=Math.min(u,i._getDaysInMonth(t,r));break}p=s.exec(n)}return new Date(t,r,u)},k=(e==null||e===""?d:(typeof e==="string"?j(e):(typeof e==="number"?(isNaN(e)?d:f(e)):new Date(e.getTime()))));k=(k&&k.toString()==="Invalid Date"?d:k);var l=0,c=0,g=0,b=0;if(k){l=k.getHours(),c=k.getMinutes(),g=k.getSeconds(),b=k.getMilliseconds();k.setHours(0);k.setMinutes(0);k.setSeconds(0);k.setMilliseconds(0)}return this._daylightSavingAdjustWidthTime(k,[l,c,g])},_daylightSavingAdjust:function(a){if(!a){return null}a.setHours(a.getHours()>12?a.getHours()+2:0);return a},_setDate:function(e,g){var h=!e,a=this.options,f=a.selectedMonth,c=a.selectedYear,j=this._restrictMinMax(this._determineDate(e,new Date()));var b=a.dateFormat;a.selectedDay=a.currentDay=j.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=j.getMonth();a.drawYear=a.selectedYear=a.currentYear=j.getFullYear();a.currentHur=j.getHours();a.currentMiu=j.getMinutes();a.currentSed=j.getSeconds();if((f!==a.selectedMonth||c!==a.selectedYear)&&!g){this._notifyChange()}this._adjustInstDate();if(a.input){if(h){this._processDefaultDate(this,"");this._setHiddenInputValue()
}else{if(a.complete){a.input.val(this._formatDate())}else{var i=this.getFormatter(a.value,a.dateFormat,this._getFormatConfig());var d=this.completeFormate(i,b);d=this.formatDate(d,e,this._getFormatConfig());a.input.val(d)}}}},_getDate:function(){var b=this.options,a=(!b.currentYear||(b.input&&b.input.val()==="")?null:this._daylightSavingAdjustWidthTime(new Date(b.currentYear,b.currentMonth,b.currentDay),[b.currentHur,b.currentMiu,b.currentSed]));return a},_daylightSavingAdjustWidthTime:function(c,a){var b=this._daylightSavingAdjust(c);if(b){b.setHours(a[0]);b.setMinutes(a[1]);b.setSeconds(a[2]);b.setMilliseconds(0)}return c},_attachHandlers:function(){var e=this,d=this.options;var c=d.stepMonths,f="#"+d.id.replace(/\\\\/g,"\\");var a=this._isYearMonthMode(d.dateFormat);var b=this._isYearMode(d.dateFormat);d.dpDiv.find("[data-handler]").map(function(){var g={prev:function(){if(a===true){e._adjustDate(f,-1,"Y")}else{if(b===true){e._adjustDate(f,-12,"Y")}else{e._adjustDate(f,-c,"M")}}return false},next:function(){if(a===true){e._adjustDate(f,+1,"Y")}else{if(b===true){e._adjustDate(f,+12,"Y")}else{e._adjustDate(f,+c,"M")}}return false},hide:function(){e.hide()},today:function(){e._gotoToday(f);return false},selectDay:function(){e._selectDay(f,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonthAndHide:function(){e._selectMonthYear(f,this,"M",true);e.hide();return false},selectYearAndHide:function(){e._selectMonthYear(f,this,"Y",true);e.hide();return false},selectMonth:function(){e._selectMonthYear(f,this,"M");return false},selectYear:function(){e._selectMonthYear(f,this,"Y");return false},focusTime:function(){if($(this).prop("readonly")){return false}e.focusInput=this.id;if(this.id=="dpTimeHour"){d.dpDiv.find(".coral-datepicer-timePanel").hide();d.dpDiv.find(".hourMenu").show()}if(this.id=="dpTimeMinute"){var i=$("#dpTimeHour").val();d.dpDiv.find(".coral-datepicer-timePanel").hide();d.dpDiv.find(".minuteMenu").replaceWith(e._modifiedMin(i));
d.dpDiv.find(".minuteMenu").show()}if(this.id=="dpTimeSecond"){var i=$("#dpTimeHour").val();var h=$("#dpTimeMinute").val();d.dpDiv.find(".secondMenu").replaceWith(e._modifiedSed(i,h));d.dpDiv.find(".coral-datepicer-timePanel").hide();d.dpDiv.find(".secondMenu").show()}return false}};$(this).bind(this.getAttribute("data-event"),g[this.getAttribute("data-handler")]);$(d.dpDiv).off(".hourMenu").on("mousedown.hourMenu",".hourMenu",function(h){if(!$(h.target).hasClass("menuTimeSel")){return false}d.dpDiv.find("#dpTimeHour").spinner("setValue",$(h.target).html());d.dpDiv.find(".menuSel").hide();e._autoFixInput(e);e._selectTime();d.dpDiv.find("#coral-timePanel").show();return false});$(d.dpDiv).off(".minuteMenu").on("mousedown.minuteMenu",".minuteMenu",function(h){if(!$(h.target).hasClass("menuTimeSel")){return false}d.dpDiv.find("#dpTimeMinute").spinner("setValue",$(h.target).html());d.dpDiv.find(".menuSel").hide();e._autoFixInput(e);e._selectTime();d.dpDiv.find("#coral-timePanel").show();return false});$(d.dpDiv).off(".secondMenu").on("mousedown.secondMenu",".secondMenu",function(h){if(!$(h.target).hasClass("menuTimeSel")){return false}d.dpDiv.find("#dpTimeSecond").spinner("setValue",$(h.target).html());d.dpDiv.find(".menuSel").hide();e._autoFixInput(e);e._selectTime();d.dpDiv.find("#coral-timePanel").show();return false})})},_generateHTML:function(){var O=this.options,x,w,T,I,g,ac,W,N,af,F,ai,o,q,p,c,ab,l,A,ae,b,R,aj,z,E,n,h,U,L,Q,M,k,C,r,X,aa,f,ad,d,K,s,Z=new Date(),y=this._daylightSavingAdjustWidthTime(new Date(Z.getFullYear(),Z.getMonth(),Z.getDate()),[0,0,0]),ag=O.isRTL,H=this._isYearMonthMode(O.dateFormat),Y=this._isYearMode(O.dateFormat),ah=H==true||Y==true?false:O.showButtonPanel,S=O.hideIfNoPrevNext,D=O.navigationAsDateFormat,t=this._getNumberOfMonths(),j=O.showCurrentAtPos,G=O.stepMonths,B=(t[0]!==1||t[1]!==1),e=this._daylightSavingAdjustWidthTime((!O.currentDay?new Date(9999,9,9):new Date(O.currentYear,O.currentMonth,O.currentDay)),[0,0,0]),i=this._getMinMaxDate("min"),v=this._getMinMaxDate("max"),a=O.drawMonth-j,V=O.drawYear,J=O.dateFormat,u="";
var P=this._hasTime(O.dateFormat);if(a<0){a+=12;V--}if(v){x=this._daylightSavingAdjustWidthTime(new Date(v.getFullYear(),v.getMonth()-(t[0]*t[1])+1,v.getDate()),[O.currentHur,O.currentMiu,O.currentSed]);x=(i&&x<i?i:x);while(this._daylightSavingAdjustWidthTime(new Date(V,a,1),[O.currentHur,O.currentMiu,O.currentSed])>x){a--;if(a<0){a=11;V--}}}O.drawMonth=a;O.drawYear=V;w=O.prevText;w=(!D?w:this.formatDate(w,this._daylightSavingAdjustWidthTime(new Date(V,a-G,1),[O.currentHur,O.currentMiu,O.currentSed]),this._getFormatConfig()));T=(this._canAdjustMonth(-1,V,a)?"<a class='coral-datepicker-prev coral-state-default coral-corner-all' data-handler='prev' data-event='mousedown' title='"+w+"'><span class='icon  cui-icon-arrow-"+(ag?"right3":"left3")+"'></span></a>":(S?"":"<a class='coral-datepicker-prev coral-state-default coral-corner-all coral-state-disabled' title='"+w+"'><span class='coral-icon coral-icon-circle-triangle-"+(ag?"e":"w")+"'>"+w+"</span></a>"));I=O.nextText;I=(!D?I:this.formatDate(I,this._daylightSavingAdjustWidthTime(new Date(V,a+G,1),[O.currentHur,O.currentMiu,O.currentSed]),this._getFormatConfig()));g=(this._canAdjustMonth(+1,V,a)?"<a class='coral-datepicker-next coral-state-default coral-corner-all' data-handler='next' data-event='mousedown' title='"+I+"'><span class='cui-icon-arrow-"+(ag?"left3":"right3")+"'></span></a>":(S?"":"<a class='coral-datepicker-next coral-state-default coral-corner-all coral-state-disabled' title='"+I+"'><span class='coral-icon coral-icon-circle-triangle-"+(ag?"w":"e")+"'>"+I+"</span></a>"));ac=O.currentText;W=(O.gotoCurrent&&O.currentDay?e:y);ac=(!D?ac:this.formatDate(ac,W,this._getFormatConfig()));N="";af=(ah)?"<div class='coral-datepicker-buttonpane coral-component-content' "+(H||Y?"style='display:none'":"")+">"+(ag?N:"")+(this._isInRange(W)?"<button type='button' class='coral-datepicker-current coral-state-default coral-priority-primary coral-corner-all' data-handler='today' data-event='mousedown'>"+ac+"</button>":"")+(ag?"":N)+"</div>":"";
var m="";!P||(m+='<button class="coral-datepicker-close coral-state-default coral-priority-secondary coral-corner-all" id="dpTimeEnsure">确定</button>');m+=(ah)?"<button type='button' class='coral-datepicker-current coral-state-default coral-priority-primary coral-corner-all' data-handler='today' data-event='mousedown'>"+ac+"</button>":"";F=parseInt(O.firstDay,10);F=(isNaN(F)?0:F);ai=O.showWeek;o=O.dayNames;q=O.dayNamesMin;p=O.monthNames;c=O.monthNamesShort;ab=O.beforeShowDay;l=O.showOtherMonths;A=O.selectOtherMonths;b=this._getDefaultDate();ae=new Date(b.getFullYear(),b.getMonth(),b.getDate());R="";aj;if(O.model=="datepicker"){u="collapse in"}for(z=0;z<t[0];z++){E="";this.maxRows=4;for(n=0;n<t[1];n++){h=this._daylightSavingAdjustWidthTime(new Date(V,a,O.selectedDay),[O.currentHur,O.currentMiu,O.currentSed]);U=" coral-corner-all";L="";if(B){L+="<div class='coral-datepicker-group";if(t[1]>1){switch(n){case 0:L+=" coral-datepicker-group-first";U=" coral-corner-"+(ag?"right":"left");break;case t[1]-1:L+=" coral-datepicker-group-last";U=" coral-corner-"+(ag?"left":"right");break;default:L+=" coral-datepicker-group-middle";U="";break}}L+="'>"}L+="<div id='datepicker' class='coral-datepickerPanel "+u+"'><div class='coral-datepicker-header coral-helper-clearfix"+U+"'>"+(/all|left/.test(U)&&z===0?(ag?g:T):"")+(/all|right/.test(U)&&z===0?(ag?T:g):"")+this._generateMonthYearHeader(a,V,i,v,z>0||n>0,p,c,H)+"</div>";if(H===true){L+=this._generateMonthHTML(a,V,i,v,z>0||n>0,p,c,e,y)}if(Y==true){L+=this._generateYearHTML(V,i,v,z>0||n>0,e,y)}L+="<table class='coral-datepicker-calendar' "+(H||Y?"style='display:none'":"")+"><thead><tr>";Q=(ai?"<th class='coral-datepicker-week-col'>"+O.weekHeader+"</th>":"");for(aj=0;aj<7;aj++){M=(aj+F)%7;Q+="<th scope='col'"+((aj+F+6)%7>=5?" class='coral-datepicker-week-end'":"")+"><span title='"+o[M]+"'>"+q[M]+"</span></th>"}L+=Q+"</tr></thead><tbody>";k=this._getDaysInMonth(V,a);if(V===O.selectedYear&&a===O.selectedMonth){O.selectedDay=Math.min(O.selectedDay,k)
}C=(this._getFirstDayOfMonth(V,a)-F+7)%7;r=Math.ceil((C+k)/7);X=(B?this.maxRows>r?this.maxRows:r:r);this.maxRows=X;aa=this._daylightSavingAdjustWidthTime(new Date(V,a,1-C),[0,0,0]);for(f=0;f<X;f++){L+="<tr>";ad=(!ai?"":"<td class='coral-datepicker-week-col'>"+O.calculateWeek(aa)+"</td>");for(aj=0;aj<7;aj++){d=(ab?ab.apply((O.input?O.input[0]:null),[aa]):[true,""]);K=(aa.getMonth()!==a);s=(K&&!A)||!d[0]||(i&&aa<=new Date(i.getFullYear(),i.getMonth(),i.getDate()-1))||(v&&aa>v);ad+="<td class='"+((aj+F+6)%7>=5?" coral-datepicker-week-end":"")+(K?" coral-datepicker-other-month":"")+((aa.getTime()===h.getTime()&&a===O.selectedMonth&&O._keyEvent)||(ae.getTime()===aa.getTime()&&ae.getTime()===h.getTime())?" "+this._dayOverClass:"")+(s?" "+this._unselectableClass+" coral-state-disabled":"")+(K&&!l?"":" "+d[1]+(aa.getTime()===e.getTime()?" "+this._currentClass:"")+(aa.getTime()===y.getTime()?" coral-datepicker-today":""))+"'"+((!K||l)&&d[2]?" title='"+d[2].replace(/'/g,"&#39;")+"'":"")+(s?"":" data-handler='selectDay' data-event='mousedown' data-month='"+aa.getMonth()+"' data-year='"+aa.getFullYear()+"'")+">"+(K&&!l?"&#xa0;":(s?"<span class='coral-state-default'>"+aa.getDate()+"</span>":"<a class='coral-state-default"+(aa.getTime()===y.getTime()?" coral-state-highlight":"")+(aa.getTime()===e.getTime()?" coral-state-active":"")+(K?" coral-priority-secondary":"")+"' href='javascript:void(0);'>"+aa.getDate()+"</a>"))+"</td>";aa.setDate(aa.getDate()+1);aa=this._daylightSavingAdjustWidthTime(aa,[0,0,0])}L+=ad+"</tr>"}a++;if(a>11){a=0;V++}if(P){L+="</tbody></table></div><div class='picker-switch accordion-toggle'><a class='coral-datepicker-today time-btn' data-handler='today' data-event='mousedown'>今天</a>";L+="<a id='timePanel' class='date-time-icon time-btn'><span class='cui-icon-clock'/></a><a class='datepicker-close time-btn' data-handler='close' data-event='mousedown'>关闭</a></div>"}E+=L}R+=E}O._keyEvent=false;return R},_generateMonthHTML:function(c,m,e,k,n,g,a,f,q){var h="<table class='coral-datepicker-calendar' ><tbody>";
var l=this.options;var s=0;var t="";var d="";var r=(e&&e.getFullYear()===m);var b=(k&&k.getFullYear()===m);for(var p=0;p<3;p++){h+="<tr>";for(var o=0;o<4;o++){if(s===q.getMonth()&&m===q.getFullYear()){t="coral-state-highlight"}else{t=""}if(s===c){d="coral-state-active"}else{d=""}if((!r||s>=e.getMonth())&&(!b||s<=k.getMonth())){h+="<td data-handler='selectMonthAndHide' data-event='mousedown' data-month='"+s+"'><a class='coral-state-default date-month "+t+" "+d+"' href='javascript:void(0);'>"+g[s++]+"</a></td>"}else{h+="<td class='"+this._unselectableClass+" coral-state-disabled'><span class='date-month' >"+g[s++]+"</span></td>"}}h+="</tr>"}return h+"</tbody></table>"},_timeDateInitValue:function(){var g=this.options,p,k,m,a,q=[],h,c,i,l,e,o=new Date();if(g.model=="timepicker"){p=g.currentHur?g.currentHur:o.getHours(),k=g.currentMiu?g.currentMiu:o.getMinutes(),m=g.currentSed?g.currentSed:o.getSeconds();q.push(o.getFullYear(),o.getMonth(),o.getDate());var d=g.minTime?q.join("-")+" "+g.minTime:null,f=g.maxTime?q.join("-")+" "+g.maxTime:null;a=new Date(o.getFullYear(),o.getMonth(),o.getDate(),p,k,m);e=new Date(o.getFullYear(),o.getMonth(),o.getDate());i=l=e}else{var b=this._hasTime(g.dateFormat),r=this._hasHur(g.dateFormat),j=this._hasMin(g.dateFormat),n=this._hasSec(g.dateFormat);var d=g.minDate,f=g.maxDate;p=r?(g.currentHur||o.getHours()):"00";k=j?(g.currentMiu||o.getMinutes()):"00";m=n?(g.currentSed||o.getSeconds()):"00";a=new Date(g.selectedYear,g.selectedMonth,g.selectedDay,p,k,m);e=new Date(g.selectedYear,g.selectedMonth,g.selectedDay);if(d&&d!=""){h=new Date(d.replace(/-/g,"/"));i=new Date(h.getFullYear(),h.getMonth(),h.getDate())}if(f&&f!=""){c=new Date(f.replace(/-/g,"/"));l=new Date(c.getFullYear(),c.getMonth(),c.getDate())}}if(this._checkDateRange(a)===1){a=new Date(f.replace(/-/g,"/"));p=a.getHours();k=a.getMinutes();m=a.getSeconds()}else{if(this._checkDateRange(a)===2){a=new Date(d.replace(/-/g,"/"));p=a.getHours();k=a.getMinutes();m=a.getSeconds()}}return{hur:p,min:k,sed:m,minDate:d,maxDate:f,minDay:h,maxDay:c,compMin:i,compMax:l,compDate:e}
},_generateTimePanel:function(){var a=this.options,f,d=a.dateFormat;var b=[],g="",e,i,k,m,j;if(this.options.model=="datepicker"){g="collapse"}e=this._timeDateInitValue();var h=e.minDate,c=e.maxDate,l=e.compDate,k=e.compMin,m=e.compMax;b.push("<div id='timepicker' class='coral-timepickerPanel "+g+"'>");b.push("<table id='coral-timePanel' class='coral-datepicer-timePanel'><tr><td><input data-handler='focusTime' data-event='click' id='dpTimeHour' name='timeHourVal' value='"+e.hur+"' maxlength='2'/></td>");b.push("<td class='separator'>:</td><td><input id='dpTimeMinute' name='timeMinVal' data-handler='focusTime' data-event='click' value='"+e.min+"' maxlength='2'/></td>");if(a.model=="datepicker"&&a.dateFormat.indexOf("s")>-1||a.model=="timepicker"&&a.timeFormat.indexOf("s")>-1){f=""}else{f="display:none"}b.push("<td class='separator' style="+f+">:</td><td id='secondTd' style="+f+"><input id='dpTimeSecond' name='timeSecVal'data-handler='focusTime' data-event='click' value='"+e.sed+"' maxlength='2'/></td>");b.push("</tr></table>");b.push(this._timeHourPanel(h,c,l,k,m,false));b.push(this._timeMinPanel(h,c,l,k,m,false));b.push(this._timeSedPanel(h,c,l,k,m,false));b.push("</div>");return b.join("")},_generateYearHTML:function(f,k,b,p,c,o){var a=this.options;var m="<table class='coral-datepicker-calendar' ><tbody>";var d="";var g="";var n=f-(f%12);var e=(k&&k.getFullYear()===f);var q=(b&&b.getFullYear()===f);for(var l=0;l<3;l++){m+="<tr>";for(var h=0;h<4;h++){d="";if(n==a.currentYear){g="coral-state-active"}else{g=""}if((!e||n>=k.getFullYear())&&(!q||n<=b.getFullYear())){m+="<td data-handler='selectYearAndHide' data-event='mousedown' data-year='"+n+"'><a class='coral-state-default date-year  "+g+"' href='javascript:void(0);'>"+n+++"</a></td>"}else{m+="<td class='"+this._unselectableClass+" coral-state-disabled'><span class='date-year' >"+n+++"</span></td>"}}m+="</tr>"}return m+"</tbody></table>"},_timeHourPanel:function(e,a,m,h,n,b){var g=[],l="";if(b){l="hourPanel"}g.push("<div class='menuSel hourMenu '"+l+" style='display: none;'>");
g.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");var c=0;for(var f=0;f<6;f++){g.push("<tr nowrap='nowrap'></tr>");for(var d=0;d<4;d++){if((e&&c<new Date(e).getHours()&&new Date(m).getTime()==new Date(h).getTime())||(a&&c>new Date(a).getHours()&&new Date(m).getTime()==new Date(n).getTime())){g.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickHour' data-event='click' >"+((c++)/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}else{g.push("<td nowrap='' class='menuTimeSel' data-handler='clickHour' data-event='click' >"+((c++)/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}}g.push("</tr>")}g.push("</tbody></table></div>");return g.join("")},_timeMinPanel:function(e,a,m,h,n,b){var g=[],l="";if(b){l="minPanel"}g.push("<div class='menuSel minuteMenu '"+l+" style='display: none;'>");g.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");var c=0;for(var f=0;f<3;f++){g.push("<tr nowrap='nowrap'></tr>");for(var d=0;d<4;d++){if((e&&c<new Date(e).getMinutes()&&new Date(m).getTime()==new Date(h).getTime())||(a&&c>new Date(a).getMinutes()&&new Date(m).getTime()==new Date(n).getTime())){g.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickMinute' data-event='click'>"+c+"</td>")}else{g.push("<td nowrap='' class='menuTimeSel' data-handler='clickMinute' data-event='click' >"+c+"</td>")}c+=5}g.push("</tr>")}g.push("</tbody></table></div>");return g.join("")},_timeSedPanel:function(f,a,m,l,n,b){var h=[],c,e="";if(b){e="sedPanel"}h.push("<div class='menuSel secondMenu '"+e+" style='display: none;'>");h.push("<table cellspacing='0' cellpadding='3' border='0' nowrap='nowrap'><tbody>");c=0;for(var g=0;g<4;g++){h.push("<tr nowrap='nowrap'></tr>");for(var d=0;d<3;d++){if((f&&c<new Date(f).getSeconds()&&new Date(m).getTime()==new Date(l).getTime())||(a&&c>new Date(a).getSeconds()&&new Date(m).getTime()==new Date(n).getTime())){h.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickSecond' data-event='click'>"+(c/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")
}else{h.push("<td nowrap='' class='menuTimeSel' data-handler='clickSecond' data-event='click' >"+(c/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}c+=5}h.push("</tr>")}h.push("</tbody></table></div>");return h.join("")},_modifiedMin:function(q){var a=this.options,o=[],g,m,p,f=a.minDate,b=a.maxDate,n,r;if(a.model=="timepicker"){var c=new Date();o.push(c.getFullYear(),c.getMonth(),c.getDate());f=a.minTime?o.join("-")+" "+a.minTime:null,b=a.maxTime?o.join("-")+" "+a.maxTime:null;p=new Date(c.getFullYear(),c.getMonth(),c.getDate());n=r=p}else{p=new Date(a.selectedYear,a.selectedMonth,a.selectedDay),g=new Date(f),m=new Date(b);n=new Date(g.getFullYear(),g.getMonth(),g.getDate()),r=new Date(m.getFullYear(),m.getMonth(),m.getDate())}var l=[];l.push("<div class='menuSel minuteMenu' style='display: none;'>");l.push("<table cellspacing='0' cellpadding='3' border='0<tr' nowrap='nowrap'><tbody>");var d=0;for(var h=0;h<3;h++){l.push("<tr nowrap='nowrap'></tr>");for(var e=0;e<4;e++){if((f&&d<new Date(f).getMinutes()&&new Date(p).getTime()==new Date(n).getTime()&&q==new Date(f).getHours())||(b&&d>new Date(b).getMinutes()&&new Date(p).getTime()==new Date(r).getTime()&&q==new Date(b).getHours())){l.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickMinute' data-event='click'>"+(d/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}else{l.push("<td nowrap='' class='menuTimeSel' data-handler='clickMinute' data-event='click' >"+(d/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}d+=5}l.push("</tr>")}l.push("</tbody></table></div>");return l.join("")},_modifiedSed:function(p,o){var a=this.options;var e=a.minDate;var b=a.maxDate;var n=new Date(a.selectedYear,a.selectedMonth,a.selectedDay),f=new Date(e),l=new Date(b),m=new Date(f.getFullYear(),f.getMonth(),f.getDate()),q=new Date(l.getFullYear(),l.getMonth(),l.getDate());var h=[];h.push("<div class='menuSel secondMenu' style='display: none;'>");h.push("<table cellspacing='0' cellpadding='3' border='0<tr' nowrap='nowrap'><tbody>");
var c=0;for(var g=0;g<3;g++){h.push("<tr nowrap='nowrap'></tr>");for(var d=0;d<4;d++){if((e&&c<new Date(e).getSeconds()&&new Date(n).getTime()==new Date(m).getTime()&&p==new Date(e).getHours()&&o==new Date(e).getMinutes())||(b&&c>new Date(b).getSeconds()&&new Date(n).getTime()==new Date(q).getTime()&&p==new Date(b).getHours()&&o==new Date(b).getMinutes())){h.push("<td nowrap='' class='menuTimeSel coral-state-disabled' data-handler='clickSecond' data-event='click'>"+(c/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}else{h.push("<td nowrap='' class='menuTimeSel' data-handler='clickSecond' data-event='click' >"+(c/Math.pow(10,2)).toFixed(2).substr(2)+"</td>")}c+=5}h.push("</tr>")}h.push("</tbody></table></div>");return h.join("")},_generateMonthYearHeader:function(c,o,f,k,p,i,a,h){var u,b,v,s,e,q,l,g,n=this.options,d=n.changeMonth,w=n.changeYear,x=n.showMonthAfterYear,j="<div class='coral-datepicker-title'>",t="",m=n.monthSuffix,r=n.dateFormat;if(!this._isYearMonthMode(r)&&!this._isYearMode(r)){if(p||!d){t+="<span class='coral-datepicker-month'>"+i[c]+"</span>"}else{u=(f&&f.getFullYear()===o);b=(k&&k.getFullYear()===o);t+="<select class='coral-datepicker-month' data-handler='selectMonth' data-event='change'>";for(v=0;v<12;v++){if((!u||v>=f.getMonth())&&(!b||v<=k.getMonth())){t+="<option value='"+v+"'"+(v===c?" selected='selected'":"")+">"+a[v]+"</option>"}}t+="</select>";t+=m}if(!x){j+=t+(p||!(d&&w)?"&#xa0;":"")}}if(!n.yearshtml){n.yearshtml="";if(p||!w){j+="<span class='coral-datepicker-year'>"+o+"</span>"}else{s=n.yearRange.split(":");e=new Date().getFullYear();q=function(z){var y=(z.match(/c[+\-].*/)?o+parseInt(z.substring(1),10):(z.match(/[+\-].*/)?e+parseInt(z,10):parseInt(z,10)));return(isNaN(y)?e:y)};l=q(s[0]);g=Math.max(l,q(s[1]||""));l=(f?Math.max(l,f.getFullYear()):l);g=(k?Math.min(g,k.getFullYear()):g);if(this._isYearMode(r)){var l=o-(o%12);n.yearshtml+="<span class = 'coral-datepicker-year'>"+l+"-"+(l+11)+"</span>"}else{n.yearshtml+="<select class='coral-datepicker-year' data-handler='selectYear' data-event='change'>";
for(;l<=g;l++){n.yearshtml+="<option value='"+l+"'"+(l===o?" selected='selected'":"")+">"+l+"</option>"}n.yearshtml+="</select>"}j+=n.yearshtml;n.yearshtml=null}}j+=n.yearSuffix;if(x){j+=(p||!(d&&w)?"&#xa0;":"")+(h===false?t:"")}j+="</div>";return j},_adjustInstDate:function(g,f){var d=this.options;var c=d.drawYear+(f==="Y"?g:0),e=d.drawMonth+(f==="M"?g:0),a=Math.min(d.selectedDay,this._getDaysInMonth(c,e))+(f==="D"?g:0),b=this._restrictMinMax(this._daylightSavingAdjustWidthTime(new Date(c,e,a),[d.currentHur,d.currentMiu,d.currentSed]));d.selectedDay=b.getDate();d.drawMonth=d.selectedMonth=b.getMonth();d.drawYear=d.selectedYear=b.getFullYear();if(f==="M"||f==="Y"){this._notifyChange()}},_restrictMinMax:function(b){var c=this.options;var d=this._getMinMaxDate("min"),e=this._getMinMaxDate("max"),a=(d&&b<d?d:b);return(e&&a>e?e:a)},_notifyChange:function(){var b=this.options,a=b.onChangeMonthYear;if(a){a.apply((b.input?b.input[0]:null),[b.selectedYear,b.selectedMonth+1,b])}},_getNumberOfMonths:function(){var b=this.options;var a=b.numberOfMonths;return(a==null?[1,1]:(typeof a==="number"?[1,a]:a))},_getMinMaxDate:function(b){var c=this.options,a,d;if(c.model=="timepicker"){a=b+"Time"}else{a=b+"Date"}return this._determineDate(c[a],null)},_getDaysInMonth:function(a,c){var b=this.options;if(b){return 32-this._daylightSavingAdjustWidthTime(new Date(a,c,32),[b.currentHur,b.currentMiu,b.currentSed]).getDate()}else{return 32-this._daylightSavingAdjustWidthTime(new Date(a,c,32),[0,0,0]).getDate()}},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(f,c,e){var d=this.options,a=this._getNumberOfMonths(),b=this._daylightSavingAdjustWidthTime(new Date(c,e+(f<0?f:a[0]*a[1]),1),[d.currentHur,d.currentMiu,d.currentSed]);if(f<0){b.setDate(this._getDaysInMonth(b.getFullYear(),b.getMonth()))}return this._isInRange(b)},_isInRange:function(d){var a=this.options,c,h,e=this._getMinMaxDate("min"),b=this._getMinMaxDate("max"),i=null,f=null,g=a.yearRange;
if(g){c=g.split(":");h=new Date().getFullYear();i=parseInt(c[0],10);f=parseInt(c[1],10);if(c[0].match(/[+\-].*/)){i+=h}if(c[1].match(/[+\-].*/)){f+=h}}return((!e||d.getTime()>=e.getTime())&&(!b||d.getTime()<=b.getTime())&&(!i||d.getFullYear()>=i)&&(!f||d.getFullYear()<=f))},_getFormatConfig:function(){var a=this.options;var b=a.shortYearCutoff;b=(typeof b!=="string"?b:new Date().getFullYear()%100+parseInt(b,10));return{shortYearCutoff:b,dayNamesShort:a.dayNamesShort,dayNames:a.dayNames,monthNamesShort:a.monthNamesShort,monthNames:a.monthNames,calculateWeek:a.calculateWeek,opts:a}},_formatDate:function(a,e,c){var d=this.options;if(!a){d.currentDay=d.selectedDay;d.currentMonth=d.selectedMonth;d.currentYear=d.selectedYear}var b=(a?(typeof a==="object"?a:this._daylightSavingAdjustWidthTime(new Date(c,e,a),[d.currentHur,d.currentMiu,d.currentSed])):this._daylightSavingAdjustWidthTime(new Date(d.currentYear,d.currentMonth,d.currentDay),[d.currentHur,d.currentMiu,d.currentSed]));b.setHours(d.currentHur);b.setMinutes(d.currentMiu);b.setSeconds(d.currentSed);b.setMilliseconds(0);return this.formatDate(d.dateFormat,b,this._getFormatConfig())},_apply:function(b,a,d){var c=this.options;var e=c.type;if(e){if(typeof e==="string"){return window[e].apply((c.input?c.input[0]:null),[d].concat(a))}else{if($.isFunction(e)){return e.apply((c.input?c.input[0]:null),[d].concat(a))}}}}});

/*!
 * 组件库4.0：下拉框
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$.component("coral.checkbox",$.coral.formelement,{version:"4.0.1",castProperties:["triggers"],options:{showStar:true,id:null,name:null,value:"",label:"",maxLabelWidth:"auto",labelField:null,starBefore:false,title:"",width:"auto",height:null,disabled:false,required:false,readonly:false,checked:false,errMsg:null,errMsgPosition:"leftBottom",onValidError:null,onKeyDown:null,onValidSuccess:null,onChange:$.noop,triggers:null,excluded:false},_create:function(){var d=this,c=this.options,e=c.maxLabelWidth,b=c.label;d.originalValue="";if(!d.element.jquery){d.element=$(d.element)}d.element.addClass("coral-form-element-checkbox tabbable");d.element.addClass("coral-validation-checkbox");typeof d.element.attr("id")=="undefined"&&!!d.options.id&&d.element.attr("id",d.options.id);d.options.id=d.element.uniqueId().attr("id");var a=d.element.attr("name");typeof a!="undefined"?(d.options.name=a):(d.element.attr("name",d.options.name));if($.trim(d.element.val())!=""&&$.trim(d.element.val())!="on"){d.options.value=d.element.val()}else{if(d.options.value){d.element.val(d.options.value)}}if(d.options.name){d.nameMark="coral-checkbox-element-"+d._hashCode(d.options.name);d.element.addClass(d.nameMark)}d.uiCheckbox=$('<span class="coral-checkbox"></span>');d.uiLabel=$('<label class="coral-checkbox-label" for=\''+d.options.id+"'></label>");d.uiIcon=$('<span class="coral-checkbox-icon"></span>');if(e=="auto"){d.uiText=$('<span class="coral-checkbox-text"></span>')}else{d.uiText=$("<span class='coral-checkbox-text'  title='"+b+"' style='max-width:"+e+"px;'></span>")}d.uiLabel.append(d.uiIcon);d.uiLabel.append(this.uiText);if(d.options.label){d.uiText.append(d.options.label)}if(d.options.title){d.uiLabel.attr("title",d.options.title)}if(d.options.checked){d.uiIcon.addClass("cui-icon-checkbox-checked coral-checkbox-hightlight");d.element.prop("checked",true)}else{d.uiIcon.addClass("cui-icon-checkbox-unchecked");
d.element.prop("checked",false)}d.element.after(d.uiCheckbox);d.uiCheckbox.append(d.element).append(d.uiLabel);if(c.labelField){this.uiLabelField=$('<label class="coral-label">'+c.labelField+"</label>");this.uiCheckbox.prepend(this.uiLabelField);this.uiCheckbox.addClass("coral-hasLabel")}if((d.element)[0].checked===true){d.originalValue=d.options.value}d._bindEvent();d._trigger("onCreate",null,[])},reset:function(){if(this.originalValue===""){this.uncheck()}else{this.check()}},_getCheckboxs:function(){var b=this,a=b.element.closest("form");if(!b.nameMark){return b.element}if(a.length>0){return a.find($("."+b.nameMark))}else{return $("."+b.nameMark)}},_setDisabled:function(a){if(a){this.element.prop("disabled",true);this.uiCheckbox.addClass("coral-state-disabled")}else{this.element.prop("disabled",false);this.uiCheckbox.removeClass("coral-state-disabled")}this.options.disabled=(a?true:false)},_setReadonly:function(a){if(a){this.element.prop("readonly",true);this.uiCheckbox.addClass("coral-readonly")}else{this.element.prop("readonly",false);this.uiCheckbox.removeClass("coral-readonly")}this.options.readonly=!!a},focus:function(){var a=this;if(this.options.disabled||this.options.readonly){return false}this.element.focus();return true},_bindEvent:function(){var a=this;if(this.options.disabled){this._setDisabled(this.options.disabled)}this.element.bind("change",function(b){if($(this).prop("checked")){a.uiIcon.removeClass("cui-icon-checkbox-unchecked ").addClass("cui-icon-checkbox-checked coral-checkbox-hightlight")}else{a.uiIcon.removeClass("cui-icon-checkbox-checked coral-checkbox-hightlight").addClass("cui-icon-checkbox-unchecked")}a._trigger("onChange",b,[{checked:!!a.element.prop("checked")}])}).bind("focus",function(b){a.uiCheckbox.addClass("coral-checkbox-highlight")}).bind("blur",function(){a.uiCheckbox.removeClass("coral-checkbox-highlight")}).bind("keydown"+this.eventNamespace,function(b){a._trigger("onKeyDown",b,{})});this.uiCheckbox.bind("mouseenter"+this.eventNamespace,function(){if(a.options.disabled||a.uiCheckbox.hasClass("coral-checkbox-highlight")||a.uiCheckbox.hasClass("coral-checkbox-highlight")){return
}$(this).addClass("coral-checkbox-hover")}).bind("mouseleave"+this.eventNamespace,function(){if(a.options.disabled){return}$(this).removeClass("coral-checkbox-hover")});this.uiLabel.bind("click",function(b){if(a.options.readonly||a.options.isLabel){return false}a._trigger("onClick",b,{})})},_setOption:function(a,b){if(a==="id"||a==="name"){return}if(a==="readonly"){this._setReadonly(b)}if(a==="disabled"){this._setDisabled(b)}if(a==="label"){this.uiText.html(b)}if(a==="maxLabelWidth"){var c=b;if(b!="auto"){c=c+"px";this.uiText.attr("title",this.options.label)}else{c="";this.uiText.attr("title","")}this.uiText.css("max-width",c)}this._super(a,b)},_destroy:function(){this.uiCheckbox.replaceWith(this.element);this.uncheck();this.element.removeAttr("value");this.element.removeClass("coral-form-element-checkbox");this.element.removeClass("coral-validation-checkbox");this.element.removeClass(this.nameMark)},_hashCode:function(e){if(!e){return 0}e=""+e;var c=0,d=0,a=e.length;for(var b=0;b<a;b++){c=31*c+e.charCodeAt(d++);if(c>2147483647||c<2147483648){c=c&4294967295}}return c},component:function(){return this.uiCheckbox},disable:function(){this._setDisabled(true)},readonly:function(){this._setReadonly(true)},enable:function(){this._setDisabled(false)},show:function(){this.component().show()},hide:function(){this.component().hide()},check:function(){if(!this.uiIcon.hasClass("coral-checkbox-hightlight")){this.uiIcon.removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkbox-hightlight");this.element.prop("checked",true)}},uncheck:function(){if(this.uiIcon.hasClass("coral-checkbox-hightlight")){this.uiIcon.removeClass("cui-icon-checkbox-checked coral-checkbox-hightlight").addClass("cui-icon-checkbox-unchecked");this.element.prop("checked",false)}},isChecked:function(){return this.element.prop("checked")},getValue:function(){return this.getValues().join(",")},getValues:function(){var b=this,a=[];b._getCheckboxs().each(function(){var c=$(this);if(c.checkbox("isChecked")){a.push(c.val())
}});return a},refresh:function(){this._destroy();this._create()}});

/*!
 * 组件库4.0：复选框组
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 *    jquery.validatehelper.js
 */
$.component("coral.checkboxlist",$.coral.formelement,{version:"4.0.1",castProperties:["data","triggers"],options:{id:null,name:null,valueField:"value",textField:"text",required:false,showStar:true,maxLabelWidth:"auto",labelField:null,starBefore:false,column:null,disabled:false,readonly:false,value:"",data:null,url:null,termSplit:";",itemSplit:":",errMsg:null,errMsgPosition:"leftBottom",repeatLayout:"table",itemWidth:"auto",onValidError:null,onKeyDown:null,onValidSuccess:null,triggers:null,excluded:false,onChange:$.noop},_create:function(){var e=this,b=null,a=null,f=null,d=this.options;if(!this.element.jquery){this.element=$(this.element)}this.element.addClass("coral-form-element-checkboxlist  ctrl-init ctrl-form-element ctrl-init-checkboxlist coral-validation-checkboxlist");typeof e.element.attr("id")=="undefined"&&!!e.options.id&&e.element.attr("id",e.options.id);e.options.id=e.element.uniqueId().attr("id");var c=e.element.attr("name");typeof c!="undefined"?(e.options.name=c):(e.element.attr("name",e.options.name));this.uiBoxlist=$('<span class="coral-checkboxlist"></span>');this.uiInput=$('<input type="hidden">');if(this.options.name){this.uiInput.attr("name",this.options.name)}if(this.options.value){this.uiInput.val(this.options.value)}this._initData();this.uiInput.appendTo(this.uiBoxlist);if(d.labelField){this.uiLabel=$('<label class="coral-label">'+d.labelField+"</label>");this.uiBoxlist.prepend(this.uiLabel);this.uiBoxlist.addClass("coral-hasLabel")}this.uiBoxlist.insertAfter(this.element);this.element.hide();this._bindEvent()},reload:function(a){},_initData:function(){var b=this,a=this.options;if(this.options.url){if(this.xhr){this.xhr.abort()}this.xhr=$.ajax(this._ajaxSettings());this.xhr.success(function(c){b._loadData(c)}).complete(function(d,c){if(d===b.xhr){b.xhr=null}}).error(function(){$.alert("Json Format Error!")})}else{if(this.options.data){this._loadData(this.options.data)
}}},_ajaxSettings:function(){var b=this.options,a=this;return{type:"get",url:b.url,data:{},async:false,dataType:"json"}},_loadData:function(g){var b=null,f=[],h,c=0,d=null,a=null,e=null;if(typeof g==="string"){b=g.split(this.options.termSplit);g=[];for(;c<b.length;c++){a=b[c];e=a.split(this.options.itemSplit);d={};d[this.options.valueField]=e[0];d[this.options.textField]=e[1];g.push(d)}}this.data=g;for(c;c<g.length;c++){h=g[c];if(h.checked){f.push(h[this.options.valueField])}}if(this.options.value){f=this.options.value.split(",")}if(!this.isInit){this.isInit=true;this.originalValue=f.join(",")}this._renderChkItem();this.setValue(f)},_renderChkItem:function(){if(this.options.repeatLayout=="table"){if(this.options.column==null){this.options.column=3}this._renderTableItem();this.uiTable.appendTo(this.uiBoxlist)}else{if(this.options.repeatLayout=="flow"){if(this.options.column==null){this.options.column=this.data.length}this._renderBorderItem();this.uiBorder.appendTo(this.uiBoxlist)}}},reset:function(){this.setValue(this.originalValue)},_renderBorderItem:function(){var d=this,c=this.options,b=this.options.column,e=this.data;d.uiBorder=$('<span class="coral-checkboxlist-border"></span>');for(var a in e){if(a>(b-1)&&a%(b)==0){$("<br/>").appendTo(d.uiBorder)}d._renderItem(e[a]).css("width",c.itemWidth).appendTo(d.uiBorder)}},_renderTableItem:function(){this.uiTable=$("<table></table>");var d=0,c=0,g=this.data,b=g.length||0,e=this.options.column,f=0,h=null,a=null;if(!g||g.length<1){return}f=Math.ceil(b/e);for(;d<f;d++){h=$("<tr></tr>");for(c=0;c<e;c++){a=$("<td></td>");if((d*e+c)<b){this._renderItem(g[(d*e+c)]).appendTo(a)}a.appendTo(h)}h.appendTo(this.uiTable)}},_renderItem:function(d){var b=d.hidden==true?"hidden":"";var e=$("<span class='coral-checkbox tabbable "+b+"'tabindex=0></span>"),c=$("<span class='coral-checkbox-label'></span>"),g=$("<span class='coral-checkbox-icon'></span>"),a=this.options.maxLabelWidth,i=$(),f=d[this.options.valueField],h=d[this.options.textField];
if(a=="auto"){i=$('<span class="coral-checkbox-text"></span>')}else{i=$("<span class='coral-checkbox-text'  title='"+h+"' style='max-width:"+a+"px;'></span>")}e.attr("data-value",f);c.append(g).append(i);c.appendTo(e);g.addClass("cui-icon-checkbox-unchecked");i.append(h);return e},_bindEvent:function(){var a=this;if(this.options.disabled){this._setDisabled(this.options.disabled)}this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).bind("click"+a.eventNamespace,function(b){a._selectItems(b);b.stopPropagation()})});this._on({"keydown .coral-checkbox":function(c){var b=$.coral.keyCode;switch(c.keyCode){case b.SPACE:c.preventDefault();a._selectItems(c);break}a._trigger("onKeyDown",c,{})},"mouseenter .coral-checkbox":function(b){var c=$(b.target).closest(".coral-checkbox");if(c.hasClass("coral-state-disabled")){return}c.addClass("coral-checkbox-hover")},"mouseleave .coral-checkbox":function(b){var c=$(b.target).closest(".coral-checkbox");if(c.hasClass("coral-state-disabled")){return}c.removeClass("coral-checkbox-hover")}});this.uiBoxlist.find(".coral-checkbox-label").each(function(){$(this).bind("click"+a.eventNamespace,function(b){if(a.options.readonly){return false}})})},_selectItems:function(d){var c=this;if(c.options.disabled){return}var f=$(d.target).closest(".coral-checkbox"),a=f.find(".coral-checkbox-icon");if(f.hasClass("coral-state-disabled")){event.stopPropagation();return}if(a.hasClass("coral-checkboxlist-item-highlight")){a.removeClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight").addClass("cui-icon-checkbox-unchecked")}else{a.removeClass("cui-icon-checkbox-unchecked").addClass("coral-checkboxlist-item-highlight cui-icon-checkbox-checked")}var b=c.getValue();c._changeValue();c._trigger("onChange",null,{value:c.uiInput.val(),oldValue:b,checked:a.hasClass("coral-checkboxlist-item-highlight")})},_changeValue:function(){var b=this,a=[];this.uiBoxlist.find(".coral-checkbox").each(function(){if($(this).find(".coral-checkbox-icon").hasClass("coral-checkboxlist-item-highlight")){a.push($(this).attr("data-value"))
}});this.uiInput.val(a.toString())},_setDisabled:function(a){a=!!a;this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).toggleClass("coral-state-disabled",a)});this.options.disabled=a},_setReadonly:function(a){a=!!a;this.uiBoxlist.find(".coral-checkbox").each(function(){$(this).toggleClass("coral-readonly",a)});this.options.readonly=a},_setOption:function(b,c){if(b==="id"||b==="name"){return}if(b==="readonly"){this._setReadonly(c)}if(b==="disabled"){this._setDisabled(c);return}if(b==="maxLabelWidth"){var e=c;if(c!="auto"){e=e+"px";var f=this.component().find(".coral-checkbox-text");for(var a=0;a<f.length;a++){var d=$(f[a]).html();$(f[a]).attr("title",d)}}else{e="";this.component().find(".coral-checkbox-text").attr("title","")}this.component().find(".coral-checkbox-text").css("max-width",e)}this._super(b,c)},_destroy:function(){this.component().remove();if(this.options.name){this.element.removeAttr("orgname").attr("name",this.options.name)}this.element.removeClass("coral-form-element-checkboxlist");this.element.removeClass("coral-validation-checkboxlist");this.element.show()},focus:function(){},component:function(){return this.uiBoxlist},disable:function(){this._setOption("disabled",true);this._setDisabled(true)},readonly:function(){this._setReadonly("readonly",true)},enable:function(){this._setOption("disabled",false);this._setDisabled(false)},disableItem:function(a){this.uiBoxlist.find('.coral-checkbox[data-value="'+a+'"]').toggleClass("coral-state-disabled",true)},enableItem:function(b){this.options.disabled=false;var a=this.uiBoxlist.find('.coral-checkbox[data-value="'+b+'"]').toggleClass("coral-state-disabled",false)},show:function(){this.component().show()},hide:function(){this.component().hide()},getValue:function(){return this.uiInput.val()},setValue:function(e,d){var a=this.getValue()||[];this.uiBoxlist.find(".coral-checkboxlist-item-highlight").each(function(){$(this).removeClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight").addClass("cui-icon-checkbox-unchecked")
});e=e||"";var b=0,c=$.isArray(e)?e:((!e||typeof e!=="string"||""===$.trim(e))?[]:e.split(","));for(;b<c.length;b++){this.uiBoxlist.find('.coral-checkbox[data-value="'+c[b]+'"]').find(".coral-checkbox-icon").removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight")}this.uiInput.val(c.toString())},invertCheck:function(b){var a=[];this.uiBoxlist.find(".coral-checkboxlist-item-highlight").each(function(){$(this).removeClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight").addClass("coral-checkbox-temp")});this.uiBoxlist.find(".cui-icon-checkbox-unchecked").each(function(){$(this).removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkboxlist-item-highlight")});this.uiBoxlist.find(".coral-checkbox-temp").each(function(){$(this).removeClass("coral-checkbox-temp").addClass("cui-icon-checkbox-unchecked")});this.uiBoxlist.find(".coral-checkbox").each(function(){if($(this).find(".coral-checkbox-icon").hasClass("coral-checkboxlist-item-highlight")){a.push($(this).attr("data-value"))}});this.setValue(a,b)},checkAll:function(){var b=[],a=0,d=null,c=this.data;for(;a<c.length;a++){d=c[a];b.push(d[this.options.valueField])}this.setValue(b)},getText:function(b){var c=0,d=this.data,e=null,a=[];if(!b){b=this.getValue().split(",")}else{if(typeof b){b=b.split(",")}}for(;c<d.length;c++){e=d[c][this.options.valueField];if($.inArray(e,b)>-1){a.push(d[c][this.options.textField])}}return a.toString()}});

$.component("coral.radio",$.coral.formelement,{version:"4.0.1",castProperties:["triggers"],options:{showStar:true,id:null,name:null,width:"auto",height:24,label:"",starBefore:false,labelField:null,disabled:false,readonly:false,allowCancel:false,checked:false,required:false,isCheck:false,value:"",errMsg:null,errMsgPosition:"leftBottom",onValidError:null,onValidSuccess:null,onClick:null,onKeyDown:null,onChange:$.noop,triggers:null,excluded:false},_create:function(){var c=this,b=this.options;if(!c.element.jquery){c.element=$(c.element)}c.element.addClass("coral-form-element-radio tabbable");c.element.addClass("coral-validation-radio");typeof c.element.attr("id")=="undefined"&&!!c.options.id&&c.element.attr("id",c.options.id);c.options.id=c.element.uniqueId().attr("id");var a=c.element.attr("name");typeof a!="undefined"?(c.options.name=a):(c.element.attr("name",c.options.name));if($.trim(c.element.val())!=""&&$.trim(c.element.val())!="on"){c.options.value=c.element.val()}else{if(c.options.value){c.element.val(c.options.value)}}c.nameMark="coral-radio-element-"+c._hashCode(c.options.name);c.element.addClass(c.nameMark);c.uiRadio=$('<span class="coral-radio"></span>');c.uiLabel=$('<label class="coral-radio-label" for='+c.options.id+"></label>");c.uiIcon=$('<span class="coral-radio-icon"></span>');c.uiLabel.append(c.uiIcon);if(c.options.label){c.uiLabel.append(c.options.label)}if(c.options.checked){c._getRadios().not(c.element).radio("uncheck");c.uiIcon.addClass("cui-icon-radio-checked coral-radio-hightlight");c.element.prop("checked",true)}else{c.uiIcon.addClass("cui-icon-radio-unchecked");c.element.prop("checked",false)}c.element.after(c.uiRadio);c.uiRadio.append(c.element).append(c.uiLabel);if(b.labelField){this.uiLabelField=$('<label class="coral-label">'+b.labelField+"</label>");this.uiRadio.prepend(this.uiLabelField);this.uiRadio.addClass("coral-hasLabel")}if((c.element)[0].checked===true){c.originalValue=this.getValue()}c._bindEvent()},reset:function(){if(this.originalValue==="off"||this.originalValue===""){this.uncheck()
}else{this.check()}},_getRadios:function(){var b=this,a=b.element.closest("form");if(a.length>0){return a.find($("."+b.nameMark))}else{return $("."+b.nameMark)}},_setDisabled:function(a){if(a){this.element.prop("disabled",true);this.uiRadio.addClass("coral-state-disabled")}else{this.element.prop("disabled",false);this.uiRadio.removeClass("coral-state-disabled")}this.options.disabled=(a?true:false)},_setReadonly:function(a){if(a){this.element.prop("reaonly",true);this.uiRadio.addClass("coral-readonly")}else{this.element.prop("readonly",false);this.uiRadio.removeClass("coral-state-readonly")}this.options.readonly=!!a},focus:function(){var a=this;if(this.options.disabled||this.options.readonly){return false}this.element.focus();return true},_bindEvent:function(){var b=this;if(this.options.disabled){this._setDisabled(this.options.disabled)}var a;this.element.bind("focus",function(){b.uiRadio.addClass("coral-radio-highlight")}).bind("blur",function(){b.uiRadio.removeClass("coral-radio-highlight")}).bind("click",function(c){if(b.options.disabled){return}if(a){a=false;return}b._clearCheckedState();b.uiIcon.removeClass("cui-icon-radio-unchecked");b.uiIcon.addClass("cui-icon-radio-checked coral-radio-hightlight");b._trigger("onChange",null,[{checked:!!b.element.prop("checked")}]);b._trigger("onClick",null,{checked:!!b.element.prop("checked")})}).bind("keydown"+this.eventNamespace,function(d){if(b.options.allowCancel){var c=$.coral.keyCode;switch(d.keyCode){case c.SPACE:d.preventDefault();b._selectItem(d);break}}b._trigger("onKeyDown",d,{})});this.uiRadio.bind("mouseenter"+this.eventNamespace,function(){if(b.options.disabled){return}$(this).addClass("coral-radio-hover")}).bind("mouseleave"+this.eventNamespace,function(){if(b.options.disabled){return}$(this).removeClass("coral-radio-hover")});this.uiLabel.bind("click",function(c){b._selectItem(c)})},_selectItem:function(b){var a=this;if(a.options.readonly||a.options.disabled){return false}suppressClick=true;a.options.isCheck=$(a.element).prop("checked");
if(!a.options.isCheck){a._clearCheckedState();a.uiIcon.removeClass("cui-icon-radio-unchecked");a.uiIcon.addClass("cui-icon-radio-checked");a.element.prop("checked",true);a._trigger("onChange",null,[{checked:!!a.element.prop("checked")}])}else{if(!a.options.allowCancel){return}a._clearCheckedState();a.uiIcon.addClass("cui-icon-radio-unchecked");a.element.prop("checked",false);a._trigger("onChange",null,[{checked:!!a.element.prop("checked")}])}},clear:function(){},_clearCheckedState:function(){this._getRadios().each(function(){$(this).radio("component").find(".coral-radio-icon").removeClass("cui-icon-radio-checked coral-radio-hightlight").addClass(" cui-icon-radio-unchecked")})},_hashCode:function(e){if(!e){return 0}e=""+e;var c=0,d=0,a=e.length;for(var b=0;b<a;b++){c=31*c+e.charCodeAt(d++);if(c>2147483647||c<2147483648){c=c&4294967295}}return c},_setOption:function(a,b){if(a==="id"||a==="name"){return}if(a==="readonly"){this._setReadonly(b)}if(a==="disabled"){this._setDisabled(b)}this._super(a,b)},_destroy:function(){this.uiRadio.replaceWith(this.element);this.uncheck();this.element.removeClass("coral-form-element-radio");this.element.removeClass("coral-validation-radio");this.element.removeClass(this.nameMark)},component:function(){return this.uiRadio},disable:function(){this._setDisabled(true)},enable:function(){this._setDisabled(false)},show:function(){this.component().show()},hide:function(){this.component().hide()},check:function(){var a=this;if(this.uiIcon.hasClass("cui-icon-radio-unchecked")){a._getRadios().each(function(){$(this).radio("component").find(".coral-radio-icon").removeClass("cui-icon-radio-checked coral-radio-hightlight").addClass(" cui-icon-radio-unchecked")});this.uiIcon.removeClass("cui-icon-radio-unchecked").addClass("cui-icon-radio-checked coral-radio-hightlight");this.element.prop("checked",true)}},uncheck:function(){if(this.uiIcon.hasClass("coral-radio-hightlight")){this.uiIcon.removeClass("cui-icon-radio-checked coral-radio-hightlight").addClass("cui-icon-radio-unchecked");
this.element.prop("checked",false)}},isChecked:function(){return this.element.prop("checked")},setValue:function(a){if("on"===a){this.check()}else{this.uncheck()}},getValue:function(){return this.getValues().join(",")},getValues:function(){var b=this,a=[];b._getRadios().each(function(){var c=$(this);if(c.radio("isChecked")){a.push(c.val())}});return a},refresh:function(){this._destroy();this._create()}});

/*!
 * 组件库4.0：复选框组
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 *    jquery.validatehelper.js
 */
$.component("coral.radiolist",$.coral.formelement,{version:"4.0.1",castProperties:["data","triggers"],options:{id:null,name:null,valueField:"value",textField:"text",required:false,labelField:null,starBefore:false,showStar:true,column:null,disabled:false,readonly:false,isCheck:false,allowCancel:false,value:"",valueIndex:null,data:[],url:null,termSplit:";",itemSplit:":",repeatLayout:"table",itemWidth:"auto",errMsg:null,errMsgPosition:"leftBottom",onLoad:null,onValidError:null,onKeyDown:null,onValidSuccess:null,triggers:null,excluded:false,onChange:$.noop},_create:function(){var d=this,b=null,a=null,e=null,c=this.options;this._prepareInit();this._initComponent();this._setDefaultValue();this._initData();this._bindEvent();if(this.options.url){this._trigger("onLoad",null,[{data:this.getData()}])}},_prepareInit:function(){this.isInit=false},_initComponent:function(){this.element.addClass("coral-form-element-radiolist coral-validation-radiolist ctrl-init ctrl-form-element ctrl-init-radiolist");typeof this.element.attr("id")=="undefined"&&!!this.options.id&&that.element.attr("id",this.options.id);this.options.id=this.element.uniqueId().attr("id");var a=this.element.attr("name");typeof a!="undefined"?(this.options.name=a):(this.element.attr("name",this.options.name));this.uiBoxlist=$('<span class="coral-radiolist"></span>');this.uiInput=$('<input type="hidden">');if(this.options.name){this.uiInput.attr("name",this.options.name);this.element.removeAttr("name").attr("orgname",this.options.name)}this.uiInput.appendTo(this.uiBoxlist);if(this.options.labelField){this.uiLabel=$('<label class="coral-label">'+this.options.labelField+"</label>");this.uiBoxlist.prepend(this.uiLabel);this.uiBoxlist.addClass("coral-hasLabel")}this.uiBoxlist.insertAfter(this.element);this.element.hide()},_setDefaultValue:function(){},_initData:function(){var b=this,a=this.options;
if(a.url){if(this.xhr){this.xhr.abort()}this.xhr=$.ajax(this._ajaxSettings());this.xhr.success(function(c){b._loadData(c)}).complete(function(d,c){if(d===b.xhr){b.xhr=null}}).error(function(){$.alert("Json Format Error!")})}else{if(a.data){this._loadData(a.data)}}},_ajaxSettings:function(){var b=this.options,a=this;return{type:"get",url:b.url,data:{},async:false,dataType:"json"}},_loadData:function(g){var b=null,h,f,c=0,d=null,a=null,e=null;if(typeof g==="string"){b=g.split(this.options.termSplit);g=[];for(;c<b.length;c++){a=b[c];e=a.split(this.options.itemSplit);d={};d[this.options.valueField]=e[0];d[this.options.textField]=e[1];g.push(d)}}this.data=g;for(c;c<g.length;c++){h=g[c];if(h.checked){f=h[this.options.valueField]}}if(this.options.value){f=this.options.value}if(!this.isInit){this.isInit=true;this.originalValue=f}this._renderRadioItem();this.setValue(f)},_renderRadioItem:function(){if(this.options.repeatLayout=="table"){if(this.options.column==null){this.options.column=3}this._renderTableItem();this.uiTable.appendTo(this.uiBoxlist)}else{if(this.options.repeatLayout=="flow"){if(this.options.column==null){this.options.column=this.data.length}this._renderFlowItem();this.uiBorder.appendTo(this.uiBoxlist)}}},reset:function(){this.setValue(this.originalValue)},getData:function(){return this.data},_renderFlowItem:function(){var d=this,c=this.options,b=this.options.column,e=this.data;d.uiBorder=$('<span class="coral-radiolist-border"></span>');for(var a in e){if(a>(b-1)&&a%(b)===0){$("<br/>").appendTo(d.uiBorder)}d._renderItem(e[a]).css("width",c.itemWidth).appendTo(d.uiBorder)}},_renderTableItem:function(){this.uiTable=$("<table></table>");var d=0,c=0,g=this.data,b=g.length||0,e=this.options.column,f=0,h=null,a=null;if(!g||g.length<1){return}f=Math.ceil(b/e);for(;d<f;d++){h=$("<tr></tr>");for(c=0;c<e;c++){a=$("<td></td>");if((d*e+c)<b){this._renderItem(g[(d*e+c)]).appendTo(a)}a.appendTo(h)}h.appendTo(this.uiTable)}},_renderItem:function(g){var e=this.data,d=false;for(var f=0;
f<e.length;f++){d=e[f]["checked"]===true}if(!d){e[0]["checked"]=true;this.tabIndex=0}else{this.tabIndex=f}var b=g.hidden===true?"hidden":"",m=g.checked===true?"tabindex = 0":"",a=g.checked===true?"tabbable":"";var h=$("<span class='coral-radio "+b+a+"'"+m+"></span>"),c=$("<label class='coral-radio-label'></label>"),k=$("<span class='coral-radio-icon'></span>"),j=g[this.options.valueField],l=g[this.options.textField];h.attr("value",j);c.append(k).append(l);c.appendTo(h);k.addClass("cui-icon-radio-unchecked");return h},_bindEvent:function(){var a=this;if(this.options.disabled){this._setDisabled(this.options.disabled)}this._on({"mouseenter .coral-radio":function(c){if(a.options.readonly){return false}var b=$(c.target).closest(".coral-radio");if($(b).hasClass("coral-state-disabled")){return}$(b).addClass("coral-radio-hover")},"mouseleave .coral-radio":function(c){if(a.options.readonly){return false}var b=$(c.target).closest(".coral-radio");if($(b).hasClass("coral-state-disabled")){return}$(b).removeClass("coral-radio-hover")},"keydown .coral-radio":function(h){var g=$.coral.keyCode;var j=$(h.target).closest(".coral-radiolist"),c=j.find(".coral-radio");record=0,isChecked=true;$.each(c,function(e){if(c[e]==document.activeElement){record=e}isChecked=$(c[e]).attr("checked")===true});switch(h.keyCode){case g.SPACE:h.preventDefault();if(!isChecked){var f=$(c[i]).attr("value");a.setValue(f)}a._selectItem(h);break;case g.LEFT:h.preventDefault();if(a.options.readonly){return false}if(record==0){record=c.length}var d=$(c[record-1]),b=d.find(".coral-radio-icon"),f=d.attr("value");d.attr("tabindex","0");d.addClass("tabbable");$(c[record]).removeAttr("tabindex");$(c[record]).removeClass("tabbable");a.setValue(f);setTimeout(function(){d.focus()});a._trigger("onChange",null,{value:f,checked:b.hasClass("coral-radiolist-item-hightlight")});break;case g.RIGHT:h.preventDefault();if(a.options.readonly){return false}if(record==c.length-1){record=-1}var d=$(c[record+1]),b=d.find(".coral-radio-icon"),f=d.attr("value");
d.attr("tabindex","0");$(c[record]).removeAttr("tabindex");d.addClass("tabbable");$(c[record]).removeClass("tabbable");$(c[record]).removeAttr("tabindex");a.setValue(f);setTimeout(function(){d.focus()});a._trigger("onChange",null,{value:f,checked:b.hasClass("coral-radiolist-item-hightlight")});break}a._trigger("onKeyDown",h,{})},"click .coral-radio":function(b){a._selectItem(b);b.stopPropagation()}})},_selectItem:function(h){var f=this;var j=$(".coral-radiolist").find(".coral-radio");var c=$(h.target).closest(".coral-radio");if(f.options.readonly){return false}var d=c,a=d.find(".coral-radio-icon"),g=d.attr("value"),b=f.getValue();$(j[this.tabIndex]).removeClass("tabbable");$(j[this.tabIndex]).removeAttr("tabindex");$.each(j,function(e){if($(j[e])[0]==c[0]){f.tabIndex=e}});d.addClass("tabbable");d.attr("tabindex","0");d.focus();if(g==b){if(!this.options.allowCancel){return false}a.removeClass("cui-icon-radio-checked coral-radiolist-item-hightlight").addClass("cui-icon-radio-unchecked");f.uiInput.val("")}else{f.setValue(g);f._trigger("onChange",null,{value:g,checked:a.hasClass("coral-radiolist-item-hightlight")})}},_setDisabled:function(a){a=!!a;this.uiBoxlist.find(".coral-radio").each(function(){$(this).toggleClass("coral-state-disabled",a)});this.options.disabled=a},_setReadonly:function(a){a=!!a;this.uiBoxlist.find(".coral-radio").each(function(){$(this).toggleClass("coral-readonly",a)});this.options.readonly=a},_setOption:function(a,b){if(a==="id"||a==="name"){return}if(a==="disabled"){this._setDisabled(b)}if(a==="readonly"){this._setReadonly(b)}this._super(a,b)},_destroy:function(){this.component().remove();if(this.options.name){this.element.removeAttr("orgname").attr("name",this.options.name)}this.element.removeClass("coral-form-element-radiolist");this.element.removeClass("coral-validation-radiolist");this.element.show()},focus:function(){},component:function(){return this.uiBoxlist},disable:function(){this._setDisabled(true)},readonly:function(){this._setReadonly(true)
},enable:function(){this._setDisabled(false)},disableItem:function(a){this.uiBoxlist.find('.coral-radio[value="'+a+'"]').toggleClass("coral-state-disabled",true)},enableItem:function(a){this.options.disabled=false;this.uiBoxlist.find('.coral-radio[value="'+a+'"]').toggleClass("coral-state-disabled",false)},show:function(){this.component().show()},hide:function(){this.component().hide()},getValue:function(){return this.uiInput.val()},setValue:function(b){b=b||"";this.uiBoxlist.find(".coral-radiolist-item-hightlight").each(function(){$(this).removeClass("cui-icon-radio-checked coral-radiolist-item-hightlight").addClass("cui-icon-radio-unchecked")});var a=this.uiBoxlist.find('.coral-radio[value="'+b+'"]').find(".coral-radio-icon").removeClass("cui-icon-radio-unchecked").addClass("cui-icon-radio-checked coral-radiolist-item-hightlight");this.uiBoxlist.find(".coral-radio").removeClass("coral-state-highlight");this.uiBoxlist.find('.coral-radio[value="'+b+'"]').addClass("coral-state-highlight");this.uiInput.val(b)},getText:function(d){var b=0,c=this.data,e=null,a=[];if(!d){d=this.getValue()}for(;b<c.length;b++){e=c[b][this.options.valueField];if(e==d){return(c[b][this.options.textField])}}return""}});

/*!
 * 组件库4.0.1：进度条
 *
 * 依赖JS文件:
 *   jquery.coral.code.js
 *   jquery.coral.component.js
 */
$.component("coral.progressbar",{version:"4.0.1",options:{id:null,name:null,max:100,value:0,text:"{value}%",onChange:null,onComplete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("coral-progressbar coral-component coral-corner-all");this.valueDiv=$('<div class="coral-progressbar-value coral-corner-left"></div>').appendTo(this.element);this.textDiv=$('<div class="coral-progressbar-text"></div>').appendTo(this.valueDiv);this.valueWidth=this.element.width()-(this.valueDiv.outerWidth(true)-this.valueDiv.outerWidth());this._refreshValue()},_destroy:function(){this.element.removeClass("coral-progressbar coral-component coral-component-content coral-corner-all");this.valueDiv.remove()},value:function(a){if(a===undefined){return this.options.value}this.options.value=this._constrainedValue(a);this._refreshValue()},_constrainedValue:function(a){if(a===undefined){a=this.options.value}this.indeterminate=a===false;if(typeof a!=="number"){a=0}return(this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,a)))},_setOptions:function(a){var b=a.value;delete a.value;this._super(a);this.options.value=this._constrainedValue(b);this._refreshValue()},_setOption:function(a,b){if(a==="max"){b=Math.max(this.min,b)}if(a==="disabled"){this.element.toggleClass("coral-state-disabled",!!b).attr("aria-disabled",b)}this._super(a,b)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var b=this.options.value,a=this._percentage().toFixed(0),e=this.options.text.replace(/{value}/,a),d=0,c=0;this.valueDiv.toggle(this.indeterminate||b>this.min).toggleClass("coral-corner-right",b===this.options.max).width(this.valueWidth*a/100);if(100==a){this.valueDiv.width("auto")}this.textDiv.html(e);d=(this.element.position().left+(this.element.outerWidth()-this.textDiv.outerWidth())/2);
c=(this.element.position().top+(this.element.outerHeight()-this.textDiv.outerHeight())/2);this.textDiv.position({of:this.element,my:d+" "+c,at:d+" "+c});this.element.toggleClass("coral-progressbar-indeterminate",this.indeterminate);if(this.indeterminate){if(!this.overlayDiv){this.overlayDiv=$("<div class='coral-progressbar-overlay'></div>").appendTo(this.valueDiv)}}else{if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==b){this.oldValue=b;this._trigger("onChange",null,{value:b,oldValue:this.oldValue})}if(b===this.options.max){this._trigger("onComplete")}}});

$.component("coral.accordion",{version:"4.0.1",options:{active:0,a:[],animate:{params:{},duration:300,easing:"swing"},collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"cui-icon-arrow-down3",header:"cui-icon-arrow-up3"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var a=this.options;a.icons=$.coral.toFunction(a.icons);this.options.a.push("ddd");this.prevShow=this.prevHide=$();this.element.addClass("coral-accordion ctrl-init ctrl-init-accordion coral-component coral-helper-reset").attr("role","tablist");if(!a.collapsible&&(a.active===false||a.active==null)){a.active=0}this._processPanels();if(a.active<0){a.active+=this.headers.length}this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?$():this.active.next()}},_createIcons:function(){var b=this,a=this.options.icons;if(a){$("<span>").addClass("coral-accordion-header-icon icon "+a.header).prependTo(this.headers);this.active.children(".coral-accordion-header-icon").removeClass(a.header).addClass(a.activeHeader);this.headers.each(function(){var c=$.parser.parseOptions(this);if(c.collapsible==false){$(this).children(".coral-accordion-header-icon").remove()}else{$(this).addClass("coral-accordion-icons")}})}},_destroyIcons:function(){this.headers.removeClass("coral-accordion-icons").children(".coral-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("coral-accordion coral-component coral-helper-reset").removeAttr("role");this.headers.removeClass("coral-accordion-header coral-accordion-header-active coral-state-default coral-corner-all coral-state-active coral-state-disabled coral-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId();
this._destroyIcons();a=this.headers.next().removeClass("coral-helper-reset coral-widget-content coral-corner-bottom coral-accordion-content coral-accordion-content-active coral-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId();if(this.options.heightStyle!=="content"){a.css("height","")}},_setOption:function(a,b){if(a==="active"){this._activate(b);return}if(a==="event"){if(this.options.event){this._off(this.headers,this.options.event)}this._setupEvents(b)}this._super(a,b);if(a==="collapsible"&&!b&&this.options.active===false){this._activate(0)}if(a==="icons"){this._destroyIcons();if(b){this._createIcons()}}if(a==="disabled"){this.element.toggleClass("coral-state-disabled",!!b).attr("aria-disabled",b);this.headers.add(this.headers.next()).toggleClass("coral-state-disabled",!!b)}},_keydown:function(d){if(d.altKey||d.ctrlKey){return}var e=$.coral.keyCode,c=this.headers.length,a=this.headers.index(d.target),b=false;switch(d.keyCode){case e.RIGHT:case e.DOWN:b=this.headers[(a+1)%c];break;case e.LEFT:case e.UP:b=this.headers[(a-1+c)%c];break;case e.SPACE:case e.ENTER:this._eventHandler(d);break;case e.HOME:b=this.headers[0];break;case e.END:b=this.headers[c-1];break}if(b){$(d.target).attr("tabIndex",-1);$(b).attr("tabIndex",0);b.focus();d.preventDefault()}},_panelKeyDown:function(a){if(a.keyCode===$.coral.keyCode.UP&&a.ctrlKey){$(a.currentTarget).prev().focus()}},refresh:function(){var a=this.options;this._processPanels();if((a.active===false&&a.collapsible===true)||!this.headers.length){a.active=false;this.active=$()}else{if(a.active===false){this._activate(0)}else{if(this.active.length&&!$.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".coral-state-disabled").length){a.active=false;this.active=$()}else{this._activate(Math.max(0,a.active-1))}}else{a.active=this.headers.index(this.active)}}}this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("coral-accordion-header coral-state-default coral-corner-all");
this.headers.next().addClass("coral-accordion-content coral-helper-reset coral-component-content coral-corner-bottom").filter(":not(.coral-accordion-content-active)").hide()},_refresh:function(){var d,b=this.options,a=b.heightStyle,c=this.element.parent();this.active=this._findActive(b.active).addClass("coral-accordion-header-active coral-state-active coral-corner-top").removeClass("coral-corner-all");this.active.next().addClass("coral-accordion-content-active").show();this.headers.attr("role","tab").each(function(){var h=$(this),g=h.uniqueId().attr("id"),e=h.next(),f=e.uniqueId().attr("id");h.attr("aria-controls",f);e.attr("aria-labelledby",g)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"})}this._createIcons();this._setupEvents(b.event);if(a==="fill"){$.coral.fitParent(this.component(),true);d=c.height();this.element.siblings(":visible").each(function(){var f=$(this),e=f.css("position");if(e==="absolute"||e==="fixed"){return}d-=f.outerHeight(true)});this.headers.each(function(){d-=$(this).outerHeight(true)});this.headers.next().each(function(){$(this).height(Math.max(0,d-$(this).innerHeight()+$(this).height()))}).addClass("coral-scroll")}else{if(a==="auto"){d=0;this.headers.next().each(function(){d=Math.max(d,$(this).css("height","").height())}).height(d)}}this.headers.each(function(){var e=$.parser.parseOptions(this);if(e.collapsible==false){$(this).next().addClass("hidden")}})},_activate:function(a){var b=this._findActive(a)[0];if(b===this.active[0]){return}b=b||this.active[0];this._eventHandler({target:b,currentTarget:b,preventDefault:$.noop})},_findActive:function(a){return typeof a==="number"?this.headers.eq(a):$()},_setupEvents:function(b){var a={keydown:"_keydown"};
if(b){$.each(b.split(" "),function(d,c){a[c]="_eventHandler"})}this._off(this.headers.add(this.headers.next()));this._on(this.headers,a);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(a){var i=this.options,d=this.active,e=$(a.currentTarget),g=e[0]===d[0],b=g&&i.collapsible,c=b?$():e.next(),f=d.next(),h={oldHeader:d,oldPanel:f,newHeader:b?$():e,newPanel:c,headerOptions:$.parser.parseOptions((b?$():e))};a.preventDefault();if((g&&!i.collapsible)||(this._trigger("beforeActivate",a,h)===false)){return}i.active=b?false:this.headers.index(e);this.active=g?$():e;this._toggle(h);d.removeClass("coral-accordion-header-active coral-state-active");if(i.icons){d.children(".coral-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header)}if(!g){e.removeClass("coral-corner-all").addClass("coral-accordion-header-active coral-state-active coral-corner-top");if(i.icons){e.children(".coral-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader)}e.next().addClass("coral-accordion-content-active")}},_toggle:function(c){var a=c.newPanel,b=this.prevShow.length?this.prevShow:c.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=a;this.prevHide=b;if(this.options.animate){this._animate(a,b,c)}else{b.hide();a.show();this._toggleComplete(c)}b.attr({"aria-hidden":"true"});b.prev().attr("aria-selected","false");if(a.length&&b.length){b.prev().attr({tabIndex:-1,"aria-expanded":"false"})}else{if(a.length){this.headers.filter(function(){return $(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}a.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(a,i,e){var h,g,d,f=this,j=0,k=a.length&&(!i.length||(a.index()<i.index())),c=this.options.animate||{},l=k&&c.down||c,b=function(){f._toggleComplete(e)};if(typeof l==="number"){d=l}if(typeof l==="string"){g=l}g=g||l.easing||c.easing;
d=d||l.duration||c.duration;if(!i.length){return a.animate(this.showProps,d,g,b)}if(!a.length){return i.animate(this.hideProps,d,g,b)}h=a.show().outerHeight();i.animate(this.hideProps,{duration:d,easing:g,step:function(m,n){n.now=Math.round(m)}});a.hide().animate(this.showProps,{duration:d,easing:g,complete:b,step:function(m,n){n.now=Math.round(m);if(n.prop!=="height"){j+=n.now}else{if(f.options.heightStyle!=="content"){j=0}}}})},_toggleComplete:function(b){var a=b.oldPanel;a.removeClass("coral-accordion-content-active").prev().removeClass("coral-corner-top").addClass("coral-corner-all");if(a.length){a.parent()[0].className=a.parent()[0].className}this._trigger("onActivate",null,b)}});

/*!
 * 组件库4.0： 窗体
 *
 * 依赖JS文件:
 *	jquery.coral.core.js
 *	jquery.coral.component.js
 *	jquery.coral.mouse.js
 *  jquery.coral.button.js
 *	jquery.coral.draggable.js
 *	jquery.coral.position.js
 *	jquery.coral.resizable.js
 */
(function(){var a={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},b={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},c=null;$.component("coral.dialog",{version:"4.0.1",castProperties:["buttons"],options:{appendTo:"body",autoOpen:true,buttons:[],closeOnEscape:true,closeText:"关闭",closeButtonClass:"cui-icon-cross2",closable:true,loadtext:"加载中，请耐心等候 ...",maximumText:"最大化",maximizable:false,maximized:false,restoreWidth:200,restoreHeight:200,dialogClass:"",iframePanel:false,draggable:true,hide:null,height:"auto",percent:false,manualResize:false,maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,zIndex:null,timeOut:0,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var d=$(this).css(e).offset().top;if(d<0){$(this).css("top",e.top-d)}}},resizable:true,show:null,title:null,subTitle:null,type:null,wtype:"dialog",message:null,width:300,url:"",reLoadOnOpen:false,postData:[],asyncType:"post",beforeClose:null,onCreate:null,onClose:null,onDrag:null,onDragStart:null,onDragStop:null,onFocus:null,onLoad:null,onLoadError:null,onOpen:null,onResize:null,onResizeStart:null,onResizeStop:null,onConfirm:null,onCancel:null,focusInput:false},_compatible:function(){this.options.reloadOnOpen=this.options.reLoadOnOpen},_create:function(){this._compatible();var e=this;var d=/^(\d|[1-9]\d|100)%$/;if(d.test(this.options.height)){this.options.percent=this.options.height;this.options.height=this._percentToPx()}if($.inArray(this.options.wtype,["dialog","message","alert","confirm"])<0){this.options.wtype="dialog"}if(this.options.wtype!=="dialog"){this.options.minHeight=null}this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};
this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this.originalsubTitle=this.element.attr("subTitle");this.options.subTitle=this.options.subTitle||this.originalsubTitle;this._createWrapper();var f=this.options.isMessage?"alert-box":"coral-dialog-content";this.element.show().removeAttr("title").addClass(f+" coral-component-content").appendTo(this.uiDialog);if(this.options.wtype!=="dialog"){this.uiDialog.addClass("coral-messager")}switch(this.options.wtype){case"alert":this._createTitlebar();this._createButtonPanel();break;case"message":break;case"confirm":this._createTitlebar();this._createButtonPanel();break;case"dialog":this._createTitlebar();this._createButtonPanel()}if(this.options.draggable&&$.fn.draggable){this._makeDraggable()}if(this.options.resizable&&$.fn.resizable){this._makeResizable()}this._isOpen=false;this._trackFocus()},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var d=this.options.appendTo;if(typeof d=="string"&&d=="parent"){return this.originalPosition.parent}if(d&&(d.jquery||d.nodeType)){return $(d)}return this.document.find(d||"body").eq(0)},forceDestroy:function(){var d=this;this._destroy(true)},_destroy:function(f){var e,d=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("coral-dialog-content coral-component-content").css(this.originalCss).detach();this.uiDialog.stop(true,true).remove();if(this.options.iframePanel){this.iframePanel.stop(true,true).remove()}if(!f){if(this.originalTitle){this.element.attr("title",this.originalTitle)}e=d.parent.children().eq(d.index);if(e.length&&e[0]!==this.element[0]){e.before(this.element)}else{d.parent.append(this.element)}}},component:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(h){var g,f=this,e,d=this.originalPosition;if(this.options.reLoadOnOpen){this.loaded=false
}if(!this._isOpen||this._trigger("beforeClose",h)===false){return}if(f.options.destroyOnClose){f.element.html("")}if(f.options.url!=""&&f.options.reLoadOnOpen&&f.options.autoDestroy){f.element.html("")}this._hide(this.uiDialog,this.options.hide,function(){e=d.parent.children().eq(d.index);if(e.length&&e[0]!==f.element[0]){e.before(f.uiDialog)}else{d.parent.append(f.uiDialog)}f._isOpen=false;f._focusedElement=null;f._destroyOverlay();f._untrackInstance();if($.inArray(f.options.wtype,["dialog","alert","confirm"])>-1){if(f.opener.length&&f.opener[0].tagName.toLowerCase()!="object"&&!f.opener.filter(":focusable").focus().length){try{g=f.document[0].activeElement;if(g&&g.nodeName.toLowerCase()!=="body"){$(g).blur()}}catch(i){}}}if("dialog"!==f.options.wtype){f.element.remove()}f._trigger("onClose",h)});if(this.options.iframePanel){this.iframePanel.hide()}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(h,e){var g=false,d=this.uiDialog.siblings(".coral-front:visible").map(function(){return +$(this).css("z-index")}).get(),f=Math.max.apply(null,d);if(f>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",f+1);if(this.options.iframePanel){this.iframePanel.css("z-index",f+1)}g=true}if(g&&!e){this._trigger("onFocus",h)}return g},open:function(){var f=this,e={panel:f.element};this.uiDialog.appendTo(this._appendTo());var g=this.options.url&&!f.loaded;if(g){$(f.element).loading({position:"overlay",text:"加载中，请耐心等候！"});f.loaded=true;$.ajax({url:this.options.url,type:this.options.asyncType,dataType:"html",data:this.options.postData,success:function(i,h,j){$(f.element).loading("hide");f.element.html(i);$(f.element).loading({text:"渲染中，请耐心等候！",position:"overlay"});if($.coral.openTag==true){$.parser.parse(f.element)}$(f.element).loading("hide");f._trigger("onLoad",null,e);$.coral.refreshAllComponent(f.element)},error:function(j,h,i){f._trigger("onLoadError",null,[{xhr:j,st:h,err:i}])},beforeSend:function(i,h){}})}c=null;if(this._isOpen){if(this._moveToTop()){if($.inArray(f.options.wtype,["dialog","alert","confirm"])>-1){this._focusTabbable()
}}return}this._isOpen=true;this.opener=$(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1);if(this.options.iframePanel){this.overlay.css("z-index",this.iframePanel.css("z-index")-1)}}this._show(this.uiDialog,this.options.show,function(){if($.inArray(f.options.wtype,["dialog","alert","confirm"])>-1){f._focusTabbable()}if(!g){$.coral.refreshAllComponent(f.element)}if(f.options.iframePanel){f.iframePanel.show();f.iframePanel.css("width",f.uiDialog.outerWidth())}f._trigger("onFocus")});this._makeFocusTarget();this._trigger("onOpen");if(!isNaN(this.options.timeOut)&&this.options.timeOut>0){c=setTimeout(d,f.options.timeOut);this.uiDialog.hover(function(){if(c){clearTimeout(c)}},function(){c=setTimeout(d,f.options.timeOut)})}function d(){f.close()}},_focusTabbable:function(){var d=this._focusedElement;if(this.options.focusInput===true){this._focusFirst();return}if(!d){d=this.element.find("[autofocus]")}if(!d.length){d=this.element.find(":tabbable")}if(!d.length&&this.uiDialogButtonPane){d=this.uiDialogButtonPane.find(":tabbable")}if(!d.length&&this.uiDialogTitlebarClose){d=this.uiDialogTitlebarClose.filter(":tabbable")}if(!d.length){d=this.uiDialog}d.eq(0).focus()},_findFields:function(){return $.coral.findComponent(".ctrl-form-element",this.element)},_focusFirst:function(){var g=this,e=this._findFields();for(var f in e){var d=e[f];if(e[f] instanceof Array){if(true==$(d[0].element)[d[0].name]("focus")){return}}else{if(d.focus&&true==d.focus()){return}}}},_keepFocus:function(d){function e(){var g=this.document[0].activeElement,f=this.uiDialog[0]===g||$.contains(this.uiDialog[0],g);if(!f){this._focusTabbable()}}d.preventDefault();e.call(this);this._delay(e)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("coral-dialog coral-component coral-component-content coral-corner-all coral-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this.element.parent());
if(this.options.iframePanel){this.iframePanel=$("<iframe class='coral-dialog-iframePanel' style='position:absolute;'></iframe>").hide().appendTo(this._appendTo())}if(this.options.zIndex){this.uiDialog.css("z-index",this.options.zIndex);if(this.options.iframePanel){this.iframePanel.css("z-index",this.options.zIndex)}}this._on(this.uiDialog,{keydown:function(f){if(this.options.closeOnEscape&&!f.isDefaultPrevented()&&f.keyCode&&f.keyCode===$.coral.keyCode.ESCAPE){f.preventDefault();this.close(f);return}if(f.keyCode!==$.coral.keyCode.TAB||f.isDefaultPrevented()){return}var e=this.uiDialog.find(":tabbable"),g=e.filter(":first"),d=e.filter(":last");if((f.target===d[0]||f.target===this.uiDialog[0])&&!f.shiftKey){this._delay(function(){g.focus()});f.preventDefault()}else{if((f.target===g[0]||f.target===this.uiDialog[0])&&f.shiftKey){this._delay(function(){d.focus()});f.preventDefault()}}},mousedown:function(d){if(this._moveToTop(d)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var e=this.options,d;this.uiDialogTitlebar=$("<div>").addClass("coral-dialog-titlebar coral-component-header coral-corner-all coral-helper-clearfix").prependTo(this.uiDialog);this.uiDialogToolbar=$("<div>").addClass("coral-dialog-toolbar coral-corner-all coral-helper-clearfix").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebar,{mousedown:function(f){if(!$(f.target).closest(".coral-dialog-toolbar-close")&&!$(f.target).closest(".coral-dialog-toolbar-maximum")){this.uiDialog.focus()}}});if(this.options.maximizable){this.uiDialogTitlebarMaximum=$("<button type='button'></button>").button({label:this.options.maximumText,icons:{primary:"cui-icon-enlarge7"},text:false}).addClass("coral-dialog-toolbar-maximum").appendTo(this.uiDialogToolbar);this._on(this.uiDialogTitlebarMaximum,{click:function(f){f.preventDefault();if(!this.uiDialog.hasClass("coral-dialog-maximum")){this.maximize()
}else{this.restore()}$.coral.refreshAllComponent(this.element);this._trigger("onMaximize",null,{width:$(window).outerWidth(),height:$(window).outerHeight()})}})}if(this.options.closable){this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:this.options.closeButtonClass},text:false}).addClass("coral-dialog-toolbar-close").appendTo(this.uiDialogToolbar);this._on(this.uiDialogTitlebarClose,{click:function(f){var g=$(f.target);g.removeClass("coral-state-hover");f.preventDefault();this.close(f)}})}d=$("<span>").uniqueId().addClass("coral-dialog-title").prependTo(this.uiDialogTitlebar);this._title(d);uiDialogsubTitle=$("<span>").uniqueId().addClass("coral-dialog-subTitle").prependTo(this.uiDialogTitlebar);this._subTitle(uiDialogsubTitle);this.uiDialog.attr({"aria-labelledby":d.attr("id")});if(this.options.maximizable&&this.options.maximized){this.maximize();$.coral.refreshAllComponent(this.element)}},maximize:function(e){var d=this.options;d.restoreHeight=d.height;d.restoreWidth=d.width;$(this.element).dialog("option","width",$(window).width());$(this.element).dialog("option","height",$(window).height());this.uiDialog.addClass("coral-dialog-maximum");this.uiDialogTitlebarMaximum.find(".cui-icon-enlarge7").removeClass("cui-icon-enlarge7").addClass("cui-icon-shrink7");if(this.options.iframePanel){this.iframePanel.css({width:$(window).width(),height:$(window).height()})}},minimize:function(){},restore:function(){var e=this,d=this.options;$(e.element).dialog("option","width",d.restoreWidth);$(e.element).dialog("option","height",d.restoreHeight);e.uiDialog.removeClass("coral-dialog-maximum");if(this.options.iframePanel){this.iframePanel.css({width:d.restoreWidth,height:d.restoreHeight});this.iframePanel.position(d.position)}e.uiDialogTitlebarMaximum.find(".cui-icon-shrink7").removeClass("cui-icon-shrink7").addClass("cui-icon-enlarge7")},_title:function(e){var d=$.coral.toFunction(this.options.titleFormat);if(!this.options.title){e.html("&#160;")
}if(d){e.html(d.call(this.element,this.options.title))}else{e.text(this.options.title)}},_subTitle:function(d){if(!this.options.subTitle){d.html("&#160;")}d.text(this.options.subTitle)},_createButtonPanel:function(){this.uiDialogButtonPane=$("<div>").addClass("coral-dialog-buttonpane coral-component-content coral-helper-clearfix");this.uiButtonSet=$("<div>").addClass("coral-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var h=this,g=this.options.buttons,d=$.noop,f=$.noop;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if($.isEmptyObject(g)){g={}}if(($.isArray(g)&&!g.length)){this.uiDialog.removeClass("coral-dialog-buttons");return}var e=true;$.each(g,function(i,j){var k,m,l="coral-btn-primary";j=$.isFunction(j)?{click:j,text:i}:j;j=$.extend({type:"button"},j);k=j.click;j.click=function(){k.apply(h.element[0],arguments)};m={icons:j.icons,icons:j.cls,countdown:j.countdown,text:j.showText};if(j.id){m.id=j.id}if(e){m=$.extend({},m,{cls:l+" "+j.cls})}else{m=$.extend({},m,{cls:j.cls})}delete j.icons;delete j.cls;delete j.showText;$("<button></button>",j).button(m).appendTo(h.uiButtonSet);e=false});this.uiDialog.addClass("coral-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var f=this,e=this.options;function d(g){return{position:g.position,offset:g.offset}}this.uiDialog.draggable({cancel:".coral-dialog-content, .coral-dialog-toolbar-close",handle:".coral-dialog-titlebar",containment:"document",start:function(g,h){$(this).addClass("coral-dialog-dragging");f._blockFrames();if(f.options.iframePanel){f.iframePanel.css(h.position)}f._trigger("onDragStart",g,d(h))},drag:function(g,h){if(f.options.iframePanel){f.iframePanel.css(h.position)}f._trigger("onDrag",g,d(h))},stop:function(g,h){var j=h.offset.left-f.document.scrollLeft(),i=h.offset.top-f.document.scrollTop();e.position={my:"left top",at:"left"+(j>=0?"+":"")+j+" top"+(i>=0?"+":"")+i,of:f.window};$(this).removeClass("coral-dialog-dragging");
if(f.options.iframePanel){f.iframePanel.position(e.position)}f._unblockFrames();f._trigger("onDragStop",g,d(h))}})},_makeResizable:function(){var i=this,g=this.options,h=g.resizable,d=this.uiDialog.css("position"),f=typeof h==="string"?h:"n,e,s,w,se,sw,ne,nw";function e(j){return{originalPosition:j.originalPosition,originalSize:j.originalSize,position:j.position,size:j.size}}this.uiDialog.resizable({cancel:".coral-dialog-content",containment:"document",alsoResize:this.element,maxWidth:g.maxWidth,maxHeight:g.maxHeight,minWidth:g.minWidth,minHeight:this._minHeight(),handles:f,start:function(j,k){$(this).addClass("coral-dialog-resizing");i.manualResize=true;if(i.options.iframePanel){i.iframePanel.css(k.position);i.iframePanel.css(k.size)}i._blockFrames();i._trigger("onResizeStart",j,e(k))},resize:function(j,k){if(i.options.iframePanel){i.iframePanel.css(k.position);i.iframePanel.css(k.size)}$.coral.refreshAllComponent(i.element);i._trigger("onResize",j,e(k))},stop:function(j,k){var n=i.uiDialog.offset(),m=n.left-i.document.scrollLeft(),l=n.top-i.document.scrollTop();g.height=i.uiDialog.height();g.width=i.uiDialog.width();g.position={my:"left top",at:"left"+(m>=0?"+":"")+m+" top"+(l>=0?"+":"")+l,of:i.window};$(this).removeClass("coral-dialog-resizing");if(i.options.iframePanel){i.iframePanel.position(g.position);i.iframePanel.position(k.size)}i._unblockFrames();i._trigger("onResizeStop",j,e(k))}}).css("position",d)},_trackFocus:function(){this._on(this.component(),{focusin:function(d){this._makeFocusTarget();this._focusedElement=$(d.target)}})},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this)},_untrackInstance:function(){var e=this._trackingInstances(),d=$.inArray(this,e);if(d!==-1){e.splice(d,1)}},_trackingInstances:function(){var d=this.document.data("coral-dialog-instances");if(!d){d=[];this.document.data("coral-dialog-instances",d)}return d},_minHeight:function(){var d=this.options;return d.height==="auto"?d.minHeight:Math.min(d.minHeight,d.height)
},_position:function(){var e=this.options.position,h=[0,0],f=[],g,d;if(e){if(typeof e==="string"||(typeof e==="object"&&"0" in e)){f=e.split?e.split(" "):[e[0],e[1]];if(f.length===1){f[1]=f[0]}$.each(["left","top"],function(k,j){if(+f[k]===f[k]){h[k]=f[k];f[k]=j}});e={my:f[0]+(h[0]<0?h[0]:"+"+h[0])+" "+f[1]+(h[1]<0?h[1]:"+"+h[1]),at:f.join(" ")}}e=$.extend({},$.coral.dialog.prototype.options.position,e)}else{e=$.coral.dialog.prototype.options.position}d=this.uiDialog.is(":visible");if(!d){this.uiDialog.show()}if(this.options.iframePanel){g=this.iframePanel.is(":visible");if(!g){this.iframePanel.show()}}if(this.options.queue){$("#coral-msgBox").position(e)}else{this.uiDialog.position(e);if(this.options.iframePanel){this.iframePanel.position(e)}}if(!d){this.uiDialog.hide()}if(this.options.iframePanel){if(!g){this.iframePanel.hide()}}},_setOptions:function(f){var g=this,e=false,d={};$.each(f,function(h,i){g._setOption(h,i);if(h in a){e=true}if(h in b){d[h]=i}});if(e&&!$(g.element).is(":hidden")){this._size();this._position()}if(this.uiDialog.is(":data(coral-resizable)")){this.uiDialog.resizable("option",d)}},_setOption:function(f,g){var e,h,d=this.uiDialog;if(f==="dialogClass"){d.removeClass(this.options.dialogClass).addClass(g)}if(f==="disabled"){return}this._super(f,g);if(f==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(f==="buttons"){this._createButtons()}if(f==="maximumText"){this.uiDialogTitlebarMaximum.button({label:""+g})}if(f==="closeText"){this.uiDialogTitlebarClose.button({label:""+g})}if(f==="draggable"){e=d.is(":data(coral-draggable)");if(e&&!g){d.draggable("destroy");if(this.options.iframePanel){this.iframePanel.draggable("destroy")}}if(!e&&g){this._makeDraggable()}}if(f==="position"){this._position()}if(f==="resizable"){h=d.is(":data(coral-resizable)");if(h&&!g){d.resizable("destroy");if(this.options.iframePanel){this.iframePanel.resizable("destroy")}}if(h&&typeof g==="string"){d.resizable("option","handles",g)}if(!h&&g!==false){this._makeResizable()
}}if(f==="title"){this._title(this.uiDialogTitlebar.find(".coral-dialog-title"))}if(f==="subTitle"){this._subTitle(this.uiDialogTitlebar.find(".coral-dialog-subTitle"))}},_size:function(){var d,f,h,e=this.options;this.element.hide().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(e.minWidth>e.width){e.width=e.minWidth}d=this.uiDialog.css({height:"auto",width:e.width}).outerHeight();this.element.show();f=Math.max(0,e.minHeight-d);h=typeof e.maxHeight==="number"?Math.max(0,e.maxHeight-d):"none";if(e.height==="auto"){this.element.css({minHeight:f,maxHeight:h,height:"auto"})}else{var g=/^(\d|[1-9]\d|100)%$/;if(g.test(this.options.height)){this.options.percent=this.options.height;this.element.height(Math.max(0,this._percentToPx()-d))}else{this.element.height(Math.max(0,this.options.height-d))}}if(this.uiDialog.is(":data(coral-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}if(this.options.iframePanel){this.iframePanel.css({width:this.uiDialog.outerWidth(),height:this.uiDialog.outerHeight()})}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var d=$(this);return $("<div>").css({position:"absolute",width:d.outerWidth(),height:d.outerHeight()}).appendTo(d.parent()).offset(d.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(d){if($(d.target).closest(".coral-dialog").length){return true}return !!$(d.target).closest(".coral-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var d=true;this._delay(function(){d=false});if(!this.document.data("coral-dialog-overlays")){this._on(this.document,{focusin:function(e){if(d){return}if(!this._allowInteraction(e)){e.preventDefault();var f=this.document.find(".coral-dialog:visible:last .coral-dialog-content").data(this.componentFullName);if(f&&f._focusTabbable){}}}})}this.overlay=$("<div>").addClass("coral-component-overlay coral-front").appendTo(this._appendTo());
if(this.options.appendTo=="parent"){this.overlay.css({position:"relative"})}else{if($(this.options.appendTo)[0].tagName.toLowerCase()!="body"){this.overlay.css({position:"relative"})}}this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("coral-dialog-overlays",(this.document.data("coral-dialog-overlays")||0)+1)},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){var d=this.document.data("coral-dialog-overlays")-1;if(!d){this.document.unbind("focusin").removeData("coral-dialog-overlays")}else{this.document.data("coral-dialog-overlays",d)}this.overlay.remove();this.overlay=null}},buttonPanel:function(){return this.uiButtonSet},hide:function(){this._isOpen=false;this.component().hide()},_percentToPx:function(){var g=this,d=this.options,f=d.percent,e=$(window);maxHeight=e.height()*parseInt(f.substring(0,f.length-1))/100;return maxHeight},refresh:function(){var g=this,d=this.options,f=d.percent;var e=/^(\d|[1-9]\d|100)%$/;if(e.test(f)&&!d.manualResize){maxHeight=g._percentToPx();d.height=maxHeight;setTimeout(function(){$(g.element).dialog("option","height",maxHeight)},0)}else{}}})}());

/*!
 * 组件库4.0： 消息提示窗
 *
 * 依赖JS文件:
 *	jquery.coral.core.js
 *	jquery.coral.component.js
 *	jquery.coral.mouse.js
 *  jquery.coral.button.js
 *	jquery.coral.draggable.js
 *	jquery.coral.position.js
 *	jquery.coral.resizable.js
 *	jquery.coral.dailog.js
 */
$.messager={loading:{show:function(e){if(!e instanceof jQuery){e=$(e)}var d=e.attr("data-loading-id");if(!d){d=new Date().getTime();e.attr("data-loading-id","loading_"+d)}var f=$("<div id='loading_"+d+"' class='coral-loading'><div class='coral-loading-zone'></div><span class='coral-loading-text'>加载中，请稍后...</span></div>");var b=f.find(".coral-loading-zone");var a=f.find(".coral-loading-text");f.outerWidth(e.outerWidth());f.outerHeight(e.outerHeight());b.outerWidth(e.outerWidth());b.outerHeight(e.outerHeight());f.position({my:"left top",at:"left top",of:e});$(document.body).append(f);var c=(f.outerWidth()-a.outerWidth())/2;a.css({left:c})},hide:function(b){if(!b instanceof jQuery){b=$(b)}var a=b.attr("data-loading-id");if(!a){return}$("#"+a).remove();b.removeAttr("data-loading-id")}},_isType:function(d){var f="",c="",a,e=d.iconCls,g=$.inArray(d.cls,["info","success","warning","error","question","danger","alert"]);if(d.cls&&g>-1){d.type=d.cls}if(!d.type){d.type="info"}var b={warning:"cui-icon-warning2",danger:"cui-icon-cancel-circle2",error:"cui-icon-cancel-circle2",success:"cui-icon-checkmark4",alert:"cui-icon-notification2",info:"cui-icon-notification2",confirm:"cui-icon-question4"};if(d.type=="alert"){c="coral-control-info ";a=b.alert}else{if(d.type=="success"){c="coral-control-success ";a=b.success}else{if(d.type=="danger"){c="coral-control-danger ";a=b.danger}else{if(d.type=="info"){c="coral-control-info ";a=b.info}else{if(d.type=="confirm"){c="coral-control-question ";a=b.confirm}else{if(d.type=="warning"){c="coral-control-warning ";a=b.warning}}}}}}if(typeof e==="boolean"){f=e===true?f="<span class='icon-control "+c+a+"'></span>":""}if(typeof e==="string"){f="<span class='icon-control "+c+d.iconCls+"'></span>"}return f
},_init:function(g,d){if(d.queue===true){if(!$("#coral-msgBox").length){$("<div id='coral-msgBox' class='queueMessage'style='z-index:9999999999'></div>").appendTo("body")}d.appendTo="#coral-msgBox"}var f="",c="",b,e=d.iconCls;if(d.wtype=="messageBox"){g=$("<div class='coral-messagerBox'>"+(d.iconCls||"")+"<span class='coral-messagerBox-content'>"+d.message+"</span></div>").appendTo("body")}else{if(d.wtype=="message"){f=this._isType(d);var a=e===false?"":"hasIcon ";g=$("<div class='"+a+d.type+"' role='alert'>"+f+"<span class='coral-alert-content'>"+d.message+"</span></div>").appendTo("body")}else{if(typeof d.message!=="undefined"&&d.wtype!="message"){f=this._isType(d);g=$("<div class='coral-messager-body'><span class='coral-messager-box'><span class='hasIcon coral-messager-box-content'>"+f+"<span class='coral-messager-content'>"+d.message+"</span></span></span></div>").appendTo("body")}}}return g},message:function(b,a,d){if(typeof b==="string"||typeof b==="boolean"||typeof b==="number"){b={message:b.toString(),wtype:"message"}}if(!d&&typeof a==="function"){d=a;a="info"}if(!a||$.inArray(a,["info","success","warning","error","question","danger","alert"])<0){a="info"}if(a=="error"){a="danger"}b=b||{};b=$.extend(true,{autoOpen:true,title:"消息提示",isMessage:true,show:"slideDown",hide:"slideUp",modal:false,queue:false,onClose:d,draggable:false,resizable:false,width:"auto",maxWidth:600,wtype:"message",type:a,iconCls:true,timeOut:2999},$.message.defaults,$.messageQueue.defaults,b);var c=$.messager._init(c,b);c.css("max-width",b.maxWidth+"px");c.dialog(b);if(b.wtype==="message"){$.messager.messageInstances++;$.messager.messageHeights.push(c.outerHeight())}},messageBox:function(a,c){if(typeof a==="string"||typeof a==="boolean"||typeof a==="number"){a={message:a.toString(),wtype:"messageBox"}}a=a||{};a=$.extend(true,{autoOpen:true,title:"消息提示",show:"slideDown",hide:"slideUp",isMessage:true,modal:false,draggable:false,resizable:false,width:200,wtype:"messageBox",timeOut:2999},$.messageBox.defaults,a);
var b=$.messager._init(b,a);b.dialog(a);return b},messageQueue:function(c,d,e){var b="信息提示";var a={};if(typeof c!=="string"){a=c||"";a.queue=true;e=a.callback;d=a.title||b}if(typeof d==="function"){e=d;d=b}if(d===undefined){d=b}a=$.extend(true,{iconCls:true,queue:true,message:c.toString(),title:d.toString()},$.messageQueue.defaults,a);$.messager.message(a);a.wtype="message"},messageToast:function(d,e,f){var b="信息提示";var a={};if(typeof d!=="string"){a=d||"";f=a.callback;e=a.title||b}if(typeof e==="function"){f=e;e=b}if(e===undefined){e=b}a=$.extend(true,{autoOpen:true,modal:false,show:"slideDown",hide:"slideUp",message:d.toString(),title:e.toString(),isMessage:true,draggable:false,resizable:false,iconCls:true,width:"auto",wtype:"message",timeOut:2999},$.messageToast.defaults,a);a.wtype="message";var c=$.messager._init(c,a);c.dialog(a);return c},alert:function(d,e,f){var b="信息提示";var a={};if(typeof d!=="string"){a=d||"";f=a.callback;e=a.title||b}if(typeof e==="function"){f=e;e=b}if(e===undefined){e=b}a=$.extend(true,{modal:true,message:d.toString(),timeOut:0,title:e.toString(),isMessage:true,width:300,icons:"cui-icon-warning2",iconCls:true,wtype:"alert"},$.alert.defaults,a);if((a.timeOut<=0||isNaN(a.timeOut))&&!a.buttons){a.buttons={"确定":function(){$(this).dialog("close");if(typeof f==="function"){f(true)}return true}}}a.wtype="alert";a.type="alert";var c=$.messager._init(c,a);c.dialog(a);return c},danger:function(d,e,f){var b="错误提示";var a={};if(typeof d!=="string"){a=d||"";f=a.callback;e=a.title||b}if(typeof e==="function"){f=e;e=b}if(e===undefined){e=b}a=$.extend(true,{modal:true,message:d.toString(),timeOut:0,title:e.toString(),isMessage:true,width:300,iconCls:true,icons:"cui-icon-cancel-circle2",wtype:"danger"},$.danger.defaults,a);if((a.timeOut<=0||isNaN(a.timeOut))&&!a.buttons){a.buttons={"确定":function(){$(this).dialog("close");if(typeof f==="function"){f(true)}return true}}}a.wtype="danger";a.type="danger";var c=$.messager._init(c,a);c.dialog(a);return c},success:function(d,e,f){var b="Success";
var a={};if(typeof d!=="string"){a=d||"";f=a.callback;e=a.title||b}if(typeof e==="function"){f=e;e=b}if(e===undefined){e=b}a=$.extend(true,{modal:true,message:d.toString(),timeOut:0,title:e.toString(),isMessage:true,width:300,iconCls:true,icons:"cui-icon-checkmark4",wtype:"success"},$.success.defaults,a);if((a.timeOut<=0||isNaN(a.timeOut))&&!a.buttons){a.buttons={"确定":function(){$(this).dialog("close");if(typeof f==="function"){f(true)}return true}}}a.wtype="success";a.type="success";var c=$.messager._init(c,a);c.dialog(a);return c},confirm:function(g,e,f){var i="确定",a="取消",d={},h={},c="信息提示";if(typeof g!=="string"){h=g||"";f=h.callback;e=h.title||c;i=h.okText?h.okText:i;a=h.cancelText?h.cancelText:a}if(typeof e==="function"){f=e;e=c}if(e===undefined){e=c}h=$.extend(true,{autoOpen:true,title:"确认提示",message:g.toString(),title:e.toString(),iconCls:true,isMessage:true,width:300,show:"slideDown",modal:true,icons:"cui-icon-question4",buttons:d},$.confirm.defaults,h);d[i]=function(){$(this).dialog("close");if(typeof f==="function"){f(true)}return false};d[a]=function(){$(this).dialog("close");if(typeof f==="function"){f(false)}return false};h.type="confirm";h.wtype="confirm";var b=$.messager._init(b,h);b.dialog(h);return b}};$.messager.messageInstances=0;$.messager.messageHeights=[];$.message=$.messager.message;$.messageQueue=$.messager.messageQueue;$.messageBox=$.messager.messageBox;$.messageToast=$.messager.messageToast;$.alert=$.messager.alert;$.danger=$.messager.danger;$.success=$.messager.success;$.confirm=$.messager.confirm;$.message.defaults={position:{my:"top",at:"top top+50",of:window}};$.messageQueue.defaults={position:{my:"top",at:"top top+50",of:window}};$.messageBox.defaults={position:{my:"right bottom",at:"right bottom",of:window}};$.messageToast.defaults={position:{my:"top",at:"top top+50",of:window}};$.alert.defaults={position:{my:"center",at:"center top+200",of:window}};$.danger.defaults={position:{my:"center",at:"center top+200",of:window}};$.success.defaults={position:{my:"center",at:"center top+200",of:window}};
$.confirm.defaults={position:{my:"center",at:"center top+200",of:window}};

$.component("coral.form",{version:"4.0.2",options:{disabled:null,ajaxSubmit:true,novalidate:false,context:"",separator:",",container:"tooltip",requires:null,excluded:[":disabled",":hidden",":not(:visible)"],errTipsType:"first",onCreate:null,url:"",postData:{},target:"",focusFirst:false,showRequiredMark:null,hideRequiredMark:null,onChange:null,triggers:{},exclude:false},_create:function(){var a=this;this._initElement();this._bindEvents();$.data(this.element,"modifiedData",{});$.data(this.element,"originalData",this._getForm());this.element.validate({excluded:this.options.excluded,errorMode:this.options.errorMode,showRequiredMark:this.options.showRequiredMark,hideRequiredMark:this.options.hideRequiredMark});if(this.options.focusFirst){this._focusFirst()}this.element.append($("<input type='text' style='display:none;'></input>"))},_getFields:function(){return this.element.find(".ctrl-form-element")},_getFieldType:function(c){var a=$(c)[0].className.split(" "),b="";for(var d in a){if(a[d].indexOf("coral-validation-")>=0){b=a[d].substr(a[d].indexOf("coral-validation-")+17);return b}}return null},_bindEvents:function(){var c=this,b=this.options,a=this._getFields();a.each(function(d,g){var f=$(g);var e=c._getFieldType(f);f.off(".formonchange").on(e+"onchange.formonchange",function(j,l){if(j.type.indexOf("onchange")!=-1){var i=$(this)[e]("option","name"),k=$(this)[e]("getValue"),h={};h[i]=k;c.updateCoralData(h);c._trigger("onChange",null,{field:this,type:e})}})})},_initElement:function(){var a=this.options;this.element.addClass(a.cls);this.element.appendTo(this.uiBorder);this.element.addClass("coral-form-default");if(a.id!==""){this.element.attr("id",a.id)}if(a.name!==""){this.element.attr("name",a.name)}if(a.action!==""){this.element.attr("action",a.action)}if(a.method!==""){this.element.attr("method",a.method)}if(a.target!==""){this.element.attr("target",a.target)}if(a.context!=""){this.element.attr("context",a.context)}else{this.element.attr("context","body")}},initRequires:function(){this._initRequires()
},_initRequires:function(){var a=this,b=this.element.find($("[class*='coral-validation-']")).parent(":visible").find($("[class*='coral-validation-']"));b.each(function(){var c=this.className,g="",e=c.split(" ");for(var d in e){if(e[d].indexOf("coral-validation-")>=0){g=e[d].substr(e[d].indexOf("coral-validation-")+17);break}}var f=$(this)[g]("option","required");if(typeof f==="boolean"&&f){if(g=="datepicker"){$(this)[g]("component",$(this)).parent("td").prev().addClass("require")}else{$(this)[g]("component").parent("td").prev().addClass("require")}}})},_getCoralType:function(a){var c=$(a)[0].className.split(" "),d="";for(var b in c){if(c[b].indexOf("coral-validation-")>=0){d=c[b].substr(c[b].indexOf("coral-validation-")+17);return d}}},showRequire:function(a){var b=$(a),c=this._getCoralType(a);b[c]("component").parent("td").prev().addClass("require")},hideRequire:function(a){var b=$(a),c=this._getCoralType(a);b[c]("component").parent("td").prev().removeClass("require")},_setOption:function(a,b){if(a=="id"||a=="name"){return}this._super(a,b);return},saveOriginalCoralData:function(a){var b=this;$.each(a,function(c,d){b._updateCoralData("original",c,d)});return},updateCoralData:function(a){var b=this;$.each(a,function(c,d){b._updateCoralData("modified",c,d)});return},_updateCoralData:function(a,b,d){var c=$.data(this.element,a+"Data");c[b]=d;$.data(this.element,a+"Data",c);return},serialize:function(){return $(this.element).serialize()},serializeArray:function(){return $(this.element).serializeArray()},modifiedData:function(a){if((typeof a=="boolean"&&a)){return this._getSerialize("modified")}else{return $.data(this.element,"modifiedData")}},originalData:function(a){if((typeof a=="boolean"&&a)){return this._getSerialize("original")}else{return $.data(this.element,"originalData")}},formData:function(){return this._getForm()},getData:function(){return this.formData()},_getSerialize:function(b){var c=$.data(this.element,b+"Data"),a="";$.each(c,function(e,f){if(typeof f!="Object"){a+=e+"="+f+"&"
}else{for(var d in f){a+=e+"="+f[d]+"&"}}});return a.substr(0,a.length-1)},_getForm:function(){var c=this,d={},b={},a=$(this.element).serializeArray();$(this.element).find(".ctrl-form-element").each(function(){var f=$(this).attr("component-role"),e=$(this)[f]("option","name");if(e){if(f!=="checkbox"&&f!=="radio"){if(d[e]){d[e]=d[e]+c.options.separator+$(this)[f]("getValue")}else{d[e]=$(this)[f]("getValue")}}else{d[e]=$(this)[f]("getValue")}}});$(a).each(function(e,f){if(f.name){if(typeof(d[f.name])==="undefined"){if(b[f.name]){b[f.name]=b[f.name]+c.options.separator+f.value}else{b[f.name]=f.value}}}});$.extend(d,b);return d},_loadData:function(b){var a=this;this._updateData(b,"modified");this._updateData(b,"original");if(typeof b=="object"){$.each(b,function(c,e){if(!a._loadCoralData(c,e)){a._loadNormalData(c,e)}})}},_loadCoralData:function(h,g){var e=this;g=g==null?"":g;var k=e._getCoralFormData();var c=false;for(var d in k){var j=k[d];var b=j.coralType;switch(b){case"radio":if(h==j.name){c=true;if(j.el[b]("option","value")==g&&g!=null){j.el[b]("check")}else{j.el[b]("uncheck")}}break;case"radiolist":if(h==j.name){c=true;if(g==null){g=""}j.el[b]("setValue",g)}break;case"checkbox":if(h==j.name){c=true;if(g==null){g=[""]}if(typeof g!="object"){if(typeof g==="string"){g=g.split(e.options.separator)}else{g=[g]}}for(var f in g){if(j.el[b]("option","value")==g[f]){j.el[b]("check");break}else{j.el[b]("uncheck")}}}break;case"checkboxlist":if(h==j.name){c=true;if(h==j.name){if(g==null){g=""}j.el[b]("setValue",g)}}break;case"combobox":case"combotree":case"combogrid":if(h==j.name){c=true;if(typeof g!="object"){if(typeof g==="string"){g=g.split(e.options.separator)}else{g=[g]}}if(g!=null){j.el[b]("setValues",g)}}break;case"datepicker":if(h==j.name){c=true;if(g!=null){j.el[b]("option","value",g)}}break;case"autocomplete":case"autocompletetree":if(h==j.name){c=true;if(g!=null){j.el[b]("option","value",g)}}break;default:if(h==j.name){c=true;if(g!=null){j.el[b]("option","value",g)}}break
}}return c},_loadNormalData:function(c,e){var d=this,a=d._getNomalFormElements();for(var b in a){if(c==a[b].attr("name")){if(undefined!=a[b].attr("type")&&"radio"==a[b].attr("type")){if(e==a[b].attr("value")){a[b][0].checked=true}else{continue}}else{if(typeof e==="string"&&e.indexOf(d.options.separator)!=-1){e=e.split(d.options.separator)}$(d.element.find("[name="+c+"]")).val(e)}}}return},_getAllFromElements:function(){return this.element.find("[name]")},_getCoralFormData:function(){var a=[];this.element.find(".ctrl-form-element").each(function(){var e=$(this),c=null,d=0,b=["radio","checkbox","combobox","combotree","combogrid","datepicker","checkboxlist","radiolist","autocomplete","textboxlist","autocompletetree"],f=e.attr("component-role");c=e[f]("option","name");if(null!=c){a.push({el:e,name:c,coralType:f})}});return a},_getCoralFormElements:function(){return this.element.find(".coral-form-element")},_getCoralNameJson:function(){var b=this,a={};b._getCoralFormElements().each(function(){var c=$(this).attr("component-role");$(this)[c]("option","name")&&(a[name]=c)});return a},_getNomalFormElements:function(){var c=this,a=[],b=c._getCoralNameJson();c._getAllFromElements().each(function(){if(!b[$(this).attr("name")]){a.push($(this))}});return a},_updateData:function(c,a){var b=$.data(this.element,a+"Data");if(typeof c=="object"){$.each(c,function(e,f){if("original"==a&&typeof b[e]!="undefined"){b[e]=f}else{if("modified"==a&&typeof b[e]!="undefined"){delete b[e]}}})}},resetData:function(){this.reset()},getErrors:function(){var b=this.component().find(".coral-validate-error"),a=[];b.each(function(){var e=$(this).find(".ctrl-form-element"),d=$(e).attr("component-role"),c={};c.errorText=$(this).find(".coral-errorIcon").attr("data-errors");c.required=$(e)[d]("option","required");c.id=$(e)[d]("option","id");c.validType=$(e)[d]("option","validType");c.value=$(e)[d]("getValue");c.element=e[0];c.requiredMsg=$(e)[d]("option","requiredMsg")||$.validate.options.requiredMsg;c.name=$(e)[d]("option","name");
a.push(c)});return a},reset:function(){var a=this;$(this.element).find(".ctrl-form-element").each(function(b){var c=$(this).attr("component-role");$(this)[c]("reset")});$.data(this.element,"modifiedData",{})},_isExclud:function(a,b){if(!b){return false}var d=b.length;for(var c=0;c<d;c++){if("string"===typeof b[c]&&a.is(b[c])){return true}}return false},clear:function(b){var a={};if(b&&b.excluded&&b.excluded instanceof Array){for(var c in b.excluded){var d=b.excluded[c];a[d]=d}}$(this.element).find(".ctrl-form-element").each(function(e){var f=$(this).attr("component-role");if(($(this)[f]("option","readonly")&&a.readonly)||($(this)[f]("option","isLabel")&&a.isLabel)||($(this)[f]("option","disabled")&&a.disabled)){return}switch(f){case"radio":case"checkbox":$(this)[f]("uncheck");break;default:$(this)[f]("setValue","");break}});$.validate.clearErrors(this.element);$.data(this.element,"modifiedData",{})},load:function(a){var c=this,b={},d=[],e=false;if(typeof(a)!=="string"){b=a;if(b.data){d=b.data}else{if(b.url){a=b.url;e=true}else{d=a}}}else{e=true}if(e){$.ajax({url:a,data:$.extend(true,{},this.options.postData,b.postData),async:false,dataType:"json",success:function(f){c._loadData(f);c._trigger($.isFunction(b.onLoad)?b.onLoad:"onLoad",null,[f])},error:function(){c._trigger("onLoadError",null,[])}})}else{this._loadData(d);this._trigger($.isFunction(b.onLoad)?b.onLoad:"onLoad",null,[{content:d}])}},loadData:function(a){this.load(a)},submit:function(a){a=a||{};if(false==this._trigger($.isFunction(a.onSubmit)?a.onSubmit:"onSubmit",null,[])){return false}if(this.options.ajaxSubmit){$.ajax({type:"post",url:$.extend(true,{},this.options.url,a.url),data:$.extend(true,{},this.options.postData,a.postData,this.formData),dataType:"json",success:function(b){this._trigger($.isFunction(a.onSuccess)?a.onSuccess:"onSuccess",null,[{content:b}])},error:function(){}})}else{if(this.valid()){this.element.submit()}else{return false}}},valid:function(){if(this.options.novalidate){return true}return this.element.validate("valid")
},hideErrorTips:function(){$("div.coral-validate-state-error").remove()},_focusFirst:function(){},findFields:function(){return $.coral.findComponent(".ctrl-form-element",this.element)},setIsLabel:function(a){$.coral.setIsLabel(a,this.element)},setReadOnly:function(a){$.coral.setReadOnly(a,this.element)},refresh:function(e){var d,b=this.options,a=b.heightStyle,c=this.component().parent();if(a==="fill"){$.coral.fitParent(this.component(),true);d=c.height();this.component().siblings(":visible").each(function(){var g=$(this),f=g.css("position");if(f==="absolute"||f==="fixed"){return}d-=g.outerHeight(true)});this.element.height(Math.max(0,d-this.element.innerHeight()+this.element.height())).addClass("coral-scroll")}else{if(a==="auto"){this.element.height("")}}$.coral.refreshAllComponent(this.element)}});

$.component("coral.tabs",{version:"4.0.1",delay:300,options:{active:0,collapsible:false,event:"click",loadonce:true,destroyAllonActive:false,heightStyle:"content",hide:null,show:null,loadtext:"加载中，请耐心等候...",method:"GET",newbtn:false,name:null,onTabNew:null,onActivate:null,onLoad:null,beforeActivate:null,beforeLoad:null,beforeTabClose:null,onTabClose:null},_create:function(){var b=this,a=this.options;if(a.method!=null&&a.method!=""){a.method=(a.method+"").toUpperCase()}else{a.method="GET"}this.running=false;this.element.addClass("coral-tabs ctrl-init ctrl-init-tabs coral-component coral-component-content coral-corner-all").toggleClass("coral-tabs-collapsible",a.collapsible);this._processTabs();if(typeof a.newbtn=="boolean"&&a.newbtn){this.addnewbtn()}a.active=this._initialActive();if($.isArray(a.disabled)){a.disabled=$.unique(a.disabled.concat($.map(this.tabs.filter(".coral-state-disabled"),function(c){return b.tabs.index(c)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(a.active)}else{this.active=$()}this._refresh();if(this.active.length){this.load(a.active)}if(this.element.hasClass("coral-tabs-bottom")){$(".coral-tabs-bottom .coral-tabs-nav, .coral-tabs-bottom .coral-tabs-nav > *").removeClass("coral-corner-all coral-corner-top").addClass("coral-corner-bottom")}else{if(this.element.hasClass("coral-tabs-right")){this.element.addClass("coral-tabs-right coral-helper-clearfix").removeClass("coral-corner-top").addClass("coral-corner-left")}else{if(this.element.hasClass("coral-tabs-left")){this.element.removeClass("coral-corner-top").addClass("coral-tabs-left coral-helper-clearfix coral-corner-left")}}}},_isLocal:(function(){var a=/#.*$/;return function(c){var e,d;c=c.cloneNode(false);return c.hash.length>1&&c.href.indexOf("#")!=-1;e=c.href.replace(a,"");d=location.href.replace(a,"");try{e=decodeURIComponent(e)}catch(b){}try{d=decodeURIComponent(d)}catch(b){}return c.hash.length>1&&e===d}})(),_initialActive:function(){var b=this.options.active,a=this.options.collapsible,c=location.hash.substring(1);
if(b===null){if(c){this.tabs.each(function(d,e){if($(e).attr("aria-controls")===c){b=d;return false}})}if(b===null){b=this.tabs.index(this.tabs.filter(".coral-state-active"))}if(b===null||b===-1){b=this.tabs.length?0:false}}if(b!==false){b=this.tabs.index(this.tabs.eq(b));if(b===-1){b=a?false:0}}if(!a&&b===false&&this.anchors.length){b=0}return b},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)}},_tabKeydown:function(c){var b=$(this.document[0].activeElement).closest("li"),a=this.tabs.index(b),d=true;if(this._handlePageNav(c)){return}switch(c.keyCode){case $.coral.keyCode.RIGHT:case $.coral.keyCode.DOWN:a++;break;case $.coral.keyCode.UP:case $.coral.keyCode.LEFT:d=false;a--;break;case $.coral.keyCode.END:a=this.anchors.length-1;break;case $.coral.keyCode.HOME:a=0;break;case $.coral.keyCode.SPACE:c.preventDefault();clearTimeout(this.activating);this._activate(a);return;case $.coral.keyCode.ENTER:c.preventDefault();clearTimeout(this.activating);this._activate(a===this.options.active?false:a);return;default:return}c.preventDefault();clearTimeout(this.activating);a=this._focusNextTab(a,d);if(!c.ctrlKey){b.attr("aria-selected","false");this.tabs.eq(a).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",a)},this.delay)}},_panelKeydown:function(a){if(this._handlePageNav(a)){return}if(a.ctrlKey&&a.keyCode===$.coral.keyCode.UP){a.preventDefault();this.active.focus()}},_handlePageNav:function(a){if(a.altKey&&a.keyCode===$.coral.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(a.altKey&&a.keyCode===$.coral.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(b,c){var a=this.tabs.length-1;function d(){if(b>a){b=0}if(b<0){b=a}return b}while($.inArray(d(),this.options.disabled)!==-1){b=c?b+1:b-1}return b},_focusNextTab:function(a,b){a=this._findNextTab(a,b);this.tabs.eq(a).focus();
return a},_setOption:function(a,b){if(a==="active"){if(typeof b==="string"){this._activate(this._getIndex(b))}else{this._activate(b)}return}if(a==="disabled"){this._setupDisabled(b);return}this._super(a,b);if(a==="collapsible"){this.element.toggleClass("coral-tabs-collapsible",b);if(!b&&this.options.active===false){this._activate(0)}}if(a==="event"){this._setupEvents(b)}if(a==="heightStyle"){this._setupHeightStyle(b)}},_tabId:function(a){return a.attr("aria-controls")||"coral-tabs-"+getNextTabId()},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,a=this.tablist.children(":has(a[href])");b.disabled=$.map(a.filter(".coral-state-disabled"),function(c){return a.index(c)});this._processTabs();if(b.active===false||!this.anchors.length){b.active=false;this.active=$()}else{if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===b.disabled.length){b.active=false;this.active=$()}else{this._activate(this._findNextTab(Math.max(0,b.active-1),false))}}else{b.active=this.tabs.index(this.active)}}this._refresh()},_refresh:function(){var a=this;this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.addClass("coral-tabs-active coral-state-active").attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})}this._setupHeightStyle(this.options.heightStyle)},add:function(g){g=g||{};var f=this.options.disabled,d=null,c=g.tabId,k=null,j=g.label,i=g.ariaControls,m=false,a=g.href,b=g.closeable==undefined?false:g.closeable,l=b===true?"<span class='coral-closable cui-icon-cross2'></span>":"",h=g.content;if(f===true){return
}if(typeof this.options.newbtn=="boolean"&&this.options.newbtn){this.tablist.find("> li:last").remove()}if(i){d=i}else{if(typeof a==="undefined"){d=$({}).uniqueId()[0].id}else{d=a;if(d.indexOf("#")==0){d=d.substr(1)}else{m=true}}}c=c?"id="+c:"";var e="<li "+c+"><a href='#{href}'>"+j+"</a>{closespan}</li>";e=e.replace(/\{closespan\}/g,l);if(!m){k=$(e.replace(/#\{href\}/g,"#"+d))}else{k=$(e.replace(/#\{href\}/g,d));this.component().find(">.coral-tabs-nav").append(k);this.component().tabs("refresh");return}if(i){k.attr("aria-controls",i)}this.component().find(">.coral-tabs-nav").append(k);if(this.element.hasClass("coral-tabs-bottom")){this.component().find(">.coral-tabs-nav").before("<div id='"+d+"'>"+h+"</div>")}else{this.component().append("<div id='"+d+"'>"+h+"</div>")}this.component().tabs("refresh");if(typeof this.options.newbtn=="boolean"&&this.options.newbtn){this.addnewbtn()}},remove:function(a){if(this.options.disabled){return}if(a instanceof Array){for(var b in a){this._remove(a[b])}this._refresh()}else{this._remove(a)}},_remove:function(b){var c;if(typeof b=="undefined"){c=this.options.active}else{if(typeof b=="string"){c=this.getIndexById(b)}else{c=b}}var a=this._getList().find("> li:has(a[href])").eq(c).attr("aria-controls");this.component().find("li[aria-controls='"+a+"']").remove();this.component().find("div#"+a).remove()},addnewbtn:function(){var b=this;var a=$("<li class='coral-tabs-newbtn coral-corner-top'><a class='coral-tabs-anchor'><span class='cui-icon-plus-circle2'></span></a></li>");a.unbind("click").bind("click",function(c){if(true===b.options.disabled){return}b._trigger("onTabNew",null,[])});this.tablist.append(a);b._hoverable(a)},_processTabs:function(){var a=this;this.tablist=this._getList().addClass("coral-tabs-nav coral-helper-reset coral-helper-clearfix coral-component-header coral-corner-all").attr("role","tablist").delegate("> li","mousedown"+this.eventNamespace,function(b){if($(this).is(".coral-state-disabled")){b.preventDefault()}}).delegate(".coral-tabs-anchor","focus"+this.eventNamespace,function(){if($(this).closest("li").is(".coral-state-disabled")){this.blur()
}});this.tabs=this.tablist.find("> li:has(a[href])").addClass("coral-state-default coral-corner-top").attr({role:"tab",tabIndex:-1});this.tabs=this.tabs.filter(function(){if($(this).data("authority")==false){$(this).remove();var b=$(this).find(">a").attr("href");if(b.slice(0,1)=="#"){$("body").find(b).remove()}return false}else{return true}});this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("coral-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(g,e){var b,c,f,d=$(e).uniqueId().attr("id"),h=$(e).closest("li"),j=h.attr("aria-controls");h.find(".coral-closable").addClass("cui-icon-cross2");if(a._isLocal(e)){b=e.hash;f=b.substring(1);c=a.element.find(a._sanitizeSelector(b))}else{f=h.attr("aria-controls")||$({}).uniqueId()[0].id;b="#"+f;c=a.element.find(b);if(!c.length){c=a._createPanel(f);if(a.element.hasClass("coral-tabs-bottom")){c.insertBefore(a.panels[g-1]||a.tablist)}else{c.insertAfter(a.panels[g-1]||a.tablist)}}c.attr("aria-live","polite")}if(c.length){a.panels=a.panels.add(c)}if(j){h.data("coral-tabs-aria-controls",j)}h.attr({"aria-controls":f,"aria-labelledby":d});c.attr("aria-labelledby",d)});this.panels.addClass("coral-tabs-panel coral-component-content coral-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find(">ol,>ul").eq(0)},_createPanel:function(a){return $("<div>").attr("id",a).addClass("coral-tabs-panel coral-component-content coral-corner-bottom").data("coral-tabs-destroy",true)},_setupDisabled:function(c){if($.isArray(c)){if(!c.length){c=false}else{if(c.length===this.anchors.length){c=true}}}for(var b=0,a;(a=this.tabs[b]);b++){if(c===true||$.inArray(b,c)!==-1){$(a).addClass("coral-state-disabled").attr("aria-disabled","true")}else{$(a).removeClass("coral-state-disabled").removeAttr("aria-disabled")}}this.options.disabled=c},_setupEvents:function(c){var b=this;var a={};if(c){$.each(c.split(" "),function(e,d){a[d]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels).add(this.tabs.children("span.cui-icon-cross2")));
this._on(true,this.anchors,{click:function(d){d.preventDefault()}});this._on(this.anchors,a);this._on(this.tabs.children("span.coral-closable"),{click:"_tabClose"});this._on(this.panels,{keydown:"_panelKeydown"});this._on(this.tabs,{keydown:"_tabKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_tabClose:function(f){var c=this;if(c.options.disabled===true){return}var d=$(f.target),h=d.closest("li"),a=h.attr("aria-controls"),g=c._getPanelForTab(h),b={currentTab:h,currentPanel:g,panelId:a};if(c._trigger("beforeTabClose",f,b)===false){return}h.remove();c.element.find("#"+a).remove();c._trigger("onTabClose",f,b);c.refresh()},_setupHeightStyle:function(c){var f,e,h=false,d=this.element.parent();if(c==="fill"){$.coral.fitParent(this.component(),true);f=d.height();e=d.width();d.addClass("coral-noscroll");f-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").not("script").each(function(){var j=$(this),i=j.css("position");if(i==="absolute"||i==="fixed"){return}f-=j.outerHeight()});this.element.children().not(this.panels).each(function(){if($(this).parent().hasClass("coral-tabs-right")||$(this).parent().hasClass("coral-tabs-left")){var i=$(this).css("position");h=true;if(i==="absolute"||i==="fixed"){return}e-=$(this).outerWidth(true);return}f-=$(this).outerHeight(true)});var b;var a=this.panels.filter(":visible");b=a.outerHeight()-a.innerHeight();this.panels.each(function(){$(this).height(Math.max(0,f-b-$(this).innerHeight()+$(this).height()))});if(h){var g=this.element.children("ul");g.height(Math.max(0,f-g.innerHeight()+g.height()))}}else{if(c==="auto"){f=0;this.panels.each(function(){f=Math.max(f,$(this).height("").height());$(this).width("")}).height(f)}}this.panels.each(function(){if($(this).is(":visible")){$.coral.refreshAllComponent($(this))}})},_eventHandler:function(a){var j=this.options,e=this.active,f=$(a.currentTarget),d=f.closest("li"),h=d[0]===e[0],b=h&&j.collapsible,c=b?$():this._getPanelForTab(d),g=!e.length?$():this._getPanelForTab(e),i={oldTab:e,oldPanel:g,newTab:b?$():d,newPanel:c};
a.preventDefault();if(d.hasClass("coral-state-disabled")||d.hasClass("coral-tabs-loading")||this.running||(h&&!j.collapsible)||(this._trigger("beforeActivate",a,i)===false)){return}j.active=b?false:this.tabs.index(d);this.active=h?$():d;if(this.xhr){this.xhr.abort()}if(!g.length&&!c.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(c.length){this.load(this.tabs.index(d),a)}this._toggle(a,i)},_toggle:function(g,f){var e=this,a=f.newPanel,d=f.oldPanel;this.running=true;function c(){e.running=false;e._trigger("onActivate",g,f);$.coral.refreshAllComponent(a)}function b(){f.newTab.closest("li").addClass("coral-tabs-active coral-state-active");if(a.length&&e.options.show){e._show(a,e.options.show,c)}else{a.show();c()}}if(d.length&&this.options.hide){this._hide(d,this.options.hide,function(){f.oldTab.closest("li").removeClass("coral-tabs-active coral-state-active");b()})}else{f.oldTab.closest("li").removeClass("coral-tabs-active coral-state-active");d.hide();b()}d.attr("aria-hidden","true");f.oldTab.attr({"aria-selected":"false","aria-expanded":"false"});if(a.length&&d.length){f.oldTab.attr("tabIndex",-1)}else{if(a.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}a.attr("aria-hidden","false");f.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(b){if(b==-1){return}var a,c=this._findActive(b);if(c[0]===this.active[0]){return}if(!c.length){c=this.active}a=c.find(".coral-tabs-anchor")[0];this._eventHandler({target:a,currentTarget:a,preventDefault:$.noop})},_findActive:function(a){return a===false?$():this.tabs.eq(a)},_getIndex:function(a){if(typeof a==="string"){a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))}return a},getIdByIndex:function(b){var a=this.tablist.children("li").filter(function(){return $(this).hasClass("coral-state-default")});return a.eq(b).attr("aria-controls")},getIndexById:function(b){var a=this.tablist.children("li").filter(function(){return $(this).hasClass("coral-state-default")
});return a.index(a.filter("[aria-controls$='"+b+"']"))},getIndexByTabId:function(b){var a=this.tablist.children("li").filter(function(){return $(this).hasClass("coral-state-default")});return a.index(a.filter("#"+b))},getAllTabId:function(){return this.getPanelIds()},getPanelIds:function(){var a=[];this.tabs.filter("[aria-controls]").each(function(){var b=$(this).attr("aria-controls");if(""!=b){a.push(b)}});return a},getTabIds:function(){var b=[];var a=this.tablist.children("li").each(function(){var c=$(this).attr("id");if(""!=c){b.push(c)}});return b},getTabEl:function(){var a=this.tablist.children("li.coral-state-default");return a},getPanelEl:function(){return{}},getLength:function(){return this.tabs.find("[aria-controls]").length},_destroy:function(){if(this.xhr){this.xhr.abort()}this.element.removeClass("coral-tabs coral-component coral-component-content coral-corner-all coral-tabs-collapsible");this.tablist.removeClass("coral-tabs-nav coral-helper-reset coral-helper-clearfix coral-component-header coral-corner-all").removeAttr("role");this.anchors.removeClass("coral-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tablist.unbind(this.eventNamespace);this.tabs.add(this.panels).each(function(){if($.data(this,"coral-tabs-destroy")){$(this).remove()}else{$(this).removeClass("coral-state-default coral-state-active coral-state-disabled coral-corner-top coral-corner-bottom coral-component-content coral-state-active coral-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}});this.tabs.each(function(){var a=$(this),b=a.data("coral-tabs-aria-controls");if(b){a.attr("aria-controls",b).removeData("coral-tabs-aria-controls")}else{a.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(a){var b=this.options.disabled;
if(b===false){return}if(a===undefined){b=false}else{a=this._getIndex(a);if($.isArray(b)){b=$.map(b,function(c){return c!==a?c:null})}else{b=$.map(this.tabs,function(c,d){return d!==a?d:null})}}this._setupDisabled(b)},disable:function(a){var b=this.options.disabled;if(b===true){return}if(a===undefined){b=true}else{a=this._getIndex(a);if($.inArray(a,b)!==-1){return}if($.isArray(b)){b=$.merge([a],b).sort()}else{b=[a]}}this._setupDisabled(b)},_destroyOtherTabs:function(a){var b=this._getList().find("> li:has(a[href])").eq(a).attr("aria-controls");this.component().children("div:not(#"+b+")").children().remove()},load:function(c,g){c=this._getIndex(c);var f=this,d=this.tabs.eq(c),b=d.find(".coral-tabs-anchor"),a=this._getPanelForTab(d),e={tab:d,panel:a};if(this.options.destroyAllonActive){f._destroyOtherTabs(c)}if(f._isLocal(b[0])||$.data(b[0],"cache")){return}else{if(this.options.loadonce){$.data(b[0],"cache",true)}}this.xhr=$.ajax(this._ajaxSettings(b,g,e));if(this.xhr&&this.xhr.statusText!=="canceled"){d.addClass("coral-tabs-loading");a.attr("aria-busy","true");a.loading({position:"inside",text:"加载中，请耐心等候..."});this.xhr.success(function(h){setTimeout(function(){a.html(h);if($.coral.openTag===true){$.parser.parse(a)}f._trigger("onLoad",g,e)},1)}).complete(function(i,h){setTimeout(function(){if(h==="abort"){f.panels.stop(false,true)}d.removeClass("coral-tabs-loading");a.removeAttr("aria-busy");if(i===f.xhr){delete f.xhr}},1)})}},_ajaxSettings:function(a,d,c){var b=this;return{url:a.attr("href"),beforeSend:function(f,e){return b._trigger("beforeLoad",d,$.extend({jqXHR:f,ajaxSettings:e},c))},type:b.options.method}},_getPanelForTab:function(a){var b=$(a).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))},getPanelForTab:function(a){return this._getPanelForTab(a)}});

(function($,undefined){$.extend($.coral,{tree:{version:"4.0.2"}});var _final={className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch"},editIcon:"cui-icon-pencil7",removeIcon:"cui-icon-cross2",event:{NODECREATED:"tree_nodeCreated",CLICK:"tree_click",EXPAND:"tree_expand",COLLAPSE:"tree_collapse",ASYNC_SUCCESS:"tree_async_success",ASYNC_ERROR:"tree_async_error",REMOVE:"tree_remove",CHECK:"tree_check",DRAG:"tree_drag",DROP:"tree_drop",RENAME:"tree_rename",DRAGMOVE:"tree_dragmove"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul",CHECK:"_check",EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},line:{CENTER:"centerDottedLine",BOTTOM:"bottomDottedLine",ROOTS:"topDottedLine",NOLINE:"noline",LINE:"dottedLine"},folder:{OPEN:"folderOpen",CLOSE:"folderClose",FILE:"file",DOCU:"docu"},arrow:{RIGHT:"arrowRight1",DOWN:"arrowDown1"},node:{CURHOVER:"coral-state-hover",CURSELECTED:"curSelectedNode",CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetTree",TMPTARGET_NODE:"tmpTargetNode"},checkbox:{STYLE:"checkbox",DEFAULT:"coral-state-default",DISABLED:"coral-state-disabled",FALSE:"false",TRUE:"true",UNCHECKED:"unchecked",CHECKED:"checked",PARTIAL:"Partical",FOCUS:"coral-state-focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"}},_option={treeId:"",treeObj:null,clickExpand:false,disabled:false,addDiyDom:null,autoCancelSelected:true,dblClickExpand:true,expandSpeed:"fast",fontCss:{},iconUrl:true,nameIsHTML:false,selectedMulti:true,showIcon:true,showLine:false,showTitle:true,txtSelectedEnable:false,rootInNode:false,showRootNode:true,rootNode:false,keyChildren:"children",keyName:"name",keyTitle:"",keyUrl:"url",simpleDataEnable:false,simpleDataIdKey:"id",simpleDataPIdKey:"pId",simpleDataRootPId:null,keepParent:false,keepLeaf:false,asyncEnable:false,asyncContentType:"application/x-www-form-urlencoded",asyncType:"post",asyncDataType:"text",asyncUrl:"",asyncAutoParam:[],asyncOtherParam:[],asyncDataFilter:null,checkable:false,autoCheckTrigger:false,chkStyle:_final.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:_final.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"},keyChecked:"checked",editable:false,editNameSelectAll:false,showRemoveBtn:true,showRenameBtn:true,removeTitle:"remove",renameTitle:"rename",dragStyle:"line",dragAutoExpandTrigger:false,dragIsCopy:true,dragIsMove:true,dragPrev:true,dragNext:true,dragInner:true,dragMinMoveSize:5,dragBorderMax:10,dragBorderMin:-5,dragMaxShowNodeNum:5,dragAutoOpenTime:500,addHoverDom:null,removeHoverDom:null,beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeReName:null,onDrag:null,onDragMove:null,onDrop:null,onReName:null,beforeCheck:null,onCheck:null,beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onLoadError:null,onLoad:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null};
$.tree={_coreInitRoot:function(setting){var root=$.tree._getRoot(setting);if(!root){root={};$.tree._setRoot(setting,root)}root[setting.keyChildren]=[];root.expandTriggerFlag=false;root.curSelectedList=[];root.noSelection=true;root.createdNodes=[];root.zId=0;root._ver=(new Date()).getTime()},_checkInitRoot:function(setting){var root=$.tree._getRoot(setting);root.radioCheckedList=[]},_editInitRoot:function(setting){var root=$.tree._getRoot(setting),roots=$.tree._getRoots();root.curEditNode=null;root.curEditInput=null;root.curHoverNode=null;root.dragFlag=0;root.dragNodeShowBefore=[];root.dragMaskList=new Array();roots.showHoverDom=true},_coreInitCache:function(setting){var cache=$.tree._getCache(setting);if(!cache){cache={};$.tree._setCache(setting,cache)}cache.nodes=[];cache.doms=[]},_checkInitCache:function(treeId){},_editInitCache:function(treeId){},_coreBindEvent:function(setting){var treeObj=setting.treeObj,cache=consts.event;treeObj.bind(cache.NODECREATED,function(event,treeId,node){$.tree._apply(setting.onNodeCreated,[event,treeId,node])});treeObj.bind(cache.CLICK,function(event,srcEvent,treeId,node,clickFlag){$.tree._apply(setting.onClick,[srcEvent,treeId,node,clickFlag])});treeObj.bind(cache.EXPAND,function(event,treeId,node){$.tree._apply(setting.onExpand,[event,treeId,node])});treeObj.bind(cache.COLLAPSE,function(event,treeId,node){$.tree._apply(setting.onCollapse,[event,treeId,node])});treeObj.bind(cache.ASYNC_SUCCESS,function(event,treeId,node,msg){$.tree._apply(setting.onLoad,[event,treeId,node,msg])});treeObj.bind(cache.ASYNC_ERROR,function(event,treeId,node,XMLHttpRequest,textStatus,errorThrown){$.tree._apply(setting.onLoadError,[event,treeId,node,XMLHttpRequest,textStatus,errorThrown])});treeObj.bind(cache.REMOVE,function(event,treeId,treeNode){$.tree._apply(setting.onRemove,[event,treeId,treeNode])})},_checkBindEvent:function(setting){var treeObj=setting.treeObj,cache=consts.event;treeObj.bind(cache.CHECK,function(event,srcEvent,treeId,node){event.srcEvent=srcEvent;
$.tree._apply(setting.onCheck,[event,treeId,node])})},_editBindEvent:function(setting){var treeObj=setting.treeObj;var cache=consts.event;treeObj.bind(cache.RENAME,function(event,treeId,treeNode,isCancel){$.tree._apply(setting.onReName,[event,treeId,treeNode,isCancel])});treeObj.bind(cache.DRAG,function(event,srcEvent,treeId,treeNodes){$.tree._apply(setting.onDrag,[srcEvent,treeId,treeNodes])});treeObj.bind(cache.DRAGMOVE,function(event,srcEvent,treeId,treeNodes){$.tree._apply(setting.onDragMove,[srcEvent,treeId,treeNodes])});treeObj.bind(cache.DROP,function(event,srcEvent,treeId,treeNodes,targetNode,moveType,isCopy){$.tree._apply(setting.onDrop,[srcEvent,treeId,treeNodes,targetNode,moveType,isCopy])})},_coreUnbindEvent:function(setting){var treeObj=setting.treeObj,cache=consts.event;treeObj.unbind(cache.NODECREATED).unbind(cache.CLICK).unbind(cache.EXPAND).unbind(cache.COLLAPSE).unbind(cache.ASYNC_SUCCESS).unbind(cache.ASYNC_ERROR).unbind(cache.REMOVE)},_checkUnbindEvent:function(setting){var treeObj=setting.treeObj;var cache=consts.event;treeObj.unbind(cache.CHECK)},_editUnbindEvent:function(setting){var treeObj=setting.treeObj;var cache=consts.event;treeObj.unbind(cache.RENAME);treeObj.unbind(cache.DRAG);treeObj.unbind(cache.DRAGMOVE);treeObj.unbind(cache.DROP)},_coreEventProxy:function(event){var target=event.target,setting=$.tree._getSetting(event.data.treeId),tId="",node=null,nodeEventType="",treeEventType="",nodeEventCallback=null,treeEventCallback=null,tmp=null;if($.tree._eqs(event.type,"mousedown")){treeEventType="mousedown"}else{if($.tree._eqs(event.type,"mouseup")){treeEventType="mouseup"}else{if($.tree._eqs(event.type,"contextmenu")){treeEventType="contextmenu"}else{if($.tree._eqs(event.type,"click")){if($.tree._eqs(target.tagName,"span")&&target.getAttribute("treeNode"+consts.id.SWITCH)!==null){tId=$.tree._getNodeMainDom(target).id;nodeEventType="switchNode"}else{tmp=$.tree._getMDom(setting,target,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(tmp){tId=$.tree._getNodeMainDom(tmp).id;
nodeEventType="clickNode"}}}else{if($.tree._eqs(event.type,"dblclick")){treeEventType="dblclick";tmp=$.tree._getMDom(setting,target,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(tmp){tId=$.tree._getNodeMainDom(tmp).id;nodeEventType="switchNode"}}}}}}if(treeEventType.length>0&&tId.length==0){tmp=$.tree._getMDom(setting,target,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(tmp){tId=$.tree._getNodeMainDom(tmp).id}}if(tId.length>0){node=$.tree._getNodeCache(setting,tId);switch(nodeEventType){case"switchNode":if(!node.isParent){nodeEventType=""}else{if($.tree._eqs(event.type,"click")||($.tree._eqs(event.type,"dblclick")&&$.tree._apply(setting.dblClickExpand,[setting.treeId,node],setting.dblClickExpand))){nodeEventCallback=$.tree._onSwitchNode}else{nodeEventType=""}}break;case"clickNode":nodeEventCallback=$.tree._onClickNode;break}}switch(treeEventType){case"mousedown":treeEventCallback=$.tree._onTreeMousedown;break;case"mouseup":treeEventCallback=$.tree._onTreeMouseup;break;case"dblclick":treeEventCallback=$.tree._onTreeDblclick;break;case"contextmenu":treeEventCallback=$.tree._onTreeContextmenu;break}var proxyResult={stop:false,node:node,nodeEventType:nodeEventType,nodeEventCallback:nodeEventCallback,treeEventType:treeEventType,treeEventCallback:treeEventCallback};return proxyResult},_checkEventProxy:function(e){var target=e.target,setting=$.tree._getSetting(e.data.treeId),tId="",node=null,nodeEventType="",treeEventType="",nodeEventCallback=null,treeEventCallback=null;if($.tree._eqs(e.type,"mouseover")){if(setting.checkable&&$.tree._eqs(target.tagName,"span")&&target.getAttribute("treeNode"+consts.id.CHECK)!==null){tId=$.tree._getNodeMainDom(target).id;nodeEventType="mouseoverCheck"}}else{if($.tree._eqs(e.type,"mouseout")){if(setting.checkable&&$.tree._eqs(target.tagName,"span")&&target.getAttribute("treeNode"+consts.id.CHECK)!==null){tId=$.tree._getNodeMainDom(target).id;nodeEventType="mouseoutCheck"}}else{if($.tree._eqs(e.type,"click")){if(setting.checkable&&$.tree._eqs(target.tagName,"span")&&target.getAttribute("treeNode"+consts.id.CHECK)!==null){tId=$.tree._getNodeMainDom(target).id;
nodeEventType="checkNode"}}}}if(tId.length>0){node=$.tree._getNodeCache(setting,tId);switch(nodeEventType){case"checkNode":nodeEventCallback=$.tree._onCheckNode;break;case"mouseoverCheck":nodeEventCallback=$.tree._onMouseoverCheck;break;case"mouseoutCheck":nodeEventCallback=$.tree._onMouseoutCheck;break}}var proxyResult={stop:nodeEventType==="checkNode",node:node,nodeEventType:nodeEventType,nodeEventCallback:nodeEventCallback,treeEventType:treeEventType,treeEventCallback:treeEventCallback};return proxyResult},_editEventProxy:function(e){var target=e.target,setting=$.tree._getSetting(e.data.treeId),relatedTarget=e.relatedTarget,tId="",node=null,nodeEventType="",treeEventType="",nodeEventCallback=null,treeEventCallback=null,tmp=null;if($.tree._eqs(e.type,"mouseover")){tmp=$.tree._getMDom(setting,target,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(tmp){tId=$.tree._getNodeMainDom(tmp).id;nodeEventType="hoverOverNode"}}else{if($.tree._eqs(e.type,"mouseout")){tmp=$.tree._getMDom(setting,relatedTarget,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(!tmp){tId="remove";nodeEventType="hoverOutNode"}}else{if($.tree._eqs(e.type,"mousedown")){tmp=$.tree._getMDom(setting,target,[{tagName:"a",attrName:"treeNode"+consts.id.A}]);if(tmp){tId=$.tree._getNodeMainDom(tmp).id;nodeEventType="mousedownNode"}}}}if(tId.length>0){node=$.tree._getNodeCache(setting,tId);switch(nodeEventType){case"mousedownNode":nodeEventCallback=$.tree._onMousedownNode;break;case"hoverOverNode":nodeEventCallback=$.tree._onHoverOverNode;break;case"hoverOutNode":nodeEventCallback=$.tree._onHoverOutNode;break}}var proxyResult={stop:false,node:node,nodeEventType:nodeEventType,nodeEventCallback:nodeEventCallback,treeEventType:treeEventType,treeEventCallback:treeEventCallback};return proxyResult},_beforeA:function(setting,node,html){var checkedKey=setting.keyChecked;if(setting.checkable){$.tree._makeChkFlag(setting,node);html.push("<span ID='",node.tId,consts.id.CHECK,"' class='",$.tree._makeChkClass(setting,node),"' treeNode",consts.id.CHECK,(node.nocheck===true?" style='display:none;'":""),"></span>")
}},_coreInitNode:function(setting,level,node,parentNode,isFirstNode,isLastNode,openFlag){if(!node){return}var r=$.tree._getRoot(setting),childKey=setting.keyChildren;node.level=level;node.tId=setting.treeId+"_"+(++r.zId);node.parentTId=parentNode?parentNode.tId:null;node.open=(typeof node.open=="string")?$.tree._eqs(node.open,"true"):!!node.open;if(node[childKey]&&node[childKey].length>0){node.isParent=true;node.zAsync=true}else{node.isParent=(typeof node.isParent=="string")?$.tree._eqs(node.isParent,"true"):!!node.isParent;node.open=(node.isParent&&!setting.asyncEnable)?node.open:false;node.zAsync=!node.isParent}node.isFirstNode=isFirstNode;node.isLastNode=isLastNode;node.getParentNode=function(){return $.tree._getNodeCache(setting,node.parentTId)};node.getPreNode=function(){return $.tree._getPreNode(setting,node)};node.getNextNode=function(){return $.tree._getNextNode(setting,node)};node.isAjaxing=false;$.tree._fixPIdKeyValue(setting,node)},_checkInitNode:function(setting,level,node,parentNode,isFirstNode,isLastNode,openFlag){if(!node){return}var checkedKey=setting.keyChecked;if(typeof node[checkedKey]=="string"){node[checkedKey]=$.tree._eqs(node[checkedKey],"true")}node[checkedKey]=!!node[checkedKey];node.checkedOld=node[checkedKey];if(typeof node.nocheck=="string"){node.nocheck=$.tree._eqs(node.nocheck,"true")}node.nocheck=!!node.nocheck||(setting.nocheckInherit&&parentNode&&!!parentNode.nocheck);if(typeof node.chkDisabled=="string"){node.chkDisabled=$.tree._eqs(node.chkDisabled,"true")}node.chkDisabled=!!node.chkDisabled||(setting.chkDisabledInherit&&parentNode&&!!parentNode.chkDisabled);if(typeof node.halfCheck=="string"){node.halfCheck=$.tree._eqs(node.halfCheck,"true")}node.halfCheck=!!node.halfCheck;node.check_Child_State=-1;node.check_Focus=false;node.getCheckStatus=function(){return $.tree._getCheckStatus(setting,node)};if(setting.chkStyle==consts.radio.STYLE&&setting.radioType==consts.radio.TYPE_ALL&&node[checkedKey]){var r=$.tree._getRoot(setting);r.radioCheckedList.push(node)
}},_editInitNode:function(setting,level,node,parentNode,isFirstNode,isLastNode,openFlag){if(!node){return}node.isHover=false;node.editNameFlag=false},_checkTreeTools:function(setting,treeTools){treeTools.checkNode=function(node,checked,checkTypeFlag,callbackFlag){var checkedKey=this.setting.keyChecked;if(node.chkDisabled===true){return}if(checked!==true&&checked!==false){checked=!node[checkedKey]}callbackFlag=!!callbackFlag;if(node[checkedKey]===checked&&!checkTypeFlag){return}else{if(callbackFlag&&$.tree._apply(this.setting.beforeCheck,[this.setting.treeId,node],true)==false){return}}if($.tree._uCanDo(this.setting)&&this.setting.checkable&&node.nocheck!==true){node[checkedKey]=checked;var checkObj=$$(node,consts.id.CHECK,this.setting);if(checkTypeFlag||this.setting.chkStyle===consts.radio.STYLE){$.tree._checkNodeRelation(this.setting,node)}$.tree._setChkClass(this.setting,checkObj,node);$.tree._repairParentChkClassWithSelf(this.setting,node);if(callbackFlag){this.setting.treeObj.trigger(consts.event.CHECK,[null,this.setting.treeId,node])}}};treeTools.checkAllNodes=function(checked){$.tree._repairAllChk(this.setting,!!checked)};treeTools.getCheckedNodes=function(checked){var childKey=this.setting.keyChildren;checked=(checked!==false);return $.tree._getTreeCheckedNodes(this.setting,$.tree._getRoot(this.setting)[childKey],checked)};treeTools.getChangeCheckedNodes=function(){var childKey=this.setting.keyChildren;return $.tree._getTreeChangeCheckedNodes(this.setting,$.tree._getRoot(this.setting)[childKey])};treeTools.setChkDisabled=function(node,disabled,inheritParent,inheritChildren){disabled=!!disabled;inheritParent=!!inheritParent;inheritChildren=!!inheritChildren;$.tree._repairSonChkDisabled(this.setting,node,disabled,inheritChildren);$.tree._repairParentChkDisabled(this.setting,node.getParentNode(),disabled,inheritParent)};var _updateNode=treeTools.updateNode;treeTools.updateNode=function(node,checkTypeFlag){if(_updateNode){_updateNode.apply(treeTools,arguments)}if(!node||!this.setting.checkable){return
}var nObj=$$(node,this.setting);if(nObj.get(0)&&$.tree._uCanDo(this.setting)){var checkObj=$$(node,consts.id.CHECK,this.setting);if(checkTypeFlag==true||this.setting.chkStyle===consts.radio.STYLE){$.tree._checkNodeRelation(this.setting,node)}$.tree._setChkClass(this.setting,checkObj,node);$.tree._repairParentChkClassWithSelf(this.setting,node)}}},_editTreeTools:function(setting,treeTools){treeTools.cancelEditName=function(newName){var root=$.tree._getRoot(this.setting);if(!root.curEditNode){return}$.tree._cancelCurEditNode(this.setting,newName?newName:null,true)};treeTools.copyNode=function(targetNode,node,moveType,isSilent){if(!node){return null}if(targetNode&&!targetNode.isParent&&this.setting.keepLeaf&&moveType===consts.move.TYPE_INNER){return null}var _this=this,newNode=$.tree._clone(node);if(!targetNode){targetNode=null;moveType=consts.move.TYPE_INNER}if(moveType==consts.move.TYPE_INNER){function copyCallback(){$.tree._addNodes(_this.setting,targetNode,[newNode],isSilent)}if($.tree._canAsync(this.setting,targetNode)){$.tree._asyncNode(this.setting,targetNode,isSilent,copyCallback)}else{copyCallback()}}else{$.tree._addNodes(this.setting,targetNode.parentNode,[newNode],isSilent);$.tree._moveNode(this.setting,targetNode,newNode,moveType,false,isSilent)}return newNode};treeTools.editName=function(node){if(!node||!node.tId||node!==$.tree._getNodeCache(this.setting,node.tId)){return}if(node.parentTId){$.tree._expandCollapseParentNode(this.setting,node.getParentNode(),true)}$.tree._editNode(this.setting,node)};treeTools.moveNode=function(targetNode,node,moveType,isSilent){if(!node){return node}if(targetNode&&!targetNode.isParent&&this.setting.keepLeaf&&moveType===consts.move.TYPE_INNER){return null}else{if(targetNode&&((node.parentTId==targetNode.tId&&moveType==consts.move.TYPE_INNER)||$$(node,this.setting).find("#"+targetNode.tId).length>0)){return null}else{if(!targetNode){targetNode=null}}}var _this=this;function moveCallback(){$.tree._moveNode(_this.setting,targetNode,node,moveType,false,isSilent)
}if($.tree._canAsync(this.setting,targetNode)&&moveType===consts.move.TYPE_INNER){$.tree._asyncNode(this.setting,targetNode,isSilent,moveCallback)}else{moveCallback()}return node};treeTools.setEditable=function(editable){this.setting.editable=editable;return this.refresh()}},_addNodeCache:function(setting,node){$.tree._getCache(setting).nodes[$.tree._getNodeCacheId(node.tId)]=node},_getNodeCacheId:function(tId){return tId.substring(tId.lastIndexOf("_")+1)},_addNodesData:function(setting,parentNode,nodes){var childKey=setting.keyChildren;if(!parentNode[childKey]){parentNode[childKey]=[]}if(parentNode[childKey].length>0){parentNode[childKey][parentNode[childKey].length-1].isLastNode=false;$.tree._setNodeLineIcos(setting,parentNode[childKey][parentNode[childKey].length-1])}parentNode.isParent=true;parentNode[childKey]=parentNode[childKey].concat(nodes)},_addSelectedNode:function(setting,node){var root=$.tree._getRoot(setting);if(!$.tree._isSelectedNode(setting,node)){root.curSelectedList.push(node)}},_addCreatedNode:function(setting,node){if(!!setting.onNodeCreated||!!setting.addDiyDom){var root=$.tree._getRoot(setting);root.createdNodes.push(node)}},_fixPIdKeyValue:function(setting,node){if(setting.simpleDataEnable){node[setting.simpleDataPIdKey]=node.parentTId?node.getParentNode()[setting.simpleDataIdKey]:setting.simpleDataRootPId}},_getAfterA:function(setting,node,array){for(var i=0,j=_init.afterA.length;i<j;i++){_init.afterA[i].apply(this,arguments)}},_getBeforeA:function(setting,node,array){for(var i=0,j=_init.beforeA.length;i<j;i++){_init.beforeA[i].apply(this,arguments)}},_getInnerAfterA:function(setting,node,array){for(var i=0,j=_init.innerAfterA.length;i<j;i++){_init.innerAfterA[i].apply(this,arguments)}},_getInnerBeforeA:function(setting,node,array){for(var i=0,j=_init.innerBeforeA.length;i<j;i++){_init.innerBeforeA[i].apply(this,arguments)}},_getCache:function(setting){return caches[setting.treeId]},_getNextNode:function(setting,node){if(!node){return null}var childKey=setting.keyChildren,p=node.parentTId?node.getParentNode():$.tree._getRoot(setting);
for(var i=0,l=p[childKey].length-1;i<=l;i++){if(p[childKey][i]===node){return(i==l?null:p[childKey][i+1])}}return null},_getNodeByParam:function(setting,nodes,key,value){if(!nodes||!key){return null}var childKey=setting.keyChildren;for(var i=0,l=nodes.length;i<l;i++){if(nodes[i][key]==value){return nodes[i]}var tmp=$.tree._getNodeByParam(setting,nodes[i][childKey],key,value);if(tmp){return tmp}}return null},_getNodeCache:function(setting,tId){if(!tId){return null}var n=caches[setting.treeId].nodes[$.tree._getNodeCacheId(tId)];return n?n:null},_getNodeName:function(setting,node){var nameKey=setting.keyName;return""+node[nameKey]},_getNodeTitle:function(setting,node){var t=setting.keyTitle===""?setting.keyName:setting.keyTitle;return""+node[t]},_getNodes:function(setting){return $.tree._getRoot(setting)[setting.keyChildren]},_getNodesByParam:function(setting,nodes,key,value){if(!nodes||!key){return[]}var childKey=setting.keyChildren,result=[];for(var i=0,l=nodes.length;i<l;i++){if(nodes[i][key]==value){result.push(nodes[i])}result=result.concat($.tree._getNodesByParam(setting,nodes[i][childKey],key,value))}return result},_getNodesByParamFuzzy:function(setting,nodes,key,value){if(!nodes||!key){return[]}var childKey=setting.keyChildren,result=[];value=value.toLowerCase();for(var i=0,l=nodes.length;i<l;i++){if(typeof nodes[i][key]=="string"&&nodes[i][key].toLowerCase().indexOf(value)>-1){result.push(nodes[i])}result=result.concat($.tree._getNodesByParamFuzzy(setting,nodes[i][childKey],key,value))}return result},_getNodesByFilter:function(setting,nodes,filter,isSingle,invokeParam){if(!nodes){return(isSingle?null:[])}var childKey=setting.keyChildren,result=isSingle?null:[];for(var i=0,l=nodes.length;i<l;i++){if($.tree._apply(filter,[nodes[i],invokeParam],false)){if(isSingle){return nodes[i]}result.push(nodes[i])}var tmpResult=$.tree._getNodesByFilter(setting,nodes[i][childKey],filter,isSingle,invokeParam);if(isSingle&&!!tmpResult){return tmpResult}result=isSingle?tmpResult:result.concat(tmpResult)
}return result},_getPreNode:function(setting,node){if(!node){return null}var childKey=setting.keyChildren,p=node.parentTId?node.getParentNode():$.tree._getRoot(setting);for(var i=0,l=p[childKey].length;i<l;i++){if(p[childKey][i]===node){return(i==0?null:p[childKey][i-1])}}return null},_getRadioCheckedList:function(setting){var checkedList=$.tree._getRoot(setting).radioCheckedList;for(var i=0,j=checkedList.length;i<j;i++){if(!$.tree._getNodeCache(setting,checkedList[i].tId)){checkedList.splice(i,1);i--;j--}}return checkedList},_getCheckStatus:function(setting,node){if(!setting.checkable||node.nocheck||node.chkDisabled){return null}var checkedKey=setting.keyChecked,r={checked:node[checkedKey],half:node.halfCheck?node.halfCheck:(setting.chkStyle==consts.radio.STYLE?(node.check_Child_State===2):(node[checkedKey]?(node.check_Child_State>-1&&node.check_Child_State<2):(node.check_Child_State>0)))};return r},_getTreeCheckedNodes:function(setting,nodes,checked,results){if(!nodes){return[]}var childKey=setting.keyChildren,checkedKey=setting.keyChecked,onlyOne=(checked&&setting.chkStyle==consts.radio.STYLE&&setting.radioType==consts.radio.TYPE_ALL);results=!results?[]:results;for(var i=0,l=nodes.length;i<l;i++){if(nodes[i].nocheck!==true&&nodes[i].chkDisabled!==true&&nodes[i][checkedKey]==checked){results.push(nodes[i]);if(onlyOne){break}}$.tree._getTreeCheckedNodes(setting,nodes[i][childKey],checked,results);if(onlyOne&&results.length>0){break}}return results},_getTreeChangeCheckedNodes:function(setting,nodes,results){if(!nodes){return[]}var childKey=setting.keyChildren,checkedKey=setting.keyChecked;results=!results?[]:results;for(var i=0,l=nodes.length;i<l;i++){if(nodes[i].nocheck!==true&&nodes[i].chkDisabled!==true&&nodes[i][checkedKey]!=nodes[i].checkedOld){results.push(nodes[i])}$.tree._getTreeChangeCheckedNodes(setting,nodes[i][childKey],results)}return results},_getRoot:function(setting){return setting?roots[setting.treeId]:null},_getRoots:function(){return roots},_getSetting:function(treeId){return settings[treeId]
},_getSettings:function(){return settings},_getTreeTools:function(treeId){var r=this._getRoot(this._getSetting(treeId));return r?r.treeTools:null},_initCache:function(setting){for(var i=0,j=_init.caches.length;i<j;i++){_init.caches[i].apply(this,arguments)}},_initNode:function(setting,level,node,parentNode,preNode,nextNode){for(var i=0,j=_init.nodes.length;i<j;i++){_init.nodes[i].apply(this,arguments)}},_initRoot:function(setting){for(var i=0,j=_init.roots.length;i<j;i++){_init.roots[i].apply(this,arguments)}},_isSelectedNode:function(setting,node){var root=$.tree._getRoot(setting);for(var i=0,j=root.curSelectedList.length;i<j;i++){if(node===root.curSelectedList[i]){return true}}return false},_removeNodeCache:function(setting,node){var childKey=setting.keyChildren;if(node[childKey]){for(var i=0,l=node[childKey].length;i<l;i++){arguments.callee(setting,node[childKey][i])}}$.tree._getCache(setting).nodes[$.tree._getNodeCacheId(node.tId)]=null},_removeSelectedNode:function(setting,node){var root=$.tree._getRoot(setting);for(var i=0,j=root.curSelectedList.length;i<j;i++){if(node===root.curSelectedList[i]||!$.tree._getNodeCache(setting,root.curSelectedList[i].tId)){root.curSelectedList.splice(i,1);i--;j--}}},_setCache:function(setting,cache){caches[setting.treeId]=cache},_setRoot:function(setting,root){roots[setting.treeId]=root},_setTreeTools:function(setting,treeTools){for(var i=0,j=_init.treeTools.length;i<j;i++){_init.treeTools[i].apply(this,arguments)}},_makeChkFlag:function(setting,node){if(!node){return}var childKey=setting.keyChildren,checkedKey=setting.keyChecked,chkFlag=-1;if(node[childKey]){for(var i=0,l=node[childKey].length;i<l;i++){var cNode=node[childKey][i];var tmp=-1;if(setting.chkStyle==consts.radio.STYLE){if(cNode.nocheck===true||cNode.chkDisabled===true){tmp=cNode.check_Child_State}else{if(cNode.halfCheck===true){tmp=2}else{if(cNode[checkedKey]){tmp=2}else{tmp=cNode.check_Child_State>0?2:0}}}if(tmp==2){chkFlag=2;break}else{if(tmp==0){chkFlag=0}}}else{if(setting.chkStyle==consts.checkbox.STYLE){if(cNode.nocheck===true||cNode.chkDisabled===true){tmp=cNode.check_Child_State
}else{if(cNode.halfCheck===true){tmp=1}else{if(cNode[checkedKey]){tmp=(cNode.check_Child_State===-1||cNode.check_Child_State===2)?2:1}else{tmp=(cNode.check_Child_State>0)?1:0}}}if(tmp===1){chkFlag=1;break}else{if(tmp===2&&chkFlag>-1&&i>0&&tmp!==chkFlag){chkFlag=1;break}else{if(chkFlag===2&&tmp>-1&&tmp<2){chkFlag=1;break}else{if(tmp>-1){chkFlag=tmp}}}}}}}}node.check_Child_State=chkFlag},_setSonNodeLevel:function(setting,parentNode,node){if(!node){return}var childKey=setting.keyChildren;node.level=(parentNode)?parentNode.level+1:0;if(!node[childKey]){return}for(var i=0,l=node[childKey].length;i<l;i++){if(node[childKey][i]){$.tree._setSonNodeLevel(setting,node,node[childKey][i])}}},_transformToArrayFormat:function(setting,nodes){if(!nodes){return[]}var childKey=setting.keyChildren,r=[];if($.tree._isArray(nodes)){for(var i=0,l=nodes.length;i<l;i++){r.push(nodes[i]);if(nodes[i][childKey]){r=r.concat($.tree._transformToArrayFormat(setting,nodes[i][childKey]))}}}else{r.push(nodes);if(nodes[childKey]){r=r.concat($.tree._transformToArrayFormat(setting,nodes[childKey]))}}return r},_transformToTreeFormat:function(setting,sNodes){var i,l,key=setting.simpleDataIdKey,parentKey=setting.simpleDataPIdKey,childKey=setting.keyChildren;if(!key||key==""||!sNodes){return[]}if($.tree._isArray(sNodes)){var r=[];var tmpMap=[];for(i=0,l=sNodes.length;i<l;i++){tmpMap[sNodes[i][key]]=sNodes[i]}for(i=0,l=sNodes.length;i<l;i++){if(tmpMap[sNodes[i][parentKey]]&&sNodes[i][key]!=sNodes[i][parentKey]){if(!tmpMap[sNodes[i][parentKey]][childKey]){tmpMap[sNodes[i][parentKey]][childKey]=[]}tmpMap[sNodes[i][parentKey]][childKey].push(sNodes[i])}else{r.push(sNodes[i])}}return r}else{return[sNodes]}},_bindEvent:function(setting){for(var i=0,j=_init.bind.length;i<j;i++){_init.bind[i].apply(this,arguments)}},_unbindEvent:function(setting){for(var i=0,j=_init.unbind.length;i<j;i++){_init.unbind[i].apply(this,arguments)}},_bindTree:function(setting){var eventParam={treeId:setting.treeId},treeObj=setting.treeObj;
if(!setting.txtSelectedEnable){treeObj.bind("selectstart",function(e){var node;var n=e.originalEvent.srcElement.nodeName.toLowerCase();return(n==="input"||n==="textarea")}).css({"-moz-user-select":"-moz-none"})}treeObj.bind("click",eventParam,$.tree._proxy);treeObj.bind("dblclick",eventParam,$.tree._proxy);treeObj.bind("mouseover",eventParam,$.tree._proxy);treeObj.bind("mouseout",eventParam,$.tree._proxy);treeObj.bind("mousedown",eventParam,$.tree._proxy);treeObj.bind("mouseup",eventParam,$.tree._proxy);treeObj.bind("contextmenu",eventParam,$.tree._proxy)},_unbindTree:function(setting){var treeObj=setting.treeObj;treeObj.unbind("click",$.tree._proxy);treeObj.unbind("dblclick",$.tree._proxy);treeObj.unbind("mouseover",$.tree._proxy);treeObj.unbind("mouseout",$.tree._proxy);treeObj.unbind("mousedown",$.tree._proxy);treeObj.unbind("mouseup",$.tree._proxy);treeObj.unbind("contextmenu",$.tree._proxy)},_doProxy:function(e){var results=[];for(var i=0,j=_init.proxys.length;i<j;i++){var proxyResult=_init.proxys[i].apply(this,arguments);results.push(proxyResult);if(proxyResult.stop){break}}return results},_proxy:function(e){var setting=$.tree._getSetting(e.data.treeId);if(!$.tree._uCanDo(setting,e)){return true}var results=$.tree._doProxy(e),r=true,x=false;for(var i=0,l=results.length;i<l;i++){var proxyResult=results[i];if(proxyResult.nodeEventCallback){x=true;r=proxyResult.nodeEventCallback.apply(proxyResult,[e,proxyResult.node])&&r}if(proxyResult.treeEventCallback){x=true;r=proxyResult.treeEventCallback.apply(proxyResult,[e,proxyResult.node])&&r}}return r},_onSwitchNode:function(event,node){var setting=$.tree._getSetting(event.data.treeId);if(node.open){if($.tree._apply(setting.beforeCollapse,[setting.treeId,node],true)==false){return true}$.tree._getRoot(setting).expandTriggerFlag=true;$.tree._switchNode(setting,node)}else{if($.tree._apply(setting.beforeExpand,[setting.treeId,node],true)==false){return true}$.tree._getRoot(setting).expandTriggerFlag=true;$.tree._switchNode(setting,node)
}return true},_onClickNode:function(event,node){var setting=$.tree._getSetting(event.data.treeId),clickFlag=((setting.autoCancelSelected&&(event.ctrlKey||event.metaKey))&&$.tree._isSelectedNode(setting,node))?0:(setting.autoCancelSelected&&(event.ctrlKey||event.metaKey)&&setting.selectedMulti)?2:1;if($.tree._apply(setting.beforeClick,[setting.treeId,node,clickFlag],true)==false){return true}if(clickFlag===0){$.tree._cancelPreSelectedNode(setting,node)}else{$.tree._selectNode(setting,node,clickFlag===2)}setting.treeObj.trigger(consts.event.CLICK,[event,setting.treeId,node,clickFlag]);if(setting.clickExpand){$(setting.treeObj).tree("expandNode",node,null,null,null,true)}return true},_onTreeMousedown:function(event,node){var setting=$.tree._getSetting(event.data.treeId);if($.tree._apply(setting.beforeMouseDown,[setting.treeId,node],true)){$.tree._apply(setting.onMouseDown,[event,setting.treeId,node])}return true},_onTreeMouseup:function(event,node){var setting=$.tree._getSetting(event.data.treeId);if($.tree._apply(setting.beforeMouseUp,[setting.treeId,node],true)){$.tree._apply(setting.onMouseUp,[event,setting.treeId,node])}return true},_onTreeDblclick:function(event,node){var setting=$.tree._getSetting(event.data.treeId);if($.tree._apply(setting.beforeDblClick,[setting.treeId,node],true)){$.tree._apply(setting.onDblClick,[event,setting.treeId,node])}return true},_onTreeContextmenu:function(event,node){var setting=$.tree._getSetting(event.data.treeId);if($.tree._apply(setting.beforeRightClick,[setting.treeId,node],true)){$.tree._apply(setting.onRightClick,[event,setting.treeId,node])}return(typeof setting.onRightClick)!="function"},_onCheckNode:function(event,node){if(node.chkDisabled===true){return false}var setting=$.tree._getSetting(event.data.treeId),checkedKey=setting.keyChecked;if($.tree._apply(setting.beforeCheck,[setting.treeId,node],true)==false){return true}node[checkedKey]=!node[checkedKey];$.tree._checkNodeRelation(setting,node);var checkObj=$$(node,consts.id.CHECK,setting);
$.tree._setChkClass(setting,checkObj,node);$.tree._repairParentChkClassWithSelf(setting,node);setting.treeObj.trigger(consts.event.CHECK,[event,setting.treeId,node]);return true},_onMouseoverCheck:function(event,node){if(node.chkDisabled===true){return false}var setting=$.tree._getSetting(event.data.treeId),checkObj=$$(node,consts.id.CHECK,setting);node.check_Focus=true;$.tree._setChkClass(setting,checkObj,node);return true},_onMouseoutCheck:function(event,node){if(node.chkDisabled===true){return false}var setting=$.tree._getSetting(event.data.treeId),checkObj=$$(node,consts.id.CHECK,setting);node.check_Focus=false;$.tree._setChkClass(setting,checkObj,node);return true},_onHoverOverNode:function(event,node){var setting=$.tree._getSetting(event.data.treeId),root=$.tree._getRoot(setting);if(root.curHoverNode!=node){$.tree._onHoverOutNode(event)}root.curHoverNode=node;$.tree._addHoverDom(setting,node)},_onHoverOutNode:function(event,node){var setting=$.tree._getSetting(event.data.treeId),root=$.tree._getRoot(setting);if(root.curHoverNode&&!$.tree._isSelectedNode(setting,root.curHoverNode)){$.tree._removeTreeDom(setting,root.curHoverNode);root.curHoverNode=null}},_onMousedownNode:function(eventMouseDown,_node){var i,l,setting=$.tree._getSetting(eventMouseDown.data.treeId),root=$.tree._getRoot(setting),roots=$.tree._getRoots();if(eventMouseDown.button==2||!setting.editable||(!setting.dragIsCopy&&!setting.dragIsMove)){return true}var target=eventMouseDown.target,_nodes=$.tree._getRoot(setting).curSelectedList,nodes=[];if(!$.tree._isSelectedNode(setting,_node)){nodes=[_node]}else{for(i=0,l=_nodes.length;i<l;i++){if(_nodes[i].editNameFlag&&$.tree._eqs(target.tagName,"input")&&target.getAttribute("treeNode"+consts.id.INPUT)!==null){return true}nodes.push(_nodes[i]);if(nodes[0].parentTId!==_nodes[i].parentTId){nodes=[_node];break}}}$.tree._editNodeBlur=true;$.tree._cancelCurEditNode(setting);var doc=$(setting.treeObj.get(0).ownerDocument),body=$(setting.treeObj.get(0).ownerDocument.body),curNode,tmpArrow,tmpTarget,isOtherTree=false,targetSetting=setting,sourceSetting=setting,preNode,nextNode,preTmpTargetNodeId=null,preTmpMoveType=null,tmpTargetNodeId=null,moveType=consts.move.TYPE_INNER,mouseDownX=eventMouseDown.clientX,mouseDownY=eventMouseDown.clientY,startTime=(new Date()).getTime();
if($.tree._uCanDo(setting)){doc.bind("mousemove",_docMouseMove)}function _docMouseMove(event){if(root.dragFlag==0&&Math.abs(mouseDownX-event.clientX)<setting.dragMinMoveSize&&Math.abs(mouseDownY-event.clientY)<setting.dragMinMoveSize){return true}var i,l,tmpNode,tmpDom,tmpNodes,childKey=setting.keyChildren;body.css("cursor","pointer");if(root.dragFlag==0){if($.tree._apply(setting.beforeDrag,[setting.treeId,nodes],true)==false){_docMouseUp(event);return true}for(i=0,l=nodes.length;i<l;i++){if(i==0){root.dragNodeShowBefore=[]}tmpNode=nodes[i];if(tmpNode.isParent&&tmpNode.open){$.tree._expandCollapseNode(setting,tmpNode,!tmpNode.open);root.dragNodeShowBefore[tmpNode.tId]=true}else{root.dragNodeShowBefore[tmpNode.tId]=false}}root.dragFlag=1;roots.showHoverDom=false;$.tree._showIfameMask(setting,true);var isOrder=true,lastIndex=-1;if(nodes.length>1){var pNodes=nodes[0].parentTId?nodes[0].getParentNode()[childKey]:$.tree._getNodes(setting);tmpNodes=[];for(i=0,l=pNodes.length;i<l;i++){if(root.dragNodeShowBefore[pNodes[i].tId]!==undefined){if(isOrder&&lastIndex>-1&&(lastIndex+1)!==i){isOrder=false}tmpNodes.push(pNodes[i]);lastIndex=i}if(nodes.length===tmpNodes.length){nodes=tmpNodes;break}}}if(isOrder){preNode=nodes[0].getPreNode();nextNode=nodes[nodes.length-1].getNextNode()}curNode=$$("<ul class='treeDragUL'></ul>",setting);for(i=0,l=nodes.length;i<l;i++){tmpNode=nodes[i];tmpNode.editNameFlag=false;$.tree._selectNode(setting,tmpNode,i>0);$.tree._removeTreeDom(setting,tmpNode);if(i>setting.dragMaxShowNodeNum-1){continue}tmpDom=$$("<li id='"+tmpNode.tId+"_tmp'></li>",setting);tmpDom.append($$(tmpNode,consts.id.A,setting).clone());tmpDom.css("padding","0");tmpDom.children("#"+tmpNode.tId+consts.id.A).removeClass(consts.node.CURSELECTED);curNode.append(tmpDom);if(i==setting.dragMaxShowNodeNum-1){tmpDom=$$("<li id='"+tmpNode.tId+"_moretmp'><a>  ...  </a></li>",setting);curNode.append(tmpDom)}}curNode.attr("id",nodes[0].tId+consts.id.UL+"_tmp");curNode.addClass(setting.treeObj.attr("class"));
curNode.appendTo(body);tmpArrow=$$("<span class='tmpTreeMove_arrow'></span>",setting);tmpArrow.attr("id","treeMove_arrow_tmp");tmpArrow.appendTo(body);setting.treeObj.trigger(consts.event.DRAG,[event,setting.treeId,nodes])}if(root.dragFlag==1){if(tmpTarget&&tmpArrow.attr("id")==event.target.id&&tmpTargetNodeId&&(event.clientX+doc.scrollLeft()+2)>($("#"+tmpTargetNodeId+consts.id.A,tmpTarget).offset().left)){var xT=$("#"+tmpTargetNodeId+consts.id.A,tmpTarget);event.target=(xT.length>0)?xT.get(0):event.target}else{if(tmpTarget){tmpTarget.removeClass(consts.node.TMPTARGET_TREE);if(tmpTargetNodeId){$("#"+tmpTargetNodeId+consts.id.A,tmpTarget).removeClass(consts.node.TMPTARGET_NODE+"_"+consts.move.TYPE_PREV).removeClass(consts.node.TMPTARGET_NODE+"_"+_final.move.TYPE_NEXT).removeClass(consts.node.TMPTARGET_NODE+"_"+_final.move.TYPE_INNER)}}}tmpTarget=null;tmpTargetNodeId=null;isOtherTree=false;targetSetting=setting;var settings=$.tree._getSettings();for(var s in settings){if(settings[s].treeId&&settings[s].editable&&settings[s].treeId!=setting.treeId&&(event.target.id==settings[s].treeId||$(event.target).parents("#"+settings[s].treeId).length>0)){isOtherTree=true;targetSetting=settings[s]}}var docScrollTop=doc.scrollTop(),docScrollLeft=doc.scrollLeft(),treeOffset=targetSetting.treeObj.offset(),scrollHeight=targetSetting.treeObj.get(0).scrollHeight,scrollWidth=targetSetting.treeObj.get(0).scrollWidth,dTop=(event.clientY+docScrollTop-treeOffset.top),dBottom=(targetSetting.treeObj.height()+treeOffset.top-event.clientY-docScrollTop),dLeft=(event.clientX+docScrollLeft-treeOffset.left),dRight=(targetSetting.treeObj.width()+treeOffset.left-event.clientX-docScrollLeft),isTop=(dTop<setting.dragBorderMax&&dTop>setting.dragBorderMin),isBottom=(dBottom<setting.dragBorderMax&&dBottom>setting.dragBorderMin),isLeft=(dLeft<setting.dragBorderMax&&dLeft>setting.dragBorderMin),isRight=(dRight<setting.dragBorderMax&&dRight>setting.dragBorderMin),isTreeInner=dTop>setting.dragBorderMin&&dBottom>setting.dragBorderMin&&dLeft>setting.dragBorderMin&&dRight>setting.dragBorderMin,isTreeTop=(isTop&&targetSetting.treeObj.scrollTop()<=0),isTreeBottom=(isBottom&&(targetSetting.treeObj.scrollTop()+targetSetting.treeObj.height()+10)>=scrollHeight),isTreeLeft=(isLeft&&targetSetting.treeObj.scrollLeft()<=0),isTreeRight=(isRight&&(targetSetting.treeObj.scrollLeft()+targetSetting.treeObj.width()+10)>=scrollWidth);
if(event.target&&$.tree._isChildOrSelf(event.target,targetSetting.treeId)){var targetObj=event.target;while(targetObj&&targetObj.tagName&&!$.tree._eqs(targetObj.tagName,"li")&&targetObj.id!=targetSetting.treeId){targetObj=targetObj.parentNode}var canMove=true;for(i=0,l=nodes.length;i<l;i++){tmpNode=nodes[i];if(targetObj.id===tmpNode.tId){canMove=false;break}else{if($$(tmpNode,setting).find("#"+targetObj.id).length>0){canMove=false;break}}}if(canMove&&event.target&&$.tree._isChildOrSelf(event.target,targetObj.id+consts.id.A)){tmpTarget=$(targetObj);tmpTargetNodeId=targetObj.id}}tmpNode=nodes[0];if(isTreeInner&&$.tree._isChildOrSelf(event.target,targetSetting.treeId)){if(!tmpTarget&&(event.target.id==targetSetting.treeId||isTreeTop||isTreeBottom||isTreeLeft||isTreeRight)&&(isOtherTree||(!isOtherTree&&tmpNode.parentTId))){tmpTarget=targetSetting.treeObj}if(isTop){targetSetting.treeObj.scrollTop(targetSetting.treeObj.scrollTop()-10)}else{if(isBottom){targetSetting.treeObj.scrollTop(targetSetting.treeObj.scrollTop()+10)}}if(isLeft){targetSetting.treeObj.scrollLeft(targetSetting.treeObj.scrollLeft()-10)}else{if(isRight){targetSetting.treeObj.scrollLeft(targetSetting.treeObj.scrollLeft()+10)}}if(tmpTarget&&tmpTarget!=targetSetting.treeObj&&tmpTarget.offset().left<targetSetting.treeObj.offset().left){targetSetting.treeObj.scrollLeft(targetSetting.treeObj.scrollLeft()+tmpTarget.offset().left-targetSetting.treeObj.offset().left)}}curNode.css({top:(event.clientY+docScrollTop+3)+"px",left:(event.clientX+docScrollLeft+3)+"px"});var dX=0;var dY=0;if(tmpTarget&&tmpTarget.attr("id")!=targetSetting.treeId){var tmpTargetNode=tmpTargetNodeId==null?null:$.tree._getNodeCache(targetSetting,tmpTargetNodeId),isCopy=((event.ctrlKey||event.metaKey)&&setting.dragIsMove&&setting.dragIsCopy)||(!setting.dragIsMove&&setting.dragIsCopy),isPrev=!!(preNode&&tmpTargetNodeId===preNode.tId),isNext=!!(nextNode&&tmpTargetNodeId===nextNode.tId),isInner=(tmpNode.parentTId&&tmpNode.parentTId==tmpTargetNodeId),canPrev=(isCopy||!isNext)&&$.tree._apply(targetSetting.dragPrev,[targetSetting.treeId,nodes,tmpTargetNode],!!targetSetting.dragPrev),canNext=(isCopy||!isPrev)&&$.tree._apply(targetSetting.dragNext,[targetSetting.treeId,nodes,tmpTargetNode],!!targetSetting.dragNext),canInner=(isCopy||!isInner)&&!(targetSetting.keepLeaf&&!tmpTargetNode.isParent)&&$.tree._apply(targetSetting.dragInner,[targetSetting.treeId,nodes,tmpTargetNode],!!targetSetting.dragInner);
if(!canPrev&&!canNext&&!canInner){tmpTarget=null;tmpTargetNodeId="";moveType=consts.move.TYPE_INNER;tmpArrow.css({display:"none"});if(window.TreeMoveTimer){clearTimeout(window.TreeMoveTimer);window.TreeMoveTargetNodeTId=null}}else{var tmpTargetA=$("#"+tmpTargetNodeId+consts.id.A,tmpTarget),tmpNextA=tmpTargetNode.isLastNode?null:$("#"+tmpTargetNode.getNextNode().tId+consts.id.A,tmpTarget.next()),tmpTop=tmpTargetA.offset().top,tmpLeft=tmpTargetA.offset().left,prevPercent=canPrev?(canInner?0.25:(canNext?0.5:1)):-1,nextPercent=canNext?(canInner?0.75:(canPrev?0.5:0)):-1,dY_percent=(event.clientY+docScrollTop-tmpTop)/tmpTargetA.height();if((prevPercent==1||dY_percent<=prevPercent&&dY_percent>=-0.2)&&canPrev){dX=1-tmpArrow.width();dY=tmpTop-tmpArrow.height()/2;moveType=consts.move.TYPE_PREV}else{if((nextPercent==0||dY_percent>=nextPercent&&dY_percent<=1.2)&&canNext){dX=1-tmpArrow.width();dY=(tmpNextA==null||(tmpTargetNode.isParent&&tmpTargetNode.open))?(tmpTop+tmpTargetA.height()-tmpArrow.height()/2):(tmpNextA.offset().top-tmpArrow.height()/2);moveType=consts.move.TYPE_NEXT}else{dX=5-tmpArrow.width();dY=tmpTop;moveType=consts.move.TYPE_INNER}}tmpArrow.css({display:"block",top:dY+"px",left:(tmpLeft+dX)+"px"});if(setting.dragStyle=="line"){if(consts.move.TYPE_INNER==moveType){tmpArrow.removeClass("preNext_line").addClass("inner_line")}else{tmpArrow.removeClass("inner_line").addClass("preNext_line")}}tmpTargetA.addClass(consts.node.TMPTARGET_NODE+"_"+moveType);if(preTmpTargetNodeId!=tmpTargetNodeId||preTmpMoveType!=moveType){startTime=(new Date()).getTime()}if(tmpTargetNode&&tmpTargetNode.isParent&&moveType==consts.move.TYPE_INNER){var startTimer=true;if(window.TreeMoveTimer&&window.TreeMoveTargetNodeTId!==tmpTargetNode.tId){clearTimeout(window.TreeMoveTimer);window.TreeMoveTargetNodeTId=null}else{if(window.TreeMoveTimer&&window.TreeMoveTargetNodeTId===tmpTargetNode.tId){startTimer=false}}if(startTimer){window.TreeMoveTimer=setTimeout(function(){if(moveType!=consts.move.TYPE_INNER){return
}if(tmpTargetNode&&tmpTargetNode.isParent&&!tmpTargetNode.open&&(new Date()).getTime()-startTime>targetSetting.dragAutoOpenTime&&$.tree._apply(targetSetting.beforeDragOpen,[targetSetting.treeId,tmpTargetNode],true)){$.tree._switchNode(targetSetting,tmpTargetNode);if(targetSetting.dragAutoExpandTrigger){targetSetting.treeObj.trigger(consts.event.EXPAND,[targetSetting.treeId,tmpTargetNode])}}},targetSetting.dragAutoOpenTime+50);window.TreeMoveTargetNodeTId=tmpTargetNode.tId}}}}else{moveType=consts.move.TYPE_INNER;if(tmpTarget&&$.tree._apply(targetSetting.dragInner,[targetSetting.treeId,nodes,null],!!targetSetting.dragInner)){tmpTarget.addClass(consts.node.TMPTARGET_TREE)}else{tmpTarget=null}tmpArrow.css({display:"none"});if(window.TreeMoveTimer){clearTimeout(window.TreeMoveTimer);window.TreeMoveTargetNodeTId=null}}preTmpTargetNodeId=tmpTargetNodeId;preTmpMoveType=moveType;setting.treeObj.trigger(consts.event.DRAGMOVE,[event,setting.treeId,nodes])}return false}doc.bind("mouseup",_docMouseUp);function _docMouseUp(event){if(window.TreeMoveTimer){clearTimeout(window.TreeMoveTimer);window.TreeMoveTargetNodeTId=null}preTmpTargetNodeId=null;preTmpMoveType=null;doc.unbind("mousemove",_docMouseMove);doc.unbind("mouseup",_docMouseUp);doc.unbind("selectstart",_docSelect);body.css("cursor","auto");if(tmpTarget){tmpTarget.removeClass(consts.node.TMPTARGET_TREE);if(tmpTargetNodeId){$("#"+tmpTargetNodeId+consts.id.A,tmpTarget).removeClass(consts.node.TMPTARGET_NODE+"_"+consts.move.TYPE_PREV).removeClass(consts.node.TMPTARGET_NODE+"_"+_final.move.TYPE_NEXT).removeClass(consts.node.TMPTARGET_NODE+"_"+_final.move.TYPE_INNER)}}$.tree._showIfameMask(setting,false);roots.showHoverDom=true;if(root.dragFlag==0){return}root.dragFlag=0;var i,l,tmpNode;for(i=0,l=nodes.length;i<l;i++){tmpNode=nodes[i];if(tmpNode.isParent&&root.dragNodeShowBefore[tmpNode.tId]&&!tmpNode.open){$.tree._expandCollapseNode(setting,tmpNode,!tmpNode.open);delete root.dragNodeShowBefore[tmpNode.tId]}}if(curNode){curNode.remove()
}if(tmpArrow){tmpArrow.remove()}var isCopy=((event.ctrlKey||event.metaKey)&&setting.dragIsMove&&setting.dragIsCopy)||(!setting.dragIsMove&&setting.dragIsCopy);if(!isCopy&&tmpTarget&&tmpTargetNodeId&&nodes[0].parentTId&&tmpTargetNodeId==nodes[0].parentTId&&moveType==consts.move.TYPE_INNER){tmpTarget=null}if(tmpTarget){var dragTargetNode=tmpTargetNodeId==null?null:$.tree._getNodeCache(targetSetting,tmpTargetNodeId);if($.tree._apply(setting.beforeDrop,[targetSetting.treeId,nodes,dragTargetNode,moveType,isCopy],true)==false){$.tree._selectNodes(sourceSetting,nodes);return}var newNodes=isCopy?$.tree._clone(nodes):nodes;function dropCallback(){if(isOtherTree){if(!isCopy){for(var i=0,l=nodes.length;i<l;i++){$.tree._removeNode(setting,nodes[i])}}if(moveType==consts.move.TYPE_INNER){$.tree._addNodes(targetSetting,dragTargetNode,newNodes)}else{$.tree._addNodes(targetSetting,dragTargetNode.getParentNode(),newNodes);if(moveType==consts.move.TYPE_PREV){for(i=0,l=newNodes.length;i<l;i++){$.tree._moveNode(targetSetting,dragTargetNode,newNodes[i],moveType,false)}}else{for(i=-1,l=newNodes.length-1;i<l;l--){$.tree._moveNode(targetSetting,dragTargetNode,newNodes[l],moveType,false)}}}}else{if(isCopy&&moveType==consts.move.TYPE_INNER){$.tree._addNodes(targetSetting,dragTargetNode,newNodes)}else{if(isCopy){$.tree._addNodes(targetSetting,dragTargetNode.getParentNode(),newNodes)}if(moveType!=consts.move.TYPE_NEXT){for(i=0,l=newNodes.length;i<l;i++){$.tree._moveNode(targetSetting,dragTargetNode,newNodes[i],moveType,false)}}else{for(i=-1,l=newNodes.length-1;i<l;l--){$.tree._moveNode(targetSetting,dragTargetNode,newNodes[l],moveType,false)}}}}$.tree._selectNodes(targetSetting,newNodes);$$(newNodes[0],setting).focus().blur();setting.treeObj.trigger(consts.event.DROP,[event,targetSetting.treeId,newNodes,dragTargetNode,moveType,isCopy])}if(moveType==consts.move.TYPE_INNER&&$.tree._canAsync(targetSetting,dragTargetNode)){$.tree._asyncNode(targetSetting,dragTargetNode,false,dropCallback)}else{dropCallback()
}}else{$.tree._selectNodes(sourceSetting,nodes);setting.treeObj.trigger(consts.event.DROP,[event,setting.treeId,nodes,null,null,null])}}doc.bind("selectstart",_docSelect);function _docSelect(){return false}if(eventMouseDown.preventDefault){eventMouseDown.preventDefault()}return true},_apply:function(fun,param,defaultValue){if(fun==defaultValue&&!$.isFunction(fun)){return defaultValue}if(typeof(fun)=="undefined"||fun==null){return defaultValue}var _fn=$.coral.toFunction(fun);if(!$.isFunction(_fn)){return defaultValue}var ret=_fn.apply(coralTree,param?param:[]);return typeof(ret)=="undefined"?defaultValue:ret},_canAsync:function(setting,node){var childKey=setting.keyChildren;return(setting.asyncEnable&&node&&node.isParent&&!(node.zAsync||(node[childKey]&&node[childKey].length>0)))},_clone:function(obj){if(obj===null){return null}var o=$.tree._isArray(obj)?[]:{};for(var i in obj){o[i]=(obj[i] instanceof Date)?new Date(obj[i].getTime()):(typeof obj[i]==="object"?arguments.callee(obj[i]):obj[i])}return o},_eqs:function(str1,str2){return str1.toLowerCase()===str2.toLowerCase()},_isArray:function(arr){return Object.prototype.toString.apply(arr)==="[object Array]"},_$:function(node,exp,setting){if(!!exp&&typeof exp!="string"){setting=exp;exp=""}if(typeof node=="string"){return $(node,setting?setting.treeObj.get(0).ownerDocument:null)}else{return $("#"+node.tId+exp,setting?setting.treeObj:null)}},_getMDom:function(setting,curDom,targetExpr){if(!curDom){return null}while(curDom&&curDom.id!==setting.treeId){for(var i=0,l=targetExpr.length;curDom.tagName&&i<l;i++){if($.tree._eqs(curDom.tagName,targetExpr[i].tagName)&&curDom.getAttribute(targetExpr[i].attrName)!==null){return curDom}}curDom=curDom.parentNode}return null},_getNodeMainDom:function(target){return($(target).parent("li").get(0)||$(target).parentsUntil("li").parent().get(0))},_isChildOrSelf:function(dom,parentId){return($(dom).closest("#"+parentId).length>0)},_uCanDo:function(setting,e){return true},_getAbs:function(obj){var oRect=obj.getBoundingClientRect(),scrollTop=document.body.scrollTop+document.documentElement.scrollTop,scrollLeft=document.body.scrollLeft+document.documentElement.scrollLeft;
return[oRect.left+scrollLeft,oRect.top+scrollTop]},_inputFocus:function(inputObj){if(inputObj.get(0)){inputObj.focus();$.tree._setCursorPosition(inputObj.get(0),inputObj.val().length)}},_inputSelect:function(inputObj){if(inputObj.get(0)){inputObj.focus();inputObj.select()}},_setCursorPosition:function(obj,pos){if(obj.setSelectionRange){obj.focus();obj.setSelectionRange(pos,pos)}else{if(obj.createTextRange){var range=obj.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select()}}},_showIfameMask:function(setting,showSign){var root=$.tree._getRoot(setting);while(root.dragMaskList.length>0){root.dragMaskList[0].remove();root.dragMaskList.shift()}if(showSign){var iframeList=$$("iframe",setting);for(var i=0,l=iframeList.length;i<l;i++){var obj=iframeList.get(i),r=$.tree._getAbs(obj),dragMask=$$("<div id='treeMask_"+i+"' class='treeMask' style='top:"+r[1]+"px; left:"+r[0]+"px; width:"+obj.offsetWidth+"px; height:"+obj.offsetHeight+"px;'></div>",setting);dragMask.appendTo($$("body",setting));root.dragMaskList.push(dragMask)}}},_addNodes:function(setting,parentNode,newNodes,isSilent){if(setting.keepLeaf&&parentNode&&!parentNode.isParent){return}if(!$.tree._isArray(newNodes)){newNodes=[newNodes]}if(setting.simpleDataEnable){newNodes=$.tree._transformToTreeFormat(setting,newNodes)}if(parentNode){var target_switchObj=$$(parentNode,consts.id.SWITCH,setting),target_icoObj=$$(parentNode,consts.id.ICON,setting),target_ulObj=$$(parentNode,consts.id.UL,setting);if(!parentNode.open){$.tree._replaceSwitchClass(parentNode,target_switchObj,consts.arrow.RIGHT);$.tree._replaceIcoClass(parentNode,target_icoObj,consts.folder.CLOSE);parentNode.open=false;target_ulObj.css({display:"none"})}$.tree._addNodesData(setting,parentNode,newNodes);$.tree._createNodes(setting,parentNode.level+1,newNodes,parentNode);if(!isSilent){$.tree._expandCollapseParentNode(setting,parentNode,true)}}else{$.tree._addNodesData(setting,$.tree._getRoot(setting),newNodes);
$.tree._createNodes(setting,0,newNodes,null)}},_appendNodes:function(setting,level,nodes,parentNode,initFlag,openFlag){if(!nodes){return[]}var html=[],childKey=setting.keyChildren;for(var i=0,l=nodes.length;i<l;i++){var node=nodes[i];if(initFlag){var tmpPNode=(parentNode)?parentNode:$.tree._getRoot(setting),tmpPChild=tmpPNode[childKey],isFirstNode=((tmpPChild.length==nodes.length)&&(i==0)),isLastNode=(i==(nodes.length-1));$.tree._initNode(setting,level,node,parentNode,isFirstNode,isLastNode,openFlag);$.tree._addNodeCache(setting,node)}var childHtml=[];if(node[childKey]&&node[childKey].length>0){childHtml=$.tree._appendNodes(setting,level+1,node[childKey],node,initFlag,openFlag&&node.open)}if(openFlag){$.tree._makeDOMNodeMainBefore(html,setting,node);$.tree._makeDOMNodeNameBefore(html,setting,node);$.tree._addDiyDom(html,setting,node);$.tree._makeDOMNodeLine(html,setting,node);$.tree._getBeforeA(setting,node,html);$.tree._getInnerBeforeA(setting,node,html);$.tree._makeDOMNodeIcon(html,setting,node);$.tree._getInnerAfterA(setting,node,html);$.tree._makeDOMNodeNameAfter(html,setting,node);$.tree._getAfterA(setting,node,html);if(node.isParent&&node.open){$.tree._makeUlHtml(setting,node,html,childHtml.join(""))}$.tree._makeDOMNodeMainAfter(html,setting,node);$.tree._addCreatedNode(setting,node)}}return html},_appendParentULDom:function(setting,node){var html=[],nObj=$$(node,setting);if(!nObj.get(0)&&!!node.parentTId){$.tree._appendParentULDom(setting,node.getParentNode());nObj=$$(node,setting)}var ulObj=$$(node,consts.id.UL,setting);if(ulObj.get(0)){ulObj.remove()}var childKey=setting.keyChildren,childHtml=$.tree._appendNodes(setting,node.level+1,node[childKey],node,false,true);$.tree._makeUlHtml(setting,node,html,childHtml.join(""));nObj.append(html.join(""))},_asyncNode:function(setting,node,isSilent,callback,opts){var opts=opts||{};var i,l;var isInit=setting.isInit;if(node&&!node.isParent){$.tree._apply(callback);return false}else{if(node&&node.isAjaxing){return false}else{if($.tree._apply(setting.beforeAsync,[setting.treeId,node],true)==false){$.tree._apply(callback);
return false}}}if(node){node.isAjaxing=true;var icoObj=$$(node,consts.id.ICON,setting);icoObj.attr({style:"","class":consts.className.BUTTON+" "+consts.className.ICO_LOADING})}var tmpParam={},asyncOtherParam=opts.asyncOtherParam||setting.asyncOtherParam;var autoParams=setting.asyncAutoParam.split(",");var isInit=setting.isInit;for(i=0,l=autoParams.length;node&&i<l;i++){var pKey=autoParams[i].split("="),spKey=pKey;if(pKey.length>1){spKey=pKey[1];pKey=pKey[0]}tmpParam[spKey]=node[pKey]}if($.tree._isArray(asyncOtherParam)){for(i=0,l=asyncOtherParam.length;i<l;i+=2){tmpParam[asyncOtherParam[i]]=asyncOtherParam[i+1]}}else{for(var p in asyncOtherParam){tmpParam[p]=asyncOtherParam[p]}}var _tmpV=$.tree._getRoot(setting)._ver,asyncUrl=$.tree._apply(setting.asyncUrl,[setting.treeId,node],setting.asyncUrl);$.ajax({contentType:setting.asyncContentType,type:setting.asyncType,url:asyncUrl,data:tmpParam,dataType:setting.asyncDataType,success:function(msg){if(_tmpV!=$.tree._getRoot(setting)._ver){return}var newNodes=[];try{if(!msg||msg.length==0){newNodes=[]}else{if(typeof msg=="string"){newNodes=eval("("+msg+")")}else{newNodes=msg}}}catch(err){newNodes=msg}if(node){node.isAjaxing=null;node.zAsync=true}$.tree._setNodeLineIcos(setting,node);if(newNodes&&newNodes!==""){if(isInit){newNodes=$.tree._createRootNodes(setting,newNodes)}newNodes=$.tree._apply(setting.asyncDataFilter,[setting.treeId,node,newNodes],newNodes);$.tree._addNodes(setting,node,!!newNodes?$.tree._clone(newNodes):[],!!isSilent)}else{if(isInit){newNodes=$.tree._createRootNodes(setting,newNodes)}$.tree._addNodes(setting,node,rootNodes,!!isSilent)}if(opts.onLoad){$.tree._apply(opts.onLoad,[setting.treeId,node,msg])}else{setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,node,msg])}$.tree._apply(callback)},error:function(XMLHttpRequest,textStatus,errorThrown){if(_tmpV!=$.tree._getRoot(setting)._ver){return}if(node){node.isAjaxing=null}$.tree._setNodeLineIcos(setting,node);setting.treeObj.trigger(consts.event.ASYNC_ERROR,[setting.treeId,node,XMLHttpRequest,textStatus,errorThrown])
}});return true},_addEditBtn:function(setting,node){if(node.editNameFlag||$$(node,consts.id.EDIT,setting).length>0){return}if(!$.tree._apply(setting.showRenameBtn,[setting.treeId,node],setting.showRenameBtn)){return}var aObj=$$(node,consts.id.A,setting),editStr="<span class='"+consts.className.BUTTON+" "+consts.editIcon+" edit' id='"+node.tId+consts.id.EDIT+"' title='"+$.tree._apply(setting.renameTitle,[setting.treeId,node],setting.renameTitle)+"' treeNode"+consts.id.EDIT+" style='display:none;'></span>";aObj.append(editStr);$$(node,consts.id.EDIT,setting).bind("click",function(){if(!$.tree._uCanDo(setting)||$.tree._apply(setting.beforeEditName,[setting.treeId,node],true)==false){return false}$.tree._editNode(setting,node);return false}).show()},_addRemoveBtn:function(setting,node){if(node.editNameFlag||$$(node,consts.id.REMOVE,setting).length>0){return}if(!$.tree._apply(setting.showRemoveBtn,[setting.treeId,node],setting.showRemoveBtn)){return}var aObj=$$(node,consts.id.A,setting),removeStr="<span class='"+consts.className.BUTTON+" "+consts.removeIcon+" remove' id='"+node.tId+consts.id.REMOVE+"' title='"+$.tree._apply(setting.removeTitle,[setting.treeId,node],setting.removeTitle)+"' treeNode"+consts.id.REMOVE+" style='display:none;'></span>";aObj.append(removeStr);$$(node,consts.id.REMOVE,setting).bind("click",function(){if(!$.tree._uCanDo(setting)||$.tree._apply(setting.beforeRemove,[setting.treeId,node],true)==false){return false}$.tree._removeNode(setting,node);setting.treeObj.trigger(consts.event.REMOVE,[setting.treeId,node]);return false}).bind("mousedown",function(eventMouseDown){return true}).show()},_addHoverDom:function(setting,node){if($.tree._getRoots().showHoverDom){node.isHover=true;if(setting.editable){$.tree._addEditBtn(setting,node);$.tree._addRemoveBtn(setting,node)}$$(node,consts.id.A,setting).addClass(consts.node.CURHOVER);$.tree._apply(setting.addHoverDom,[setting.treeId,node])}},_cancelPreSelectedNode:function(setting,node){var list=$.tree._getRoot(setting).curSelectedList;
for(var i=0,j=list.length-1;j>=i;j--){if(!node||node===list[j]){$$(list[j],consts.id.A,setting).removeClass(consts.node.CURSELECTED);if(node){$.tree._removeSelectedNode(setting,node);break}}}if(!node){$.tree._getRoot(setting).curSelectedList=[]}},_createNodeCallback:function(setting){if(!!setting.onNodeCreated||!!setting.addDiyDom){var root=$.tree._getRoot(setting);while(root.createdNodes.length>0){var node=root.createdNodes.shift();$.tree._apply(setting.addDiyDom,[setting.treeId,node]);if(!!setting.onNodeCreated){setting.treeObj.trigger(consts.event.NODECREATED,[setting.treeId,node])}}}},_createRootNodes:function(setting,nodes){if(setting.simpleDataEnable){nodes=$.tree._transformToTreeFormat(setting,nodes)}if(setting.showRootNode==true){if(setting.rootNode&&typeof(setting.rootNode)!=="boolean"){setting.rootNode.children=nodes;nodes=[setting.rootNode]}}else{if(typeof(setting.rootNode)=="boolean"&&setting.rootNode){if(nodes.length>=1){if(nodes[0].children&&nodes[0].children.length>0){nodes=nodes[0].children}else{nodes=[]}}}}return nodes},_createNodes:function(setting,level,nodes,parentNode){if(!nodes||nodes.length==0){return}var root=$.tree._getRoot(setting),childKey=setting.keyChildren,openFlag=!parentNode||parentNode.open||!!$$(parentNode[childKey][0],setting).get(0);root.createdNodes=[];var treeHtml=$.tree._appendNodes(setting,level,nodes,parentNode,true,openFlag);if(!parentNode){setting.treeObj.append(treeHtml.join(""))}else{var ulObj=$$(parentNode,consts.id.UL,setting);if(ulObj.get(0)){ulObj.append(treeHtml.join(""))}}setting.isInit=false;$.tree._createNodeCallback(setting)},_checkNodeRelation:function(setting,node){var pNode,i,l,childKey=setting.keyChildren,checkedKey=setting.keyChecked,r=consts.radio;if(setting.chkStyle==r.STYLE){var checkedList=$.tree._getRadioCheckedList(setting);if(node[checkedKey]){if(setting.radioType==r.TYPE_ALL){for(i=checkedList.length-1;i>=0;i--){pNode=checkedList[i];if(pNode[checkedKey]&&pNode!=node){pNode[checkedKey]=false;checkedList.splice(i,1);
$.tree._setChkClass(setting,$$(pNode,consts.id.CHECK,setting),pNode);if(pNode.parentTId!=node.parentTId){$.tree._repairParentChkClassWithSelf(setting,pNode)}}}checkedList.push(node)}else{var parentNode=(node.parentTId)?node.getParentNode():$.tree._getRoot(setting);for(i=0,l=parentNode[childKey].length;i<l;i++){pNode=parentNode[childKey][i];if(pNode[checkedKey]&&pNode!=node){pNode[checkedKey]=false;$.tree._setChkClass(setting,$$(pNode,consts.id.CHECK,setting),pNode)}}}}else{if(setting.radioType==r.TYPE_ALL){for(i=0,l=checkedList.length;i<l;i++){if(node==checkedList[i]){checkedList.splice(i,1);break}}}}}else{if(node[checkedKey]&&(!node[childKey]||node[childKey].length==0||setting.chkboxType.Y.indexOf("s")>-1)){$.tree._setSonNodeCheckBox(setting,node,true)}if(!node[checkedKey]&&(!node[childKey]||node[childKey].length==0||setting.chkboxType.N.indexOf("s")>-1)){$.tree._setSonNodeCheckBox(setting,node,false)}if(node[checkedKey]&&setting.chkboxType.Y.indexOf("p")>-1){$.tree._setParentNodeCheckBox(setting,node,true)}if(!node[checkedKey]&&setting.chkboxType.N.indexOf("p")>-1){$.tree._setParentNodeCheckBox(setting,node,false)}}},_cancelCurEditNode:function(setting,forceName,isCancel){var root=$.tree._getRoot(setting),nameKey=setting.keyName,node=root.curEditNode;if(node){var inputObj=root.curEditInput,newName=forceName?forceName:(isCancel?node[nameKey]:inputObj.val());if($.tree._apply(setting.beforeReName,[setting.treeId,node,newName,isCancel],true)===false){return false}else{node[nameKey]=newName;setting.treeObj.trigger(consts.event.RENAME,[setting.treeId,node,isCancel])}var aObj=$$(node,consts.id.A,setting);aObj.removeClass(consts.node.CURSELECTED_EDIT);inputObj.unbind();$.tree._setNodeName(setting,node);node.editNameFlag=false;root.curEditNode=null;root.curEditInput=null;$.tree._selectNode(setting,node,false)}root.noSelection=true;return true},_editNode:function(setting,node){var root=$.tree._getRoot(setting);$.tree._editNodeBlur=false;if($.tree._isSelectedNode(setting,node)&&root.curEditNode==node&&node.editNameFlag){setTimeout(function(){$.tree._inputFocus(root.curEditInput)
},0);return}var nameKey=setting.keyName;node.editNameFlag=true;$.tree._removeTreeDom(setting,node);$.tree._cancelCurEditNode(setting);$.tree._selectNode(setting,node,false);$$(node,consts.id.SPAN,setting).html("<input type=text class='rename' id='"+node.tId+consts.id.INPUT+"' treeNode"+consts.id.INPUT+" >");var inputObj=$$(node,consts.id.INPUT,setting);inputObj.attr("value",node[nameKey]);if(setting.editNameSelectAll){$.tree._inputSelect(inputObj)}else{$.tree._inputFocus(inputObj)}inputObj.bind("blur",function(event){if(!$.tree._editNodeBlur){$.tree._cancelCurEditNode(setting)}}).bind("keydown",function(event){if(event.keyCode=="13"){$.tree._editNodeBlur=true;$.tree._cancelCurEditNode(setting)}else{if(event.keyCode=="27"){$.tree._cancelCurEditNode(setting,null,true)}}}).bind("click",function(event){return false}).bind("dblclick",function(event){return false});$$(node,consts.id.A,setting).addClass(consts.node.CURSELECTED_EDIT);root.curEditInput=inputObj;root.noSelection=false;root.curEditNode=node},_destroy:function(setting){if(!setting){return}$.tree._initCache(setting);$.tree._initRoot(setting);$.tree._unbindTree(setting);$.tree._unbindEvent(setting);setting.treeObj.empty();delete settings[setting.treeId]},_expandCollapseNode:function(setting,node,expandFlag,animateFlag,callback){var root=$.tree._getRoot(setting),childKey=setting.keyChildren;if(!node){$.tree._apply(callback,[]);return}if(root.expandTriggerFlag){var _callback=callback;callback=function(){if(_callback){_callback()}if(node.open){setting.treeObj.trigger(consts.event.EXPAND,[setting.treeId,node])}else{setting.treeObj.trigger(consts.event.COLLAPSE,[setting.treeId,node])}};root.expandTriggerFlag=false}if(!node.open&&node.isParent&&((!$$(node,consts.id.UL,setting).get(0))||(node[childKey]&&node[childKey].length>0&&!$$(node[childKey][0],setting).get(0)))){$.tree._appendParentULDom(setting,node);$.tree._createNodeCallback(setting)}if(node.open==expandFlag){$.tree._apply(callback,[]);return}var ulObj=$$(node,consts.id.UL,setting),switchObj=$$(node,consts.id.SWITCH,setting),icoObj=$$(node,consts.id.ICON,setting);
if(node.isParent){node.open=!node.open;if(node.iconOpen&&node.iconClose){icoObj.attr("style",$.tree._makeNodeIcoStyle(setting,node))}if(node.open){$.tree._replaceSwitchClass(node,switchObj,consts.arrow.DOWN);$.tree._replaceIcoClass(node,icoObj,consts.folder.OPEN);if(animateFlag==false||setting.expandSpeed==""){ulObj.show();$.tree._apply(callback,[])}else{if(node[childKey]&&node[childKey].length>0){ulObj.slideDown(setting.expandSpeed,callback)}else{ulObj.show();$.tree._apply(callback,[])}}}else{$.tree._replaceSwitchClass(node,switchObj,consts.arrow.RIGHT);$.tree._replaceIcoClass(node,icoObj,consts.folder.CLOSE);if(animateFlag==false||setting.expandSpeed==""||!(node[childKey]&&node[childKey].length>0)){ulObj.hide();$.tree._apply(callback,[])}else{ulObj.slideUp(setting.expandSpeed,callback)}}}else{$.tree._apply(callback,[])}},_expandCollapseParentNode:function(setting,node,expandFlag,animateFlag,callback){if(!node){return}if(!node.parentTId){$.tree._expandCollapseNode(setting,node,expandFlag,animateFlag,callback);return}else{$.tree._expandCollapseNode(setting,node,expandFlag,animateFlag)}if(node.parentTId){$.tree._expandCollapseParentNode(setting,node.getParentNode(),expandFlag,animateFlag,callback)}},_expandCollapseSonNode:function(setting,node,expandFlag,animateFlag,callback){var root=$.tree._getRoot(setting),childKey=setting.keyChildren,treeNodes=(node)?node[childKey]:root[childKey],selfAnimateSign=(node)?false:animateFlag,expandTriggerFlag=$.tree._getRoot(setting).expandTriggerFlag;$.tree._getRoot(setting).expandTriggerFlag=false;if(treeNodes){for(var i=0,l=treeNodes.length;i<l;i++){if(treeNodes[i]){$.tree._expandCollapseSonNode(setting,treeNodes[i],expandFlag,selfAnimateSign)}}}$.tree._getRoot(setting).expandTriggerFlag=expandTriggerFlag;$.tree._expandCollapseNode(setting,node,expandFlag,animateFlag,callback)},_makeDOMNodeIcon:function(html,setting,node){var nameStr=$.tree._getNodeName(setting,node),name=setting.nameIsHTML?nameStr:nameStr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
if(setting.formatter){name=$.tree._apply(setting.formatter,[setting,node,name],setting.formatter)}html.push("<span id='",node.tId,consts.id.ICON,"' title='' treeNode",consts.id.ICON," class='",$.tree._makeNodeIcoClass(setting,node),"' style='",$.tree._makeNodeIcoStyle(setting,node),"'></span><span id='",node.tId,consts.id.SPAN,"'>",name,"</span>")},_makeDOMNodeLine:function(html,setting,node){html.push("<span id='",node.tId,consts.id.SWITCH,"' title='' class='",$.tree._makeNodeLineClass(setting,node),"' treeNode",consts.id.SWITCH,"></span>")},_makeDOMNodeMainAfter:function(html,setting,node){html.push("</li>")},_makeDOMNodeMainBefore:function(html,setting,node){html.push("<li ",(node.hidden?"style='display:none;' ":""),"id='",node.tId,"' class='",consts.className.LEVEL,node.level,"' tabindex='0' hidefocus='true' treenode>")},_makeDOMNodeNameAfter:function(html,setting,node){html.push("</a>")},_makeDOMNodeNameBefore:function(html,setting,node){var title=$.tree._getNodeTitle(setting,node),url=$.tree._makeNodeUrl(setting,node),fontcss=$.tree._makeNodeFontCss(setting,node),fontStyle=[];for(var f in fontcss){fontStyle.push(f,":",fontcss[f],";")}html.push("<a id='",node.tId,consts.id.A,"' class='",consts.className.LEVEL,node.level,"' treeNode",consts.id.A,' onclick="',(node.click||""),'" ',((url!=null&&url.length>0)?"href='"+url+"'":"")," target='",$.tree._makeNodeTarget(node),"' style='",fontStyle.join(""),"'");if($.tree._apply(setting.showTitle,[setting.treeId,node],setting.showTitle)&&title){html.push("title='",title.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'")}html.push(">")},_addDiyDom:function(html,setting,node){if(node.level>0){html.push($.tree._getIndent(setting,node))}},_getIndent:function(setting,node){var spaceWidth=16;if(node.getParentNode()){var html="",lineCss,lineClass=["cui-icon"];if(node.getParentNode().getNextNode()){if(setting.showLine){lineClass.push(consts.line.LINE)}else{lineClass.push(consts.line.NOLINE)}html="<span class='treeLine "+lineClass.join("-")+"' style='width:"+spaceWidth+"px;'></span>"
}else{html="<span class='treeIndent' style='width:"+spaceWidth+"px;'></span>"}return $.tree._getIndent(setting,node.getParentNode())+html}else{return""}},_makeNodeFontCss:function(setting,node){var fontCss=$.tree._apply(setting.fontCss,[setting.treeId,node],setting.fontCss);return(fontCss&&((typeof fontCss)!="function"))?fontCss:{}},_makeNodeIcoClass:function(setting,node){var icon=(node.isParent&&node.iconOpen&&node.iconClose)?(node.open?node.iconOpen:node.iconClose):node.icon,nodeIcon=node.isParent?" coral-tree-icon-parent":" coral-tree-icon-leaf";if(!icon){var icoCss=["cui-icon"];if(!node.isAjaxing){icoCss[0]=(node.iconSkin?node.iconSkin+"-":"")+icoCss[0];if(setting.showIcon){if(node.isParent){icoCss.push(node.open?consts.folder.OPEN:consts.folder.CLOSE)}else{icoCss.push(consts.folder.FILE)}}}return consts.className.BUTTON+nodeIcon+" "+icoCss.join("-")}else{if(setting.iconUrl==true){return consts.className.BUTTON}else{return consts.className.BUTTON+" "+icon}}},_makeNodeIcoStyle:function(setting,node){var icoStyle=[];if(!node.isAjaxing){var icon=(node.isParent&&node.iconOpen&&node.iconClose)?(node.open?node.iconOpen:node.iconClose):node.icon;if(icon){if(setting.iconUrl==true){icoStyle.push("background:url(",icon,") 0 0 no-repeat;")}else{$.tree._makeNodeIcoClass(setting,node)}}if(setting.showIcon==false||!$.tree._apply(setting.showIcon,[setting.treeId,node],true)){icoStyle.push("width:0px;height:0px;")}}return icoStyle.join("")},_makeNodeLineClass:function(setting,node){var lineClass=[],classPix="cui-icon-";if(setting.showLine==true){if(node.isParent){lineClass.push(node.open?consts.arrow.DOWN:consts.arrow.RIGHT)}else{if(node.isLastNode){lineClass.push(consts.line.BOTTOM);classPix="cui-icon-"}else{lineClass.push(consts.line.CENTER);classPix="cui-icon-"}}}else{if(node.isParent){lineClass.push(node.open?consts.arrow.DOWN:consts.arrow.RIGHT)}else{lineClass.push(consts.folder.DOCU)}}return $.tree._makeNodeLineClassEx(node)+classPix+lineClass.join("-")},_makeNodeLineClassEx:function(node){return consts.className.BUTTON+" "+consts.className.LEVEL+node.level+" "+consts.className.SWITCH+" "
},_makeNodeTarget:function(node){return(node.target||"_blank")},_makeNodeUrl:function(setting,node){var urlKey=setting.keyUrl;return node[urlKey]?node[urlKey]:null},_makeUlHtml:function(setting,node,html,content){html.push("<ul id='",node.tId,consts.id.UL,"' class='",consts.className.LEVEL,node.level," ",$.tree._makeUlLineClass(setting,node),"' style='display:",(node.open?"block":"none"),"'>");html.push(content);html.push("</ul>")},_makeUlLineClass:function(setting,node){return((setting.showLine&&!node.isLastNode)?consts.line.LINE:"")},_makeChkClass:function(setting,node){var checkedKey=setting.keyChecked,chkName,c=consts.checkbox,r=consts.radio,fullStyle="",stateCls="";if(setting.chkStyle==r.STYLE){fullStyle=(node.check_Child_State<1)?c.CHECKED:c.PARTIAL;chkName="cui-icon-"+setting.chkStyle+"-"+(node[checkedKey]?c.CHECKED:c.UNCHECKED);chkName+=fullStyle==c.PARTIAL?c.PARTIAL:""}else{if(node.halfCheck){fullStyle=c.PARTIAL}else{fullStyle=node[checkedKey]?((node.check_Child_State===2||node.check_Child_State===-1)?c.CHECKED:c.PARTIAL):((node.check_Child_State<1)?c.UNCHECKED:c.PARTIAL)}chkName="cui-icon-"+setting.chkStyle+"-"+(fullStyle==c.PARTIAL?((node[checkedKey]?c.CHECKED:c.UNCHECKED)+c.PARTIAL):fullStyle)}stateCls=(node.check_Focus&&node.chkDisabled!==true)?c.FOCUS:(node.chkDisabled==true?c.DISABLED:c.DEFAULT);return consts.className.BUTTON+" "+stateCls+" "+chkName},_addLine:function(setting,node,oldLevel){var i=typeof(oldLevel)=="undefined"?1:0;var diff="";var arr=$.tree._transformToArrayFormat(setting,node);if(oldLevel!=null&&node.level!=null){diff=(typeof(oldLevel)=="undefined"?0:oldLevel)-(typeof(node.level)=="undefined"?0:node.level)}for(i;i<arr.length;i++){$$(arr[i],consts.id.A,setting).find("span:lt("+(arr[i].level+diff)+")").remove();$$(arr[i],consts.id.A,setting).prepend($.tree._getIndent(setting,arr[i]))}},_lineClass:function(node,showLine){var lineClass=[];if(node.isParent){lineClass=node.open?consts.arrow.DOWN:consts.arrow.RIGHT}else{if(showLine){if(node.level==0&&node.isLastNode&&node.isFirstNode){lineClass=consts.line.NOLINE
}else{if(node.level==0&&node.isFirstNode&&!node.isLastNode){lineClass=consts.line.ROOTS}else{if(node.isLastNode){lineClass=consts.line.BOTTOM}else{lineClass=consts.line.CENTER}}}}}return lineClass},_moveNode:function(setting,targetNode,node,moveType,animateFlag,isSilent){var root=$.tree._getRoot(setting),html=[],childKey=setting.keyChildren;if(targetNode==node){return}if(setting.keepLeaf&&targetNode&&!targetNode.isParent&&moveType==consts.move.TYPE_INNER){return}var oldParentNode=(node.parentTId?node.getParentNode():root),oldLevelP=oldParentNode.level;targetNodeIsRoot=(targetNode===null||targetNode==root);if(targetNodeIsRoot&&targetNode===null){targetNode=root}if(targetNodeIsRoot){moveType=consts.move.TYPE_INNER}var targetParentNode=(targetNode.parentTId?targetNode.getParentNode():root);if(moveType!=consts.move.TYPE_PREV&&moveType!=consts.move.TYPE_NEXT){moveType=consts.move.TYPE_INNER}if(moveType==consts.move.TYPE_INNER){if(targetNodeIsRoot){node.parentTId=null}else{if(!targetNode.isParent){targetNode.isParent=true;targetNode.open=!!targetNode.open;$.tree._setNodeLineIcos(setting,targetNode)}node.parentTId=targetNode.tId}}var targetObj,target_ulObj;if(targetNodeIsRoot){targetObj=setting.treeObj;target_ulObj=targetObj}else{if(!isSilent&&moveType==consts.move.TYPE_INNER){$.tree._expandCollapseNode(setting,targetNode,true,false)}else{if(!isSilent){$.tree._expandCollapseNode(setting,targetNode.getParentNode(),true,false)}}targetObj=$$(targetNode,setting);target_ulObj=$$(targetNode,consts.id.UL,setting);if(!!targetObj.get(0)&&!target_ulObj.get(0)){var ulstr=[];$.tree._makeUlHtml(setting,targetNode,ulstr,"");targetObj.append(ulstr.join(""))}target_ulObj=$$(targetNode,consts.id.UL,setting)}var nodeDom=$$(node,setting);if(!nodeDom.get(0)){nodeDom=$.tree._appendNodes(setting,node.level,[node],null,false,true).join("")}else{if(!targetObj.get(0)){nodeDom.remove()}}if(target_ulObj.get(0)&&moveType==consts.move.TYPE_INNER){target_ulObj.append(nodeDom)}else{if(targetObj.get(0)&&moveType==consts.move.TYPE_PREV){targetObj.before(nodeDom)
}else{if(targetObj.get(0)&&moveType==consts.move.TYPE_NEXT){targetObj.after(nodeDom)}}}var i,l,lineClass=[],tmpSrcIndex=-1,tmpTargetIndex=0,oldNeighbor=null,newNeighbor=null,oldNeighborLevel=null,newNeighborLevel=null,oldLevel=node.level;if(node.isFirstNode){tmpSrcIndex=0;if(oldParentNode[childKey].length>1){oldNeighbor=oldParentNode[childKey][1];oldNeighbor.isFirstNode=true;oldNeighborLevel=oldNeighbor.level}}else{if(node.isLastNode){tmpSrcIndex=oldParentNode[childKey].length-1;oldNeighbor=oldParentNode[childKey][tmpSrcIndex-1];oldNeighbor.isLastNode=true;oldNeighborLevel=oldNeighbor.level}else{for(i=0,l=oldParentNode[childKey].length;i<l;i++){if(oldParentNode[childKey][i].tId==node.tId){tmpSrcIndex=i;break}}}}if(tmpSrcIndex>=0){oldParentNode[childKey].splice(tmpSrcIndex,1)}if(moveType!=consts.move.TYPE_INNER){for(i=0,l=targetParentNode[childKey].length;i<l;i++){if(targetParentNode[childKey][i].tId==targetNode.tId){tmpTargetIndex=i}}}if(moveType==consts.move.TYPE_INNER){if(!targetNode[childKey]){targetNode[childKey]=new Array()}if(targetNode[childKey].length>0){newNeighbor=targetNode[childKey][targetNode[childKey].length-1];newNeighbor.isLastNode=false;newNeighborLevel=newNeighbor.level}targetNode[childKey].splice(targetNode[childKey].length,0,node);node.isLastNode=true;node.isFirstNode=(targetNode[childKey].length==1)}else{if(targetNode.isFirstNode&&moveType==consts.move.TYPE_PREV){targetParentNode[childKey].splice(tmpTargetIndex,0,node);newNeighbor=targetNode;newNeighbor.isFirstNode=false;newNeighborLevel=newNeighbor.level;node.parentTId=targetNode.parentTId;node.isFirstNode=true;node.isLastNode=false}else{if(targetNode.isLastNode&&moveType==consts.move.TYPE_NEXT){targetParentNode[childKey].splice(tmpTargetIndex+1,0,node);newNeighbor=targetNode;newNeighbor.isLastNode=false;newNeighborLevel=newNeighbor.level;node.parentTId=targetNode.parentTId;node.isFirstNode=false;node.isLastNode=true}else{if(moveType==consts.move.TYPE_PREV){targetParentNode[childKey].splice(tmpTargetIndex,0,node)
}else{targetParentNode[childKey].splice(tmpTargetIndex+1,0,node)}node.parentTId=targetNode.parentTId;node.isFirstNode=false;node.isLastNode=false}}}$.tree._fixPIdKeyValue(setting,node);$.tree._setSonNodeLevel(setting,node.getParentNode(),node);var nodeObj=$$(node,consts.id.SWITCH,setting);$.tree._setNodeLineIcos(setting,node);$.tree._repairNodeLevelClass(setting,node,oldLevel);$.tree._addLine(setting,node,oldLevel);lineClass=$.tree._lineClass(node,setting.showLine);$.tree._replaceSwitchClass(node,nodeObj,lineClass);if(!setting.keepParent&&oldParentNode[childKey].length<1){oldParentNode.isParent=false;oldParentNode.open=false;var tmp_ulObj=$$(oldParentNode,consts.id.UL,setting),tmp_switchObj=$$(oldParentNode,consts.id.SWITCH,setting),tmp_icoObj=$$(oldParentNode,consts.id.ICON,setting);lineClass=$.tree._lineClass(oldParentNode,setting.showLine);$.tree._replaceSwitchClass(oldParentNode,tmp_switchObj,lineClass);$.tree._replaceIcoClass(oldParentNode,tmp_icoObj,consts.folder.FILE);tmp_ulObj.css("display","none");$.tree._addLine(setting,oldParentNode,oldLevelP)}else{if(oldNeighbor){$.tree._setNodeLineIcos(setting,oldNeighbor);$.tree._addLine(setting,oldNeighbor,oldNeighborLevel)}}if(newNeighbor){tmp_switchObj=$$(newNeighbor,consts.id.SWITCH,setting);$.tree._setNodeLineIcos(setting,newNeighbor);$.tree._addLine(setting,newNeighbor,newNeighborLevel);lineClass=$.tree._lineClass(newNeighbor,setting.showLine);$.tree._replaceSwitchClass(newNeighbor,tmp_switchObj,lineClass)}if(!!setting.check&&setting.checkable&&$.tree._repairChkClass){$.tree._repairChkClass(setting,oldParentNode);$.tree._repairParentChkClassWithSelf(setting,oldParentNode);if(oldParentNode!=node.parent){$.tree._repairParentChkClassWithSelf(setting,node)}}if(!isSilent){$.tree._expandCollapseParentNode(setting,node.getParentNode(),true,animateFlag)}},_removeChildNodes:function(setting,node){if(!node){return}var childKey=setting.keyChildren,nodes=node[childKey];if(!nodes){return}for(var i=0,l=nodes.length;i<l;i++){$.tree._removeNodeCache(setting,nodes[i])
}$.tree._removeSelectedNode(setting);delete node[childKey];if(!setting.keepParent){node.isParent=false;node.open=false;var tmp_switchObj=$$(node,consts.id.SWITCH,setting),tmp_icoObj=$$(node,consts.id.ICON,setting);$.tree._replaceSwitchClass(node,tmp_switchObj,consts.line.CENTER);$.tree._replaceIcoClass(node,tmp_icoObj,consts.line.CENTER);$$(node,consts.id.UL,setting).remove()}else{$$(node,consts.id.UL,setting).empty()}},_showNode:function(setting,node,options){node.hidden=false;$.tree._initShowForExCheck(setting,node);$$(node,setting).show();if(typeof options!=="undefined"&&typeof options.showParents!=="undefined"&&options.showParents&&null!==node.getParentNode()){$.tree._showNode(setting,node.getParentNode(),options)}},_initShowForExCheck:function(setting,n){if(!n.hidden&&setting.checkable){if(typeof n._nocheck!="undefined"){n.nocheck=n._nocheck;delete n._nocheck}if($.tree._setChkClass){var checkObj=$$(n,consts.id.CHECK,setting);$.tree._setChkClass(setting,checkObj,n)}if($.tree._repairParentChkClassWithSelf){$.tree._repairParentChkClassWithSelf(setting,n)}}},_showNodes:function(setting,nodes,options){if(!nodes||nodes.length==0){return}var pList={},i,j;for(i=0,j=nodes.length;i<j;i++){var n=nodes[i];if(!pList[n.parentTId]){var pn=n.getParentNode();pList[n.parentTId]=(pn===null)?$.tree._getRoot(setting):n.getParentNode()}$.tree._showNode(setting,n,options)}for(var tId in pList){var children=pList[tId][setting.keyChildren];$.tree._setFirstNodeForShow(setting,children);$.tree._setLastNodeForShow(setting,children)}},_setFirstNodeForShow:function(setting,nodes){var n,i,j,first,old;for(i=0,j=nodes.length;i<j;i++){n=nodes[i];if(!first&&!n.hidden&&n.isFirstNode){first=n;break}else{if(!first&&!n.hidden&&!n.isFirstNode){n.isFirstNode=true;first=n;$.tree._setNodeLineIcos(setting,n)}else{if(first&&n.isFirstNode){n.isFirstNode=false;old=n;$.tree._setNodeLineIcos(setting,n);break}else{n=null}}}}return{"new":first,old:old}},_setLastNodeForShow:function(setting,nodes){var n,i,j,last,old;
for(i=nodes.length-1;i>=0;i--){n=nodes[i];if(!last&&!n.hidden&&n.isLastNode){last=n;break}else{if(!last&&!n.hidden&&!n.isLastNode){n.isLastNode=true;last=n;$.tree._setNodeLineIcos(setting,n)}else{if(last&&n.isLastNode){n.isLastNode=false;old=n;$.tree._setNodeLineIcos(setting,n);break}else{n=null}}}}return{"new":last,old:old}},_hideNode:function(setting,node,options){node.hidden=true;node.isFirstNode=false;node.isLastNode=false;$.tree._initHideForExCheck(setting,node);$.tree._cancelPreSelectedNode(setting,node);$$(node,setting).hide()},_initHideForExCheck:function(setting,n){if(n.hidden&&setting.checkable){if(typeof n._nocheck=="undefined"){n._nocheck=!!n.nocheck;n.nocheck=true}n.check_Child_State=-1;if($.tree._repairParentChkClassWithSelf){$.tree._repairParentChkClassWithSelf(setting,n)}}},_hideNodes:function(setting,nodes,options){if(!nodes||nodes.length==0){return}var pList={},i,j;for(i=0,j=nodes.length;i<j;i++){var n=nodes[i];if((n.isFirstNode||n.isLastNode)&&!pList[n.parentTId]){var pn=n.getParentNode();pList[n.parentTId]=(pn===null)?$.tree._getRoot(setting):n.getParentNode()}$.tree._hideNode(setting,n,options)}for(var tId in pList){var children=pList[tId][setting.keyChildren];$.tree._setFirstNodeForHide(setting,children);$.tree._setLastNodeForHide(setting,children)}},_setFirstNodeForHide:function(setting,nodes){var n,i,j;for(i=0,j=nodes.length;i<j;i++){n=nodes[i];if(n.isFirstNode){break}if(!n.hidden&&!n.isFirstNode){n.isFirstNode=true;$.tree._setNodeLineIcos(setting,n);break}else{n=null}}return n},_setLastNodeForHide:function(setting,nodes){var n,i;for(i=nodes.length-1;i>=0;i--){n=nodes[i];if(n.isLastNode){break}if(!n.hidden&&!n.isLastNode){n.isLastNode=true;$.tree._setNodeLineIcos(setting,n);break}else{n=null}}return n},_setFirstNode:function(setting,parentNode){var childKey=setting.keyChildren,childLength=parentNode[childKey].length;if(childLength>0){parentNode[childKey][0].isFirstNode=true}},_setLastNode:function(setting,parentNode){var childKey=setting.keyChildren,childLength=parentNode[childKey].length;
if(childLength>0){parentNode[childKey][childLength-1].isLastNode=true}},_removeNode:function(setting,node){var root=$.tree._getRoot(setting),lineClass=[],childKey=setting.keyChildren,oldLevel=node.level,prevNode=node.getPreNode(),nextNode=node.getNextNode(),parentNode=(node.parentTId)?node.getParentNode():root,parentNodeOldlevel=parentNode.level;node.isFirstNode=false;node.isLastNode=false;node.getPreNode=function(){return null};node.getNextNode=function(){return null};if(!$.tree._getNodeCache(setting,node.tId)){return}$$(node,setting).remove();$.tree._removeNodeCache(setting,node);$.tree._removeSelectedNode(setting,node);for(var i=0,l=parentNode[childKey].length;i<l;i++){if(parentNode[childKey][i].tId==node.tId){parentNode[childKey].splice(i,1);break}}$.tree._setFirstNode(setting,parentNode);$.tree._setLastNode(setting,parentNode);var tmp_ulObj,tmp_switchObj,tmp_icoObj,childLength=parentNode[childKey].length;if(!setting.keepParent&&childLength==0){parentNode.isParent=false;parentNode.open=false;tmp_ulObj=$$(parentNode,consts.id.UL,setting);tmp_switchObj=$$(parentNode,consts.id.SWITCH,setting);tmp_icoObj=$$(parentNode,consts.id.ICON,setting);lineClass=$.tree._lineClass(parentNode,setting.showLine);$.tree._replaceSwitchClass(parentNode,tmp_switchObj,lineClass);$.tree._replaceIcoClass(parentNode,tmp_icoObj,consts.folder.FILE);tmp_ulObj.css("display","none")}else{if(setting.showLine&&childLength>0){var newLast=parentNode[childKey][childLength-1];tmp_ulObj=$$(newLast,consts.id.UL,setting);tmp_switchObj=$$(newLast,consts.id.SWITCH,setting);tmp_icoObj=$$(newLast,consts.id.ICON,setting);if(parentNode==root){if(parentNode[childKey].length==1){$.tree._replaceSwitchClass(newLast,tmp_switchObj,consts.arrow.DOWN)}else{var tmp_first_switchObj=$$(parentNode[childKey][0],consts.id.SWITCH,setting);$.tree._replaceSwitchClass(parentNode[childKey][0],tmp_first_switchObj,(parentNode[childKey][0].isParent?(parentNode[childKey][0].open==true?consts.arrow.DOWN:consts.arrow.RIGHT):consts.line.ROOTS));
if(!newLast.isParent){$.tree._replaceSwitchClass(newLast,tmp_switchObj,consts.line.BOTTOM)}else{$.tree._replaceSwitchClass(newLast,tmp_switchObj,(node.open==true?consts.arrow.DOWN:consts.arrow.RIGHT))}}}else{if(newLast.isParent){$.tree._replaceSwitchClass(newLast,tmp_switchObj,(newLast.open?consts.arrow.DOWN:consts.arrow.RIGHT))}else{$.tree._replaceSwitchClass(newLast,tmp_switchObj,consts.line.BOTTOM)}}$.tree._addLine(setting,parentNode,parentNodeOldlevel);tmp_ulObj.removeClass(consts.line.LINE)}}},_replaceIcoClass:function(node,obj,newName){var icon=(node.isParent&&node.iconOpen&&node.iconClose)?(node.open?node.iconOpen:node.iconClose):node.icon;if(!obj||node.isAjaxing){return}var tmpName=obj.attr("class");if(tmpName==undefined){return}var tmpList=tmpName.split("-");switch(newName){case consts.folder.OPEN:case consts.folder.CLOSE:case consts.folder.FILE:case consts.line.CENTER:case consts.line.BOTTOM:case consts.line.LINE:if(icon){obj.attr("class",tmpList)}else{tmpList[tmpList.length-1]=newName;obj.attr("class",tmpList.join("-"))}break}},_replaceSwitchClass:function(node,obj,newName){if(!obj){return}var tmpName=obj.attr("class");if(tmpName==undefined){return}var tmpList=tmpName.split("-");switch(newName){case consts.arrow.DOWN:case consts.arrow.RIGHT:case consts.line.NOLINE:tmpList[tmpList.length-1]=newName;break;case consts.folder.OPEN:case consts.folder.CLOSE:case consts.line.ROOTS:case consts.line.CENTER:case consts.line.BOTTOM:case consts.folder.DOCU:case consts.line.LINE:tmpList[tmpList.length-1]=newName;break}obj.attr("class",tmpList.join("-"));if(newName!==consts.folder.DOCU){obj.removeAttr("disabled")}else{obj.attr("disabled","disabled")}},_repairAllChk:function(setting,checked){if(setting.checkable&&setting.chkStyle===consts.checkbox.STYLE){var checkedKey=setting.keyChecked,childKey=setting.keyChildren,root=$.tree._getRoot(setting);for(var i=0,l=root[childKey].length;i<l;i++){var node=root[childKey][i];if(node.nocheck!==true&&node.chkDisabled!==true){node[checkedKey]=checked
}$.tree._setSonNodeCheckBox(setting,node,checked)}}},_repairChkClass:function(setting,node){if(!node){return}$.tree._makeChkFlag(setting,node);if(node.nocheck!==true){var checkObj=$$(node,consts.id.CHECK,setting);$.tree._setChkClass(setting,checkObj,node)}},_repairParentChkClass:function(setting,node){if(!node||!node.parentTId){return}var pNode=node.getParentNode();$.tree._repairChkClass(setting,pNode);$.tree._repairParentChkClass(setting,pNode)},_repairParentChkClassWithSelf:function(setting,node){if(!node){return}var childKey=setting.keyChildren;if(node[childKey]&&node[childKey].length>0){$.tree._repairParentChkClass(setting,node[childKey][0])}else{$.tree._repairParentChkClass(setting,node)}},_repairSonChkDisabled:function(setting,node,chkDisabled,inherit){if(!node){return}var childKey=setting.keyChildren;if(node.chkDisabled!=chkDisabled){node.chkDisabled=chkDisabled}$.tree._repairChkClass(setting,node);if(node[childKey]&&inherit){for(var i=0,l=node[childKey].length;i<l;i++){var sNode=node[childKey][i];$.tree._repairSonChkDisabled(setting,sNode,chkDisabled,inherit)}}},_repairParentChkDisabled:function(setting,node,chkDisabled,inherit){if(!node){return}if(node.chkDisabled!=chkDisabled&&inherit){node.chkDisabled=chkDisabled}$.tree._repairChkClass(setting,node);$.tree._repairParentChkDisabled(setting,node.getParentNode(),chkDisabled,inherit)},_selectNode:function(setting,node,addFlag){if(!addFlag){$.tree._cancelPreSelectedNode(setting)}$$(node,consts.id.A,setting).addClass(consts.node.CURSELECTED);$.tree._addSelectedNode(setting,node)},_setNodeFontCss:function(setting,treeNode){var aObj=$$(treeNode,consts.id.A,setting),fontCss=$.tree._makeNodeFontCss(setting,treeNode);if(fontCss){aObj.css(fontCss)}},_setNodeLineIcos:function(setting,node){if(!node){return}var switchObj=$$(node,consts.id.SWITCH,setting),ulObj=$$(node,consts.id.UL,setting),icoObj=$$(node,consts.id.ICON,setting),ulLine=$.tree._makeUlLineClass(setting,node);if(ulLine.length==0){ulObj.removeClass(consts.line.LINE)
}else{ulObj.addClass(ulLine)}switchObj.attr("class",$.tree._makeNodeLineClass(setting,node));if(node.isParent){switchObj.removeAttr("disabled")}else{switchObj.attr("disabled","disabled")}icoObj.removeAttr("style");icoObj.attr("style",$.tree._makeNodeIcoStyle(setting,node));icoObj.attr("class",$.tree._makeNodeIcoClass(setting,node))},_setNodeName:function(setting,node){var title=$.tree._getNodeTitle(setting,node),nObj=$$(node,consts.id.SPAN,setting);nObj.empty();var names="";if(setting.formatter){names=$.tree._apply(setting.formatter,[setting,node],setting.formatter)}else{names=$.tree._getNodeName(setting,node)}if(setting.nameIsHTML){nObj.html(names)}else{nObj.text(names)}if($.tree._apply(setting.showTitle,[setting.treeId,node],setting.showTitle)){var aObj=$$(node,consts.id.A,setting);aObj.attr("title",!title?"":title)}},_setNodeTarget:function(setting,node){var aObj=$$(node,consts.id.A,setting);aObj.attr("target",$.tree._makeNodeTarget(node))},_setNodeUrl:function(setting,node){var aObj=$$(node,consts.id.A,setting),url=$.tree._makeNodeUrl(setting,node);if(url==null||url.length==0){aObj.removeAttr("href")}else{aObj.attr("href",url)}},_switchNode:function(setting,node){if(node.open||!$.tree._canAsync(setting,node)){$.tree._expandCollapseNode(setting,node,!node.open)}else{if(setting.asyncEnable){if(!$.tree._asyncNode(setting,node)){$.tree._expandCollapseNode(setting,node,!node.open);return}}else{if(node){$.tree._expandCollapseNode(setting,node,!node.open)}}}},_setChkClass:function(setting,obj,node){if(!obj){return}if(node.nocheck===true){obj.hide()}else{obj.show()}obj.attr("class",$.tree._makeChkClass(setting,node))},_setParentNodeCheckBox:function(setting,node,value,srcNode){var childKey=setting.keyChildren,checkedKey=setting.keyChecked,checkObj=$$(node,consts.id.CHECK,setting);if(!srcNode){srcNode=node}$.tree._makeChkFlag(setting,node);if(node.nocheck!==true&&node.chkDisabled!==true){node[checkedKey]=value;$.tree._setChkClass(setting,checkObj,node);if(setting.autoCheckTrigger&&node!=srcNode){setting.treeObj.trigger(consts.event.CHECK,[null,setting.treeId,node])
}}if(node.parentTId){var pSign=true;if(!value){var pNodes=node.getParentNode()[childKey];for(var i=0,l=pNodes.length;i<l;i++){if((pNodes[i].nocheck!==true&&pNodes[i].chkDisabled!==true&&pNodes[i][checkedKey])||((pNodes[i].nocheck===true||pNodes[i].chkDisabled===true)&&pNodes[i].check_Child_State>0)){pSign=false;break}}}if(pSign){$.tree._setParentNodeCheckBox(setting,node.getParentNode(),value,srcNode)}}},_setSonNodeCheckBox:function(setting,node,value,srcNode){if(!node){return}var childKey=setting.keyChildren,checkedKey=setting.keyChecked,checkObj=$$(node,consts.id.CHECK,setting);if(!srcNode){srcNode=node}var hasDisable=false;if(node[childKey]){for(var i=0,l=node[childKey].length;i<l&&node.chkDisabled!==true;i++){var sNode=node[childKey][i];$.tree._setSonNodeCheckBox(setting,sNode,value,srcNode);if(sNode.chkDisabled===true){hasDisable=true}}}if(node!=$.tree._getRoot(setting)&&node.chkDisabled!==true){if(hasDisable&&node.nocheck!==true){$.tree._makeChkFlag(setting,node)}if(node.nocheck!==true&&node.chkDisabled!==true){node[checkedKey]=value;if(!hasDisable){node.check_Child_State=(node[childKey]&&node[childKey].length>0)?(value?2:0):-1}}else{node.check_Child_State=-1}$.tree._setChkClass(setting,checkObj,node);if(setting.autoCheckTrigger&&node!=srcNode&&node.nocheck!==true&&node.chkDisabled!==true){setting.treeObj.trigger(consts.event.CHECK,[null,setting.treeId,node])}}},_removeEditBtn:function(setting,node){$$(node,consts.id.EDIT,setting).unbind().remove()},_removeRemoveBtn:function(setting,node){$$(node,consts.id.REMOVE,setting).unbind().remove()},_removeTreeDom:function(setting,node){node.isHover=false;$.tree._removeEditBtn(setting,node);$.tree._removeRemoveBtn(setting,node);$$(node,consts.id.A,setting).removeClass(consts.node.CURHOVER);$.tree._apply(setting.removeHoverDom,[setting.treeId,node])},_repairNodeLevelClass:function(setting,node,oldLevel){if(oldLevel===node.level){return}var liObj=$$(node,setting),aObj=$$(node,consts.id.A,setting),ulObj=$$(node,consts.id.UL,setting),oldClass=consts.className.LEVEL+oldLevel,newClass=consts.className.LEVEL+node.level;
liObj.removeClass(oldClass);liObj.addClass(newClass);aObj.removeClass(oldClass);aObj.addClass(newClass);ulObj.removeClass(oldClass);ulObj.addClass(newClass)},_selectNodes:function(setting,nodes){for(var i=0,l=nodes.length;i<l;i++){$.tree._selectNode(setting,nodes[i],i>0)}}};var settings={},roots={},caches={},_init={bind:[$.tree._coreBindEvent,$.tree._checkBindEvent,$.tree._editBindEvent],unbind:[$.tree._coreUnbindEvent,$.tree._checkUnbindEvent,$.tree._editUnbindEvent],caches:[$.tree._coreInitCache,$.tree._checkInitCache,$.tree._editInitCache],nodes:[$.tree._coreInitNode,$.tree._checkInitNode,$.tree._editInitNode],proxys:[$.tree._checkEventProxy,$.tree._coreEventProxy,$.tree._editEventProxy],roots:[$.tree._coreInitRoot,$.tree._checkInitRoot,$.tree._editInitRoot],beforeA:[$.tree._beforeA],afterA:[],innerBeforeA:[],innerAfterA:[],treeTools:[$.tree._checkTreeTools,$.tree._editTreeTools]};$.coral.tree={componentName:"tree",consts:_final,getTreeObj:function(treeId){var o=$.tree._getTreeTools(treeId);return o?o:null},destroy:function(treeId){if(!!treeId&&treeId.length>0){$.tree._destroy($.tree._getSetting(treeId))}else{for(var s in settings){$.tree._destroy(settings[s])}}},init:function(obj,optionData,nodeData){if(!obj.hasClass("coral-tree")){obj.addClass("coral-tree")}if(optionData.clickExpand){_option.clickExpand=true;_option.dblClickExpand=false}var setting=$.tree._clone(_option);$.extend(true,setting,optionData);setting.treeId=$(obj).uniqueId().attr("id");setting.treeObj=obj;setting.treeObj.empty();settings[setting.treeId]=setting;if(setting.cls){$(obj).addClass(setting.cls)}if(setting.componentCls){$(obj).addClass(setting.componentCls)}if(typeof document.body.style.maxHeight==="undefined"){setting.expandSpeed=""}$.tree._initRoot(setting);var root=$.tree._getRoot(setting),childKey=setting.keyChildren;nodeData=nodeData?$.tree._clone($.tree._isArray(nodeData)?nodeData:[nodeData]):[];nodeData=$.tree._createRootNodes(setting,nodeData);if(setting.simpleDataEnable){root[childKey]=$.tree._transformToTreeFormat(setting,nodeData)
}else{root[childKey]=nodeData}$.tree._initCache(setting);$.tree._unbindTree(setting);$.tree._bindTree(setting);$.tree._unbindEvent(setting);$.tree._bindEvent(setting);var treeTools={setting:setting,option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.extend({},treeTools.setting)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.extend({},treeTools.setting[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(arguments.length===1){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(arguments.length===1){return treeTools.setting[key]===undefined?null:treeTools.setting[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){treeTools.setting[key]=value;if(key==="disabled"){if(value){$("#"+setting.treeId).prepend("<div class='coral-state-disabled tree-disabled'></div>")}else{$("#"+setting.treeId+" .tree-disabled").remove()}}return this},disable:function(){return treeTools._setOptions({disabled:true})},enable:function(){return treeTools._setOptions({disabled:false})},addNodes:function(parentNode,newNodes,isSilent){var oldLevel=parentNode!=null?(typeof(parentNode.level)=="undefined"?0:parentNode.level):null;if(!newNodes){return null}if(!parentNode){parentNode=null}if(parentNode&&!parentNode.isParent&&setting.keepLeaf){return null}var xNewNodes=$.tree._clone($.tree._isArray(newNodes)?newNodes:[newNodes]);function addCallback(){$.tree._addNodes(setting,parentNode,xNewNodes,(isSilent==true))}if($.tree._canAsync(setting,parentNode)){$.tree._asyncNode(setting,parentNode,isSilent,addCallback)}else{addCallback()}$.tree._addLine(setting,parentNode,oldLevel);return xNewNodes},cancelSelectedNode:function(node){$.tree._cancelPreSelectedNode(setting,node)
},destroy:function(){$.tree._destroy(setting)},expandAll:function(expandFlag){expandFlag=!!expandFlag;$.tree._expandCollapseSonNode(setting,null,expandFlag,true);return expandFlag},expandNode:function(node,expandFlag,sonSign,focus,callbackFlag){if(!node||!node.isParent){return null}if(expandFlag!==true&&expandFlag!==false){expandFlag=!node.open}callbackFlag=!!callbackFlag;if(callbackFlag&&expandFlag&&($.tree._apply(setting.beforeExpand,[setting.treeId,node],true)==false)){return null}else{if(callbackFlag&&!expandFlag&&($.tree._apply(setting.beforeCollapse,[setting.treeId,node],true)==false)){return null}}if(expandFlag&&node.parentTId){$.tree._expandCollapseParentNode(setting,node.getParentNode(),expandFlag,false)}if(expandFlag===node.open&&!sonSign){return null}$.tree._getRoot(setting).expandTriggerFlag=callbackFlag;if(!$.tree._canAsync(setting,node)&&sonSign){$.tree._expandCollapseSonNode(setting,node,expandFlag,true,function(){if(focus!==false){try{$$(node,setting).focus().blur()}catch(e){}}})}else{node.open=!expandFlag;$.tree._switchNode(this.setting,node);if(focus!==false){try{$$(node,setting).focus().blur()}catch(e){}}}return expandFlag},getNodes:function(){return $.tree._getNodes(setting)},getNodeByParam:function(key,value,parentNode){if(!key){return null}return $.tree._getNodeByParam(setting,parentNode?parentNode[setting.keyChildren]:$.tree._getNodes(setting),key,value)},getNodeByTId:function(tId){return $.tree._getNodeCache(setting,tId)},getNodesByParam:function(key,value,parentNode){if(!key){return null}return $.tree._getNodesByParam(setting,parentNode?parentNode[setting.keyChildren]:$.tree._getNodes(setting),key,value)},getNodesByParamFuzzy:function(key,value,parentNode){if(!key){return null}return $.tree._getNodesByParamFuzzy(setting,parentNode?parentNode[setting.keyChildren]:$.tree._getNodes(setting),key,value)},getNodesByFilter:function(filter,isSingle,parentNode,invokeParam){isSingle=!!isSingle;if(!filter||(typeof filter!="function")){return(isSingle?null:[])
}return $.tree._getNodesByFilter(setting,parentNode?parentNode[setting.keyChildren]:$.tree._getNodes(setting),filter,isSingle,invokeParam)},getNodeIndex:function(node){if(!node){return null}var childKey=setting.keyChildren,parentNode=(node.parentTId)?node.getParentNode():$.tree._getRoot(setting);for(var i=0,l=parentNode[childKey].length;i<l;i++){if(parentNode[childKey][i]==node){return i}}return -1},getSelectedNodes:function(){var r=[],list=$.tree._getRoot(setting).curSelectedList;for(var i=0,l=list.length;i<l;i++){r.push(list[i])}return r},isSelectedNode:function(node){return $.tree._isSelectedNode(setting,node)},reAsyncChildNodes:function(parentNode,reloadType,isSilent,opts){if(!this.setting.asyncEnable){return}var isRoot=!parentNode;if(isRoot){parentNode=$.tree._getRoot(setting)}if(reloadType=="refresh"){var childKey=this.setting.keyChildren;for(var i=0,l=parentNode[childKey]?parentNode[childKey].length:0;i<l;i++){$.tree._removeNodeCache(setting,parentNode[childKey][i])}$.tree._removeSelectedNode(setting);parentNode[childKey]=[];if(isRoot){this.setting.treeObj.empty()}else{var ulObj=$$(parentNode,consts.id.UL,setting);ulObj.empty()}}$.tree._asyncNode(this.setting,isRoot?null:parentNode,!!isSilent,null,opts)},reLoadChildNodes:function(parentNode,reloadType,isSilent,newNodes){var isRoot=!parentNode;if(isRoot){parentNode=$.tree._getRoot(setting)}if(reloadType=="refresh"){var childKey=this.setting.keyChildren;for(var i=0,l=parentNode[childKey]?parentNode[childKey].length:0;i<l;i++){$.tree._removeNodeCache(setting,parentNode[childKey][i])}$.tree._removeSelectedNode(setting);parentNode[childKey]=[];if(isRoot){this.setting.treeObj.empty()}else{var ulObj=$$(parentNode,consts.id.UL,setting);ulObj.empty()}}if(this.setting.isInit){newNodes=$.tree._createRootNodes(this.setting,newNodes)}treeTools.addNodes(isRoot?null:parentNode,newNodes,!!isSilent)},refresh:function(){this.setting.treeObj.empty();var root=$.tree._getRoot(setting),nodes=root[setting.keyChildren];$.tree._initRoot(setting);
root[setting.keyChildren]=nodes;$.tree._initCache(setting);$.tree._createNodes(setting,0,root[setting.keyChildren])},reload:function(opts){this.setting.isInit=true;if(opts){opts=opts||{};var that=this,nodes=[],isUrl=false;if(typeof(opts)!=="string"){if(opts.data){nodes=opts.data}else{if(opts instanceof Array){nodes=opts}else{if(opts.asyncUrl){this.setting.asyncUrl=opts.asyncUrl}isUrl=true}}}else{isUrl=true;this.setting.asyncUrl=opts}if(isUrl&&this.setting.asyncEnable){treeTools.reAsyncChildNodes(null,"refresh",null,opts)}else{treeTools.reLoadChildNodes(null,"refresh",null,nodes);$.tree._apply(opts.onLoad,[null,this.setting.treeId]);if(opts.onLoad){$.tree._apply(opts.onLoad,[setting.treeId,null,nodes])}else{setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,null,nodes])}}}else{if(this.setting.asyncEnable){opts=opts||{};treeTools.reAsyncChildNodes(null,"refresh",null,opts)}}},removeChildNodes:function(node){if(!node){return null}var childKey=setting.keyChildren,nodes=node[childKey];$.tree._removeChildNodes(setting,node);return nodes?nodes:null},_pinyinEngine:function(){return new pinyinEngine()},_pinyinSetCache:function(engine,key,dataArr){for(var i in dataArr){engine.setCache([dataArr[i][key]],dataArr[i])}return engine},_pinyinSearch:function(engine,keyword,callback){var dataResult=[];engine.search(keyword,function(data){dataResult.push(data)});callback(dataResult)},filterNodesByParam:function(keysObj){var that=this,nodes=that.getNodes(),nodesArr=[],nodesFilter=[];that.expandAll(true);nodesArr=that.transformToArray(nodes);var engine=that._pinyinEngine();engine=that._pinyinSetCache(engine,"name",nodesArr);that.hideNodes(nodesArr);if(typeof keysObj==="object"){$.each(keysObj,function(k,v){if(k=="name"){that._pinyinSearch(engine,v,function(dataFilter){that.showNodes(dataFilter,{showParents:true})})}})}},showNodes:function(nodes,options){$.tree._showNodes(setting,nodes,options)},showNode:function(node,options){if(!node){return}$.tree._showNodes(setting,[node],options)
},hideNodes:function(nodes,options){$.tree._hideNodes(setting,nodes,options)},hideNode:function(node,options){if(!node){return}$.tree._hideNodes(setting,[node],options)},removeNode:function(node,callbackFlag){if(!node){return}callbackFlag=!!callbackFlag;if(callbackFlag&&$.tree._apply(setting.beforeRemove,[setting.treeId,node],true)==false){return}$.tree._removeNode(setting,node);if(callbackFlag){this.setting.treeObj.trigger(consts.event.REMOVE,[setting.treeId,node])}},selectNode:function(node,addFlag){if(!node){return}if($.tree._uCanDo(setting)){addFlag=setting.selectedMulti&&addFlag;if(node.parentTId){$.tree._expandCollapseParentNode(setting,node.getParentNode(),true,false,function(){})}else{}$.tree._selectNode(setting,node,addFlag)}},transformToTreeNodes:function(simpleNodes){return $.tree._transformToTreeFormat(setting,simpleNodes)},transformToArray:function(nodes){return $.tree._transformToArrayFormat(setting,nodes)},updateNode:function(node,checkTypeFlag){if(!node){return}var nObj=$$(node,setting);if(nObj.get(0)&&$.tree._uCanDo(setting)){$.tree._setNodeName(setting,node);$.tree._setNodeTarget(setting,node);$.tree._setNodeUrl(setting,node);$.tree._setNodeLineIcos(setting,node);$.tree._setNodeFontCss(setting,node)}}};root.treeTools=treeTools;$.tree._setTreeTools(setting,treeTools);if(setting.disabled){treeTools.disable()}else{treeTools.enable()}setting.isInit=true;setting.dataLoaded=false;setting.rootReload=true;if(root[childKey]&&root[childKey].length>0){$.tree._createNodes(setting,0,root[childKey]);setting.treeObj.trigger(consts.event.ASYNC_SUCCESS,[setting.treeId,null,root[childKey]])}else{if(setting.asyncEnable&&setting.asyncUrl&&setting.asyncUrl!==""){$.tree._asyncNode(setting)}}return treeTools}};var coralTree=$.coral.tree,$$=$.tree._$,consts=coralTree.consts;var _createNodes=$.tree._createNodes;$.tree._createNodes=function(setting,level,nodes,parentNode){if(_createNodes){_createNodes.apply($.tree,arguments)}if(!nodes){return}if($.tree._repairParentChkClassWithSelf){$.tree._repairParentChkClassWithSelf(setting,parentNode)
}};var _removeNode=$.tree._removeNode;$.tree._removeNode=function(setting,node){var parentNode=node.getParentNode();if(_removeNode){_removeNode.apply($.tree,arguments)}if(!node||!parentNode){return}$.tree._repairChkClass(setting,parentNode);$.tree._repairParentChkClass(setting,parentNode)};var _appendNodes=$.tree._appendNodes;$.tree._appendNodes=function(setting,level,nodes,parentNode,initFlag,openFlag){var html="";if(_appendNodes){html=_appendNodes.apply($.tree,arguments)}if(parentNode){$.tree._makeChkFlag(setting,parentNode)}return html};var _cancelPreSelectedNode=$.tree._cancelPreSelectedNode;$.tree._cancelPreSelectedNode=function(setting,node){var list=$.tree._getRoot(setting).curSelectedList;for(var i=0,j=list.length;i<j;i++){if(!node||node===list[i]){$.tree._removeTreeDom(setting,list[i]);if(node){break}}}if(_cancelPreSelectedNode){_cancelPreSelectedNode.apply($.tree,arguments)}};var _makeNodeUrl=$.tree._makeNodeUrl;$.tree._makeNodeUrl=function(setting,node){return setting.editable?null:(_makeNodeUrl.apply($.tree,arguments))};var _removeNode1=$.tree._removeNode;$.tree._removeNode=function(setting,node){var root=$.tree._getRoot(setting);if(root.curEditNode===node){root.curEditNode=null}if(_removeNode1){_removeNode1.apply($.tree,arguments)}};var _selectNode=$.tree._selectNode;$.tree._selectNode=function(setting,node,addFlag){var root=$.tree._getRoot(setting);if($.tree._isSelectedNode(setting,node)&&root.curEditNode==node&&node.editNameFlag){return false}if(_selectNode){_selectNode.apply($.tree,arguments)}$.tree._addHoverDom(setting,node);return true};var _uCanDo=$.tree._uCanDo;$.tree._uCanDo=function(setting,e){var root=$.tree._getRoot(setting);if(e&&($.tree._eqs(e.type,"mouseover")||$.tree._eqs(e.type,"mouseout")||$.tree._eqs(e.type,"mousedown")||$.tree._eqs(e.type,"mouseup"))){return true}if(root.curEditNode){$.tree._editNodeBlur=false;root.curEditInput.focus()}return(!root.curEditNode)&&(_uCanDo?_uCanDo.apply($.tree,arguments):true)};$.fn.tree=function(options){var returnValue=this;
if(!this.length){return this}var otherArgs=Array.prototype.slice.call(arguments,1);var args=Array.prototype.slice.call(arguments,0);this.each(function(){var isMethodCall=typeof options==="string";options=options||{};var methodValue,parseOptions=$.parser.parseOptions(this,[],["data","rootNode","chkboxType","formatter"]);_options=$.extend({},$.fn.tree.defaults||{},parseOptions);if(isMethodCall){var treeobj=$.coral.tree.getTreeObj($(this).attr("id"));methodValue=treeobj[options].apply(treeobj,[].concat(otherArgs));if(methodValue!==undefined){returnValue=methodValue}return}else{_options=$.extend({},_options,options);var node=args[1]||_options.data;$.coral.tree.init($(this),_options,node)}});return returnValue}})(jQuery);

$.component("coral.layout",{version:"4.1.4",options:{onCreate:null,fit:false},layoutPanelDefault:{region:null,split:false,showSplitIcon:false,collapsedSize:30,minWidth:10,minHeight:10,maxWidth:10000,maxHeight:10000},resizing:false,_resizeLayout:function(){var i=this,b=this.element,n=i.options,h=i.panels,d=$(b);if(b[0].tagName.toLowerCase()=="body"){this._fit()}else{n.fit?d.css(this._fit()):this._fit(false)}var f=d.find(">.coral-layout-split-north").height()||0,c=d.find(">.coral-layout-split-south").height()||0,a=d.find(">.coral-layout-split-west").width()||0,m=d.find(">.coral-layout-split-east").width()||0;var j={top:0,left:0,width:d.width()-a-m,height:d.height()-c-f};k(this._isPanelVisible(h.expandNorth)?h.expandNorth:h.north,"n");k(this._isPanelVisible(h.expandSouth)?h.expandSouth:h.south,"s");g(this._isPanelVisible(h.expandEast)?h.expandEast:h.east,"e");g(this._isPanelVisible(h.expandWest)?h.expandWest:h.west,"w");h.center.panel("resize",j);function e(o){var p=o.panel("getOptions");return Math.min(Math.max(p.height,p.minHeight),p.maxHeight)}function l(p){var o=p.panel("getOptions");return Math.min(Math.max(o.width,o.minWidth),o.maxWidth)}function k(p,r){if(!p.length||!i._isPanelVisible(p)){return}var t=p.panel("getOptions"),u=e(p),s=(r=="n"?"north":"south"),q=d.find(">.coral-layout-panel-"+s).children(".ctrl-init-panel"),v=q.panel("getOptions");j.height-=u;if(r=="n"){var w=d.find(">.coral-layout-split-north");j.top+=u+f;if(!v.split&&t.border){j.top--}w.css({top:u,left:0})}else{var o=d.find(">.coral-layout-split-south");o.css({top:d.height()-u-c,left:0})}p.panel("resize",{width:d.width(),height:u,left:0,top:(r=="n"?0:d.height()-u)});if(!v.split&&t.border){j.height++}if(t.border&&!$.support.boxSizing){j.height-2}}function g(o,q){if(!o.length||!i._isPanelVisible(o)){return}var v=o.panel("getOptions"),u=(q=="e"?"east":"west"),p=d.find(">.coral-layout-panel-"+u).children(".ctrl-init-panel"),w=p.panel("getOptions");var r=l(o);o.panel("resize",{width:r,height:j.height,left:(q=="e"?d.width()-r:0),top:j.top});
j.width-=r;if(q=="w"){var t=d.find(">.coral-layout-split-west");j.left+=r+a;t.css({height:j.height,top:j.top,left:r});if(!w.split&&v.border){j.left--}}else{var s=d.find(">.coral-layout-split-east");s.css({height:j.height,top:j.top,left:d.width()-r-m})}if(!w.split&&v.border){j.width++}if(!$.support.boxSizing){j.width-2}}},_splitLayout:function(e,c){var d=$(this.element).layout("panel",e);d.panel("options").split=c;var a="layout-split-"+e;var b=d.panel("panel").removeClass(a);if(c){b.addClass(a)}b.resizable({disabled:(!c)});this._resizeLayout()},_create:function(){this.panels={center:$(),north:$(),south:$(),east:$(),west:$()};var b=this;var a=this.element;var d=$(a);d.addClass("coral-layout");function c(e){e.children("div").each(function(){var f=$.parser.parseOptions(this,[]);if("north,south,east,west,center".indexOf(f.region)>=0){b._addPanel(a,f,this);var g=e.layout("panel",f.region);if(g.panel("option").split){b._addSplitIcon(a,f,this)}}})}d.children("form").length?c(d.children("form")):c(d);d.append('<div class="coral-layout-split-proxy-h"></div><div class="coral-layout-split-proxy-v"></div>');this._resizeLayout();this._initCollapse();this._on({"click.splitIcon":function(g){var f=$(g.target).attr("data-dir");if(b.panels[f].is(":visible")){this._collapse(f)}else{this._expand(f)}return false}})},_addSplitIcon:function(c,q,i){var j=this,f=$(c),g=q.region,b=f.layout("panel",g),d=$(i),l=$(i).parent(),n=d.panel("component"),h="coral-layout-split-"+g,a="<div id='layout-split-"+g+"Id' class='layout-split "+h+"'>",e={north:"up5",south:"down5",east:"right5",west:"left5"};if(!e[g]){return}if(!d.length){l=f.find(">.coral-layout-panel-"+g)}if(b.panel("option").showSplitIcon){var m="splitIcon cui-icon-arrow-"+e[g],o="<div class='"+m+"' data-dir='"+g+"'></div>";a+=o+"</div>"}else{a+="</div>"}var k=$(a);l.after(k)},_addPanel:function(a,n,m){var f=this;n.region=n.region||"center";var g=this.panels;var d=$(a);var e=n.region;if(g[e].length){return}var b=$(m);if(!b.length){b=$("<div></div>").appendTo(d)
}var c={north:"up3",south:"down3",east:"right3",west:"left3"};var h="cui-icon-arrow-"+c[e];var k=["title","->"];var c={north:"up3",south:"down3",east:"right3",west:"left3"};var h="cui-icon-arrow-"+c[e];if(c[e]){k.push({icons:h,label:e,text:false,onClick:function(o){f._collapse(e)}})}var l=$.extend({},this.layoutPanelDefault,{width:(b.length?parseInt(b[0].style.width)||b.outerWidth():"auto"),height:(b.length?parseInt(b[0].style.height)||b.outerHeight():"auto"),doSize:false,componentCls:("coral-layout-panel coral-layout-panel-"+e),bodyCls:"coral-layout-body",toolbarOptions:{data:k},onOpen:function(){}},n);if(l.region==="center"){l.split=false}b.panel(l);g[e]=b;var j=b.panel("component");var i={north:"s",south:"n",east:"w",west:"e"};if(b.panel("option").split){j.resizable($.extend({handles:(i[e]||""),disabled:(!b.panel("option").split),start:function(q){f.resizing=true;if(e=="north"||e=="south"){var o=$(">div.coral-layout-split-proxy-v",a)}else{var o=$(">div.coral-layout-split-proxy-h",a)}var p=0,r={display:"block"};if(e=="north"){r.top=parseInt(j.css("top"))+j.outerHeight()-o.height();r.left=parseInt(j.css("left"));r.width=j.outerWidth();r.height=o.height()}else{if(e=="south"){r.top=parseInt(j.css("top"));r.left=parseInt(j.css("left"));r.width=j.outerWidth();r.height=o.height()}else{if(e=="east"){r.top=parseInt(j.css("top"))||0;r.left=parseInt(j.css("left"))||0;r.width=o.width();r.height=j.outerHeight()}else{if(e=="west"){r.top=parseInt(j.css("top"))||0;r.left=j.outerWidth()-o.width();r.width=o.width();r.height=j.outerHeight()}}}}o.css(r);$('<div class="coral-layout-mask"></div>').css({left:0,top:0,width:d.width(),height:d.height()}).appendTo(d)},resize:function(p){if(e=="north"||e=="south"){var o=$(">div.coral-layout-split-proxy-v",a);o.css("top",p.pageY-$(a).offset().top-o.height()/2)}else{var o=$(">div.coral-layout-split-proxy-h",a);o.css("left",p.pageX-$(a).offset().left-o.width()/2)}return false},helper:"coral-resizable-helper",stop:function(p,o){d.children("div.coral-layout-split-proxy-v,div.coral-layout-split-proxy-h").hide();
b.panel("resize",o.size);f._resizeLayout();f.resizing=false;d.find(">div.coral-layout-mask").remove()}},n))}},_remove:function(d){var a=this.panels,b=this.element;var f=$(b).find(".coral-layout-split-"+d),c=f.find(".splitIcon");if(a[d].length){a[d].panel("destroy");$(a[d]).remove();a[d]=$();var e="expand"+d.substring(0,1).toUpperCase()+d.substring(1);if(a[e]){a[e].panel("destroy");$(a[d]).remove();a[e]=undefined}if(f.length){$(f).remove();f=$()}}},_collapseSplitIcon:function(i,a){var g=this,k,d=this.element,c=this.panels[i],j=c.panel("getOptions"),e=j.collapsedSize;var f=$(d).find(".coral-layout-split-"+i),b=f.find(".splitIcon");if(i=="east"){k="cui-icon-arrow-left5";b.removeClass("cui-icon-arrow-right5").addClass(k);f.css({left:a.expandP.left-f.width()})}else{if(i=="west"){k="cui-icon-arrow-right5";b.removeClass("cui-icon-arrow-left5").addClass(k);f.css({left:a.expandP.width})}else{if(i=="north"){k="cui-icon-arrow-down5";b.removeClass("cui-icon-arrow-up5").addClass(k);f.css({top:a.expandP.height});$(d).find(".coral-layout-split-west").css({top:a.expandP.height+f.height(),height:a.resizeC.height});$(d).find(".coral-layout-split-east").css({top:a.expandP.height+f.height(),height:a.resizeC.height})}else{if(i=="south"){k="cui-icon-arrow-up5";b.removeClass("cui-icon-arrow-down5").addClass(k);var h=a.expandP.top-f.height();f.css({top:h});$(d).find(".coral-layout-split-west").css({height:a.resizeC.height});$(d).find(".coral-layout-split-east").css({height:a.resizeC.height})}}}}},_collapse:function(j,e){var h=this,c=this.element;if(e==undefined){e="normal"}var i=this.panels;var b=i[j];var k=b.panel("getOptions");if(k.beforeCollapse.call(b)==false){return}var f="expand"+j.substring(0,1).toUpperCase()+j.substring(1);if(!i[f]){i[f]=d(j);i[f].panel("component").bind("click",function(l){if($(l.target).closest(".collapseIcon").length){return false}var m=g();b.panel("expand",false).panel("open").panel("resize",m.collapse);b.panel("component").animate(m.expand,function(){$(this).unbind(".layout").bind("mouseleave.layout",{region:j},function(n){if(h.resizing==true){return
}h._collapse(n.data.region)})});return false})}var a=g();if(!this._isPanelVisible(i[f])){i.center.panel("resize",a.resizeC)}b.panel("component").animate(a.collapse,e,function(){b.panel("collapse",false).panel("close");i[f].panel("open").panel("resize",a.expandP);$(this).unbind(".layout")});this._collapseSplitIcon(j,a);function d(m){var l="";if(m=="east"){l+="cui-icon-arrow-left3"}else{if(m=="west"){l+="cui-icon-arrow-right3"}else{if(m=="north"){l+="cui-icon-arrow-down3"}else{if(m=="south"){l+="cui-icon-arrow-up3"}}}}var o=$("<div></div>").appendTo(c);var n=["->","->",{icons:l,componentCls:"collapseIcon",label:j,text:false,onClick:function(p){h._expand(j)}}];if(m=="east"||m=="west"){n=[{icons:l,componentCls:"collapseIcon",label:j,text:false,onClick:function(p){h._expand(j)}}]}o.panel($.extend({},h.layoutPanelDefault,{componentCls:("coral-layout-expand coral-layout-expand-"+m),title:"&nbsp;",showTitle:false,closed:true,minWidth:0,minHeight:0,doSize:false,toolbarOptions:{isOverflow:false,data:n}}));o.panel("component").hover(function(){$(this).addClass("coral-layout-expand-over")},function(){$(this).removeClass("coral-layout-expand-over")});return o}function g(){var t=$(c);var m=i.center.panel("getOptions");var l=k.collapsedSize;if(j=="east"){var r=m.width+k.width-l;var o=0;if(!k.split){o=1}return{resizeC:{width:r},expand:{left:t.width()-k.width},expandP:{top:m.top,left:t.width()-l,width:l,height:m.height},collapse:{left:t.width(),top:m.top,height:m.height}}}else{if(j=="west"){var r=m.width+k.width-l;var q=t.find(">.coral-layout-split-west");var o=0;if(!k.split){o=1}return{resizeC:{width:r,left:l+q.width()-o},expand:{left:0},expandP:{left:0,top:m.top,width:l,height:m.height},collapse:{left:-k.width,top:m.top,height:m.height}}}else{if(j=="north"){var n=m.height;var p=t.find(">.coral-layout-split-north");if(!h._isPanelVisible(i.expandNorth)){n+=k.height-l}i.east.add(i.west).add(i.expandEast).add(i.expandWest).panel("resize",{top:l+p.height(),height:n});return{resizeC:{top:l+p.height(),height:n},expand:{top:0},expandP:{top:0,left:0,width:t.width(),height:l},collapse:{top:-k.height,width:t.width()}}
}else{if(j=="south"){var n=m.height;if(!h._isPanelVisible(i.expandSouth)){n+=k.height-l}i.east.add(i.west).add(i.expandEast).add(i.expandWest).panel("resize",{height:n});return{resizeC:{height:n},expand:{top:t.height()-k.height},expandP:{top:t.height()-l,left:0,width:t.width(),height:l},collapse:{top:t.height(),width:t.width()}}}}}}}},_expandSplitIcon:function(e){var d=this,a,b=this.element;var f=$(b).find(".coral-layout-split-"+e),c=f.find(".splitIcon");if(e=="east"){a="cui-icon-arrow-right5";c.removeClass("cui-icon-arrow-left5").addClass(a)}else{if(e=="west"){a="cui-icon-arrow-left5";c.removeClass("cui-icon-arrow-right5").addClass(a)}else{if(e=="north"){a="cui-icon-arrow-up5";c.removeClass("cui-icon-arrow-down5").addClass(a)}else{if(e=="south"){a="cui-icon-arrow-down5";c.removeClass("cui-icon-arrow-up5").addClass(a)}}}}},_expand:function(g){var e=this,b=this.element,f=this.panels,a=f[g],h=a.panel("getOptions");if(h.beforeExpand.call(a)==false){return}var i=d();var c="expand"+g.substring(0,1).toUpperCase()+g.substring(1);if(f[c]){f[c].panel("close");a.panel("component").stop(true,true);a.panel("expand",false).panel("open").panel("resize",i.collapse);a.panel("component").animate(i.expand,function(){e._resizeLayout()});this._expandSplitIcon(g)}function d(){var k=$(b);var j=f.center.panel("getOptions");if(g=="east"&&f.expandEast){return{collapse:{left:k.width(),top:j.top,height:j.height},expand:{left:k.width()-f.east.panel("getOptions").width}}}else{if(g=="west"&&f.expandWest){return{collapse:{left:-f.west.panel("getOptions").width,top:j.top,height:j.height},expand:{left:0}}}else{if(g=="north"&&f.expandNorth){return{collapse:{top:-f.north.panel("getOptions").height,width:k.width()},expand:{top:0}}}else{if(g=="south"&&f.expandSouth){return{collapse:{top:k.height(),width:k.width()},expand:{top:k.height()-f.south.panel("getOptions").height,height:f.south.panel("getOptions").height}}}}}}}},_isPanelVisible:function(a){if(!a){return false}if(a.length){return a.panel("component").is(":visible")
}else{return false}},_initCollapse:function(){var a=this.panels;if(a.east.length&&a.east.panel("getOptions").collapsed){this._collapse("east",0)}if(a.west.length&&a.west.panel("getOptions").collapsed){this._collapse("west",0)}if(a.north.length&&a.north.panel("getOptions").collapsed){this._collapse("north",0)}if(a.south.length&&a.south.panel("getOptions").collapsed){this._collapse("south",0)}},_fit:function(a){return $.coral.panel.fit(this.element,a)},_destroy:function(){this.element.children().remove();this.element.detach()},refresh:function(){this._resizeLayout()},panel:function(a){return this.panels[a]},collapse:function(a){this._collapse(a)},expand:function(a){this._expand(a)},add:function(a){this._addPanel(this.element,a);this._addSplitIcon(this.element,a);this._resizeLayout();if(this.panels[a.region].panel("getOptions").collapsed){this._collapse(a.region,0)}},remove:function(a){this._remove(a);this._resizeLayout()},split:function(a){this._splitLayout(a,true)},unsplit:function(a){this._splitLayout(a,false)},resize:function(g,h){var f=g;var b=this.element;if(h!==undefined){var c=this.panels[h];var i=c.panel("component").outerHeight();var d=c.panel("component").outerWidth();c.panel("resize",g);var a=c.panel("component").outerHeight();var e=c.panel("component").outerWidth();f.height=$(b).height()+a-i;f.width=$(b).width()+e-d}$(b).css(f);this._resizeLayout()}});

$.component("coral.basemenu",{castProperties:["data"],options:{popup:false,trigger:null,my:"left top",at:"left bottom",of:null,triggerEvent:"click",data:null,onClick:null,onCreate:null,url:null,method:null},_create:function(){if(this.options.popup){this._initPopup()}},_generateULContent:function(){var c=this;if(this.element.children().length==0&&this.options.data!=null){var a="";var b=(typeof this.options.data==="string")?$.parseJSON(this.options.data):this.options.data;a=this._generateHTML(a,b);if(a.length>7){a=a.substring(4);a=a.substring(0,a.length-5)}this.element.html(a)}else{if(this.element.children().length==0&&this.options.url!=null){var a="";$.ajax({type:"get",url:c.options.url,async:false,data:null,dataType:"json",success:function(e){var d="";d=c._generateHTML(d,e);if(d.length>7){d=d.substring(4);d=d.substring(0,d.length-5)}c.element.html(d)},error:function(){}})}}},_generateHTML:function(c,d){c+="<ul>";for(var b=0;b<d.length;b++){if(d[b].id!=""){c+='<li data-id="'+d[b].id+'">'}else{c+="<li>"}c+=this._generateANode(d[b]);var a=d[b].items;if(typeof a!=="undefined"&&a instanceof Array&&a.length>0){c=this._generateHTML(c,a)}c+="</li>"}c+="</ul>";return c},_generateANode:function(a){var b="<a";if(a.iconclass!=""){b+=" data-icon='"+a.iconclass+"'"}if(a.name!=""){b+=" data-name='"+a.name+"'"}if(a.disabled!=""){b+=" data-disabled='"+a.disabled+"'"}if(a.url!=""){b+=" data-url='"+a.url+"'"}if(a.target!=""){b+=" data-target='"+a.target+"'"}b+=">";if(a.name!=""){b+=a.name}b+="</a>";return b},_initPopup:function(){var a=this;this.options.trigger=typeof this.options.trigger==="string"?$("#"+this.options.trigger):this.options.trigger;this.element.closest(".coral-menu").addClass("coral-menu-dynamic coral-shadow").appendTo(document.body);this.positionConfig={my:this.options.my,at:this.options.at,of:this.options.of?this.options.of:this.options.trigger};this.options.trigger.on(this.options.triggerEvent+".coral-menu",function(c){if(a.options.disabled===true){return}var b=$(this);
if(a.element.is(":visible")){a.hide()}else{a.show()}c.preventDefault()});$(document.body).on("click.coral-menu",function(d){var b=a.element.closest(".coral-menu");if(b.is(":hidden")){return}var c=$(d.target);if(c.is(a.options.trigger.get(0))||a.options.trigger.has(c).length>0){return}var f=b.offset();if(d.pageX<f.left||d.pageX>f.left+b.width()||d.pageY<f.top||d.pageY>f.top+b.height()){a.hide(d)}});$(window).on("resize.coral-menu",function(){if(a.element.closest(".coral-menu").is(":visible")){a.align()}})},show:function(){this.align();this.element.closest(".coral-menu").css("z-index",++$.coral.zindex).show()},hide:function(){this.element.closest(".coral-menu").fadeOut("fast")},align:function(){this.element.closest(".coral-menu").css({left:"",top:""}).position({my:this.options.my,at:this.options.at,of:this.options.of?this.options.of:this.options.trigger})},_apply:function(c,b,a){if(typeof c==="string"){return window[c].apply(b,[a])}else{if($.isFunction(c)){return c.apply(b,[a])}}},_setMenuItemLinkDisabled:function(a){if(a.data("disabled")===true){a.toggleClass(this.componentFullName+"-disabled coral-state-disabled",true).attr("aria-disabled",true)}else{a.toggleClass(this.componentFullName+"-disabled coral-state-disabled",false).attr("aria-disabled",false)}},_bindMenuItemClick:function(b){var a=b.options.onClick;b.links.on("click",function(){if(b.options.disabled===true){return}var c={};if($(this).parent("li").attr("data-id")!=null){c.id=$(this).parent("li").attr("data-id")}if($(this).attr("data-target")!=null){c.target=$(this).attr("data-target")}if($(this).attr("data-name")!=null){c.name=$(this).attr("data-name")}if($(this).attr("data-url")!=null){c.url=$(this).attr("data-url")}if($(this).find(":checkbox,:radio").length>0){c.hasChk=true;c.checked=$(this).find(":checkbox,:radio").prop("checked")}else{c.hasChk=false}var d={target:b,currentTarget:b,preventDefault:$.noop};b._trigger("onClick",d,c)})},setActiveMenu:function(b){var a=this;if(b==null||b.length==0){return}$.each(b,function(){var c=a.element.find("[data-name='"+this+"']");
c.parent().addClass("coral-menuitem-current")})},setCurrenMenu:function(a){if(a==null||a.length==0){return}this.element.find(">li>a").each(function(){var c=$(this),b=c.attr("data-name");if(b!==a){return}c.parent().addClass("coral-menuitem-current");$(this).parent().siblings().removeClass("coral-menuitem-current")})}});$.component("coral.navigationmenu",$.coral.basemenu,{castProperties:["title"],options:{collapsible:true,active:0,textAlign:"left",role:"navigationmenu",menus:"ul",title:null,icons:{activeHeader:"cui-icon-arrow-down",header:"cui-icon-arrow-right2"},header:"> li > :first-child,> :not(li):even"},_activate:function(a){var b=this._findActive(a)[0];if(b===this.active[0]){return}b=b||this.active[0];this._eventHandler({target:b,currentTarget:b,preventDefault:$.noop})},_findActive:function(a){return typeof a==="number"?this.headers.eq(a):$()},_setOption:function(a,b){if(a==="active"){this._activate(b);return}this._super(a,b)},_create:function(){var a=this;this._generateULContent();this._render();this.links=this.element.find(".coral-menuitem-link:not(.coral-state-disabled)");this._on({"mousedown .coral-navigationmenu-header":function(b){b.preventDefault()},"click .coral-menuitem-link":function(c){c.preventDefault();var e=$(c.target).closest(".coral-menuitem-link"),b=$(c.target).closest(".coral-menu-parent");if(b.not(".coral-state-disabled").length){b.siblings().find(">ul").attr("aria-expanded",false).slideUp();b.find(">.icon").removeClass(a.options.icons.activeHeader).addClass(a.options.icons.header);if(!c.isPropagationStopped()){this.mouseHandled=true}var d=b.find(">ul");if(!e.parent().hasClass("coral-menu-parent")){this.oldActive=this.active||$();this.active=e;this.oldActive.removeClass("coral-state-highlight");ui={item:this.active,target:this.active.attr("href")};this.active.addClass("coral-state-highlight");this._trigger("onSelect",c,ui)}else{if(d.attr("aria-expanded")=="true"){d.attr("aria-expanded",false).slideUp()}else{d.attr("aria-expanded",true).slideDown();
b.find(">.icon").removeClass(a.options.icons.header).addClass(a.options.icons.activeHeader)}}}},"mouseenter .coral-menuitem-link":function(c){c.preventDefault();var d=$(c.target).closest(".coral-menuitem-link");var b=$(c.target).closest(".coral-menu-parent");if(b.not(".coral-state-disabled").length){if(!d.parent().hasClass("coral-menu-parent")){d.addClass("coral-state-hover")}this._updateTitle()}},"mouseleave .coral-menuitem-link":function(c){c.preventDefault();var d=$(c.target).closest(".coral-menuitem-link");var b=$(c.target).closest(".coral-menu-parent");if(b.not(".coral-state-disabled").length){if(!d.parent().hasClass("coral-menu-parent")){d.removeClass("coral-state-hover")}}}});this._super()},_updateTitle:function(){this.element.find("li>a").each(function(){var c=$(this),a=c.find(".coral-menuitem-text").text();var b=$("<span style = 'visibility: hidden'>"+a+"</span>").appendTo("body");if(c.width()<b.width()){c.attr("title",a)}b.remove()})},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("coral-navigationmenu-header coral-state-default")},_render:function(){var c=this;this.element.addClass("coral-helper-reset coral-navigationmenu coral-menu").attr("role","navigationmenu");this.element.uniqueId();this.options.id=this.element.attr("id");this._processPanels();submenus=this.element.find(this.options.menus);submenus.filter(":not(.coral-menu)").addClass("coral-menu-list coral-helper-reset").attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=$(this),d=e.parent();d.attr("aria-haspopup","true");e.attr("aria-labelledby",d.attr("id"))});menus=submenus.add(this.element);items=menus.find(this.options.items);items.not(".coral-menu-item").each(function(){var d=$(this);if(that._isDivider(d)){d.addClass("coral-component-content coral-menu-divider")}});this.element.find("li").each(function(){var g=$(this),e=g.children("a"),f=e.data("icon"),h=typeof(g.parent().parent("li").attr("data-level"))=="undefined"?0:parseInt(g.parent().parent("li").attr("data-level"))+1;
e.addClass("coral-menuitem-link coral-state-default coral-corner-all");e.contents().filter(function(j,k){if(k.tagName){return false}return true}).wrap("<span class='coral-menuitem-text'/>");e.html('<div class="coral-navigationmenu-item-inner">'+e.html()+"</div>");g.addClass("coral-menuitem coral-component coral-corner-all").attr("data-level",h).addClass("level"+h);if(g.children("ul").length>0){var d=g.children("ul");g.addClass("coral-menu-parent");d.addClass("coral-menu-list coral-helper-reset");e.prepend('<span class="coral-navigationmenu-item-arrow cui-icon-arrow-down3"></span>')}else{if(c.options.textAlign=="right"){}}if(c.options.textAlign=="right"){$("<span class='coral-empty' style='width:"+h*16+"px;height:"+16+"px;'></span>").prependTo(e.find(".coral-navigationmenu-item-inner"))}});var a=".coral-navigationmenu li > a[data-target='"+this.options.active+"'], .coral-navigationmenu li > a[href='"+this.options.active+"']";var b=$(a);b.parents("ul").show();if(!b.parent().hasClass("coral-menu-parent")){b.addClass("coral-state-highlight");this.oldActive=b;this.active=b}}});$.component("coral.menu",{version:"4.0.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"coral-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",onBlur:null,onFocus:null,onSelect:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().addClass("coral-menu coral-component coral-component-content").toggleClass("coral-menu-icons",!!this.element.find(".coral-icon").length).attr({role:this.options.role,tabIndex:0});if(this.options.disabled){this.element.addClass("coral-state-disabled").attr("aria-disabled","true")}this._on({"mousedown .coral-menu-item":function(a){a.preventDefault()},"click .coral-menu-item":function(a){var b=$(a.target);if(!this.mouseHandled&&b.not(".coral-state-disabled").length){this.select(a);if(!a.isPropagationStopped()){this.mouseHandled=true}if(b.has(".coral-menu").length){this.expand(a)
}else{if(!this.element.is(":focus")&&$(this.document[0].activeElement).closest(".coral-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".coral-menu").length===1){clearTimeout(this.timer)}}}}},"mouseenter .coral-menu-item":function(a){if(this.previousFilter){return}var b=$(a.currentTarget);b.siblings(".coral-state-active").removeClass("coral-state-active");this.focus(a,b)},mouseleave:"collapseAll","mouseleave .coral-menu":"collapseAll",focus:function(c,a){var b=this.active||this.element.find(this.options.items).eq(0);if(!a){this.focus(c,b)}},blur:function(a){this._delay(function(){if(!$.contains(this.element[0],this.document[0].activeElement)){this.collapseAll(a)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(a){if(this._closeOnDocumentClick(a)){this.collapseAll(a)}this.mouseHandled=false}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".coral-menu").addBack().removeClass("coral-menu coral-component coral-component-content coral-menu-icons coral-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".coral-menu-item").removeClass("coral-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("coral-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var a=$(this);if(a.data("coral-menu-submenu-carat")){a.remove()}});this.element.find(".coral-menu-divider").removeClass("coral-menu-divider coral-component-content")},_keydown:function(e){var b,d,f,c,a=true;switch(e.keyCode){case $.coral.keyCode.PAGE_UP:this.previousPage(e);break;case $.coral.keyCode.PAGE_DOWN:this.nextPage(e);break;case $.coral.keyCode.HOME:this._move("first","first",e);break;case $.coral.keyCode.END:this._move("last","last",e);break;case $.coral.keyCode.UP:this.previous(e);
break;case $.coral.keyCode.DOWN:this.next(e);break;case $.coral.keyCode.LEFT:this.collapse(e);break;case $.coral.keyCode.RIGHT:if(this.active&&!this.active.is(".coral-state-disabled")){this.expand(e)}break;case $.coral.keyCode.ENTER:case $.coral.keyCode.SPACE:this._activate(e);break;case $.coral.keyCode.ESCAPE:this.collapse(e);break;default:a=false;d=this.previousFilter||"";f=String.fromCharCode(e.keyCode);c=false;clearTimeout(this.filterTimer);if(f===d){c=true}else{f=d+f}b=this._filterMenuItems(f);b=c&&b.index(this.active.next())!==-1?this.active.nextAll(".coral-menu-item"):b;if(!b.length){f=String.fromCharCode(e.keyCode);b=this._filterMenuItems(f)}if(b.length){this.focus(e,b);this.previousFilter=f;this.filterTimer=this._delay(function(){delete this.previousFilter},1000)}else{delete this.previousFilter}}if(a){e.preventDefault()}},_activate:function(a){if(!this.active.is(".coral-state-disabled")){if(this.active.is("[aria-haspopup='true']")){this.expand(a)}else{this.select(a)}}},refresh:function(){var e,b,d=this,c=this.options.icons.submenu,a=this.element.find(this.options.menus);this.element.toggleClass("coral-menu-icons",!!this.element.find(".coral-icon").length);a.filter(":not(.coral-menu)").addClass("coral-menu coral-component coral-component-content coral-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var h=$(this),g=h.parent(),f=$("<span>").addClass("coral-menu-icon coral-icon "+c).data("coral-menu-submenu-carat",true);g.attr("aria-haspopup","true").prepend(f);h.attr("aria-labelledby",g.attr("id"))});e=a.add(this.element);b=e.find(this.options.items);b.not(".coral-menu-item").each(function(){var f=$(this);if(d._isDivider(f)){f.addClass("coral-component-content coral-menu-divider")}});b.not(".coral-menu-item, .coral-menu-divider").addClass("coral-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()});b.filter(".coral-state-disabled").attr("aria-disabled","true");if(this.active&&!$.contains(this.element[0],this.active[0])){this.blur()
}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){if(a==="icons"){this.element.find(".coral-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu)}if(a==="disabled"){this.element.toggleClass("coral-state-disabled",!!b).attr("aria-disabled",b)}this._super(a,b)},focus:function(b,a){var d,c;this.blur(b,b&&b.type==="focus");this._scrollIntoView(a);this.active=a.first();c=this.active.addClass("coral-state-focus").removeClass("coral-state-active");if(this.options.role){this.element.attr("aria-activedescendant",c.attr("id"))}this.active.parent().closest(".coral-menu-item").addClass("coral-state-active");if(b&&b.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}d=a.children(".coral-menu");if(d.length&&b&&(/^mouse/.test(b.type))){this._startOpening(d)}this.activeMenu=a.parent();this._trigger("onFocus",b,{item:a})},_scrollIntoView:function(d){var g,c,e,a,b,f;if(this._hasScroll()){g=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;c=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;e=d.offset().top-this.activeMenu.offset().top-g-c;a=this.activeMenu.scrollTop();b=this.activeMenu.height();f=d.outerHeight();if(e<0){this.activeMenu.scrollTop(a+e)}else{if(e+f>b){this.activeMenu.scrollTop(a+e-b+f)}}}},blur:function(b,a){if(!a){clearTimeout(this.timer)}if(!this.active){return}this.active.removeClass("coral-state-focus");this.active=null;this._trigger("onBlur",b,{item:this.active})},_startOpening:function(a){clearTimeout(this.timer);if(a.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(a)},this.delay)},_open:function(b){var a=$.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".coral-menu").not(b.parents(".coral-menu")).hide().attr("aria-hidden","true");b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(a)},collapseAll:function(b,a){clearTimeout(this.timer);
this.timer=this._delay(function(){var c=a?this.element:$(b&&b.target).closest(this.element.find(".coral-menu"));if(!c.length){c=this.element}this._close(c);this.blur(b);this.activeMenu=c},this.delay)},_close:function(a){if(!a){a=this.active?this.active.parent():this.element}a.find(".coral-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".coral-state-active").not(".coral-state-focus").removeClass("coral-state-active")},_closeOnDocumentClick:function(a){return !$(a.target).closest(".coral-menu").length},_isDivider:function(a){return !/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(b){var a=this.active&&this.active.parent().closest(".coral-menu-item",this.element);if(a&&a.length){this._close();this.focus(b,a)}},expand:function(b){var a=this.active&&this.active.children(".coral-menu ").find(this.options.items).first();if(a&&a.length){this._open(a.parent());this._delay(function(){this.focus(b,a)})}},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".coral-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".coral-menu-item").length},_move:function(d,b,c){var a;if(this.active){if(d==="first"||d==="last"){a=this.active[d==="first"?"prevAll":"nextAll"](".coral-menu-item").eq(-1)}else{a=this.active[d+"All"](".coral-menu-item").eq(0)}}if(!a||!a.length||!this.active){a=this.activeMenu.find(this.options.items)[b]()}this.focus(c,a)},nextPage:function(c){var b,d,a;if(!this.active){this.next(c);return}if(this.isLastItem()){return}if(this._hasScroll()){d=this.active.offset().top;a=this.element.height();this.active.nextAll(".coral-menu-item").each(function(){b=$(this);return b.offset().top-d-a<0});this.focus(c,b)}else{this.focus(c,this.activeMenu.find(this.options.items)[!this.active?"first":"last"]())}},previousPage:function(c){var b,d,a;if(!this.active){this.next(c);return}if(this.isFirstItem()){return
}if(this._hasScroll()){d=this.active.offset().top;a=this.element.height();this.active.prevAll(".coral-menu-item").each(function(){b=$(this);return b.offset().top-d+a>0});this.focus(c,b)}else{this.focus(c,this.activeMenu.find(this.options.items).first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(a){this.active=this.active||$(a.target).closest(".coral-menu-item");var b={item:this.active};if(!this.active.has(".coral-menu").length){this.collapseAll(a,true)}this._trigger("onSelect",a,b)},_filterMenuItems:function(c){var a=c.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),b=new RegExp("^"+a,"i");return this.activeMenu.find(this.options.items).filter(".coral-menu-item").filter(function(){return b.test($.trim($(this).text()))})}});$.component("coral.breadcrumb",{_create:function(){this.element.wrap('<div class="coral-breadcrumb coral-module coral-component coral-component-header coral-helper-clearfix coral-corner-all" role="menu">');this.element.children("li").each(function(b){var c=$(this);c.attr("role","menuitem");var a=c.children("a");a.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />');if(b>0){c.before('<li class="coral-breadcrumb-chevron menu-rightArrow cui-icon-arrowDown1"></li>')}else{a.addClass("coral-icon coral-icon-home")}})}});$.component("coral.tieredmenu",$.coral.basemenu,{options:{autoDisplay:true},_create:function(){this._generateULContent();this._render();this.links=this.element.find(".coral-menuitem-link");this.lis=this.element.find(".coral-menuitem");this.menuitems=this.element.children("li.coral-menuitem");this._bindEvents();this._super()},_render:function(){var a=this;this.element.addClass("coral-menu-list coral-helper-reset").wrap('<div class="coral-tieredmenu coral-menu coral-component coral-component-content coral-corner-all coral-helper-clearfix" />');if(this.options.id){this.element.parent().attr("id",this.options.id)}else{this.element.parent().uniqueId();
this.options.id=this.element.parent().attr("id")}this.element.find("li").each(function(){var d=$(this),b=d.children("a"),c=b.data("icon");a._setMenuItemLinkDisabled(b);b.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />');if(c){b.prepend('<span class="menu-icon '+c+'"></span>')}d.addClass("coral-menuitem coral-component coral-corner-all");if(d.children("ul").length>0){d.addClass("coral-menu-parent");d.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow");b.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>')}})},_bindEvents:function(){this._bindItemEvents();this._bindDocumentHandler()},_bindMenuItemClick:function(c,b){var a=[];if(typeof b==="boolean"&&!b){a=this.element.find("> .coral-menuitem > .coral-menuitem-link")}c.links.not(a).on("click",function(h){if(c.options.disabled===true||$(this).hasClass("coral-state-disabled")){return}var d={};var f=$(h.target).closest("li").hasClass("coral-menu-parent");if($(this).parent("li").attr("data-id")!=null){d.id=$(this).parent("li").attr("data-id")}if($(this).attr("data-target")!=null){d.target=$(this).attr("data-target")}if($(this).attr("data-name")!=null){d.name=$(this).attr("data-name")}if($(this).attr("data-url")!=null){d.url=$(this).attr("data-url")}if($(this).find(":checkbox,:radio").length>0){d.hasChk=true;d.checked=$(this).find(":checkbox,:radio").prop("checked")}else{d.hasChk=false}var g={target:h.target,currentTarget:c,preventDefault:$.noop};d.isParent=f;c._trigger("onClick",g,d)})},_bindItemEvents:function(){var a=this;this._on(this.links,{mouseenter:function(g){var f=g.target;if(this.options.vertical||$(window).width()<900){return}if(this.options.disabled===true||$(f).hasClass("coral-state-disabled")){return}var b=$(f),d=b.parent(),c=this.options.autoDisplay,h=d.siblings(".coral-menuitem-active");if(h.length===1){this._deactivate(h)}if(c||a.active){this._activate(d)
}else{this._highlight(d)}}});this._on({"mouseleave.coral-menuitem":function(c){var b=$(c.target).closest("li");if(this.options.vertical||!this.options.autoDisplay||$(window).width()<900){return}if(this.options.disabled===true||$(c.target).closest("a").hasClass("coral-state-disabled")){return}$(b).find("ul").hide();$(b).children("a").removeClass("coral-state-hover")},mouseleave:function(b){if(this.options.vertical||!this.options.autoDisplay||$(window).width()<900){return}this.element.find("ul").hide();this.element.find(".coral-state-hover").removeClass("coral-state-hover")},"click.coral-menuitem":function(c){var b=$(c.target).closest("li");if(this.options.disabled===true||$(b).find(">a").hasClass("coral-state-disabled")){return}if(!this.options.vertical&&$(window).width()>900){if(b.find("li").length==0){if(!b.hasClass("coral-menuitem-active")){a.element.find(".coral-menuitem-active").removeClass("coral-menuitem-active");b.addClass("coral-menuitem-active");b.parents("li").addClass("coral-menuitem-active")}}}if((!this.options.vertical&&$(window).width()>900)||(this.element.parent().hasClass("coral-menu-min")&&!$(b).parents("ul").hasClass("coral-menu-child"))){return}if(b.find("li").length){if(b.hasClass("coral-menuitem-open")){b.children("ul").css({display:"none"});b.removeClass("coral-menuitem-open")}else{b.children("ul").css({display:"block"});b.addClass("coral-menuitem-open")}}else{if(!b.hasClass("coral-menuitem-active")){a.element.find(".coral-menuitem-active").removeClass("coral-menuitem-active");b.addClass("coral-menuitem-active");b.parents("li").addClass("coral-menuitem-active")}}c.stopPropagation()}});if(this.options.autoDisplay===false){this.rootLinks=this.element.find("> .coral-menuitem > .coral-menuitem-link");this.rootLinks.data("primecoral-tieredmenu-rootlink",this.options.id).find("*").data("primecoral-tieredmenu-rootlink",this.options.id);this.rootLinks.on("click.coral-menu",function(h){if(a.options.disabled===true||$(this).hasClass("coral-state-disabled")){return
}var f=$(this),g=f.parent(),c=g.children("ul.coral-menu-child");if(c.length===1){if(c.is(":visible")){a.active=false;a._deactivate(g)}else{a.active=true;a._highlight(g);a._showSubmenu(g,c)}}var b={};if($(this).parent("li").attr("data-id")!=null){b.id=$(this).parent("li").attr("data-id")}if($(this).attr("data-target")!=null){b.target=$(this).attr("data-target")}if($(this).attr("data-name")!=null){b.name=$(this).attr("data-name")}if($(this).attr("data-url")!=null){b.url=$(this).attr("data-url")}if($(this).find(":checkbox,:radio").length>0){b.hasChk=true;b.checked=$(this).find(":checkbox,:radio").prop("checked")}else{b.hasChk=false}var d={target:a,currentTarget:a,preventDefault:$.noop};a._trigger("onClick",d,b);if(!$(this).parent("li").hasClass("coral-menu-parent")){a.hide()}});this._bindMenuItemClick(a,false)}else{this._bindMenuItemClick(a,true)}this.element.parent().find("ul.coral-menu-list").on("mouseleave.coral-menu",function(b){if(a.activeitem){a._deactivate(a.activeitem)}if(!a.element.parent().hasClass("coral-menubar-horizontal")){b.stopPropagation()}})},add:function(a,c){if((typeof a!=="string"&&typeof a!=="number"&&a!==null)||(typeof c!=="object")){return}var b=this;if(typeof a==="string"||a==null){this._addByParentId(a,c)}else{if(typeof a==="number"){this._addByIndex(a,c)}}},_addByParentId:function(b,d){var c=this,a=this.element.find(".coral-menuitem").filter("[data-id$='"+b+"']");if(!a.length&&b!==null){return}if(b===null){this.element.append(this._getAddHTML(d,false));var e=this._renderAddHTML();this._bindAddItemEvents(e);this._bindLinkRootEvents($(e[0]))}else{if(this._hasChildren(a)){a.children("ul").append(this._getAddHTML(d,false))}else{a.append(this._getAddHTML(d,true))}var f=this._renderAddHTML(a);this._bindAddItemEvents(f)}},_getAddHTML:function(d,e){var c="";if(!(d instanceof Array)){d=[d]}if(typeof e==="boolean"&&e){c+="<ul>"}for(var b=0;b<d.length;b++){if(d[b].id!=""){c+='<li data-id="'+d[b].id+'">'}else{c+="<li>"}c+=this._generateANode(d[b]);var a=d[b].items;
if(a.length>0){c=this._generateHTML(c,a)}c+="</li>"}if(typeof e==="boolean"&&e){c+="</ul>"}return c},_renderAddHTML:function(a){var b=this,c=this.element.find("li").not(".coral-menuitem");if(a&&!a.children("ul").hasClass("coral-menu-list")){a.addClass("coral-menu-parent");a.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow");a.children("a").prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>')}c.each(function(){var f=$(this),d=f.children("a"),e=d.data("icon");b._setMenuItemLinkDisabled(d);d.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />');if(e){d.prepend('<span class="menu-icon '+e+'"></span>')}f.addClass("coral-menuitem coral-component coral-corner-all");if(f.children("ul").length>0){f.addClass("coral-menu-parent");f.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow");d.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>')}});return c.find(".coral-menuitem-link")},_bindLinkRootEvents:function(b){var a=this;b.data("primecoral-tieredmenu-rootlink",this.options.id).find("*").data("primecoral-tieredmenu-rootlink",this.options.id);b.on("click.coral-menu",function(g){if(a.options.disabled===true||$(this).hasClass("coral-state-disabled")){return}var d=$(this),f=d.parent(),c=f.children("ul.coral-menu-child");if(c.length===1){if(c.is(":visible")){a.active=false;a._deactivate(f)}else{a.active=true;a._highlight(f);a._showSubmenu(f,c)}}})},_bindAddItemEvents:function(b){var a=this;b.on("click",function(){if(a.options.disabled===true||$(this).hasClass("coral-state-disabled")){return}var c={};if($(this).parent("li").attr("data-id")!=null){c.id=$(this).parent("li").attr("data-id")}if($(this).attr("data-target")!=null){c.target=$(this).attr("data-target")}if($(this).attr("data-name")!=null){c.name=$(this).attr("data-name")}if($(this).attr("data-url")!=null){c.url=$(this).attr("data-url")
}if($(this).find(":checkbox,:radio").length>0){c.hasChk=true;c.checked=$(this).find(":checkbox,:radio").prop("checked")}else{c.hasChk=false}var d={target:a,currentTarget:a,preventDefault:$.noop};a._trigger("onClick",d,c);a.hide()});b.on("mouseenter",function(){if(a.options.disabled===true||$(this).hasClass("coral-state-disabled")){return}var c=$(this),e=c.parent(),d=a.options.autoDisplay;var f=e.siblings(".coral-menuitem-active");if(f.length===1){a._deactivate(f)}if(d||a.active){if(e.hasClass("coral-menuitem-active")){a._reactivate(e)}else{a._activate(e)}}else{a._highlight(e)}});b.parents("li").find("ul.coral-menu-list").on("mouseleave.coral-menu",function(c){if(a.activeitem){a._deactivate(a.activeitem)}c.stopPropagation()})},_hasChildren:function(a){if(a.hasClass("coral-menu-parent")){return true}else{return false}},_getLength:function(){return this.element.children("li").length},_addByIndex:function(b,d){var c=this,a=parseInt(b);if(a<0||a>this._getLength()){return}if(this._getLength()==0||a==this._getLength()){this.element.append(this._getAddHTML(d,false))}else{this.element.children("li:eq("+a+")").before(this._getAddHTML(d,false))}var e=this._renderAddHTML();this._bindAddItemEvents(e);this._bindLinkRootEvents($(e[0]))},remove:function(){var a=this.element.children("li");if(!a.length){return}a.remove()},removeItem:function(a){var b=this;if(typeof a==="string"){this._removeById(a)}else{this._removeByIndex(a)}},_removeById:function(b){var a=this.element.find(".coral-menuitem").filter("[data-id$='"+b+"']");if(!a.length){return}if(!a.siblings("li").length){a.parent("ul").remove()}else{a.remove()}},_removeByIndex:function(b){var a=parseInt(b);if(a<0||a>(this._getLength()-1)){return}var c=this.element.children("li.coral-menuitem:eq("+a+")");if(!c.length){return}c.remove()},updateItem:function(b,a){var c=this;if(typeof b==="string"){this._updateById(b,a)}else{this._updateByIndex(b,a)}},_updateById:function(c,a){var b=this.element.find(".coral-menuitem").filter("[data-id$='"+c+"']");
if(!b.length){return}b.children(".coral-menuitem-link").children(".coral-menuitem-text").html(a)},_updateByIndex:function(c,b){var a=parseInt(c);if(a<0||a>(this._getLength()-1)){return}var d=this.element.children("li.coral-menuitem:eq("+a+")");if(!d.length){return}d.children(".coral-menuitem-link").children(".coral-menuitem-text").html(b)},_bindDocumentHandler:function(){var a=this;$(document.body).on("click.coral-menu",function(c){var b=$(c.target);if(b.data("primecoral-tieredmenu-rootlink")===a.options.id){return}a.active=false;if(b.closest("li").find("ul").length!=0||a.element.parent().hasClass("coral-menubar-vertical")){return}a.element.find("li.coral-menuitem-active").each(function(){a._deactivate($(this),true)})})},enable:function(){var a=this.element.find(".coral-menuitem");if(!a.length){return}a.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",false).attr("aria-disabled",false)},enableItem:function(a){var b=this;if(typeof a==="string"){this._enableItemById(a)}else{this._enableItemByIndex(a)}},_enableItemById:function(b){var a=this.element.find(".coral-menuitem").filter("[data-id$='"+b+"']");if(!a.length){return}a.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",false).attr("aria-disabled",false)},_enableItemByIndex:function(b){var a=parseInt(b);if(a<0||a>(this._getLength()-1)){return}var c=this.element.children("li.coral-menuitem:eq("+a+")");if(!c.length){return}c.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",false).attr("aria-disabled",false)},disable:function(){var a=this.element.find(".coral-menuitem");if(!a.length){return}a.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",true).attr("aria-disabled",true)},disableItem:function(a){var b=this;if(typeof a==="string"){return this._disableItemById(a)}else{return this._disableItemByIndex(a)}},_disableItemById:function(b){var a=this.element.find(".coral-menuitem").filter("[data-id$='"+b+"']");
if(!a.length){return}a.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",true).attr("aria-disabled",true)},_disableItemByIndex:function(b){var a=parseInt(b);if(a<0||a>(this._getLength()-1)){return}var c=this.element.children("li.coral-menuitem:eq("+a+")");if(!c.length){return}c.children(".coral-menuitem-link").toggleClass(this.componentFullName+"-disabled coral-state-disabled",true).attr("aria-disabled",true)},hideAll:function(){var a=this.element.children("li");if(!a.length){return}a.hide()},hideItem:function(a){var b=this;if(typeof a==="string"){return b._hideById(a)}else{return b._hideByIndex(a)}},_hideById:function(b){var a=this.element.find(".coral-menuitem").filter("[data-id$='"+b+"']");if(!a.length){return}a.toggleClass("coral-tieredmenu-hidden",true)},_hideByIndex:function(b){var a=parseInt(b);if(a<0||a>(this._getLength()-1)){return}var c=this.element.children("li.coral-menuitem:eq("+a+")");if(!c.length){return}c.toggleClass("coral-tieredmenu-hidden",true)},showAll:function(){var a=this.element.children("li");if(!a.length){return}a.show()},showItem:function(a){var b=this;if(typeof a==="string"){return b._showById(a)}else{return b._showByIndex(a)}},_showById:function(b){var a=this.element.find(".coral-menuitem").filter("[data-id$='"+b+"']");if(!a.length){return}a.toggleClass("coral-tieredmenu-hidden",false)},_showByIndex:function(b){var a=parseInt(b);if(a<0||a>(this._getLength()-1)){return}var c=this.element.children("li.coral-menuitem:eq("+a+")");if(!c.length){return}c.toggleClass("coral-tieredmenu-hidden",false)},_deactivate:function(b,a){this.activeitem=null;b.children("a.coral-menuitem-link").removeClass("coral-state-hover");if(a){b.children("ul.coral-menu-child:visible").fadeOut("fast")}else{b.children("ul.coral-menu-child:visible").hide()}},_activate:function(b){this._highlight(b);var a=b.children("ul.coral-menu-child");if(a.length===1){this._showSubmenu(b,a)}},_reactivate:function(d){this.activeitem=d;var c=d.children("ul.coral-menu-child"),b=c.children("li.coral-menuitem-active:first"),a=this;
if(b.length===1){a._deactivate(b)}},_highlight:function(a){this.activeitem=a;a.children("a.coral-menuitem-link").addClass("coral-state-hover")},_showSubmenu:function(b,a){if(!a.children("li:not(.coral-tieredmenu-hidden)").length){return}if(this.options.disabled===true){return}a.css({left:b.outerWidth(),top:0,"z-index":++$.coral.zindex});a.show()}});$.component("coral.menubar",$.coral.tieredmenu,{options:{responsive:false,minmenu:false,vertical:false,autoDisplay:true},component:function(){return this.element.parent()},_create:function(){this._super();this.options.id=this.element.parent().removeAttr("id").uniqueId();if(!this.options.vertical){this.element.parent().removeClass("coral-tieredmenu").addClass("coral-menubar").addClass("coral-menubar-horizontal")}else{if(this.options.vertical){this.element.parent().addClass("coral-menubar-vertical").removeClass("coral-tieredmenu")}}this.element.find(">li>ul").addClass("coral-dropdown-menu");if(this.options.responsive){this.component().addClass("menu-responsive")}if(this.options.minmenu){this.component().addClass("coral-menu-min")}},_setOption:function(a,b){this._super(a,b);if(a=="minmenu"){if(b){this.component().removeClass("coral-menu-min").addClass("coral-menu-min")}else{if(!b){this.component().removeClass("coral-menu-min")}}}},_showSubmenu:function(e,c){var d=$(window),b=null,a={"z-index":++$.coral.zindex};if(e.parent().hasClass("coral-menu-child")){a.left=e.outerWidth();a.top=0;b=e.offset().top-d.scrollTop()}else{a.left=0;if(e.parent().parent().hasClass("coral-menu-min")){a.top=e.outerHeight()+37}else{a.top=e.outerHeight()}b=e.offset().top+a.top-d.scrollTop()}c.css("height","auto");if((b+c.outerHeight())>d.height()){a.overflow="auto";a.height=d.height()-(b+20)}c.css(a).show()}});$.component("coral.slidemenu",$.coral.basemenu,{_create:function(){this._generateULContent();this._render();this.rootList=this.element;this.content=this.element.parent();this.wrapper=this.content.parent();this.container=this.wrapper.parent();this.submenus=this.container.find("ul.coral-menu-list");
this.links=this.element.find("a.coral-menuitem-link:not(.coral-state-disabled)");this.backward=this.wrapper.children("div.coral-slidemenu-backward");this.stack=[];this.jqWidth=this.container.width();var a=this;if(!this.element.hasClass("coral-menu-dynamic")){this._applyDimensions()}this._super();this._bindEvents()},_render:function(){var a=this;this.element.addClass("coral-menu-list coral-helper-reset").wrap('<div class="coral-menu coral-slidemenu coral-component coral-component-content coral-corner-all coral-helper-clearfix"/>').wrap('<div class="coral-slidemenu-wrapper" />').after('<div class="coral-slidemenu-backward coral-component-header coral-corner-all coral-helper-clearfix">\n                    <span class="coral-icon coral-icon-triangle-1-w"></span>Back</div>').wrap('<div class="coral-slidemenu-content" />');this.element.parent().uniqueId();this.options.id=this.element.parent().attr("id");this.element.find("li").each(function(){var d=$(this),b=d.children("a"),c=b.data("icon");a._setMenuItemLinkDisabled(b);b.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />');if(c){b.prepend('<span class="menu-icon '+c+'"></span>')}d.addClass("coral-menuitem coral-component coral-corner-all");if(d.children("ul").length>0){d.addClass("coral-menu-parent");d.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow");b.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>')}})},_bindEvents:function(){var a=this;this._bindMenuItemClick(a);this.links.on("mouseenter.coral-menu",function(){$(this).addClass("coral-state-hover")}).on("mouseleave.coral-menu",function(){$(this).removeClass("coral-state-hover")}).on("click.coral-menu",function(){var c=$(this),b=c.next();if(b.length==1){a._forward(b)}});this.backward.on("click.coral-menu",function(){a._back()})},_forward:function(b){var c=this;this._push(b);var a=-1*(this._depth()*this.jqWidth);b.show().css({left:this.jqWidth});
this.rootList.animate({left:a},300,"easeInOutCirc",function(){if(c.backward.is(":hidden")){c.backward.fadeIn("fast")}})},_back:function(){var c=this,b=this._pop(),d=this._depth();var a=-1*(d*this.jqWidth);this.rootList.animate({left:a},300,"easeInOutCirc",function(){b.hide();if(d===0){c.backward.fadeOut("fast")}})},_push:function(a){this.stack.push(a)},_pop:function(){return this.stack.pop()},_last:function(){return this.stack[this.stack.length-1]},_depth:function(){return this.stack.length},_applyDimensions:function(){this.submenus.width(this.container.width());this.wrapper.height(this.rootList.outerHeight(true)+this.backward.outerHeight(true));this.content.height(this.rootList.outerHeight(true));this.rendered=true},show:function(){this.align();this.container.css("z-index",++$.coral.zindex).show();if(!this.rendered){this._applyDimensions()}}});$.component("coral.contextmenu",$.coral.tieredmenu,{options:{autoDisplay:true,target:null,event:"contextmenu"},_create:function(){this._super();this.element.parent().removeClass("coral-tieredmenu").addClass("coral-contextmenu coral-menu-dynamic coral-shadow coral-contextmenu");var a=this;this.options.target=typeof this.options.target==="string"?$("#"+this.options.target):this.options.target;this.options.target=this.options.target||$(document);if(!this.element.parent().parent().is(document.body)){this.element.parent().appendTo("body")}this.options.target.on(this.options.event+".coral-contextmenu",function(b){a.show(b)})},_bindItemEvents:function(){this._super();var a=this;this.links.bind("click",function(){if($(this).parent().hasClass("coral-menu-parent")){return false}a._hide()})},_bindDocumentHandler:function(){var a=this;$(document.body).bind("click.coral-contextmenu",function(b){if(a.element.parent().is(":hidden")){return}a._hide()})},show:function(g){if(this.options.disabled===true){g.preventDefault();g.stopPropagation();return}$(document.body).children(".coral-contextmenu:visible").hide();var f=$(window),d=g.pageX,c=g.pageY,b=this.element.parent().outerWidth(),a=this.element.parent().outerHeight();
if((d+b)>(f.width())+f.scrollLeft()){d=d-b}if((c+a)>(f.height()+f.scrollTop())){c=c-a}if(this.options.beforeShow){this.options.beforeShow.call(this)}this.element.parent().css({left:d,top:c,"z-index":++$.coral.zindex}).show();g.preventDefault();g.stopPropagation()},_hide:function(){var a=this;this.element.parent().find("li.coral-menuitem-active").each(function(){a._deactivate($(this),true)});this.element.parent().fadeOut("fast")},isVisible:function(){return this.element.parent().is(":visible")},getTarget:function(){return this.jqTarget}});$.component("coral.navigatemenubase",$.coral.basemenu,{options:{autoDisplay:true},_create:function(){this._generateULContent();this._render();this.links=this.element.find(".coral-menuitem-link:not(.coral-state-disabled)");this._bindEvents();this._super()},_render:function(){var a=this;this.element.addClass("coral-menu-list coral-helper-reset").wrap('<div class="coral-tieredmenu coral-menu coral-component coral-component-content coral-corner-all coral-helper-clearfix" />');this.element.parent().uniqueId();this.options.id=this.element.parent().attr("id");this.element.find("li").each(function(){var d=$(this),b=d.children("a"),c=b.data("icon");a._setMenuItemLinkDisabled(b);b.addClass("coral-menuitem-link coral-corner-all").contents().wrap('<span class="coral-menuitem-text" />');if(c){b.prepend('<span class="menu-icon '+c+'"></span>')}d.addClass("coral-menuitem coral-component coral-corner-all");if(d.children("ul").length>0){d.addClass("coral-menu-parent");d.css("position","static");d.children("ul").css("width","100%");d.find("ul li").css("width","auto");d.find("ul li a").css("width","auto");d.children("ul").addClass("coral-component-content coral-menu-list coral-corner-all coral-helper-clearfix coral-menu-child coral-shadow");b.prepend('<span class="menu-rightArrow cui-icon-arrowDown1"></span>')}})},_bindEvents:function(){this._bindItemEvents();this._bindDocumentHandler()},_bindItemEvents:function(){var a=this;this._bindMenuItemClick(a);
this.links.on("mouseenter.coral-menu",function(){if(a.options.disabled===true){return}var b=$(this),d=b.parent(),c=a.options.autoDisplay;var e=d.siblings(".coral-menuitem-active");if(e.length===1){a._deactivate(e)}if(c||a.active){if(d.hasClass("coral-menuitem-active")){a._reactivate(d)}else{a._activate(d)}}else{a._highlight(d)}});if(this.options.autoDisplay===false){this.rootLinks=this.element.find("> .coral-menuitem > .coral-menuitem-link");this.rootLinks.data("primecoral-tieredmenu-rootlink",this.options.id).find("*").data("primecoral-tieredmenu-rootlink",this.options.id);this.rootLinks.on("click.coral-menu",function(f){var c=$(this),d=c.parent(),b=d.children("ul.coral-menu-child");if(b.length===1){if(b.is(":visible")){a.active=false;a._deactivate(d)}else{a.active=true;a._highlight(d);a._showSubmenu(d,b)}}})}this.element.parent().find("ul.coral-menu-list").on("mouseleave.coral-menu",function(b){if(a.activeitem){}b.stopPropagation()})},_bindDocumentHandler:function(){var a=this;$(document.body).on("click.coral-menu ",function(c){var b=$(c.target);if(b.data("primecoral-tieredmenu-rootlink")===a.options.id){return}if(b.is("[type='checkbox']")){return}a.active=false;a.element.find("li.coral-menuitem-active").each(function(){if(a.options.fixmenu==="false"){a._deactivate($(this),true)}})})},_activate:function(b){this._highlight(b);var a=b.children("ul.coral-menu-child");if(a.length===1){this._showSubmenu(b,a)}},_reactivate:function(d){this.activeitem=d;var c=d.children("ul.coral-menu-child"),b=c.children("li.coral-menuitem-active:first"),a=this;if(b.length===1){a._deactivate(b)}},_highlight:function(a){this.activeitem=a;a.children("a.coral-menuitem-link").addClass("coral-state-hover");a.addClass("coral-menuitem-active")},_showSubmenu:function(b,a){if(this.options.disabled===true){return}a.css({left:b.outerWidth(),top:0,"z-index":++$.coral.zindex});a.show()}});$.component("coral.navigatemenu",$.coral.navigatemenubase,{options:{autoDisplay:true,checkable:null,fixmenu:null},_generateHTML:function(d,e){d+="<ul>";
for(var c=0;c<e.length;c++){d+="<li>";d+=this._generateANode(e[c]);var b=e[c].name;var a=e[c].items;if(a.length>0){d=this._generateLast(d,a,b)}d+="</li>"}d+="</ul>";return d},_generateLast:function(c,d,a){c+="<ul>";for(var b=0;b<d.length;b++){c+="<li>";c+=this._generateChbNode(d[b],a);c+="</li>"}c+="</ul>";return c},_generateChbNode:function(e,b){var f="<a";if(e.iconclass!=""){}if(e.name!=""){f+=" data-name='"+e.name+"'"}if(e.disabled!=""){f+=" data-disabled='"+e.disabled+"'"}if(e.url!=""){f+=" href='"+e.url+"'"}if(e.target!=""){f+=" target='"+e.target+"'"}f+=">";var d=e.checked===true?"checked":"";var a=e.disabled=="true"?"disabled=true":"";var c="<input type='radio' "+a+" name='"+b+"' "+d+" data-id='"+this.element[0].id+"_"+e.name+"'/>";if(this.options.checkable===true){c="<input type='checkbox' "+a+" "+d+" data-id='"+this.element[0].id+"_"+e.name+"'/>"}f+=c;if(e.name!=""){f+=e.name}f+="</a>";return f},_create:function(){this._super();this.element.parent().removeClass("coral-tieredmenu").addClass("coral-navigatemenu");if(this.options.fixmenu!=="false"){var b=$(this.links[0]).parent(":first").find("ul").outerHeight();var a=this.element.parent().outerHeight();this.element.parent().outerHeight(b+a-3)}if(this.options.fixmenu!=="false"){this._activate($(this.links[0]).parent());$(this.links[0]).parent(":first").find("ul").css("height","auto")}},_showSubmenu:function(e,c){var d=$(window),b=null,a={"z-index":++$.coral.zindex};if(e.parent().hasClass("coral-menu-child")){a.left=e.outerWidth();a.top=0;b=e.offset().top-d.scrollTop()}else{a.left=0;a.top=this.element.parent().outerHeight();b=e.offset().top+a.top-d.scrollTop()}c.css("height","auto");if((b+c.outerHeight())>d.height()){a.overflow="auto";a.height=d.height()-(b+20)}c.css(a).show()},check:function(a,b){$("[data-id='"+this.element[0].id+"_"+a+"']").prop("checked",b)}});

/**
 * JRA: #CORALIV-727
 */
/*
SWFObject v2.2 <http://code.google.com/p/swfobject/> 
is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
;var swfobject=function(){var D="undefined",r="object",S="Shockwave Flash",W="ShockwaveFlash.ShockwaveFlash",q="application/x-shockwave-flash",R="SWFObjectExprInst",x="onreadystatechange",O=window,j=document,t=navigator,T=false,U=[h],o=[],N=[],I=[],l,Q,E,B,J=false,a=false,n,G,m=true,M=function(){var aa=typeof j.getElementById!=D&&typeof j.getElementsByTagName!=D&&typeof j.createElement!=D,ah=t.userAgent.toLowerCase(),Y=t.platform.toLowerCase(),ae=Y?/win/.test(Y):/win/.test(ah),ac=Y?/mac/.test(Y):/mac/.test(ah),af=/webkit/.test(ah)?parseFloat(ah.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,X=!+"\v1",ag=[0,0,0],ab=null;
if(typeof t.plugins!=D&&typeof t.plugins[S]==r){ab=t.plugins[S].description;if(ab&&!(typeof t.mimeTypes!=D&&t.mimeTypes[q]&&!t.mimeTypes[q].enabledPlugin)){T=true;
X=false;ab=ab.replace(/^.*\s+(\S+\s+\S+$)/,"$1");ag[0]=parseInt(ab.replace(/^(.*)\..*$/,"$1"),10);ag[1]=parseInt(ab.replace(/^.*\.(.*)\s.*$/,"$1"),10);
ag[2]=/[a-zA-Z]/.test(ab)?parseInt(ab.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else{if(typeof O.ActiveXObject!=D){try{var ad=new ActiveXObject(W);if(ad){ab=ad.GetVariable("$version");
if(ab){X=true;ab=ab.split(" ")[1].split(",");ag=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)];}}}catch(Z){}}}return{w3:aa,pv:ag,wk:af,ie:X,win:ae,mac:ac};
}(),k=function(){if(!M.w3){return;}if((typeof j.readyState!=D&&j.readyState=="complete")||(typeof j.readyState==D&&(j.getElementsByTagName("body")[0]||j.body))){f();
}if(!J){if(typeof j.addEventListener!=D){j.addEventListener("DOMContentLoaded",f,false);}if(M.ie&&M.win){j.attachEvent(x,function(){if(j.readyState=="complete"){j.detachEvent(x,arguments.callee);
f();}});if(O==top){(function(){if(J){return;}try{j.documentElement.doScroll("left");}catch(X){setTimeout(arguments.callee,0);return;}f();})();}}if(M.wk){(function(){if(J){return;
}if(!/loaded|complete/.test(j.readyState)){setTimeout(arguments.callee,0);return;}f();})();}s(f);}}();function f(){if(J){return;}try{var Z=j.getElementsByTagName("body")[0].appendChild(C("span"));
Z.parentNode.removeChild(Z);}catch(aa){return;}J=true;var X=U.length;for(var Y=0;Y<X;Y++){U[Y]();}}function K(X){if(J){X();}else{U[U.length]=X;}}function s(Y){if(typeof O.addEventListener!=D){O.addEventListener("load",Y,false);
}else{if(typeof j.addEventListener!=D){j.addEventListener("load",Y,false);}else{if(typeof O.attachEvent!=D){i(O,"onload",Y);}else{if(typeof O.onload=="function"){var X=O.onload;
O.onload=function(){X();Y();};}else{O.onload=Y;}}}}}function h(){if(T){V();}else{H();}}function V(){var X=j.getElementsByTagName("body")[0];var aa=C(r);
aa.setAttribute("type",q);var Z=X.appendChild(aa);if(Z){var Y=0;(function(){if(typeof Z.GetVariable!=D){var ab=Z.GetVariable("$version");if(ab){ab=ab.split(" ")[1].split(",");
M.pv=[parseInt(ab[0],10),parseInt(ab[1],10),parseInt(ab[2],10)];}}else{if(Y<10){Y++;setTimeout(arguments.callee,10);return;}}X.removeChild(aa);Z=null;H();
})();}else{H();}}function H(){var ag=o.length;if(ag>0){for(var af=0;af<ag;af++){var Y=o[af].id;var ab=o[af].callbackFn;var aa={success:false,id:Y};if(M.pv[0]>0){var ae=c(Y);
if(ae){if(F(o[af].swfVersion)&&!(M.wk&&M.wk<312)){w(Y,true);if(ab){aa.success=true;aa.ref=z(Y);ab(aa);}}else{if(o[af].expressInstall&&A()){var ai={};ai.data=o[af].expressInstall;
ai.width=ae.getAttribute("width")||"0";ai.height=ae.getAttribute("height")||"0";if(ae.getAttribute("class")){ai.styleclass=ae.getAttribute("class");}if(ae.getAttribute("align")){ai.align=ae.getAttribute("align");
}var ah={};var X=ae.getElementsByTagName("param");var ac=X.length;for(var ad=0;ad<ac;ad++){if(X[ad].getAttribute("name").toLowerCase()!="movie"){ah[X[ad].getAttribute("name")]=X[ad].getAttribute("value");
}}P(ai,ah,Y,ab);}else{p(ae);if(ab){ab(aa);}}}}}else{w(Y,true);if(ab){var Z=z(Y);if(Z&&typeof Z.SetVariable!=D){aa.success=true;aa.ref=Z;}ab(aa);}}}}}function z(aa){var X=null;
var Y=c(aa);if(Y&&Y.nodeName=="OBJECT"){if(typeof Y.SetVariable!=D){X=Y;}else{var Z=Y.getElementsByTagName(r)[0];if(Z){X=Z;}}}return X;}function A(){return !a&&F("6.0.65")&&(M.win||M.mac)&&!(M.wk&&M.wk<312);
}function P(aa,ab,X,Z){a=true;E=Z||null;B={success:false,id:X};var ae=c(X);if(ae){if(ae.nodeName=="OBJECT"){l=g(ae);Q=null;}else{l=ae;Q=X;}aa.id=R;if(typeof aa.width==D||(!/%$/.test(aa.width)&&parseInt(aa.width,10)<310)){aa.width="310";
}if(typeof aa.height==D||(!/%$/.test(aa.height)&&parseInt(aa.height,10)<137)){aa.height="137";}j.title=j.title.slice(0,47)+" - Flash Player Installation";
var ad=M.ie&&M.win?"ActiveX":"PlugIn",ac="MMredirectURL="+O.location.toString().replace(/&/g,"%26")+"&MMplayerType="+ad+"&MMdoctitle="+j.title;if(typeof ab.flashvars!=D){ab.flashvars+="&"+ac;
}else{ab.flashvars=ac;}if(M.ie&&M.win&&ae.readyState!=4){var Y=C("div");X+="SWFObjectNew";Y.setAttribute("id",X);ae.parentNode.insertBefore(Y,ae);ae.style.display="none";
(function(){if(ae.readyState==4){ae.parentNode.removeChild(ae);}else{setTimeout(arguments.callee,10);}})();}u(aa,ab,X);}}function p(Y){if(M.ie&&M.win&&Y.readyState!=4){var X=C("div");
Y.parentNode.insertBefore(X,Y);X.parentNode.replaceChild(g(Y),X);Y.style.display="none";(function(){if(Y.readyState==4){Y.parentNode.removeChild(Y);}else{setTimeout(arguments.callee,10);
}})();}else{Y.parentNode.replaceChild(g(Y),Y);}}function g(ab){var aa=C("div");if(M.win&&M.ie){aa.innerHTML=ab.innerHTML;}else{var Y=ab.getElementsByTagName(r)[0];
if(Y){var ad=Y.childNodes;if(ad){var X=ad.length;for(var Z=0;Z<X;Z++){if(!(ad[Z].nodeType==1&&ad[Z].nodeName=="PARAM")&&!(ad[Z].nodeType==8)){aa.appendChild(ad[Z].cloneNode(true));
}}}}}return aa;}function u(ai,ag,Y){var X,aa=c(Y);if(M.wk&&M.wk<312){return X;}if(aa){if(typeof ai.id==D){ai.id=Y;}if(M.ie&&M.win){var ah="";for(var ae in ai){if(ai[ae]!=Object.prototype[ae]){if(ae.toLowerCase()=="data"){ag.movie=ai[ae];
}else{if(ae.toLowerCase()=="styleclass"){ah+=' class="'+ai[ae]+'"';}else{if(ae.toLowerCase()!="classid"){ah+=" "+ae+'="'+ai[ae]+'"';}}}}}var af="";for(var ad in ag){if(ag[ad]!=Object.prototype[ad]){af+='<param name="'+ad+'" value="'+ag[ad]+'" />';
}}aa.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+ah+">"+af+"</object>";N[N.length]=ai.id;X=c(ai.id);}else{var Z=C(r);Z.setAttribute("type",q);
for(var ac in ai){if(ai[ac]!=Object.prototype[ac]){if(ac.toLowerCase()=="styleclass"){Z.setAttribute("class",ai[ac]);}else{if(ac.toLowerCase()!="classid"){Z.setAttribute(ac,ai[ac]);
}}}}for(var ab in ag){if(ag[ab]!=Object.prototype[ab]&&ab.toLowerCase()!="movie"){e(Z,ab,ag[ab]);}}aa.parentNode.replaceChild(Z,aa);X=Z;}}return X;}function e(Z,X,Y){var aa=C("param");
aa.setAttribute("name",X);aa.setAttribute("value",Y);Z.appendChild(aa);}function y(Y){var X=c(Y);if(X&&X.nodeName=="OBJECT"){if(M.ie&&M.win){X.style.display="none";
(function(){if(X.readyState==4){b(Y);}else{setTimeout(arguments.callee,10);}})();}else{X.parentNode.removeChild(X);}}}function b(Z){var Y=c(Z);if(Y){for(var X in Y){if(typeof Y[X]=="function"){Y[X]=null;
}}Y.parentNode.removeChild(Y);}}function c(Z){var X=null;try{X=j.getElementById(Z);}catch(Y){}return X;}function C(X){return j.createElement(X);}function i(Z,X,Y){Z.attachEvent(X,Y);
I[I.length]=[Z,X,Y];}function F(Z){var Y=M.pv,X=Z.split(".");X[0]=parseInt(X[0],10);X[1]=parseInt(X[1],10)||0;X[2]=parseInt(X[2],10)||0;return(Y[0]>X[0]||(Y[0]==X[0]&&Y[1]>X[1])||(Y[0]==X[0]&&Y[1]==X[1]&&Y[2]>=X[2]))?true:false;
}function v(ac,Y,ad,ab){if(M.ie&&M.mac){return;}var aa=j.getElementsByTagName("head")[0];if(!aa){return;}var X=(ad&&typeof ad=="string")?ad:"screen";if(ab){n=null;
G=null;}if(!n||G!=X){var Z=C("style");Z.setAttribute("type","text/css");Z.setAttribute("media",X);n=aa.appendChild(Z);if(M.ie&&M.win&&typeof j.styleSheets!=D&&j.styleSheets.length>0){n=j.styleSheets[j.styleSheets.length-1];
}G=X;}if(M.ie&&M.win){if(n&&typeof n.addRule==r){n.addRule(ac,Y);}}else{if(n&&typeof j.createTextNode!=D){n.appendChild(j.createTextNode(ac+" {"+Y+"}"));
}}}function w(Z,X){if(!m){return;}var Y=X?"visible":"hidden";if(J&&c(Z)){c(Z).style.visibility=Y;}else{v("#"+Z,"visibility:"+Y);}}function L(Y){var Z=/[\\\"<>\.;]/;
var X=Z.exec(Y)!=null;return X&&typeof encodeURIComponent!=D?encodeURIComponent(Y):Y;}var d=function(){if(M.ie&&M.win){window.attachEvent("onunload",function(){var ac=I.length;
for(var ab=0;ab<ac;ab++){I[ab][0].detachEvent(I[ab][1],I[ab][2]);}var Z=N.length;for(var aa=0;aa<Z;aa++){y(N[aa]);}for(var Y in M){M[Y]=null;}M=null;for(var X in swfobject){swfobject[X]=null;
}swfobject=null;});}}();return{registerObject:function(ab,X,aa,Z){if(M.w3&&ab&&X){var Y={};Y.id=ab;Y.swfVersion=X;Y.expressInstall=aa;Y.callbackFn=Z;o[o.length]=Y;
w(ab,false);}else{if(Z){Z({success:false,id:ab});}}},getObjectById:function(X){if(M.w3){return z(X);}},embedSWF:function(ab,ah,ae,ag,Y,aa,Z,ad,af,ac){var X={success:false,id:ah};
if(M.w3&&!(M.wk&&M.wk<312)&&ab&&ah&&ae&&ag&&Y){w(ah,false);K(function(){ae+="";ag+="";var aj={};if(af&&typeof af===r){for(var al in af){aj[al]=af[al];}}aj.data=ab;
aj.width=ae;aj.height=ag;var am={};if(ad&&typeof ad===r){for(var ak in ad){am[ak]=ad[ak];}}if(Z&&typeof Z===r){for(var ai in Z){if(typeof am.flashvars!=D){am.flashvars+="&"+ai+"="+Z[ai];
}else{am.flashvars=ai+"="+Z[ai];}}}if(F(Y)){var an=u(aj,am,ah);if(aj.id==ah){w(ah,true);}X.success=true;X.ref=an;}else{if(aa&&A()){aj.data=aa;P(aj,am,ah,ac);
return;}else{w(ah,true);}}if(ac){ac(X);}});}else{if(ac){ac(X);}}},switchOffAutoHideShow:function(){m=false;},ua:M,getFlashPlayerVersion:function(){return{major:M.pv[0],minor:M.pv[1],release:M.pv[2]};
},hasFlashPlayerVersion:F,createSWF:function(Z,Y,X){if(M.w3){return u(Z,Y,X);}else{return undefined;}},showExpressInstall:function(Z,aa,X,Y){if(M.w3&&A()){P(Z,aa,X,Y);
}},removeSWF:function(X){if(M.w3){y(X);}},createCSS:function(aa,Z,Y,X){if(M.w3){v(aa,Z,Y,X);}},addDomLoadEvent:K,addLoadEvent:s,getQueryParamValue:function(aa){var Z=j.location.search||j.location.hash;
if(Z){if(/\?/.test(Z)){Z=Z.split("?")[1];}if(aa==null){return L(Z);}var Y=Z.split("&");for(var X=0;X<Y.length;X++){if(Y[X].substring(0,Y[X].indexOf("="))==aa){return L(Y[X].substring((Y[X].indexOf("=")+1)));
}}}return"";},expressInstallCallback:function(){if(a){var X=c(R);if(X&&l){X.parentNode.replaceChild(l,X);if(Q){w(Q,true);if(M.ie&&M.win){l.style.display="block";
}}if(E){E(B);}}a=false;}}};}();

$.component("coral.swfuploader",{options:{swfUploadOptions:null,swf:"external/swfupload.swf",uploader:"swfupload.php",auto:true,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:false,debug:false,fileObjName:"Filedata",maxFileSize:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",uploadTemplate:false,method:"post",multiple:true,formData:{},preventCaching:true,uploadedFileList:[],separator:",",progressData:"speed",queueID:false,queueSizeLimit:999,removeCompleted:true,removeTimeout:3,requeueErrors:false,successTimeout:30,uploadLimit:999,overrideEvents:[]},_create:function(){var j=this,k=this.element.clone(),b=this.options;this.options.id=this.element.attr("id");var i=$("<div />",{id:b.id+"_wrappper","class":"swfuploader",css:{height:b.height+"px",width:b.width+"px"}});this.element.append(i);var a={assume_success_timeout:b.successTimeout,button_placeholder_id:i[0].id,button_width:b.width,button_height:b.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:(b.multiple?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE),button_disabled:false,button_cursor:(b.buttonCursor=="arrow"?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND),button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:b.debug,requeue_on_error:b.requeueErrors,file_post_name:b.fileObjName,file_size_limit:b.maxFileSize,file_types:b.fileTypeExts,file_types_description:b.fileTypeDesc,file_queue_limit:b.queueSizeLimit,file_upload_limit:b.uploadLimit,flash_url:b.swf,prevent_swf_caching:b.preventCaching,post_params:b.formData,upload_url:b.uploader,use_query_string:(b.method=="get"),swfupload_loaded_handler:b.onSWFReady,file_dialog_complete_handler:this.onDialogClose,file_dialog_start_handler:this.onDialogOpen,file_queued_handler:function(m){j.onSelect.apply(j,[this,m])},file_queue_error_handler:function(m,o,n){j.onSelectError.apply(j,[this,m,o,n])},upload_complete_handler:function(m){j.onUploadComplete.apply(j,[this,m])
},upload_error_handler:function(m,o,n){j.onUploadError.apply(j,[this,m,o,n])},upload_progress_handler:function(n,o,m){j.onUploadProgress.apply(j,[this,n,o,m])},upload_start_handler:function(m){j.onUploadStart.apply(j,[this,m])},upload_success_handler:function(n,o,m){j.onUploadSuccess.apply(j,[this,n,o,m])}};if(b.swfUploadOptions){a=$.extend(a,b.swfUploadOptions)}a=$.extend(a,b);var l=swfobject.getFlashPlayerVersion();var c=(l.major>=9);if(c){window["swfuploader_"+b.id]=new SWFUpload(a);var d=window["swfuploader_"+b.id];this.element.data("swfuploader",d);$("#"+d.movieName).wrap(i);i=$("#"+b.id);i.data("swfuploader",d);$("#"+d.movieName).css({position:"absolute","z-index":1});if(!b.queueID){var g=$("<div />",{id:b.id+"-queue","class":"swfuploader-queue"});i.after(g);d.settings.queueID=b.id+"-queue";d.settings.defaultQueue=true}d.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:"Some files were not added to the queue:"};d.original=k;d.wrapper=i;d.queue=g;if(b.onInit){b.onInit.call(this.element,d)}}else{var f=b.onNoflash.call(this.element);var h=$("<div class='coral-uploader-button' style='height: 40px;'></div>").appendTo(f);var e=$("<input type='button'/>").appendTo(h);e.button({id:b.id+"-button",label:b.buttonText,onClick:function(){alert("没有安装flash或flash版本过低")}})}},addUploadCount:function(){var a=this.element.data("swfuploader");a.addUploadCount()},reduece:function(a){var d=this.element.data("swfuploader"),c=d.settings;if($("#"+a).hasClass("template-download")){d.reduceUploadCount();uploadList=c.uploadedFileList;var b=this.getValues();uploadList.splice($.inArray(a,b),1)}else{if($("#"+a).hasClass("template-upload")){downList=c.unUploadedFileList;var b=this.getUnUploadValues();downList.splice($.inArray(a,b),1)}}},setValues:function(a){var c=this.element.data("swfuploader"),b=c.settings;b.uploadedFileList=a
},cancel:function(h,j){var i=arguments,c,a,g=this;var e=this.element.data("swfuploader"),d=e.settings,f=-1;if(!d.disabled){if(typeof h==="array"||typeof h==="undefined"){if(typeof h==="undefined"){var m=e.queueData.queueLength;$("#"+d.queueID).children().each(function(){f++;if(i[1]===true){e.cancelUpload(this.id,false)}else{e.cancelUpload(this.id)}$(this).find(".data").removeClass("data");$(this).delay(1000+100*f).fadeOut(500,function(){$(this).remove()});g._trigger("onRemove",null);delete e.queueData.files[this.id];g.reduece(this.id)});e.queueData.queueSize=0;e.queueData.queueLength=0;if(d.onClearQueue){d.onClearQueue.call(this.element,m)}}else{for(var b=0;b<i.length;b++){e.cancelUpload(i[b]);$("#"+i[b]).find(".data").removeClass("data");$("#"+i[b]).delay(1000+100*b).fadeOut(500,function(){$(this).remove()});this._trigger("onRemove",null);delete e.queueData.files[i[b]];g.reduece(i[b])}}}else{var l=$("#"+h);$item=$(l);e.cancelUpload($item.attr("id"));$item.find(".data").removeClass("data");$item.delay(1000).fadeOut(500,function(){$(this).remove()});this._trigger("onRemove",null);delete e.queueData.files[h];if($("#"+h).hasClass("template-download")){e.reduceUploadCount();c=d.uploadedFileList;var k=this.getValues();c.splice($.inArray(h,k),1)}else{if($("#"+h).hasClass("template-upload")){a=d.unUploadedFileList;var k=this.getUnUploadValues();a.splice($.inArray(h,k),1)}}}}},_destroy:function(){var b=this.element.data("swfuploader"),a=b.settings;b.destroy();this.element.find(".swfuploader").remove();if(a.uploadedFileList){$("#"+a.queueID).remove()}$("#"+a.id).replaceWith(this.element);if(a.onDestroy){a.onDestroy.call(this)}delete b},disable:function(a){var c=this.element.data("swfuploader"),b=c.settings;if(a){$("#"+this.options.queueID).addClass("coral-state-disabled");b.disabled=true;this._trigger("onDisable",null,[])}else{$("#"+this.options.queueID).removeClass("coral-state-disabled");b.disabled=false;this._trigger("onEnable",null,[])}c.setButtonDisabled(a)},getQueueData:function(){var e=[],c=[];
var d=this.element.data("swfuploader"),b=d.settings;for(var a=0;a<b.uploadedFileList.length;a++){e.push(b.uploadedFileList[a].fileId)}for(var a=0;a<b.unUploadedFileList.length;a++){c.push(b.unUploadedFileList[a].fileId)}return $.merge(e,c)},getUnUploadValues:function(){var a=[];var d=this.element.data("swfuploader"),c=d.settings;for(var b=0;b<c.unUploadedFileList.length;b++){a.push(c.unUploadedFileList[b].fileId)}return a},getValues:function(){var c=[];var d=this.element.data("swfuploader"),b=d.settings;for(var a=0;a<b.uploadedFileList.length;a++){c.push(b.uploadedFileList[a].fileId)}return c},getValue:function(){var b=this.element.data("swfuploader"),a=b.settings;return this.getValues().join(a.separator)},getValidateValue:function(){return this.getValue()},_setOption:function(b,f,g){var a=arguments;var d=f;var e=this.element.data("swfuploader"),c=e.settings;this._super(b,f);switch(b){case"uploader":e.setUploadURL(f);break;case"formData":if(!g){f=$.extend(c.formData,f)}e.setPostParams(c.formData);break;case"method":if(f=="get"){e.setUseQueryString(true)}else{e.setUseQueryString(false)}break;case"fileObjName":e.setFilePostName(f);break;case"fileTypeExts":e.setFileTypes(f,c.fileTypeDesc);break;case"fileTypeDesc":e.setFileTypes(c.fileTypeExts,f);break;case"maxFileSize":e.setFileSizeLimit(f);break;case"uploadLimit":e.setFileUploadLimit(f);break;case"queueSizeLimit":e.setFileQueueLimit(f);break;case"buttonCursor":if(f=="arrow"){e.setButtonCursor(SWFUpload.CURSOR.ARROW)}else{e.setButtonCursor(SWFUpload.CURSOR.HAND)}break;case"buttonText":$("#"+this.options.id+"-button").find(".swfuploader-button-text").html(f);break;case"width":e.setButtonDimensions(f,c.height);break;case"height":e.setButtonDimensions(c.width,f);break;case"multiple":if(f){e.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES)}else{e.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILE)}break}},stop:function(){var a=this.element.data("swfuploader");a.queueData.averageSpeed=0;a.queueData.uploadSize=0;a.queueData.bytesUploaded=0;
a.queueData.uploadQueue=[];a.stopUpload();this._trigger("onStop",null,[])},upload:function(b){var c=arguments,f;var e=this.element.data("swfuploader"),d=e.settings;e.queueData.averageSpeed=0;e.queueData.uploadSize=0;e.queueData.bytesUploaded=0;e.queueData.uploadQueue=[];if(!d.disabled){if(c[0]||typeof b==="undefined"){if(typeof b==="undefined"){e.queueData.uploadSize=e.queueData.queueSize;var a=d.unUploadedFileList;e.queueData.uploadQueue.push("*");e.startUpload()}else{for(f=0;f<c.length;f++){e.queueData.uploadQueue.push(c[f])}e.startUpload(e.queueData.uploadQueue.shift())}}else{e.startUpload()}}},onDialogOpen:function(){var a=this.settings;this.queueData.errorMsg="Some files were not added to the queue:";this.queueData.filesReplaced=0;this.queueData.filesCancelled=0;if(a.onDialogOpen){a.onDialogOpen.call(this)}},onDialogClose:function(a,c,d){var b=this.settings;this.queueData.filesErrored=a-c;this.queueData.filesSelected=a;this.queueData.filesQueued=c-this.queueData.filesCancelled;this.queueData.queueLength=d;if($.inArray("onDialogClose",b.overrideEvents)<0){if(this.queueData.filesErrored>0){}}if(b.onDialogClose){b.onDialogClose.call(this,this.queueData)}if(b.auto){$("#"+b.id).swfuploader("upload","*")}},handerSWFEvent:function(){},validateFiles:function(a,b){var c=a.settings;if(c.acceptFileTypes&&!(c.acceptFileTypes.test(b.type)||c.acceptFileTypes.test(b.name))){b.error="The file is not an accepted file type."}else{if(b.size>c.maxFileSize){b.error="The File is too large."}}return b.error},onSelect:function(i,b){var c=i.settings,k,l;var a={};var e=Math.round(b.size/1024);var j="KB";if(e>1000){e=Math.round(e/1000);j="MB"}var g=e.toString().split(".");e=g[0];if(g.length>1){e+="."+g[1].substr(0,2)}e+=j;var f=b.name;if(f.length>25){f=f.substr(0,25)+"..."}itemData={fileID:b.id,instanceID:c.id,fileName:f,fileSize:e};if($.inArray("onSelect",c.overrideEvents)<0){k=c.uploadTemplate({files:[b],options:c});for(var h in itemData){k=k.replace(new RegExp("\\$\\{"+h+"\\}","g"),itemData[h])
}k=$(c.templatesContainer).html(k).children();k.addClass("template-upload fade");$("#"+c.queueID).append(k);this._trigger("onRenderUploadTmp",null,{item:k})}i.queueData.queueSize+=b.size;i.queueData.files[b.id]=b;this._trigger("onSelect",null,[{file:b}])},onSelectError:function(b,c,g,f){var d=b.settings,a,e;if($.inArray("onSelectError",d.overrideEvents)<0){switch(g){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:if(d.queueSizeLimit>f){alert("\nThe number of files selected exceeds the remaining upload limit")}else{alert("\nThe number of files selected exceeds the queue size limit")}break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:$.messageQueue({message:"The File is too large"});break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:b.queueData.errorMsg='\nThe file "'+c.name+'" is empty.';break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:b.queueData.errorMsg='\nThe file "'+c.name+'" is not an accepted file type ('+d.fileTypeDesc+").";break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:$.messageQueue({message:"The file is not an accepted file type"});break}}if(g!=SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){delete b.queueData.files[c.id]}this._trigger("onSelectError",null,[{file:c,error:f}])},onQueueComplete:function(){if(this.settings.onQueueComplete){this.settings.onQueueComplete.call(this,this.settings.queueData)}},onUploadComplete:function(b,e){var f=b.settings,g=b;var d=b.getStats();b.queueData.queueLength=d.files_queued;if(b.queueData.uploadQueue[0]=="*"){if(b.queueData.queueLength>0){b.startUpload()}else{b.queueData.uploadQueue=[];if(f.onQueueComplete){f.onQueueComplete.call(b,b.queueData)}}}else{if(b.queueData.uploadQueue.length>0){b.startUpload(b.queueData.uploadQueue.shift())}else{b.queueData.uploadQueue=[];if(f.onQueueComplete){f.onQueueComplete.call(b,b.queueData)}}}if($.inArray("onUploadComplete",f.overrideEvents)<0){if(f.removeCompleted){switch(e.filestatus){case SWFUpload.FILE_STATUS.COMPLETE:setTimeout(function(){if($("#"+e.id)){g.queueData.queueSize-=e.size;
g.queueData.queueLength-=1;delete g.queueData.files[e.id];$("#"+e.id).fadeOut(500,function(){$(this).remove()})}},f.removeTimeout*1000);break;case SWFUpload.FILE_STATUS.ERROR:if(!f.requeueErrors){setTimeout(function(){if($("#"+e.id)){g.queueData.queueSize-=e.size;g.queueData.queueLength-=1;delete g.queueData.files[e.id];$("#"+e.id).fadeOut(500,function(){$(this).remove()})}},f.removeTimeout*1000)}break}}else{e.uploaded=true}}var c=f.unUploadedFileList;var a=this.getUnUploadValues();c.splice($.inArray(e[f.prmNames.fileId],a),1);this._trigger("onComplete",null,[{file:e}])},onUploadError:function(a,c,g,f){var d=a.settings;var e="Error";switch(g){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:e="HTTP Error ("+f+")";this._trigger("onFail",null,[{file:c,error:f}]);break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:e="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:e="IO Error";this._trigger("onFail",null,[{file:c,error:f}]);break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:e="Security Error";this._trigger("onFail",null,[{file:c,error:f}]);break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+f+").");e="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:e="Failed";this._trigger("onFail",null,[{file:c,error:f}]);break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:e="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:e="Cancelled";a.queueData.queueSize-=c.size;a.queueData.queueLength-=1;if(c.status==SWFUpload.FILE_STATUS.IN_PROGRESS||$.inArray(c.id,a.queueData.uploadQueue)>=0){a.queueData.uploadSize-=c.size}delete a.queueData.files[c.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:e="Stopped";this._trigger("onFail",null,[{file:c,error:f}]);break}if($.inArray("onUploadError",d.overrideEvents)<0){}var b=a.getStats();a.queueData.uploadsErrored=b.upload_errors},onUploadProgress:function(l,e,k,h){var f=l.settings;var c=new Date();
var m=c.getTime();var i=m-l.timer;if(i>500){l.timer=m}var g=k-l.bytesLoaded;l.bytesLoaded=k;var b=l.queueData.queueBytesUploaded+k;var a=Math.round(k/h*100);var n="KB/s";var j=0;var d=(g/1024)/(i/1000);d=Math.floor(d*10)/10;if(l.queueData.averageSpeed>0){l.queueData.averageSpeed=Math.floor((l.queueData.averageSpeed+d)/2)}else{l.queueData.averageSpeed=Math.floor(d)}if(d>1000){j=(d*0.001);l.queueData.averageSpeed=Math.floor(j);n="MB/s"}if($.inArray("onUploadProgress",f.overrideEvents)<0){$("#"+e.id).find(".progressbar-value").show().css("width",a+"%");$("#"+e.id).find(".progressbar-text").text(a+"%")}this._trigger("onProgress",null,[{file:e}])},onUploadStart:function(a,b){var c=a.settings;var d=new Date();a.timer=d.getTime();a.bytesLoaded=0;if(a.queueData.uploadQueue.length==0){a.queueData.uploadSize=b.size}if(c.checkExisting){$.ajax({type:"POST",async:false,url:c.checkExisting,data:{filename:b.name},success:function(f){if(f==1){var e=confirm('A file with the name "'+b.name+'" already exists on the server.\nWould you like to replace the existing file?');if(!e){a.cancelUpload(b.id);$("#"+b.id).remove();if(a.queueData.uploadQueue.length>0&&a.queueData.queueLength>0){if(a.queueData.uploadQueue[0]=="*"){a.startUpload()}else{a.startUpload(a.queueData.uploadQueue.shift())}}}}}})}this._trigger("onStart",null,[{file:b}]);this._trigger("onSend",null,[{file:b}])},onUploadSuccess:function(k,a,g,e){var b=k.settings,m;var h=k.getStats();k.queueData.uploadsSuccessful=h.successful_uploads;k.queueData.queueBytesUploaded+=a.size;if($.inArray("onUploadSuccess",b.overrideEvents)<0){$("#"+a.id).find(".data").html(" - 上传完成")}var c=Math.round(a.size/1024);var l="KB";if(c>1000){c=Math.round(c/1000);l="MB"}var i=c.toString().split(".");c=i[0];if(i.length>1){c+="."+i[1].substr(0,2)}c+=l;var f=a.name;if(f.length>25){f=f.substr(0,25)+"..."}if($.inArray("onSelect",b.overrideEvents)<0){m=b.downloadTemplate({files:[a],options:b});for(var j in itemData){m=m.replace(new RegExp("\\$\\{"+j+"\\}","g"),itemData[j])
}if(b.uploadTemplate){m=$(b.templatesContainer).html(m).children();m.addClass("template-download fade");$("#"+a.id).replaceWith(m)}this._trigger("onRenderDownloadTmp",null,{item:m})}this._trigger("onSuccess",null,[{file:a}])}});

(function(){$.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||$('<input type="file">').prop("disabled"));$.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);function a(b){var c=b==="dragover";return function(f){f.dataTransfer=f.originalEvent&&f.originalEvent.dataTransfer;var d=f.dataTransfer;if(d&&$.inArray("Files",d.types)!==-1&&this._trigger(b,$.Event(b,{delegatedEvent:f}))!==false){f.preventDefault();if(c){d.dropEffect="copy"}}}}$.component("blueimp.fileupload",{options:{dropZone:$(document),pasteZone:undefined,fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(c,b){c=this.messages[c]||c.toString();if(b){$.each(b,function(d,e){c=c.replace("{"+d+"}",e)})}return c},formData:function(b){return b.serializeArray()},add:function(c,b){if(c.isDefaultPrevented()){return false}if(b.autoUpload||(b.autoUpload!==false&&$(this).fileupload("option","autoUpload"))){b.process().done(function(){b.submit()})}},processData:false,contentType:false,cache:false,timeout:0},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:$.support.blobSlice&&function(){var b=this.slice||this.webkitSlice||this.mozSlice;return b.apply(this,arguments)
},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(d,c,b){var e=d-this.timestamp;if(!this.bitrate||!b||e>b){this.bitrate=(c-this.loaded)*(1000/e)*8;this.loaded=c;this.timestamp=d}return this.bitrate}},_isXHRUpload:function(b){return !b.forceIframeTransport&&((!b.multipart&&$.support.xhrFileUpload)||$.support.xhrFormDataFileUpload)},_getFormData:function(b){var c;if($.type(b.formData)==="function"){return b.formData(b.form)}if($.isArray(b.formData)){return b.formData}if($.type(b.formData)==="object"){c=[];$.each(b.formData,function(d,e){c.push({name:d,value:e})});return c}return[]},_getTotal:function(c){var b=0;$.each(c,function(d,e){b+=e.size||1});return b},_initProgressObject:function(c){var b={loaded:0,total:0,bitrate:0};if(c._progress){$.extend(c._progress,b)}else{c._progress=b}},_initResponseObject:function(b){var c;if(b._response){for(c in b._response){if(b._response.hasOwnProperty(c)){delete b._response[c]}}}else{b._response={}}},_onProgress:function(f,d){if(f.lengthComputable){var c=((Date.now)?Date.now():(new Date()).getTime()),b;if(d._time&&d.progressInterval&&(c-d._time<d.progressInterval)&&f.loaded!==f.total){return}d._time=c;b=Math.floor(f.loaded/f.total*(d.chunkSize||d._progress.total))+(d.uploadedBytes||0);this._progress.loaded+=(b-d._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(c,this._progress.loaded,d.bitrateInterval);d._progress.loaded=d.loaded=b;d._progress.bitrate=d.bitrate=d._bitrateTimer.getBitrate(c,b,d.bitrateInterval);this._trigger("progress",$.Event("progress",{delegatedEvent:f}),d);this._trigger("progressall",$.Event("progressall",{delegatedEvent:f}),this._progress)}},_initProgressListener:function(b){var c=this,d=b.xhr?b.xhr():$.ajaxSettings.xhr();if(d.upload){$(d.upload).bind("progress",function(f){var g=f.originalEvent;f.lengthComputable=g.lengthComputable;f.loaded=g.loaded;f.total=g.total;c._onProgress(f,b)});b.xhr=function(){return d
}}},_isInstanceOf:function(b,c){return Object.prototype.toString.call(c)==="[object "+b+"]"},_initXHRData:function(c){var e=this,g,d=c.files[0],b=c.multipart||!$.support.xhrFileUpload,f=$.type(c.paramName)==="array"?c.paramName[0]:c.paramName;c.headers=$.extend({},c.headers);if(c.contentRange){c.headers["Content-Range"]=c.contentRange}if(!b||c.blob||!this._isInstanceOf("File",d)){c.headers["Content-Disposition"]='attachment; filename="'+encodeURI(d.name)+'"'}if(!b){c.contentType=d.type||"application/octet-stream";c.data=c.blob||d}else{if($.support.xhrFormDataFileUpload){if(c.postMessage){g=this._getFormData(c);if(c.blob){g.push({name:f,value:c.blob})}else{$.each(c.files,function(h,i){g.push({name:($.type(c.paramName)==="array"&&c.paramName[h])||f,value:i})})}}else{if(e._isInstanceOf("FormData",c.formData)){g=c.formData}else{g=new FormData();$.each(this._getFormData(c),function(h,i){g.append(i.name,i.value)})}if(c.blob){g.append(f,c.blob,d.name)}else{$.each(c.files,function(h,i){if(e._isInstanceOf("File",i)||e._isInstanceOf("Blob",i)){g.append(($.type(c.paramName)==="array"&&c.paramName[h])||f,i,i.uploadName||i.name)}})}}c.data=g}}c.blob=null},_initIframeSettings:function(b){var c=$("<a></a>").prop("href",b.url).prop("host");b.dataType="iframe "+(b.dataType||"");b.formData=this._getFormData(b);if(b.redirect&&c&&c!==location.host){b.formData.push({name:b.redirectParamName||"redirect",value:b.redirect})}},_initDataSettings:function(b){if(this._isXHRUpload(b)){if(!this._chunkedUpload(b,true)){if(!b.data){this._initXHRData(b)}this._initProgressListener(b)}if(b.postMessage){b.dataType="postmessage "+(b.dataType||"")}}else{this._initIframeSettings(b)}},_getParamName:function(b){var c=$(b.fileInput),d=b.paramName;if(!d){d=[];c.each(function(){var e=$(this),f=e.prop("name")||"files[]",g=(e.prop("files")||[1]).length;while(g){d.push(f);g-=1}});if(!d.length){d=[c.prop("name")||"files[]"]}}else{if(!$.isArray(d)){d=[d]}}return d},_initFormSettings:function(b){if(!b.form||!b.form.length){b.form=$(b.fileInput.prop("form"));
if(!b.form.length){b.form=$(this.options.fileInput.prop("form"))}}b.paramName=this._getParamName(b);if(!b.url){b.url=b.form.prop("action")||location.href}b.type=(b.type||($.type(b.form.prop("method"))==="string"&&b.form.prop("method"))||"").toUpperCase();if(b.type!=="POST"&&b.type!=="PUT"&&b.type!=="PATCH"){b.type="POST"}if(!b.formAcceptCharset){b.formAcceptCharset=b.form.attr("accept-charset")}},_getAJAXSettings:function(c){var b=$.extend({},this.options,c);this._initFormSettings(b);this._initDataSettings(b);return b},_getDeferredState:function(b){if(b.state){return b.state()}if(b.isResolved()){return"resolved"}if(b.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(b){b.success=b.done;b.error=b.fail;b.complete=b.always;return b},_getXHRPromise:function(e,d,c){var b=$.Deferred(),f=b.promise();d=d||this.options.context||f;if(e===true){b.resolveWith(d,c)}else{if(e===false){b.rejectWith(d,c)}}f.abort=b.promise;return this._enhancePromise(f)},_addConvenienceMethods:function(f,d){var c=this,b=function(e){return $.Deferred().resolveWith(c,e).promise()};d.process=function(g,e){if(g||e){d._processQueue=this._processQueue=(this._processQueue||b([this])).pipe(function(){if(d.errorThrown){return $.Deferred().rejectWith(c,[d]).promise()}return b(arguments)}).pipe(g,e)}return this._processQueue||b([this])};d.submit=function(){if(this.state()!=="pending"){d.jqXHR=this.jqXHR=(c._trigger("submit",$.Event("submit",{delegatedEvent:f}),this)!==false)&&c._onSend(f,this)}return this.jqXHR||c._getXHRPromise()};d.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}this.errorThrown="abort";c._trigger("fail",null,this);return c._getXHRPromise(false)};d.state=function(){if(this.jqXHR){return c._getDeferredState(this.jqXHR)}if(this._processQueue){return c._getDeferredState(this._processQueue)}};d.processing=function(){return !this.jqXHR&&this._processQueue&&c._getDeferredState(this._processQueue)==="pending"};d.progress=function(){return this._progress};d.response=function(){return this._response
}},_getUploadedBytes:function(d){var b=d.getResponseHeader("Range"),e=b&&b.split("-"),c=e&&e.length>1&&parseInt(e[1],10);return c&&c+1},_chunkedUpload:function(m,g){m.uploadedBytes=m.uploadedBytes||0;var f=this,d=m.files[0],e=d.size,b=m.uploadedBytes,c=m.maxChunkSize||e,i=this._blobSlice,j=$.Deferred(),l=j.promise(),h,k;if(!(this._isXHRUpload(m)&&i&&(b||c<e))||m.data){return false}if(g){return true}if(b>=e){d.error=m.i18n("uploadedBytes");return this._getXHRPromise(false,m.context,[null,"error",d.error])}k=function(){var p=$.extend({},m),n=p._progress.loaded;p.blob=i.call(d,b,b+c,d.type);p.chunkSize=p.blob.size;p.contentRange="bytes "+b+"-"+(b+p.chunkSize-1)+"/"+e;f._initXHRData(p);f._initProgressListener(p);h=((f._trigger("chunksend",null,p)!==false&&$.ajax(p))||f._getXHRPromise(false,p.context)).done(function(o,r,q){b=f._getUploadedBytes(q)||(b+p.chunkSize);if(n+p.chunkSize-p._progress.loaded){f._onProgress($.Event("progress",{lengthComputable:true,loaded:b-p.uploadedBytes,total:b-p.uploadedBytes}),p)}m.uploadedBytes=p.uploadedBytes=b;p.result=o;p.textStatus=r;p.jqXHR=q;f._trigger("chunkdone",null,p);f._trigger("chunkalways",null,p);if(b<e){k()}else{j.resolveWith(p.context,[o,r,q])}}).fail(function(o,r,q){p.jqXHR=o;p.textStatus=r;p.errorThrown=q;f._trigger("chunkfail",null,p);f._trigger("chunkalways",null,p);j.rejectWith(p.context,[o,r,q])})};this._enhancePromise(l);l.abort=function(){return h.abort()};k();return l},_beforeSend:function(c,b){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(b);this._initProgressObject(b);b._progress.loaded=b.loaded=b.uploadedBytes||0;b._progress.total=b.total=this._getTotal(b.files)||1;b._progress.bitrate=b.bitrate=0;this._active+=1;this._progress.loaded+=b.loaded;this._progress.total+=b.total},_onDone:function(b,g,f,d){var e=d._progress.total,c=d._response;if(d._progress.loaded<e){this._onProgress($.Event("progress",{lengthComputable:true,loaded:e,total:e}),d)
}c.result=d.result=b;c.textStatus=d.textStatus=g;c.jqXHR=d.jqXHR=f;this._trigger("done",null,d)},_onFail:function(d,f,e,c){var b=c._response;if(c.recalculateProgress){this._progress.loaded-=c._progress.loaded;this._progress.total-=c._progress.total}b.jqXHR=c.jqXHR=d;b.textStatus=c.textStatus=f;b.errorThrown=c.errorThrown=e;this._trigger("fail",null,c)},_onAlways:function(d,e,c,b){this._trigger("always",null,b)},_onSend:function(h,f){if(!f.submit){this._addConvenienceMethods(h,f)}var g=this,j,b,i,c,k=g._getAJAXSettings(f),d=function(){g._sending+=1;k._bitrateTimer=new g._BitrateTimer();j=j||(((b||g._trigger("send",$.Event("send",{delegatedEvent:h}),k)===false)&&g._getXHRPromise(false,k.context,b))||g._chunkedUpload(k)||$.ajax(k)).done(function(e,m,l){g._onDone(e,m,l,k)}).fail(function(e,m,l){g._onFail(e,m,l,k)}).always(function(m,n,l){g._onAlways(m,n,l,k);g._sending-=1;g._active-=1;if(k.limitConcurrentUploads&&k.limitConcurrentUploads>g._sending){var e=g._slots.shift();while(e){if(g._getDeferredState(e)==="pending"){e.resolve();break}e=g._slots.shift()}}if(g._active===0){g._trigger("stop")}});return j};this._beforeSend(h,k);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){i=$.Deferred();this._slots.push(i);c=i.pipe(d)}else{this._sequence=this._sequence.pipe(d,d);c=this._sequence}c.abort=function(){b=[undefined,"abort","abort"];if(!j){if(i){i.rejectWith(k.context,b)}return d()}return j.abort()};return this._enhancePromise(c)}return d()},_onAdd:function(p,l){var o=this,u=true,t=$.extend({},this.options,l),d=l.files,r=d.length,f=t.limitMultiFileUploads,h=t.limitMultiFileUploadSize,s=t.limitMultiFileUploadSizeOverhead,n=0,m=this._getParamName(t),c,b,q,k,g=0;if(!r){return false}if(h&&d[0].size===undefined){h=undefined}if(!(t.singleFileUploads||f||h)||!this._isXHRUpload(t)){q=[d];c=[m]}else{if(!(t.singleFileUploads||h)&&f){q=[];c=[];for(k=0;k<r;k+=f){q.push(d.slice(k,k+f));
b=m.slice(k,k+f);if(!b.length){b=m}c.push(b)}}else{if(!t.singleFileUploads&&h){q=[];c=[];for(k=0;k<r;k=k+1){n+=d[k].size+s;if(k+1===r||((n+d[k+1].size+s)>h)||(f&&k+1-g>=f)){q.push(d.slice(g,k+1));b=m.slice(g,k+1);if(!b.length){b=m}c.push(b);g=k+1;n=0}}}else{c=m}}}l.originalFiles=d;$.each(q||d,function(e,i){var j=$.extend({},l);j.files=q?i:[i];j.paramName=c[e];o._initResponseObject(j);o._initProgressObject(j);o._addConvenienceMethods(p,j);u=o._trigger("add",$.Event("add",{delegatedEvent:p}),j);return u});return u},_replaceFileInput:function(e){var b=e.fileInput,c=b.clone(true),d=b.is(document.activeElement);e.fileInputClone=c;$("<form></form>").append(c)[0].reset();b.after(c).detach();if(d){c.focus()}$.cleanData(b.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(f,g){if(g===b[0]){return c[0]}return g});if(b[0]===this.element[0]){this.element=c}},_handleFileTreeEntry:function(g,i){var d=this,h=$.Deferred(),c=function(k){if(k&&!k.entry){k.entry=g}h.resolve([k])},e=function(k){d._handleFileTreeEntries(k,i+g.name+"/").done(function(l){h.resolve(l)}).fail(c)},f=function(){j.readEntries(function(k){if(!k.length){e(b)}else{b=b.concat(k);f()}},c)},j,b=[];i=i||"";if(g.isFile){if(g._file){g._file.relativePath=i;h.resolve(g._file)}else{g.file(function(k){k.relativePath=i;h.resolve(k)},c)}}else{if(g.isDirectory){j=g.createReader();f()}else{h.resolve([])}}return h.promise()},_handleFileTreeEntries:function(b,d){var c=this;return $.when.apply($,$.map(b,function(e){return c._handleFileTreeEntry(e,d)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(c){c=c||{};var b=c.items;if(b&&b.length&&(b[0].webkitGetAsEntry||b[0].getAsEntry)){return this._handleFileTreeEntries($.map(b,function(e){var d;if(e.webkitGetAsEntry){d=e.webkitGetAsEntry();if(d){d._file=e.getAsFile()}return d}return e.getAsEntry()}))}return $.Deferred().resolve($.makeArray(c.files)).promise()},_getSingleFileInputFiles:function(d){d=$(d);var b=d.prop("webkitEntries")||d.prop("entries"),c,e;
if(b&&b.length){return this._handleFileTreeEntries(b)}c=$.makeArray(d.prop("files"));if(!c.length){e=d.prop("value");if(!e){return $.Deferred().resolve([]).promise()}c=[{name:e.replace(/^.*\\/,"")}]}else{if(c[0].name===undefined&&c[0].fileName){$.each(c,function(f,g){g.name=g.fileName;g.size=g.fileSize})}}return $.Deferred().resolve(c).promise()},_getFileInputFiles:function(b){if(!(b instanceof $)||b.length===1){return this._getSingleFileInputFiles(b)}return $.when.apply($,$.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(d){var b=this,c={fileInput:$(d.target),form:$(d.target.form)};this._getFileInputFiles(c.fileInput).always(function(e){c.files=e;if(b.options.replaceFileInput){b._replaceFileInput(c)}if(b._trigger("change",$.Event("change",{delegatedEvent:d}),c)!==false){b._onAdd(d,c)}})},_onPaste:function(d){var b=d.originalEvent&&d.originalEvent.clipboardData&&d.originalEvent.clipboardData.items,c={files:[]};if(b&&b.length){$.each(b,function(e,g){var f=g.getAsFile&&g.getAsFile();if(f){c.files.push(f)}});if(this._trigger("paste",$.Event("paste",{delegatedEvent:d}),c)!==false){this._onAdd(d,c)}}},_onDrop:function(f){f.dataTransfer=f.originalEvent&&f.originalEvent.dataTransfer;var b=this,d=f.dataTransfer,c={};if(d&&d.files&&d.files.length){f.preventDefault();this._getDroppedFiles(d).always(function(e){c.files=e;if(b._trigger("drop",$.Event("drop",{delegatedEvent:f}),c)!==false){b._onAdd(f,c)}})}},_onDragOver:a("dragover"),_onDragEnter:a("dragenter"),_onDragLeave:a("dragleave"),_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop,dragenter:this._onDragEnter,dragleave:this._onDragLeave});this._on(this.options.pasteZone,{paste:this._onPaste})}if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragenter dragleave dragover drop");
this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(b,c){var d=$.inArray(b,this._specialOptions)!==-1;if(d){this._destroyEventHandlers()}this._super(b,c);if(d){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var b=this.options;if(b.fileInput===undefined){b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else{if(!(b.fileInput instanceof $)){b.fileInput=$(b.fileInput)}}if(!(b.dropZone instanceof $)){b.dropZone=$(b.dropZone)}if(!(b.pasteZone instanceof $)){b.pasteZone=$(b.pasteZone)}},_getRegExp:function(d){var c=d.split("/"),b=c.pop();c.shift();return new RegExp(c.join("/"),b)},_isRegExpOption:function(b,c){return b!=="url"&&$.type(c)==="string"&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var c=this,b=this.options,d=this.element.data();$.each(this.element[0].attributes,function(f,e){var g=e.name.toLowerCase(),h;if(/^data-/.test(g)){g=g.slice(5).replace(/-[a-z]/g,function(i){return i.charAt(1).toUpperCase()});h=d[g];if(c._isRegExpOption(g,h)){h=c._getRegExp(h)}b[g]=h}})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(c){var b=this;if(!c||this.options.disabled){return}if(c.fileInput&&!c.files){this._getFileInputFiles(c.fileInput).always(function(d){c.files=d;b._onAdd(null,c)})}else{c.files=$.makeArray(c.files);this._onAdd(null,c)}},send:function(f){if(f&&!this.options.disabled){if(f.fileInput&&!f.files){var d=this,b=$.Deferred(),g=b.promise(),c,e;g.abort=function(){e=true;if(c){return c.abort()}b.reject(null,"abort","abort");return g};this._getFileInputFiles(f.fileInput).always(function(h){if(e){return}if(!h.length){b.reject();return}f.files=h;c=d._onSend(null,f);
c.then(function(i,k,j){b.resolve(i,k,j)},function(i,k,j){b.reject(i,k,j)})});return this._enhancePromise(g)}f.files=$.makeArray(f.files);if(f.files.length){return this._onSend(null,f)}}return this._getXHRPromise(false,f&&f.context)}})})();

(function(){var a=$.blueimp.fileupload.prototype.options.add;$.component("blueimp.fileupload",$.blueimp.fileupload,{options:{processQueue:[],add:function(d,b){var c=$(this);b.process(function(){return c.fileupload("process",b)});a.call(this,d,b)}},processActions:{},_processFile:function(f,e){var d=this,b=$.Deferred().resolveWith(d,[f]),c=b.promise();this._trigger("process",null,f);$.each(f.processQueue,function(g,h){var j=function(i){if(e.errorThrown){return $.Deferred().rejectWith(d,[e]).promise()}return d.processActions[h.action].call(d,i,h)};c=c.pipe(j,h.always&&j)});c.done(function(){d._trigger("onProcessDone",null,f);d._trigger("onProcessAlways",null,f)}).fail(function(){d._trigger("onProcessFail",null,f);d._trigger("onProcessAlways",null,f)});return c},_transformProcessQueue:function(b){var c=[];$.each(b.processQueue,function(){var d={},f=this.action,e=this.prefix===true?f:this.prefix;$.each(this,function(g,h){if($.type(h)==="string"&&h.charAt(0)==="@"){d[g]=b[h.slice(1)||(e?e+g.charAt(0).toUpperCase()+g.slice(1):g)]}else{d[g]=h}});c.push(d)});b.processQueue=c},processing:function(){return this._processing},process:function(d){var c=this,b=$.extend({},this.options,d);if(b.processQueue&&b.processQueue.length){this._transformProcessQueue(b);if(this._processing===0){this._trigger("onProcessStart")}$.each(d.files,function(e){var g=e?$.extend({},b):b,f=function(){if(d.errorThrown){return $.Deferred().rejectWith(c,[d]).promise()}return c._processFile(g,d)};g.index=e;c._processing+=1;c._processingQueue=c._processingQueue.pipe(f,f).always(function(){c._processing-=1;if(c._processing===0){c._trigger("onProcessStop")}})})}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=$.Deferred().resolveWith(this).promise()}})})();

(function(){$.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");$.component("blueimp.fileupload",$.blueimp.fileupload,{getUnUploadValues:function(){var a=[];for(var b=0;b<this.options.unUploadedFileList.length;b++){a.push(this.options.unUploadedFileList[b][this.options.prmNames.fileId])}return a},remove:function(c){var d=this;function a(f){var e=$("#"+f).data("data");if($("#"+f).hasClass("template-download")){d._trigger("remove",null,$.extend({context:$("#"+f),type:"DELETE"},e))}else{if($("#"+f).hasClass("template-upload")){if(e.abort){e.abort()}else{e.errorThrown="abort";d._trigger("fail",null,$.extend({context:$("#"+f),type:"DELETE"},e))}}}}if(c===undefined){this.options.filesContainer.children().each(function(){a(this.id)})}else{if(typeof c==="array"){for(var b=0;b<c.length;b++){a(c[b])}}else{a(c)}}this._trigger("onDelete",null)},destroy:function(){this.element.find(".fileupload-buttonbar").find(".fileinput-button").each(function(){var a=$(this).find("input:file").detach();$(this).button("destroy").append(a)});this.element.find(".ctrl-init-button").remove();this.options.filesContainer.remove();this._super()},upload:function(b){if($.isArray(b)){for(var a=0;a<b.length;a++){var c=$("#"+b[a]).data("data");if(c&&c.submit){c.submit()}}}else{var c=$("#"+b).data("data");if(c&&c.submit){c.submit()}}}});$.component("coral.fileuploader",{castProperties:["triggers"],checkIE:function(){var a=3,c=document.createElement("div"),b=c.getElementsByTagName("i");while(c.innerHTML="<!--[if gt IE "+(++a)+"]><i></i><![endif]-->",b[0]){}return a>4?a:false},options:{prmNames:{fileName:"name",fileSize:"size",fileURL:"url",fileError:"error",fileId:"id",filetype:"type"},focus:null,clearError:null,triggers:null,postData:{},autoUpload:false,removeCompleted:false,maxFileSize:"5012kb",separator:",",filesUrl:null,filesLimt:9999,multiple:"multiple",uploadBtnOptions:{icons:"",label:"+"}},_getConfig:function(){var d,g=this;var b=this.checkIE();
var c=this.options;if(!c.queueID){c.queueID=this.element[0].id+"_queueID";c.filesContainer=$("<ul/>",{"class":"files",id:c.queueID});this.element.before(c.filesContainer)}else{c.filesContainer=$("#"+c.queueID);c.filesContainer.addClass("files card-files")}if(c.queueMode=="list"){c.filesContainer.addClass("list-files")}if(c.queueMode=="card"){c.filesContainer.addClass("card-files")}if(c.queueMode!=="card"&&c.queueMode!=="list"){c.filesContainer.addClass(c.queueMode)}c.templatesContainer=this.document[0].createElement(c.filesContainer.prop("nodeName"));c.uploadTmp=function(j){var h,i;if(j.fileError){h='<div class="fileError"><span class="error"></span></div>'}else{h=""}i='<li id="${fileId}" class="fileItem"><div class="fileContent"><span class="fileThumb">${fileType}</span><div class="progress"><div class="progressbar-value"></div></div><span class="fileName" title="${fileName}">${fileName}</span><span class="fileSize">(${fileSize})k</span><span class="fileAction"><span class="progressbar-text"></span><span class="upload cui-icon-plus-circle2"></span><span class="remove cui-icon-minus-circle2"></span></span>'+h+"</div></li>";return i};c.uploadTemplate=function(p){var k="fileId_"+new Date().getTime();var j=p.options.prmNames;p.options.unUploadedFileList=p.options.unUploadedFileList||[];var m=p.options.autoUpload,i,l,h={fileName:p.files[0][j.fileName],fileSize:p.files[0][j.fileSize],fileId:p.files[0][j.fileId]||k,fileError:p.files[0][j.fileError],fileType:p.files[0][j.filetype]};p.files[0].id=h.fileId;h.fileType=h.fileName.substring(h.fileName.lastIndexOf(".")+1);p.options.unUploadedFileList.push(h);if(!m){i="disabled"}l=p.options.uploadTmp(h);for(var n in h){l=l.replace(new RegExp("\\$\\{"+n+"\\}","g"),h[n])}return l};c.downloadTmp=function(j){var h,i;if(j.fileError){h='<div class="fileError"><span class="error"></span>${fileError}</div>'}else{h=""}i='<li id="${fileId}" class="fileItem"><div class="fileContent"><span class="fileThumb">${fileType}</span><div class="progress"><div class="progressbar-value"></div></div><span class="fileName"><a href="javascript:void(0)" title="${fileName}" download="${fileName}">${fileName}</a></span><span class="fileSize">(${fileSize})k</span><span class="remove cui-icon-minus-circle2 fileAction"></span></span>'+h+"</div></li>";
return i};c.downloadTemplate=function(h){var q=h.options.prmNames;h.options.uploadedFileList=h.options.uploadedFileList||[];var i="fileId_"+new Date().getTime();var n=h.options.autoUpload,k,p,m,j={fileName:h.files[0][q.fileName],fileSize:h.files[0][q.fileSize],fileUrl:h.options[q.fileUrl],fileError:h.files[0][q.fileError],fileId:h.files[0][q.fileId]||i,fileType:h.files[0][q.filetype]};h.options.uploadedFileList.push(j);p=h.options.downloadTmp(j);for(var l in j){p=p.replace(new RegExp("\\$\\{"+l+"\\}","g"),j[l])}return p};this.useFlash=(b!==false&&b<10);if(this.options.uploadBtn){var f="fileinput-button",e=this.options.uploadBtnOptions;if(e.cls){e=$.extend({},e,{cls:f+" "+e.cls})}else{e=$.extend({},e,{cls:f})}$(this.options.uploadBtn).button(e);var a={type:"file",name:"uploadFile"};if(this.options.multiple){a.multiple="mutiple"}$("<input/>",a).appendTo($(this.options.uploadBtn));this.uploadFile=$(this.options.uploadBtn).find("input[type=file]");this.uploaderBtn=$(this.options.uploadBtn).uniqueId()}else{this.uploadFile=this.element.find("input[type=file]");this.uploaderBtn=this.element.find(".fileinput-button").uniqueId()}if(this.useFlash){this.uploadFile.hide();d={swf:$.coral.scriptPath+"external/swfupload.swf",uploader:this.options.url,auto:this.options.autoUpload,separator:this.options.separator,checkExisting:false,debug:this.options.debug,fileObjName:"uploadFile",height:130,uploadTemplate:this.options.uploadTemplate,downloadTemplate:this.options.downloadTemplate,method:"post",multi:this.options.multi,formData:this.options.formData,preventCaching:true,progressData:"percentage",queueID:this.options.queueID,queueSizeLimit:999,removeCompleted:this.options.removeCompleted,removeTimeout:this.options.removeTimeout,requeueErrors:false,successTimeout:30,uploadLimit:this.options.filesLimt,width:820,maxFileSize:this.options.maxFileSize,fileTypeExts:this.options.acceptFileTypes,onSWFReady:function(){if(g.options.filesUrl){$.ajax({type:"POST",async:false,datatype:"json",url:g.options.filesUrl,data:g.options.postData,success:function(k){for(var h=0;
h<k.length;h++){var j=g._renderDownload([k[h]]).appendTo(g.options.filesContainer);g._transition(j);g.uploaderBtn.swfuploader("addUploadCount")}},error:function(h){}})}},overrideEvents:[]};$.extend(true,d,this.options);this.uploaderBtn.swfuploader(d)}else{d={disabled:false,autoUpload:false,url:this.options.url,maxFileSize:this.options.maxFileSize,maxNumberOfFiles:this.options.maxNumberOfFiles,acceptFileTypes:this.options.acceptFileTypes,uploadTemplate:this.options.uploadTemplate,downloadTemplate:this.options.downloadTemplate,templatesContainer:this.options.templatesContainer,filesContainer:this.options.filesContainer,prependFiles:false,dataType:"json",separator:",",messages:{unknownError:"Unknown error"},processdone:function(i,h){h.context.find(".upload").button("enable")},required:true,getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(h){if(typeof(h.result)==="string"){h.result=$.parseJSON(h.result)}if(h.result&&$.isArray(h.result.files)){return h.result.files}return[]},add:function(m,k){if(m.isDefaultPrevented()){return false}var l=$(this),i,j=l.data("blueimp-fileupload"),h=j.options;if(!g.validateFile(h,k)){return}l.fileupload("process",k);k.context=g._renderUpload(k.files).data("data",k).addClass("processing");h.filesContainer[h.prependFiles?"prepend":"append"](k.context);g._forceReflow(k.context);g._transition(k.context);k.process(function(){return l.fileupload("process",k)}).always(function(){k.context.each(function(n){$(this).find(".size").text(g._formatFileSize(k.files[n].size))}).removeClass("processing")}).done(function(){k.context.find(".upload").prop("disabled",false);if((g._trigger("onSelect",m,[{file:k.files[0]}])!==false)&&(h.autoUpload||k.autoUpload)&&k.autoUpload!==false){k.submit()}}).fail(function(){if(k.files.error){k.context.each(function(o){var n=k.files[o].error;if(n){$(this).find(".error").text(n)}})}})},done:function(o,n){if(o.isDefaultPrevented()){return false}var m=$(this).data("blueimp-fileupload"),j=n.getFilesFromResponse||m.options.getFilesFromResponse,l=j(n),k,h;
if(n.context){n.context.each(function(p){var q=l[p]||{error:"Empty file upload result"};h=g._addFinishedDeferreds();g._transition($(this)).done(function(){var r=$(this);k=g._renderDownload([q]).replaceAll(r);g._forceReflow(k);g._transition(k).done(function(){n.context=$(this);g._trigger("onSuccess",o,[{file:n.files[0]}]);g._trigger("onComplete",o,[{file:n.files[0]}]);h.resolve()})})})}else{k=g._renderDownload(l)[m.options.prependFiles?"prependTo":"appendTo"](m.options.filesContainer);g._forceReflow(k);h=g._addFinishedDeferreds();g._transition(k).done(function(){n.context=$(this);g._trigger("onSuccess",o,[{file:n.files[0]}]);g._trigger("onComplete",o,[{file:n.files[0]}]);h.resolve()})}var i=g.options.unUploadedFileList;g.clearFileList(i,n)},stop:function(j){if(j.isDefaultPrevented()){return false}var i=$(this).data("blueimp-fileupload"),h=g._addFinishedDeferreds();$.when.apply($,g._getFinishedDeferreds()).done(function(){g._trigger("onStop",j)});g._transition($(this).find(".fileupload-progress")).done(function(){$(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");$(this).find(".progress-extended").html("&nbsp;");h.resolve()})},processstart:function(h){if(h.isDefaultPrevented()){return false}$(this).addClass("fileupload-processing")},processstop:function(h){if(h.isDefaultPrevented()){return false}$(this).removeClass("fileupload-processing")},fail:function(j,h){if(j.isDefaultPrevented()){return false}var i=$(this).data("blueimp-fileupload"),l,k,m,p;if(h.context){h.context.each(function(q){if(h.errorThrown!=="abort"){var r=h.files[q];r.error=r.error||h.errorThrown||h.i18n("unknownError");p=g._addFinishedDeferreds();g._transition($(this)).done(function(){var s=$(this);m=g._renderDownload([r]).replaceAll(s);g._forceReflow(m);g._transition(m).done(function(){h.context=$(this);g._trigger("onFail",j,[{file:h.files[0],error:h.files[0].error}]);g._trigger("onComplete",j,[{file:h.files[0]}]);p.resolve()})})}else{p=g._addFinishedDeferreds();g._transition($(this)).done(function(){$(this).remove();
g._trigger("onRemove",j);p.resolve()})}})}else{if(h.errorThrown!=="abort"){h.context=g._renderUpload(h.files)[i.options.prependFiles?"prependTo":"appendTo"](i.options.filesContainer).data("data",h);g._forceReflow(h.context);p=g._addFinishedDeferreds();g._transition(h.context).done(function(){h.context=$(this);g._trigger("onFail",j,[{file:h.files[0],error:h.files[0].error}]);g._trigger("onComplete",j,[{file:h.files[0]}]);p.resolve()})}else{g._trigger("onFail",j,[{file:h.files[0],error:h.files[0].error}]);g._trigger("onComplete",j,[{file:h.files[0]}]);g._addFinishedDeferreds().resolve()}}var o=g.options.uploadedFileList;g.clearFileList(o,h);var n=g.options.unUploadedFileList;g.clearFileList(n,h)},progress:function(j,i){if(j.isDefaultPrevented()){return false}var h=Math.floor(i.loaded/i.total*100);if(i.context){i.context.each(function(){$(this).find(".progressbar-value").show().css("width",h+"%");$(this).find(".progressbar-text").text(h+"%")})}g._trigger("onProgress",j,[{file:i.files[0]}])},progressall:function(l,j){if(l.isDefaultPrevented()){return false}var k=$(this),i=Math.floor(j.loaded/j.total*100),h=k.find(".fileupload-progress"),m=h.find(".progress-extended");if(m.length){m.html(g._renderExtendedProgress(j))}},start:function(i){if(i.isDefaultPrevented()){return false}var h=$(this).data("blueimp-fileupload");g._resetFinishedDeferreds();g._transition($(this).find(".fileupload-progress")).done(function(){g._trigger("onStart",i)})},send:function(i,h){if(i.isDefaultPrevented()){return false}if(h.context&&h.dataType&&h.dataType.substr(0,6)==="iframe"){h.context.find(".progress").addClass(!$.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%")}return g._trigger("onSend",i,[{file:h.files[0]}])},remove:function(l,k){if(l.isDefaultPrevented()){return false}var i=$(this).data("blueimp-fileupload"),j,h,m=function(){g._transition(k.context).done(function(){$(this).remove();g._trigger("onRemove",l)})};if(k.url){k.dataType=k.dataType||i.options.dataType;
$.ajax(k).done(m).fail(function(){g._trigger("onRemoveFailed",l)})}else{m()}var h=g.options.uploadedFileList;g.clearFileList(h,k)}};$.extend(true,d,this.options);this.uploaderBtn.fileupload(d);if(this.options.filesUrl){$.ajax({type:"POST",async:false,datatype:"json",url:this.options.filesUrl,data:this.options.postData,success:function(k){for(var h=0;h<k.length;h++){var j=g._renderDownload([k[h]]).appendTo(g.options.filesContainer);g._transition(j)}},error:function(h){}})}}},upload:function(b){var a=this.checkIE(),c=[];if(this.useFlash){this.uploaderBtn.swfuploader("upload",b)}else{if(b===undefined){b=this.getUnUploadValues()}this.uploaderBtn.fileupload("upload",b)}},_destroy:function(){var a=this.checkIE(),b=[];if(this.useFlash){this.uploaderBtn.swfuploader("destroy")}else{this.uploaderBtn.fileupload("destroy")}},remove:function(b){var a=this.checkIE(),c=[];if(this.useFlash){this.uploaderBtn.swfuploader("cancel",b)}else{this.uploaderBtn.fileupload("remove",b)}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(a){if(!a){a=$.Deferred()}this._finishedUploads.push(a);return a},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var d=$(this),b=d.prop("href"),a=d.prop("download"),c="application/octet-stream";d.bind("dragstart",function(f){try{f.originalEvent.dataTransfer.setData("DownloadURL",[c,a,b].join(":"))}catch(g){}})},_formatFileSize:function(a){if(typeof a!=="number"){return""}if(a>=1000000000){return(a/1000000000).toFixed(2)+" GB"}if(a>=1000000){return(a/1000000).toFixed(2)+" MB"}return(a/1000).toFixed(2)+" KB"},_formatBitrate:function(a){if(typeof a!=="number"){return""}if(a>=1000000000){return(a/1000000000).toFixed(2)+" Gbit/s"}if(a>=1000000){return(a/1000000).toFixed(2)+" Mbit/s"}if(a>=1000){return(a/1000).toFixed(2)+" kbit/s"}return a.toFixed(2)+" bit/s"},_formatTime:function(b){var a=new Date(b*1000),c=Math.floor(b/86400);c=c?c+"d ":"";return c+("0"+a.getUTCHours()).slice(-2)+":"+("0"+a.getUTCMinutes()).slice(-2)+":"+("0"+a.getUTCSeconds()).slice(-2)
},_formatPercentage:function(a){return(a*100).toFixed(2)+" %"},_renderExtendedProgress:function(a){return this._formatBitrate(a.bitrate)+" | "+this._formatTime((a.total-a.loaded)*8/a.bitrate)+" | "+this._formatPercentage(a.loaded/a.total)+" | "+this._formatFileSize(a.loaded)+" / "+this._formatFileSize(a.total)},_renderTemplate:function(c,b){if(!c){return $()}var a=c({files:b,formatFileSize:this._formatFileSize,options:this.options});if(a instanceof $){return a}return $(this.options.templatesContainer).html(a).children()},_renderPreviews:function(a){a.context.find(".preview").each(function(b,c){$(c).append(a.files[b].preview)})},_renderUpload:function(c,b){var a=this._renderTemplate(this.options.uploadTemplate,c);a.addClass("template-upload fade");if(a.hasClass("fade")){a.hide()}this._trigger("onRenderUploadTmp",null,{item:a});return a},_renderDownload:function(b){var a=this._renderTemplate(this.options.downloadTemplate,b).find("a[download]").each(this._enableDragToDesktop).end();a.addClass("template-download fade");if(a.hasClass("fade")){a.hide()}this._trigger("onRenderDownloadTmp",null,{item:a});return a},_forceReflow:function(a){return $.support.transition&&a.length&&a[0].offsetWidth},_transition:function(b){var a=$.Deferred();if(b.hasClass("fade")){b.fadeToggle(this.options.transitionDuration,this.options.transitionEasing,function(){a.resolveWith(b)})}else{a.resolveWith(b)}return a},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".upload, .remove"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",false).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",true).parent().addClass("disabled")
},_create:function(){var a=this.options;this.options.id=this.element.uniqueId().attr("id");this._super();this._resetFinishedDeferreds();if(!$.support.fileInput){this._disableFileInputButton()}this.element.find(".fileupload-buttonbar").find(".fileinput-button").each(function(){});a.uploadedFileList=[];a.unUploadedFileList=[];this._getConfig();if(a.beforeCreate){a.beforeCreate.apply(this)}else{this.beforeCreate()}},beforeCreate:function(){var a=this;this._on(this.options.filesContainer,{"click .upload":function(c){c.preventDefault();var b=$(c.currentTarget).closest(".template-upload");$("#"+a.element[0].id).fileuploader("upload",b[0].id)},"click .remove":function(c){c.preventDefault();var b=$(c.currentTarget).closest(".template-upload,.template-download");$("#"+a.element[0].id).fileuploader("remove",b[0].id)},"click .stop":function(c){c.preventDefault();var b=$(c.currentTarget).closest(".template-upload");$("#"+a.element[0].id).fileuploader("stop",b[0].id)}})},clearFileList:function(c,d){var b,a;if(c===this.options.uploadedFileList){b=this.getValues()}else{if(c===this.options.unUploadedFileList){b=this.getUnUploadValues()}}a=$.inArray(d.context[0][this.options.prmNames.fileId],b);if(a!==-1){c.splice(a,1)}else{c.splice(a,0)}},validateFile:function(b,e){var c=e.files[0].name.substring(e.files[0].name.lastIndexOf(".")+1);c=$.trim(c);var d=$.trim(b.acceptFileTypes);var a=this.getQueueData(),f=this.formatMaxSize(b.maxFileSize);if(a.length>=b.filesLimt){$.messageQueue({message:"Maximum number of files exceeded"});return false}if(e.files[0].size>=f){$.messageQueue({message:"The File is too large"});return false}if(d=="*.*"){return true}else{if(d.indexOf(c)==-1){$.messageQueue({message:"The file is not an accepted file type"});return false}}return true},formatMaxSize:function(b){var d=new RegExp("/^s*|s*$/"),e,c,f=1024;b=b.toLowerCase();b=b.replace(d,"");var a=b.match(/^\d+/);if(a!==null&&a.length>0){c=parseInt(a[0])}if(isNaN(c)||c<0){c=0}e=c*f;return e},getQueueData:function(){var c=[],b=[];
for(var a=0;a<this.options.uploadedFileList.length;a++){c.push(this.options.uploadedFileList[a].fileId)}for(var a=0;a<this.options.unUploadedFileList.length;a++){b.push(this.options.unUploadedFileList[a].fileId)}return $.merge(c,b)},getValues:function(){var b=[];for(var a=0;a<this.options.uploadedFileList.length;a++){b.push(this.options.uploadedFileList[a].fileId)}return b},getValidateValue:function(){var a=this.checkIE();if(this.useFlash){return this.uploaderBtn.swfuploader("getValidateValue")}else{return this.getValue()}},setValue:function(b){var a=this.checkIE();if(this.useFlash){this.uploaderBtn.swfuploader("setValues",b)}else{}},getValue:function(){var a=this.checkIE();if(this.useFlash){return this.uploaderBtn.swfuploader("getValue")}else{return this.getValues().join(this.options.separator)}},clearError:function(){},focus:function(){},getUnUploadValues:function(){var a=[];for(var b=0;b<this.options.unUploadedFileList.length;b++){a.push(this.options.unUploadedFileList[b].fileId)}return a},enable:function(){var a=this.checkIE();if(this.useFlash){this.uploaderBtn.swfuploader("disable",false)}else{var b=false;if(this.options.disabled){b=true}this._super();if(b){this.element.find("input, button").prop("disabled",false);this._enableFileInputButton();this.options.filesContainer.prop("disabled",false).removeClass("coral-state-disabled")}this.options.disabled=false;this._trigger("onEnable",null,[])}},disable:function(){var a=this.checkIE();if(this.useFlash){this.uploaderBtn.swfuploader("disable",true)}else{if(!this.options.disabled){this.element.find("input, button").prop("disabled",true);this._disableFileInputButton();this.options.filesContainer.prop("disabled",true).addClass("coral-state-disabled")}this._super();this.options.disabled=true;this._trigger("onDisable",null,[])}}})})();

(function(){var b={init:function(c,d){return this.each(function(){var p=$(this);var o=p.clone();var i=$.extend({id:p.attr("id"),swf:$.coral.scriptPath+"external/swfupload.swf",uploader:"swfupload.php",auto:true,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:false,debug:false,fileObjName:"Filedata",fileSizeLimit:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",height:30,itemTemplate:false,method:"post",multi:true,formData:{},preventCaching:true,progressData:"percentage",queueID:false,queueSizeLimit:999,removeCompleted:true,removeTimeout:3,requeueErrors:false,successTimeout:30,uploadLimit:0,width:120,overrideEvents:[]},c);var f={assume_success_timeout:i.successTimeout,button_placeholder_id:i.id,button_width:i.width,button_height:i.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:(i.multi?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE),button_disabled:false,button_cursor:(i.buttonCursor=="arrow"?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND),button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:i.debug,requeue_on_error:i.requeueErrors,file_post_name:i.fileObjName,file_size_limit:i.fileSizeLimit,file_types:i.fileTypeExts,file_types_description:i.fileTypeDesc,file_queue_limit:i.queueSizeLimit,file_upload_limit:i.uploadLimit,flash_url:i.swf,prevent_swf_caching:i.preventCaching,post_params:i.formData,upload_url:i.uploader,use_query_string:(i.method=="get"),file_dialog_complete_handler:a.onDialogClose,file_dialog_start_handler:a.onDialogOpen,file_queued_handler:a.onSelect,file_queue_error_handler:a.onSelectError,swfupload_loaded_handler:i.onSWFReady,upload_complete_handler:a.onUploadComplete,upload_error_handler:a.onUploadError,upload_progress_handler:a.onUploadProgress,upload_start_handler:a.onUploadStart,upload_success_handler:a.onUploadSuccess};if(d){f=$.extend(f,d)}f=$.extend(f,i);var q=swfobject.getFlashPlayerVersion();var g=(q.major>=9);
if(g){window["uploadify_"+i.id]=new SWFUpload(f);var h=window["uploadify_"+i.id];p.data("uploadify",h);var n=$("<div />",{id:i.id,"class":"uploadify",css:{height:i.height+"px",width:i.width+"px"}});$("#"+h.movieName).wrap(n);n=$("#"+i.id);n.data("uploadify",h);var e=$("<div />",{id:i.id+"-button","class":"uploadify-button "+i.buttonClass});if(i.buttonImage){e.css({"background-image":"url('"+i.buttonImage+"')","text-indent":"-9999px"})}e.html('<span class="uploadify-button-text">'+i.buttonText+"</span>").css({height:i.height+"px","line-height":i.height+"px",width:i.width+"px"});n.append(e);$("#"+h.movieName).css({position:"absolute","z-index":1});if(!i.queueID){var l=$("<div />",{id:i.id+"-queue","class":"uploadify-queue"});n.after(l);h.settings.queueID=i.id+"-queue";h.settings.defaultQueue=true}h.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:"Some files were not added to the queue:"};h.original=o;h.wrapper=n;h.button=e;h.queue=l;if(i.onInit){i.onInit.call(p,h)}}else{if(i.onFallback){i.onFallback.call(p)}var k=i.onNoflash.call(p);var m=$("<div class='coral-uploader-button' style='height: 40px;'></div>").appendTo(k);var j=$("<input type='button'/>").appendTo(m);j.button({id:i.id+"-button",label:i.buttonText,onClick:function(){alert("没有安装flash或flash版本过低")}})}})},cancel:function(c,e){var d=arguments;this.each(function(){var k=$(this),h=k.data("uploadify"),i=h.settings,g=-1;if(d[0]){if(d[0]=="*"){var f=h.queueData.queueLength;$("#"+i.queueID).find(".uploadify-queue-item").each(function(){g++;if(d[1]===true){h.cancelUpload($(this).attr("id"),false)}else{h.cancelUpload($(this).attr("id"))}$(this).find(".data").removeClass("data").html(" - Cancelled");$(this).find(".uploadify-progress-bar").remove();$(this).delay(1000+100*g).fadeOut(500,function(){$(this).remove()});delete h.queueData.files[c]
});h.queueData.queueSize=0;h.queueData.queueLength=0;if(i.onClearQueue){i.onClearQueue.call(k,f)}}else{for(var l=0;l<d.length;l++){h.cancelUpload(d[l]);$("#"+d[l]).find(".data").removeClass("data").html(" - Cancelled");$("#"+d[l]).find(".uploadify-progress-bar").remove();$("#"+d[l]).delay(1000+100*l).fadeOut(500,function(){$(this).remove()});delete h.queueData.files[c]}}}else{var j=$("#"+i.queueID).find(".uploadify-queue-item").get(0);$item=$(j);h.cancelUpload($item.attr("id"));$item.find(".data").removeClass("data").html(" - Cancelled");$item.find(".uploadify-progress-bar").remove();$item.delay(1000).fadeOut(500,function(){$(this).remove()});delete h.queueData.files[c]}})},destroy:function(){this.each(function(){var e=$(this),c=e.data("uploadify"),d=c.settings;c.destroy();if(d.defaultQueue){$("#"+d.queueID).remove()}$("#"+d.id).replaceWith(c.original);if(d.onDestroy){d.onDestroy.call(this)}delete c})},disable:function(c){this.each(function(){var f=$(this),d=f.data("uploadify"),e=d.settings;if(c){d.button.addClass("disabled");if(e.onDisable){e.onDisable.call(this)}}else{d.button.removeClass("disabled");if(e.onEnable){e.onEnable.call(this)}}d.setButtonDisabled(c)})},settings:function(d,f,g){var c=arguments;var e=f;this.each(function(){var j=$(this),h=j.data("uploadify"),i=h.settings;if(typeof(c[0])=="object"){for(var k in f){setData(k,f[k])}}if(c.length===1){e=i[d]}else{switch(d){case"uploader":h.setUploadURL(f);break;case"formData":if(!g){f=$.extend(i.formData,f)}h.setPostParams(i.formData);break;case"method":if(f=="get"){h.setUseQueryString(true)}else{h.setUseQueryString(false)}break;case"fileObjName":h.setFilePostName(f);break;case"fileTypeExts":h.setFileTypes(f,i.fileTypeDesc);break;case"fileTypeDesc":h.setFileTypes(i.fileTypeExts,f);break;case"fileSizeLimit":h.setFileSizeLimit(f);break;case"uploadLimit":h.setFileUploadLimit(f);break;case"queueSizeLimit":h.setFileQueueLimit(f);break;case"buttonImage":h.button.css("background-image",settingValue);break;case"buttonCursor":if(f=="arrow"){h.setButtonCursor(SWFUpload.CURSOR.ARROW)
}else{h.setButtonCursor(SWFUpload.CURSOR.HAND)}break;case"buttonText":$("#"+i.id+"-button").find(".uploadify-button-text").html(f);break;case"width":h.setButtonDimensions(f,i.height);break;case"height":h.setButtonDimensions(i.width,f);break;case"multi":if(f){h.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILES)}else{h.setButtonAction(SWFUpload.BUTTON_ACTION.SELECT_FILE)}break}i[d]=f}});if(c.length===1){return e}},stop:function(){this.each(function(){var d=$(this),c=d.data("uploadify");c.queueData.averageSpeed=0;c.queueData.uploadSize=0;c.queueData.bytesUploaded=0;c.queueData.uploadQueue=[];c.stopUpload()})},upload:function(){var c=arguments;this.each(function(){var e=$(this),d=e.data("uploadify");d.queueData.averageSpeed=0;d.queueData.uploadSize=0;d.queueData.bytesUploaded=0;d.queueData.uploadQueue=[];if(c[0]){if(c[0]=="*"){d.queueData.uploadSize=d.queueData.queueSize;d.queueData.uploadQueue.push("*");d.startUpload()}else{for(var f=0;f<c.length;f++){d.queueData.uploadSize+=d.queueData.files[c[f]].size;d.queueData.uploadQueue.push(c[f])}d.startUpload(d.queueData.uploadQueue.shift())}}else{d.startUpload()}})}};var a={onDialogOpen:function(){var c=this.settings;this.queueData.errorMsg="Some files were not added to the queue:";this.queueData.filesReplaced=0;this.queueData.filesCancelled=0;if(c.onDialogOpen){c.onDialogOpen.call(this)}},onDialogClose:function(c,e,f){var d=this.settings;this.queueData.filesErrored=c-e;this.queueData.filesSelected=c;this.queueData.filesQueued=e-this.queueData.filesCancelled;this.queueData.queueLength=f;if($.inArray("onDialogClose",d.overrideEvents)<0){if(this.queueData.filesErrored>0){alert(this.queueData.errorMsg)}}if(d.onDialogClose){d.onDialogClose.call(this,this.queueData)}if(d.auto){$("#"+d.id).uploadify("upload","*")}},onSelect:function(g){var h=this.settings;var e={};for(var f in this.queueData.files){e=this.queueData.files[f];if(e.uploaded!=true&&e.name==g.name){var c=confirm('The file named "'+g.name+'" is already in the queue.\nDo you want to replace the existing item in the queue?');
if(!c){this.cancelUpload(g.id);this.queueData.filesCancelled++;return false}else{$("#"+e.id).remove();delete this.queueData.files[f];this.cancelUpload(e.id);this.queueData.filesReplaced++}}}var i=Math.round(g.size/1024);var m="KB";if(i>1000){i=Math.round(i/1000);m="MB"}var k=i.toString().split(".");i=k[0];if(k.length>1){i+="."+k[1].substr(0,2)}i+=m;var j=g.name;if(j.length>25){j=j.substr(0,25)+"..."}itemData={fileID:g.id,instanceID:h.id,fileName:j,fileSize:i};if(h.itemTemplate==false){h.itemTemplate='<div id="${fileID}" class="uploadify-queue-item">					<div class="cancel">						<a href="javascript:$(\'#${instanceID}\').uploadify(\'cancel\', \'${fileID}\')">X</a>					</div>					<span class="fileName">${fileName} (${fileSize})</span><span class="data"></span>					<div class="uploadify-progress">						<div class="uploadify-progress-bar"><!--Progress Bar--></div>					</div>				</div>'}if($.inArray("onSelect",h.overrideEvents)<0){itemHTML=h.itemTemplate;for(var l in itemData){itemHTML=itemHTML.replace(new RegExp("\\$\\{"+l+"\\}","g"),itemData[l])}$("#"+h.queueID).append(itemHTML)}this.queueData.queueSize+=g.size;this.queueData.files[g.id]=g;if(h.onSelect){h.onSelect.apply(this,arguments)}},onSelectError:function(c,f,e){var d=this.settings;if($.inArray("onSelectError",d.overrideEvents)<0){switch(f){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:if(d.queueSizeLimit>e){this.queueData.errorMsg+="\nThe number of files selected exceeds the remaining upload limit ("+e+")."}else{this.queueData.errorMsg+="\nThe number of files selected exceeds the queue size limit ("+d.queueSizeLimit+")."}break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+c.name+'" exceeds the size limit ('+d.fileSizeLimit+").";break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:this.queueData.errorMsg+='\nThe file "'+c.name+'" is empty.';break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:this.queueData.errorMsg+='\nThe file "'+c.name+'" is not an accepted file type ('+d.fileTypeDesc+").";
break}}if(f!=SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){delete this.queueData.files[c.id]}if(d.onSelectError){d.onSelectError.apply(this,arguments)}},onQueueComplete:function(){if(this.settings.onQueueComplete){this.settings.onQueueComplete.call(this,this.settings.queueData)}},onUploadComplete:function(e){var f=this.settings,c=this;var d=this.getStats();this.queueData.queueLength=d.files_queued;if(this.queueData.uploadQueue[0]=="*"){if(this.queueData.queueLength>0){this.startUpload()}else{this.queueData.uploadQueue=[];if(f.onQueueComplete){f.onQueueComplete.call(this,this.queueData)}}}else{if(this.queueData.uploadQueue.length>0){this.startUpload(this.queueData.uploadQueue.shift())}else{this.queueData.uploadQueue=[];if(f.onQueueComplete){f.onQueueComplete.call(this,this.queueData)}}}if($.inArray("onUploadComplete",f.overrideEvents)<0){if(f.removeCompleted){switch(e.filestatus){case SWFUpload.FILE_STATUS.COMPLETE:setTimeout(function(){if($("#"+e.id)){c.queueData.queueSize-=e.size;c.queueData.queueLength-=1;delete c.queueData.files[e.id];$("#"+e.id).fadeOut(500,function(){$(this).remove()})}},f.removeTimeout*1000);break;case SWFUpload.FILE_STATUS.ERROR:if(!f.requeueErrors){setTimeout(function(){if($("#"+e.id)){c.queueData.queueSize-=e.size;c.queueData.queueLength-=1;delete c.queueData.files[e.id];$("#"+e.id).fadeOut(500,function(){$(this).remove()})}},f.removeTimeout*1000)}break}}else{e.uploaded=true}}if(f.onUploadComplete){f.onUploadComplete.call(this,e)}},onUploadError:function(d,h,g){var e=this.settings;var f="Error";switch(h){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:f="HTTP Error ("+g+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:f="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:f="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:f="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+g+").");f="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:f="Failed";
break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:f="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:f="Cancelled";this.queueData.queueSize-=d.size;this.queueData.queueLength-=1;if(d.status==SWFUpload.FILE_STATUS.IN_PROGRESS||$.inArray(d.id,this.queueData.uploadQueue)>=0){this.queueData.uploadSize-=d.size}if(e.onCancel){e.onCancel.call(this,d)}delete this.queueData.files[d.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:f="Stopped";break}if($.inArray("onUploadError",e.overrideEvents)<0){if(h!=SWFUpload.UPLOAD_ERROR.FILE_CANCELLED&&h!=SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED){$("#"+d.id).addClass("uploadify-error")}$("#"+d.id).find(".uploadify-progress-bar").css("width","1px");if(h!=SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND&&d.status!=SWFUpload.FILE_STATUS.COMPLETE){$("#"+d.id).find(".data").html(" - "+f)}}var c=this.getStats();this.queueData.uploadsErrored=c.upload_errors;if(e.onUploadError){e.onUploadError.call(this,d,h,g,f)}},onUploadProgress:function(f,l,i){var g=this.settings;var d=new Date();var m=d.getTime();var j=m-this.timer;if(j>500){this.timer=m}var h=l-this.bytesLoaded;this.bytesLoaded=l;var c=this.queueData.queueBytesUploaded+l;var o=Math.round(l/i*100);var n="KB/s";var k=0;var e=(h/1024)/(j/1000);e=Math.floor(e*10)/10;if(this.queueData.averageSpeed>0){this.queueData.averageSpeed=Math.floor((this.queueData.averageSpeed+e)/2)}else{this.queueData.averageSpeed=Math.floor(e)}if(e>1000){k=(e*0.001);this.queueData.averageSpeed=Math.floor(k);n="MB/s"}if($.inArray("onUploadProgress",g.overrideEvents)<0){if(g.progressData=="percentage"){$("#"+f.id).find(".data").html(" - "+o+"%")}else{if(g.progressData=="speed"&&j>500){$("#"+f.id).find(".data").html(" - "+this.queueData.averageSpeed+n)}}$("#"+f.id).find(".uploadify-progress-bar").css("width",o+"%")}if(g.onUploadProgress){g.onUploadProgress.call(this,f,l,i,c,this.queueData.uploadSize)}},onUploadStart:function(c){var d=this.settings;
var e=new Date();this.timer=e.getTime();this.bytesLoaded=0;if(this.queueData.uploadQueue.length==0){this.queueData.uploadSize=c.size}if(d.checkExisting){$.ajax({type:"POST",async:false,url:d.checkExisting,data:{filename:c.name},success:function(g){if(g==1){var f=confirm('A file with the name "'+c.name+'" already exists on the server.\nWould you like to replace the existing file?');if(!f){this.cancelUpload(c.id);$("#"+c.id).remove();if(this.queueData.uploadQueue.length>0&&this.queueData.queueLength>0){if(this.queueData.uploadQueue[0]=="*"){this.startUpload()}else{this.startUpload(this.queueData.uploadQueue.shift())}}}}}})}if(d.onUploadStart){d.onUploadStart.call(this,c)}},onUploadSuccess:function(e,g,c){var f=this.settings;var d=this.getStats();this.queueData.uploadsSuccessful=d.successful_uploads;this.queueData.queueBytesUploaded+=e.size;if($.inArray("onUploadSuccess",f.overrideEvents)<0){$("#"+e.id).find(".data").html(" - 上传完成")}if(f.onUploadSuccess){f.onUploadSuccess.call(this,e,g,c)}}};$.fn.uploadify=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return b.init.apply(this,arguments)}else{$.error("The method "+c+" does not exist in $.uploadify")}}}})();

$.component("coral.uploader",{version:$.coral.version,castProperties:["dataCustom","formData","overrideEvents","buttons","itemTemplate"],options:{id:"",swf:$.coral.scriptPath+"external/swfupload.swf",uploader:"",auto:true,buttonClass:"",buttonCursor:"hand",buttonImage:null,buttonText:"SELECT FILES",checkExisting:false,debug:false,fileObjName:"Filedata",fileSizeLimit:0,fileTypeDesc:"All Files",fileTypeExts:"*.*",heigh:30,itemTemplate:false,method:"post",multi:true,formData:{},preventCaching:true,progressData:"percentage",queueID:false,queueSizeLimit:999,removeCompleted:true,removeTimeout:3,requeueError:false,successTimeout:30,uploadLimit:0,width:120,cls:"",displayStyle:"original",emptyText:"请选择...",delay:1000,buttons:null,overrideEvents:[],onCancel:null,onClearQueue:null,onDestroy:null,onDialogClose:null,onDialogOpen:null,onDisable:null,onEnable:null,onFallback:null,onNoflash:null,onInit:null,onQueueComplete:null,onSelectError:null,onSelect:null,onNoFlash:null,onSWFReady:null,onUploadComplete:null,onUploadError:null,onUploadSuccess:null,onUploadProgress:null,onUploadStart:null},_create:function(){var b=this;b._initElement();var a=b._flashCheck();if(a==false){b._trigger("onNoFlash",null,[])}},_initElement:function(){var c=this,b=c.options,a={};if(typeof c.element.attr("id")!="undefined"){b.id=c.element.attr("id")}else{if(b.id){c.element.attr("id",b.id)}}if(typeof c.element.attr("name")!="undefined"){b.name=c.element.attr("name")}else{if(b.name){c.element.attr("name",b.name)}}delete b.id;a=c.getEventsObj();b=$.extend({},b,a);this._initUploder(b);b.id=c.element.attr("id")},_flashCheck:function(){var d=!-[1,];var a=true;if(d){try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");a=true}catch(f){a=false}}else{try{if(navigator.plugins&&navigator.plugins.length>0){var b=navigator.plugins["Shockwave Flash"];if(b==undefined){a=false}}else{a=true}}catch(f){a=false}}return a},component:function(){return this.uiUploader},destroy:function(){this.uploader.uploadify("destroy")
},disable:function(a){this.uploader.uploadify("disable",a)},settings:function(a,b,c){this.uploader.uploadify("settings",a,b,c)},stop:function(){this.uploader.uploadify("stop")},upload:function(a){if("original"==this.options.displayStyle||!this._isQueueDialog()){this.uploader.uploadify("upload",a);return}if(this.select.length==0){return}var b=this,c=this.element.attr("id");$("#"+c+"_queue").dialog("open")},getvalue:function(){if(this.select.length==0){alert("none file")}return this.select.join(",")},cancel:function(){this.uploader.uploadify("cancel")},clear:function(a){if("custom"==this.options.displayStyle){this.select=[];this.uiUploader.find(".coral-file").html("请选择...");this.uiUploader.find("object").attr("title","请选择...")}this.uploader.uploadify("cancel");this.clearQueue()},clearQueue:function(){this.uploader.clearQueue()},uploadify:function(){return this.uploader},queueData:function(){return this.uploader.data("uploadify").queueData},_getButtons:function(){if(typeof this.options.buttons==="object"){return this.options.buttons}if(typeof this.options.buttons!=="string"){return[]}var h=this,g=this.options,f=this.options.buttons,b=[];var d=$.trim(f).split(",");for(var c in d){var a={},e=d[c].split(" ");a.label=e[0];a.click=e[1];b.push(a)}return b},_triggerClick:function(a,c,d){var b=this;var e=$.coral.toFunction(a);c=$.Event(c);return e.apply(b.element[0],[c].concat(d))},_createButtons:function(){var d=this,c=this.options,b=this._getButtons();var a=$('<span class="coral-uploader-btn-icons coral-corner-right"></span>');d.uiBorder.append(a);$.each(b,function(h,j){var g=j.label,k=j.id,i=j.click,f={},e=$('<span class="coral-uploader-btn-ico icon coral-uploader-btn-textico"></span>');if(g){e.html(g);f.label=g}if(k){e.attr("data-id",k);f.id=k}e.bind("click"+d.eventNamespace,function(l){if(d.options.disabled){return}d._triggerClick(i,l,f)});a.append(e)})},_initUploder:function(a){var c=this,d=c.element.attr("id");c.uiUploader=$('<span class="coral-uploader"></span>');c.uiBorder=$('<span class="coral-uploader-border coral-corner-all"></span>');
c.uploader=$('<div id="'+d+'_uploader"></div>');c.element.after(c.uiUploader);c.uiUploader.append(c.uiBorder);c.uiBorder.append(c.element);c.element.hide();if(a.displayStyle=="original"){c.element.before(c.uploader);this.uploader.uploadify(a);return}this.uiUploader.addClass("coral-uploader-custom coral-textbox");this.uiBorder.addClass("coral-textbox-border");if(a.buttons){this._createButtons()}c.select=[];$(this.element).wrap('<span class="coral-file-default"></span>').before("<span class='coral-file'>"+a.emptyText+"</span>").before(c.uploader);var b=$.extend(a,{height:28,width:800});if(!b.queueID){$(this.element).before("<div id='"+d+"_queue'></div>");$("#"+d+"_queue").dialog({autoOpen:false,title:"上传",modal:false,resizable:false,onOpen:function(){c.uploader.uploadify("upload","*")}});a.queueID=d+"_queue";this.hasDialog=true}c.uploader.uploadify(b)},_isQueueDialog:function(){return this.hasDialog},_reloadUploader:function(){var b=this,a=this.options;delete a.id;b.uploader.uploadify(a);a.id=b.element.attr("id")},getEventsObj:function(){var b=this,a=this.options,c=this.element.attr("id");return{onCancel:function(d){b._trigger("onCancel",null,[{file:d}])},onClearQueue:function(d){b._trigger("onClearQueue",null,[{queueItemCount:d}])},onDestroy:function(){b._trigger("onDestroy",null,[])},onDialogClose:function(d){if("custom"==a.displayStyle&&a.auto&&b._isQueueDialog()){$("#"+c+"_queue").dialog("open")}b._trigger("onDialogClose",null,[{queueData:d}])},onDialogOpen:function(){if("custom"==a.displayStyle){}b._trigger("onDialogOpen",null,[])},onDisable:function(){b._trigger("onDisable",null,[])},onEnable:function(){b._trigger("onEnable",null,[])},onFallback:function(){b._trigger("onFallback ",null,[])},onNoflash:function(){return b.uiBorder},onInit:function(d){b._trigger("onInit",null,[{swfuploadify:d}])},onQueueComplete:function(d){var e=b.element.attr("id");if("custom"==a.displayStyle&&b._isQueueDialog()){setTimeout(function(){$("#"+e+"_queue").dialog("close");b.select=[]},a.delay)
}b._trigger("onQueueComplete",null,[{queueData:d}])},onSelectError:function(d,f,e){b._trigger("onSelectError",null,[{arguments:arguments}])},onSelect:function(d){if("custom"==a.displayStyle){b.select.push(d.name);b.uiUploader.find(".coral-file").html(b.select.join(","));b.uiUploader.find("object").attr("title",b.select.join(","))}b._trigger("onSelect",null,[{file:d}])},onSWFReady:function(){b._trigger("onSWFReady",null,[])},onUploadComplete:function(d){b._trigger("onUploadComplete",null,[{file:d}])},onUploadError:function(d,g,f,e){b._trigger("onUploadError",null,[{file:d,errorCode:g,errorMsg:f,errorString:e}])},onUploadSuccess:function(e,f,d){b._trigger("onUploadSuccess",null,[{file:e,data:f,response:d}])},onUploadProgress:function(e,h,d,g,f){b._trigger("onUploadProgress",null,[{file:e,fileBytesLoaded:h,fileTotalBytes:d,queueBytesLoaded:g,uploadSize:f}])},onUploadStart:function(d){b._trigger("onUploadStart",null,[{file:d}])}}},_setOption:function(a,c){var b=this;if(a==="id"||a==="name"){return}this._super(a,c);if(a==="emptyText"){this.uiUploader.find(".coral-file").html(c);return}b.settings(a,c)},_destroy:function(){var a=this;a.uiUploader.replaceWith(a.element)}});

var tooltip=$.component("coral.tooltip",{version:"4.0.1",options:{content:function(){var a=$(this).attr("title")||"";return $("<a>").text(a).html()},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,tooltipClass:null,track:false,onClose:null,onOpen:null},_addDescribedBy:function(b,c){var a=(b.attr("aria-describedby")||"").split(/\s+/);a.push(c);b.data("coral-tooltip-id",c).attr("aria-describedby",$.trim(a.join(" ")))},_removeDescribedBy:function(c){var d=c.data("coral-tooltip-id"),b=(c.attr("aria-describedby")||"").split(/\s+/),a=$.inArray(d,b);if(a!==-1){b.splice(a,1)}c.removeData("coral-tooltip-id");b=$.trim(b.join(" "));if(b){c.attr("aria-describedby",b)}else{c.removeAttr("aria-describedby")}},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};if(this.options.disabled){this._disable()}this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("coral-helper-hidden-accessible").appendTo(this.document[0].body)},_setOption:function(a,c){var b=this;if(a==="disabled"){this[c?"_disable":"_enable"]();this.options[a]=c;return}this._super(a,c);if(a==="content"){$.each(this.tooltips,function(e,d){b._updateContent(d)})}},_disable:function(){var a=this;$.each(this.tooltips,function(d,b){var c=$.Event("blur");c.target=c.currentTarget=b[0];a.close(c,true)});this.element.find(this.options.items).addBack().each(function(){var b=$(this);if(b.is("[title]")){b.data("coral-tooltip-title",b.attr("title")).removeAttr("title")}})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var a=$(this);if(a.data("coral-tooltip-title")){a.attr("title",a.data("coral-tooltip-title"))}})},open:function(b){var a=this,c=$(b?b.target:this.element).closest(this.options.items);if(!c.length||c.data("coral-tooltip-id")){return}if(c.attr("title")){c.data("coral-tooltip-title",c.attr("title"))}c.data("coral-tooltip-open",true);
if(b&&b.type==="mouseover"){c.parents().each(function(){var e=$(this),d;if(e.data("coral-tooltip-open")){d=$.Event("blur");d.target=d.currentTarget=this;a.close(d,true)}if(e.attr("title")){e.uniqueId();a.parents[this.id]={element:this,title:e.attr("title")};e.attr("title","")}})}this._updateContent(c,b)},_updateContent:function(f,e){var d,a=this.options.content,c=this,b=e?e.type:null;if(typeof a==="string"){return this._open(e,f,a)}d=a.call(f[0],function(g){if(!f.data("coral-tooltip-open")){return}c._delay(function(){if(e){e.type=b}this._open(e,f,g)})});if(d){this._open(e,f,d)}},_open:function(a,d,e){var i,h,g,b,f=$.extend({},this.options.position);if(!e){return}i=this._find(d);if(i.length){i.find(".coral-tooltip-content").html(e);return}if(d.is("[title]")){if(a&&a.type==="mouseover"){d.attr("title","")}else{d.removeAttr("title")}}i=this._tooltip(d);this._addDescribedBy(d,i.attr("id"));i.find(".coral-tooltip-content").html(e);this.liveRegion.children().hide();if(e.clone){b=e.clone();b.removeAttr("id").find("[id]").removeAttr("id")}else{b=e}$("<div>").html(b).appendTo(this.liveRegion);function c(j){f.of=j;if(i.is(":hidden")){return}i.position(f)}if(this.options.track&&a&&/^mouse/.test(a.type)){this._on(this.document,{mousemove:c});c(a)}else{i.position($.extend({of:d},this.options.position))}this.hiding=false;this.closing=false;i.hide();this._show(i,this.options.show);if(this.options.show&&this.options.show.delay){g=this.delayedShow=setInterval(function(){if(i.is(":visible")){c(f.of);clearInterval(g)}},$.fx.interval)}this._trigger("onOpen",a,{tooltip:i});h={keyup:function(j){if(j.keyCode===$.coral.keyCode.ESCAPE){var k=$.Event(j);k.currentTarget=d[0];this.close(k,true)}}};if(d[0]!==this.element[0]){h.remove=function(){this._removeTooltip(i)}}if(!a||a.type==="mouseover"){h.mouseleave="close"}if(!a||a.type==="focusin"){h.focusout="close"}this._on(true,d,h)},close:function(b){var a=this,d=$(b?b.currentTarget:this.element),c=this._find(d);if(this.closing){return}clearInterval(this.delayedShow);
if(d.data("coral-tooltip-title")&&!d.attr("title")){d.attr("title",d.data("coral-tooltip-title"))}this._removeDescribedBy(d);this.hiding=true;c.stop(true);this._hide(c,this.options.hide,function(){a._removeTooltip($(this));this.hiding=false;this.closing=false});d.removeData("coral-tooltip-open");this._off(d,"mouseleave focusout keyup");if(d[0]!==this.element[0]){this._off(d,"remove")}this._off(this.document,"mousemove");if(b&&b.type==="mouseleave"){$.each(this.parents,function(f,e){$(e.element).attr("title",e.title);delete a.parents[f]})}this.closing=true;this._trigger("onClose",b,{tooltip:c});if(!this.hiding){this.closing=false}},_tooltip:function(a){var b=$("<div>").attr("role","tooltip").addClass("coral-tooltip coral-component coral-corner-all coral-component-content "+(this.options.tooltipClass||"")),c=b.uniqueId().attr("id");$("<div>").addClass("coral-tooltip-content").appendTo(b);b.appendTo(this.document[0].body);this.tooltips[c]=a;return b},_find:function(a){var b=a.data("coral-tooltip-id");return b?$("#"+b):$()},_removeTooltip:function(a){a.remove();delete this.tooltips[a.attr("id")]},_destroy:function(){var a=this;$.each(this.tooltips,function(d,b){var c=$.Event("blur");c.target=c.currentTarget=b[0];a.close(c,true);$("#"+d).remove();if(b.data("coral-tooltip-title")){if(!b.attr("title")){b.attr("title",b.data("coral-tooltip-title"))}b.removeData("coral-tooltip-title")}});this.liveRegion.remove()}});

/*!
 * jQuery UI Spinner 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/spinner/
 */
function spinner_modifier(a){return function(){var b=this.element.val();a.apply(this,arguments);this._refresh();if(b!==this.element.val()){this._trigger("onChange")}}}var spinner=$.component("coral.spinner",$.coral.formelement,{version:"4.0.3",castProperties:["triggers"],defaultElement:"<input>",componentEventPrefix:"spin",options:{culture:null,icons:{down:"cui-icon-arrow-down3",up:"cui-icon-arrow-up3"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,onChange:null,onSpin:null,onStart:null,onStop:null,triggers:null,excluded:false},_create:function(){if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name")}else{if(this.options.name){this.element.attr("name",this.options.name)}}if(typeof this.element.attr("value")!="undefined"){this.options.value=this.element.attr("value")}this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true)}if($.trim(this.element.val())!==""){this.options.value=this.element.text()}else{if(this.options.value){this.element.val(this.options.value)}}this.originalValue=this.getValue();this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var a={},b=this.element;$.each(["min","max","step"],function(c,d){var e=b.attr(d);if(e!==undefined&&e.length){a[d]=e}});return a},_events:{keydown:function(a){if(this._start(a)&&this._keydown(a)){a.preventDefault()}},keyup:"_stop",focus:function(){this.previous=this.element.val()
},blur:function(a){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("onChange",a)}},mousewheel:function(a,b){if(!b){return}if(!this.spinning&&!this._start(a)){return false}this._spin((b>0?1:-1)*this.options.step,a);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(a)}},100);a.preventDefault()},"mousedown .coral-spinner-button":function(b){var a;a=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();function c(){var d=this.element[0]===this.document[0].activeElement;if(!d){this.element.focus();this.previous=a;this._delay(function(){this.previous=a})}}b.preventDefault();c.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;c.call(this)});if(this._start(b)===false){return}this._repeat(null,$(b.currentTarget).hasClass("coral-spinner-up")?1:-1,b)},"mouseup .coral-spinner-button":"_stop","mouseenter .coral-spinner-button":function(a){if(!$(a.currentTarget).hasClass("coral-state-active")){return}if(this._start(a)===false){return false}this._repeat(null,$(a.currentTarget).hasClass("coral-spinner-up")?1:-1,a)},"mouseleave .coral-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("coral-spinner-input coral-textbox-default").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");if(this.options.vertical){this.component().addClass("spinner-vertical")}this.buttons=a.find(".coral-spinner-button").attr("tabIndex",-1).button().removeClass("coral-corner-all");if(!this.options.vertival){if(this.buttons.height()>Math.ceil(a.height()*0.5)&&a.height()>0){a.height(a.height())}}if(this.options.disabled){this.disable()}},_keydown:function(b){var a=this.options,c=$.coral.keyCode;switch(b.keyCode){case c.UP:this._repeat(null,1,b);return true;case c.DOWN:this._repeat(null,-1,b);return true;case c.PAGE_UP:this._repeat(null,a.page,b);
return true;case c.PAGE_DOWN:this._repeat(null,-a.page,b);return true}return false},_uiSpinnerHtml:function(){return"<span class='coral-spinner coral-textbox coral-component'><span class='coral-textbox-border coral-corner-all'></span></span>"},_buttonHtml:function(){return"<a class='coral-spinner-button coral-spinner-up coral-corner-tr'><span class='icon "+this.options.icons.up+"'></span></a><a class='coral-spinner-button coral-spinner-down coral-corner-br'><span class='icon "+this.options.icons.down+"'></span></a>"},_start:function(a){if(!this.spinning&&this._trigger("onStart",a)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(b,a,c){b=b||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,a,c)},b);this._spin(a*this.options.step,c)},_spin:function(b,a){var c=this.value()||0;if(!this.counter){this.counter=1}c=this._adjustValue(c+b*this._increment(this.counter));if(!this.spinning||this._trigger("onSpin",a,{value:c})!==false){this._value(c);this.counter++}},_increment:function(a){var b=this.options.incremental;if(b){return $.isFunction(b)?b(a):Math.floor(a*a*a/50000-a*a/500+17*a/200+1)}return 1},_precision:function(){var a=this._precisionOf(this.options.step);if(this.options.min!==null){a=Math.max(a,this._precisionOf(this.options.min))}return a},_precisionOf:function(b){var c=b.toString(),a=c.indexOf(".");return a===-1?0:c.length-a-1},_adjustValue:function(c){var b,d,a=this.options;b=a.min!==null?a.min:0;d=c-b;d=Math.round(d/a.step)*a.step;c=b+d;c=parseFloat(c.toFixed(this._precision()));if(a.max!==null&&c>a.max){return a.max}if(a.min!==null&&c<a.min){return a.min}return c},_stop:function(a){if(!this.spinning){return}clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("onStop",a)},_setOption:function(a,b){if(a==="value"){if(typeof b!=="undefined"){this.value(b)}else{this.value()}}if(a==="culture"||a==="numberFormat"){var c=this._parse(this.element.val());
this.options[a]=b;this.element.val(this._format(c));return}if(a==="max"||a==="min"||a==="step"){if(typeof b==="string"){b=this._parse(b)}}if(a==="icons"){this.buttons.first().find(".coral-icon").removeClass(this.options.icons.up).addClass(b.up);this.buttons.last().find(".coral-icon").removeClass(this.options.icons.down).addClass(b.down)}this._super(a,b);if(a==="disabled"){this.component().toggleClass("coral-state-disabled",!!b);this.element.prop("disabled",!!b);this.buttons.button(b?"disable":"enable")}},_setOptions:spinner_modifier(function(a){this._super(a)}),_parse:function(a){if(typeof a==="string"&&a!==""){a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a}return a===""||isNaN(a)?null:a},_format:function(a){if(a===""){return""}return window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var a=this.value();if(a===null){return false}return a===this._adjustValue(a)},_value:function(c,a){var b;if(c!==""){b=this._parse(c);if(b!==null){if(!a){b=this._adjustValue(b)}c=this._format(b)}}this.element.val(c);this._refresh()},_destroy:function(){this.element.removeClass("coral-spinner-input").removeClass("coral-textbox-default").prop("disabled",false).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.component().replaceWith(this.element)},reset:function(){this.setValue(this.originalValue)},stepUp:spinner_modifier(function(a){this._stepUp(a)}),_stepUp:function(a){if(this._start()){this._spin((a||1)*this.options.step);this._stop()}},stepDown:spinner_modifier(function(a){this._stepDown(a)}),_stepDown:function(a){if(this._start()){this._spin((a||1)*-this.options.step);this._stop()}},pageUp:spinner_modifier(function(a){this._stepUp((a||1)*this.options.page)
}),pageDown:spinner_modifier(function(a){this._stepDown((a||1)*this.options.page)}),setValue:function(a){a=a||"";this.value(a)},getValue:function(a){return this.value()+""},value:function(a){if(!arguments.length){return this._parse(this.element.val())}spinner_modifier(this._value).call(this,a)},component:function(){return this.uiSpinner.parent()}});

/*!
 * jQuery UI Slider 1.11.2
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slider/
 */
var slider=$.component("coral.slider",$.coral.mouse,{version:"4.0.3",componentEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this._calculateNewMax();this.element.addClass("coral-slider coral-slider-"+this.orientation+" coral-component coral-component-content coral-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var d,a,b=this.options,f=this.element.find(".coral-slider-handle").addClass("coral-state-default coral-corner-all"),e="<span class='coral-slider-handle coral-state-default coral-corner-all' tabindex='0'></span>",c=[];a=(b.values&&b.values.length)||1;if(f.length>a){f.slice(a).remove();f=f.slice(0,a)}for(d=f.length;d<a;d++){c.push(e)}this.handles=f.add($(c.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(g){$(this).data("coral-slider-handle-index",g)})},_createRange:function(){var a=this.options,b="";if(a.range){if(a.range===true){if(!a.values){a.values=[this._valueMin(),this._valueMin()]}else{if(a.values.length&&a.values.length!==2){a.values=[a.values[0],a.values[0]]}else{if($.isArray(a.values)){a.values=a.values.slice(0)}}}}if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);b="coral-slider-range coral-component-header coral-corner-all"}else{this.range.removeClass("coral-slider-range-min coral-slider-range-max").css({left:"",bottom:""})
}this.range.addClass(b+((a.range==="min"||a.range==="max")?" coral-slider-range-"+a.range:""))}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){this._off(this.handles);this._on(this.handles,this._handleEvents);this._hoverable(this.handles);this._focusable(this.handles)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this.element.removeClass("coral-slider coral-slider-horizontal coral-slider-vertical coral-component coral-component-content coral-corner-all");this._mouseDestroy()},_mouseCapture:function(c){var g,j,b,e,i,k,f,a,h=this,d=this.options;if(d.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();g={x:c.pageX,y:c.pageY};j=this._normValueFromMouse(g);b=this._valueMax()-this._valueMin()+1;this.handles.each(function(l){var m=Math.abs(j-h.values(l));if((b>m)||(b===m&&(l===h._lastChangedValue||h.values(l)===d.min))){b=m;e=$(this);i=l}});k=this._start(c,i);if(k===false){return false}this._mouseSliding=true;this._handleIndex=i;e.addClass("coral-state-active").focus();f=e.offset();a=!$(c.target).parents().addBack().is(".coral-slider-handle");this._clickOffset=a?{left:0,top:0}:{left:c.pageX-f.left-(e.width()/2),top:c.pageY-f.top-(e.height()/2)-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)};if(!this.handles.hasClass("coral-state-hover")){this._slide(c,i,j)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(c){var a={x:c.pageX,y:c.pageY},b=this._normValueFromMouse(a);this._slide(c,this._handleIndex,b);return false},_mouseStop:function(a){this.handles.removeClass("coral-state-active");this._mouseSliding=false;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"
},_normValueFromMouse:function(b){var a,e,d,c,f;if(this.orientation==="horizontal"){a=this.elementSize.width;e=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{a=this.elementSize.height;e=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}d=(e/a);if(d>1){d=1}if(d<0){d=0}if(this.orientation==="vertical"){d=1-d}c=this._valueMax()-this._valueMin();f=this._valueMin()+d*c;return this._trimAlignValue(f)},_start:function(c,b){var a={handle:this.handles[b],value:this.value()};if(this.options.values&&this.options.values.length){a.value=this.values(b);a.values=this.values()}return this._trigger("start",c,a)},_slide:function(e,d,c){var a,b,f;if(this.options.values&&this.options.values.length){a=this.values(d?0:1);if((this.options.values.length===2&&this.options.range===true)&&((d===0&&c>a)||(d===1&&c<a))){c=a}if(c!==this.values(d)){b=this.values();b[d]=c;f=this._trigger("slide",e,{handle:this.handles[d],value:c,values:b});a=this.values(d?0:1);if(f!==false){this.values(d,c)}}}else{if(c!==this.value()){f=this._trigger("slide",e,{handle:this.handles[d],value:c});if(f!==false){this.value(c)}}}},_stop:function(c,b){var a={handle:this.handles[b],value:this.value()};if(this.options.values&&this.options.values.length){a.value=this.values(b);a.values=this.values()}this._trigger("stop",c,a)},_change:function(c,b){if(!this._keySliding&&!this._mouseSliding){var a={handle:this.handles[b],value:this.value()};if(this.options.values&&this.options.values.length){a.value=this.values(b);a.values=this.values()}this._lastChangedValue=b;this._trigger("change",c,a)}},value:function(a){if(arguments.length){this.options.value=this._trimAlignValue(a);this._refreshValue();this._change(null,0);return}return this._value()},values:function(b,e){var d,a,c;if(arguments.length>1){this.options.values[b]=this._trimAlignValue(e);this._refreshValue();this._change(null,b);return}if(arguments.length){if($.isArray(arguments[0])){d=this.options.values;a=arguments[0];for(c=0;
c<d.length;c+=1){d[c]=this._trimAlignValue(a[c]);this._change(null,c)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(b)}else{return this.value()}}}else{return this._values()}},_setOption:function(b,c){var a,d=0;if(b==="range"&&this.options.range===true){if(c==="min"){this.options.value=this._values(0);this.options.values=null}else{if(c==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}}if($.isArray(this.options.values)){d=this.options.values.length}if(b==="disabled"){this.element.toggleClass("coral-state-disabled",!!c)}this._super(b,c);switch(b){case"orientation":this._detectOrientation();this.element.removeClass("coral-slider-horizontal coral-slider-vertical").addClass("coral-slider-"+this.orientation);this._refreshValue();this.handles.css(c==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(a=0;a<d;a+=1){this._change(null,a)}this._animateOff=false;break;case"step":case"min":case"max":this._animateOff=true;this._calculateNewMax();this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var a=this.options.value;a=this._trimAlignValue(a);return a},_values:function(a){var d,c,b;if(arguments.length){d=this.options.values[a];d=this._trimAlignValue(d);return d}else{if(this.options.values&&this.options.values.length){c=this.options.values.slice();for(b=0;b<c.length;b+=1){c[b]=this._trimAlignValue(c[b])}return c}else{return[]}}},_trimAlignValue:function(d){if(d<=this._valueMin()){return this._valueMin()}if(d>=this._valueMax()){return this._valueMax()}var a=(this.options.step>0)?this.options.step:1,c=(d-this._valueMin())%a,b=d-c;if(Math.abs(c)*2>=a){b+=(c>0)?a:(-a)}return parseFloat(b.toFixed(5))},_calculateNewMax:function(){var a=(this.options.max-this._valueMin())%this.options.step;
this.max=this.options.max-a},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshValue:function(){var f,e,i,g,j,d=this.options.range,c=this.options,h=this,b=(!this._animateOff)?c.animate:false,a={};if(this.options.values&&this.options.values.length){this.handles.each(function(k){e=(h.values(k)-h._valueMin())/(h._valueMax()-h._valueMin())*100;a[h.orientation==="horizontal"?"left":"bottom"]=e+"%";$(this).stop(1,1)[b?"animate":"css"](a,c.animate);if(h.options.range===true){if(h.orientation==="horizontal"){if(k===0){h.range.stop(1,1)[b?"animate":"css"]({left:e+"%"},c.animate)}if(k===1){h.range[b?"animate":"css"]({width:(e-f)+"%"},{queue:false,duration:c.animate})}}else{if(k===0){h.range.stop(1,1)[b?"animate":"css"]({bottom:(e)+"%"},c.animate)}if(k===1){h.range[b?"animate":"css"]({height:(e-f)+"%"},{queue:false,duration:c.animate})}}}f=e})}else{i=this.value();g=this._valueMin();j=this._valueMax();e=(j!==g)?(i-g)/(j-g)*100:0;a[this.orientation==="horizontal"?"left":"bottom"]=e+"%";this.handle.stop(1,1)[b?"animate":"css"](a,c.animate);if(d==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[b?"animate":"css"]({width:e+"%"},c.animate)}if(d==="max"&&this.orientation==="horizontal"){this.range[b?"animate":"css"]({width:(100-e)+"%"},{queue:false,duration:c.animate})}if(d==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[b?"animate":"css"]({height:e+"%"},c.animate)}if(d==="max"&&this.orientation==="vertical"){this.range[b?"animate":"css"]({height:(100-e)+"%"},{queue:false,duration:c.animate})}}},_handleEvents:{keydown:function(e){var f,c,b,d,a=$(e.target).data("coral-slider-handle-index");switch(e.keyCode){case $.coral.keyCode.HOME:case $.coral.keyCode.END:case $.coral.keyCode.PAGE_UP:case $.coral.keyCode.PAGE_DOWN:case $.coral.keyCode.UP:case $.coral.keyCode.RIGHT:case $.coral.keyCode.DOWN:case $.coral.keyCode.LEFT:e.preventDefault();if(!this._keySliding){this._keySliding=true;$(e.target).addClass("coral-state-active");
f=this._start(e,a);if(f===false){return}}break}d=this.options.step;if(this.options.values&&this.options.values.length){c=b=this.values(a)}else{c=b=this.value()}switch(e.keyCode){case $.coral.keyCode.HOME:b=this._valueMin();break;case $.coral.keyCode.END:b=this._valueMax();break;case $.coral.keyCode.PAGE_UP:b=this._trimAlignValue(c+((this._valueMax()-this._valueMin())/this.numPages));break;case $.coral.keyCode.PAGE_DOWN:b=this._trimAlignValue(c-((this._valueMax()-this._valueMin())/this.numPages));break;case $.coral.keyCode.UP:case $.coral.keyCode.RIGHT:if(c===this._valueMax()){return}b=this._trimAlignValue(c+d);break;case $.coral.keyCode.DOWN:case $.coral.keyCode.LEFT:if(c===this._valueMin()){return}b=this._trimAlignValue(c-d);break}this._slide(e,a,b)},keyup:function(b){var a=$(b.target).data("coral-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(b,a);this._change(b,a);$(b.target).removeClass("coral-state-active")}}}});

(function(){var a="easyinput",c="easytext",b=a+c.charAt(0).toUpperCase()+c.slice(1);$.component(a+"."+c,{options:{currentValue:"",values:[],maxWidth:200,minWidth:80,maxChars:200,storage:"array",ajaxConfig:{url:"/",id:"",UPDATETemplate:"",UPDATEData:{},GETCallback:null}},_name:c,_input:null,_id:null,_valuesIndex:null,_classUnChanged:null,_classEmpty:null,_classOnEdit:null,_classChanged:null,_classEasyText:c.toLowerCase(),_setListeners:function(){this._input.bind({focus:this._focusBehaviour,input:this._autoGrownBehaviour,blur:this._blurBehaviour,storageChange:this._storageChange})},_getClassName:function(d){return this._name.toLowerCase()+"-"+d},_setClassNames:function(){this._classOnHover=this._getClassName("onHover");this._classUnChanged=this._getClassName("unChanged");this._classOnEdit=this._getClassName("onEdit");this._classChanged=this._getClassName("changed");this._classEmpty=this._getClassName("empty")},_setVars:function(){var d=this.element;this._input=d;d.uniqueId();this._valuesIndex=0;this._id=this._name+"-"+d.attr("id");d.attr("maxLength",this.options.maxChars)},_setRuler:function(){var e="#"+this._name+"-ruler",f=$(e),d=this._input;if(!f.length){String.prototype.visualLength=function(){var g=$(e);g.html(this.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"));return g.width()};f=$('<span id="'+e.substr(1)+'"></span>');f.css({fontSize:d.css("fontSize"),fontFamily:d.css("font-family"),fontWeight:d.css("fontWeight"),position:"absolute",visibility:"hidden",whiteSpace:"nowrap"});$("body").after(f)}},_initializeAjax:function(){var d=this.options.ajaxConfig;if(!$.isFunction(d.GETCallback)){return}if(d.url.charAt(d.url.length-1)!=="/"){d.url+="/"}if(!d.id){d.id=this._id}$.ajax({url:d.url+d.id,succes:d.GETCallback})},_setState:function(){var d=this._input,i=d.val(),e=i.visualLength(),g=this.options.minWidth,h=this.options.maxWidth,f;if(e<g){f=g}else{if(h<e){f=h}else{f=e}}d.width(f);if(d.val().length===0){d.removeClass(this._classChanged);
d.addClass(this._classEmpty)}else{d.addClass(this._classChanged)}},_focusBehaviour:function(){var e=$(this).data(b),d=e._input;d.removeClass(e._classChanged+" "+e._classUnChanged+" "+e._classEmpty).addClass(e._classOnEdit)},_autoGrownBehaviour:function(){var h=$(this).data(b),d=h._input,i=d.val(),f=h.options.minWidth,g=h.options.maxWidth,e=i.visualLength();if(e<f){e=f}else{if(e>g){e=g}}d.width(e)},_blurBehaviour:function(){var f=$(this).data(b),d=f._input,g=d.val(),e=f.options.ajaxConfig,h;d.removeClass(f._classOnEdit);if(g.length===0){d.addClass(f._classEmpty)}else{d.addClass(f._classChanged);f.option("values",g);f._valuesIndex=f.option("values").length-1;if(f.options.storage==="ajax"){e.UPDATEData.value=d.val();$.ajax({url:e.url+e.id,data:f._tmpl(e.UPDATETemplate,e.UPDATEData),type:"UPDATE"})}}f._setState()},_tmpl:function(f,e){var d=typeof(f)!=="string"?(function(){throw {name:"Invalid Parameter",message:"You must insert a string into the function"}}()):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+f.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return e?d(e):d},_setOption:function(e,f){var d=this.options;switch(e){case"values":d.values.push(f);if(d.storage==="localStorage"){localStorage.setItem(this._id,JSON.stringify(d.values))}return;case"currentValue":this.option("values",f);this._input.val(f);break}this._super("_setOption",e,f)},_create:function(){var e,d,f=this.options.storage;this._setClassNames();this._setVars();this._setListeners();d=this._input;d.addClass(this._classEasyText);if(f==="localStorage"){if(localStorage[this._id]){e=JSON.parse(localStorage[this._id]);this.options.values=e;d.val(e[e.length-1]);this._valuesIndex=e.length-1}}else{if(f==="ajax"){this._initializeAjax()}}this._setRuler();this._setState()},_destroy:function(){this._input.attr("class","")
},deleteStorage:function(){var e=this.options.ajaxConfig,d=this.options.storage;if(d==="localStorage"){localStorage.removeItem(this._id)}else{if(d==="ajax"){$.ajax({url:e.url+e.id,type:"DELETE"})}}this.options.values=[];this._input.val("");this._setState()},getNextBackValue:function(f){var d=this.option("values"),e=this._valuesIndex;if(f===undefined){f=true}if(typeof(f)!=="boolean"){throw new Error("Invalid parameter")}e+=f?1:(-1);if(d[e]===undefined){return -1}this._valuesIndex=e;this._input.val(d[e]);this._setState();return d[e]}})})();

$.component("coral.autocomplete",$.coral.inputbase,{version:"4.0.2",defaultElement:"<input>",castProperties:["source","buttons","title","rootNode","triggers"],options:{appendTo:"body",autoFocus:false,allowRepeat:false,asyncType:"post",delay:300,maxLabelWidth:"auto",multiLineLabel:false,minLength:0,minHeight:1,height:"auto",multiple:false,position:{my:"left top",at:"left bottom",collision:"none"},value:"",text:"",forceSelection:false,defaultValue:"",postMode:"value",required:false,showStar:true,separator:",",buttons:[],title:null,errMsg:null,errMsgPosition:"leftBottom",panelHeight:"auto",maxPanelHeight:200,iframePanel:false,isLabel:false,source:null,valueField:"value",textField:"label",searchField:"valueField",onValidSuccess:null,onValidError:null,onChange:null,onBlur:null,onClose:null,onFocus:null,onOpen:null,oncancel:null,onResponse:null,onSearch:null,onSelect:null,triggers:null,excluded:false},requestIndex:0,pending:0,_create:function(){var a=this;this._prepareInit();this._initAutocomplete();this._initState();this._initSource();this._initData();this._bindEvent();this._setDefaultValue();this._setDefaultText();this.liveRegion=$("<span>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).addClass("coral-helper-hidden-accessible").appendTo(this.document[0].body);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}});if(this.options.multiLineLabel){$(this.element).easytext({minWidth:10,maxWidth:200,maxChars:60});this._on(this.document,{click:function(b){if(this.options.readonly||this.options.isLabel){return}this._moveInput("last",b)}})}},_prepareInit:function(){this.lastSelectedItem={};this.selectedItems=[];this.isNewMenu=true},_initAutocomplete:function(){var c=this.options.render=="tree"?"autocompletetree":"autocomplete";if(this.options.iframePanel){this.iframePanel=$("<iframe class='coral-autocomplete-iframePanel' style='position:absolute;display:none;'></iframe>").appendTo("body")}if(this.options.multiLineLabel){var b=this,e=this.element[0].nodeName.toLowerCase(),d=e==="textarea",a=e==="input";
this.ismultiLineLabel=d?true:a?false:this.element.prop("isContentEditable");this.autocompleteWrapper=$("<span class='coral-"+c+" coral-textboxlist coral-textbox'></span>").insertAfter(this.element);this.elementBorder=$("<span class='coral-textbox-border coral-corner-all'></span>").css({minHeight:this.options.minHeight+"px",height:this.options.height,overflow:"auto"}).appendTo(this.autocompleteWrapper);this.valuebox=$("<input type='hidden'>").appendTo(this.elementBorder);this.valueMethod=this.valuebox[d||a?"val":"text"];this.textMethod=this.element[d||a?"val":"text"];this.element.addClass("coral-validation-"+c+" coral-autocomplete-input coral-autocomplete-text coral-textbox-default tabbable").attr("autocomplete","off");this.textboxlistUl=$("<ul class='coral-textboxlist-ul'><li class='coral-textboxlist-inputLi'></li></ul>");this.textboxlistUl.appendTo(this.elementBorder);this.element.appendTo(this.textboxlistUl.find(".coral-textboxlist-inputLi"));if(this.options.buttons.length>0){this._createButtonPanel()}if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name");this.valuebox.attr("name",this.options.name);this.element.removeAttr("name")}else{if(this.options.name){this.valuebox.attr("name",this.options.name)}}if(this.options.text){this.setText(this.options.text)}if($.trim(this.valuebox.val())!=""){this.options.value=this.valuebox.val()}if(this.options.showPopup){}}else{var e=this.element[0].nodeName.toLowerCase(),d=e==="textarea",a=e==="input";this.ismultiLineLabel=d?true:a?false:this.element.prop("isContentEditable");this.autocompleteWrapper=$('<span class="coral-'+c+' coral-textbox" style="border-width: 0;"></span>').insertAfter(this.element);this.elementBorder=$('<span class="coral-textbox-border coral-corner-all"></span>').css({minHeight:this.options.minHeight+"px"}).appendTo(this.autocompleteWrapper);
this.valuebox=$("<input type='hidden'>").appendTo(this.elementBorder);this.valueMethod=this.valuebox[d||a?"val":"text"];this.textMethod=this.element[d||a?"val":"text"];this.element.addClass("coral-validation-"+c+" coral-autocomplete-input coral-autocomplete-text coral-textbox-default tabbable coral-form-element-autocomplete").attr("autocomplete","off");this.element.appendTo(this.elementBorder);if(this.options.buttons.length>0){this._createButtonPanel()}if(typeof this.element.attr("id")!="undefined"){this.options.id=this.element.attr("id")}else{if(this.options.id){this.element.attr("id",this.options.id)}}if(typeof this.element.attr("name")!="undefined"){this.options.name=this.element.attr("name");this.valuebox.attr("name",this.options.name);this.element.removeAttr("name")}else{if(this.options.name){this.valuebox.attr("name",this.options.name)}}if(this.options.text){this.setText(this.options.text)}if($.trim(this.valuebox.val())!=""){this.options.value=this.valuebox.val()}}},_initState:function(){if(this.element.prop("readonly")||this.options.readonly){this.options.readonly=true;this.valuebox.prop("readonly",true);this.element.prop("readonly",true);this.component().addClass("coral-readonly")}if(this.options.isLabel){this.element.prop("readonly",true);this.valuebox.prop("readonly",true);this.component().addClass("coral-isLabel")}},reset:function(){this.setValue(this.originalValue)},_bindEvent:function(){var c=this,b,a,d;this._on(this.element,{mouseenter:function(f){if(c.options.disabled||c.options.isLabel||c.options.readonly){return}c.autocompleteWrapper.addClass("coral-textbox-hover")},mouseleave:function(f){if(c.options.disabled||c.options.isLabel||c.options.readonly){return}c.autocompleteWrapper.removeClass("coral-textbox-hover")},keyup:function(e){if(this.options.readonly||this.options.isLabel){return}this._trigger("onKeyUp",e,{})},keydown:function(e){if(c.options.disabled||c.options.isLabel||c.options.readonly){return}if(this.element.prop("readOnly")){b=true;d=true;
a=true;return}b=false;d=false;a=false;var f=$.coral.keyCode;switch(e.keyCode){case f.PAGE_UP:if(this.options.render=="tree"){break}b=true;this._move("previousPage",e);break;case f.PAGE_DOWN:if(this.options.render=="tree"){break}b=true;this._move("nextPage",e);break;case f.LEFT:b=true;this._moveItem("left",e);break;case f.RIGHT:b=true;this._moveItem("right",e);break;case f.UP:if(this.options.render=="tree"){break}b=true;this._keyEvent("previous",e);break;case f.DOWN:if(this.options.render=="tree"){break}b=true;this._keyEvent("next",e);break;case f.ENTER:if(this.menu.active){b=true;e.preventDefault();this.menu.select(e)}break;case f.TAB:if(this.menu.active){this.menu.select(e)}break;case f.ESCAPE:if(this.menu.element.is(":visible")){if(!this.ismultiLineLabel){this.setValue(this.term,true)}this.close(e);e.preventDefault()}break;default:a=true;this._searchTimeout(e);break}this._trigger("onKeyDown",e,{})},keypress:function(e){if(c.options.disabled||c.options.isLabel||c.options.readonly){return}if(b){b=false;if(!this.ismultiLineLabel||this.menu.element.is(":visible")){e.preventDefault()}return}if(a){return}if(this.options.render=="tree"){return}var f=$.coral.keyCode;switch(e.keyCode){case f.PAGE_UP:this._move("previousPage",e);break;case f.PAGE_DOWN:this._move("nextPage",e);break;case f.UP:this._keyEvent("previous",e);break;case f.DOWN:this._keyEvent("next",e);break;default:break}},input:function(e){if(c.options.disabled||c.options.isLabel||c.options.readonly){return}if(d){d=false;e.preventDefault();return}this._searchTimeout(e)},focus:function(){if(c.options.disabled||c.options.isLabel||c.options.readonly){return}this.selectedItem=null;this.previous=this.getValue();this.component().addClass("coral-state-focus")},blur:function(f){this.component().removeClass("coral-state-focus");if(c.options.disabled||c.options.isLabel||c.options.readonly){return}if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching);this.close(f);if(!this.options.multiLineLabel){if(this.options.multiple){}else{if(!this.options.forceSelection){if(this.lastSelectedItem[this.options.textField]!=this.element.val()){this.setValue(this.element.val(),true)
}}else{if(this.options.render=="tree"){}else{var e=$.grep(this.responseItems,function(g){return g[c.options.textField]==c.element.val()});if(!e.length){this.setValue("",true)}else{this.setValue(e[0][c.options.valueField],true)}}}}}this._trigger("onBlur",f,{item:this.selectedItem})}});this._on(this.menu.element,{mousedown:function(e){if(this.options.readonly||this.options.isLabel){return}e.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur});var f=this.menu.element[0];if(!$(e.target).closest(".coral-menu-item").length){this._delay(function(){var g=this;this.document.one("mousedown",function(h){if(h.target!==g.element[0]&&h.target!==f&&!$.contains(f,h.target)){g.close()}})})}},menuonfocus:function(g,h){if(this.options.readonly||this.options.isLabel){return}var e,f;if(this.isNewMenu){this.isNewMenu=false;if(g.originalEvent&&/^mouse/.test(g.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){$(g.target).trigger(g.originalEvent)});return}}f=h.item.data("coral-autocomplete-item");if(false!==this._trigger("onFocus",g,{item:f})){if(g.originalEvent&&/^key/.test(g.originalEvent.type)){}}e=h.item.attr("aria-label")||f[this.options.valueField];if(e&&$.trim(e).length){this.liveRegion.children().hide();$("<div>").text(e).appendTo(this.liveRegion)}},menuonselect:function(g,j){if(this.options.readonly||this.options.isLabel){return}var f=j.item.data("coral-autocomplete-item"),e=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=e;this._delay(function(){this.previous=e;this.selectedItem=f;c.lastSelectedItem=f})}c.lastSelectedItem=f;this.selectedItem=f;if(false!==this._trigger("onSelect",g,{item:f})){var f=j.item.data("coral-autocomplete-item");valueField=f[this.options.valueField];textField=f[this.options.textField];var i=c.getValue(),l=c.getText(),h=i==""?[]:i.split(this.options.separator),k=l==""?[]:l.split(this.options.separator);if(c.options.multiple){if(this.options.postMode=="value"){if(!this.options.allowRepeat&&$.inArray(valueField,h)>-1){return
}h.push(valueField);k.push(textField);this.setText(k.join(this.options.separator));this.setValue(h.join(this.options.separator),true)}if(this.options.postMode=="text"){if(!this.options.allowRepeat&&$.inArray(textField,k)>-1){return}k.push(textField);c.setValue(k.join(this.options.separator),true)}if(this.options.postMode=="value-text"){if(!this.options.allowRepeat&&$.inArray(valueField+"-"+textField,h+"-"+k)>-1){return}h.push(valueField);k.push(textField);this.setValue(h.join(this.options.separator)+"-"+k.join(this.options.separator),true)}}else{if(this.options.postMode=="value"){this.setText(f[this.options.textField],true);this.setValue(f[this.options.valueField],true)}if(this.options.postMode=="text"){this.setValue(f[this.options.textField],true)}if(this.options.postMode=="value-text"){this.setValue(f[this.options.valueField]+"-"+f[this.options.textField],true)}}}this.term=this.getText();this.close(g)}});if(this.options.multiLineLabel){this._on({"click .coral-label-close":function(f){if(this.options.readonly||this.options.isLabel){return}this._removeLabel(f)},"click .coral-textboxlist-item":function(f){if(this.options.readonly||this.options.isLabel){return}f.stopPropagation()},"click .coral-textbox-border":function(f){if(this.options.readonly||this.options.isLabel){return}this.element.focus()},"mouseenter .coral-label-close":function(f){$(f.target).addClass("coral-label-close-hover")},"mouseleave .coral-label-close":function(f){$(f.target).removeClass("coral-label-close-hover")},"focus .coral-textboxlist-item":function(f){if(this.options.readonly||this.options.isLabel){return}$(f.target).addClass("coral-state-active")},"blur .coral-textboxlist-item":function(f){$(f.target).removeClass("coral-state-active")},"keydown .coral-state-active":function(g){if(this.options.readonly||this.options.isLabel){return}var f=$.coral.keyCode;switch(g.keyCode){case f.LEFT:this._moveInput("left",g);break;case f.RIGHT:this._moveInput("right",g);break;case f.BACKSPACE:this._removeLabel(g);
break;case f.DELETE:this._removeLabel(g);break;default:break}}})}},_initData:function(){var b=this;var a=this.options;this.menu=$("<ul>").addClass("coral-autocomplete-panel coral-front").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");if(isNaN(a.panelHeight)){$(".coral-autocomplete-panel").css({"max-height":a.maxPanelHeight+"px"});$(".coral-autocomplete-iframePanel").css({"max-height":a.maxPanelHeight+"px"})}},_setDefaultValue:function(){if(!this.options.value){this.originalValue="";return}else{this.setValue(this.options.value);this.originalValue=this.getValue()}},_setDefaultText:function(){if(!this.options.text){return}this.setText(this.options.text)},getLastSelectedItem:function(){return this.lastSelectedItem},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("coral-autocomplete-input").removeAttr("autocomplete").removeAttr("title");this.menu.element.remove();if(this.options.iframePanel){this.iframePanel.remove()}this.liveRegion.remove()},_setOption:function(a,c){var b=this.options.maxLabelWidth;if(b!="auto"){b=b+"px"}this._super(a,c);if(a==="isLabel"&&typeof c==="boolean"){this.element.prop("readonly",c);this.valuebox.prop("readonly",c);this.component().removeClass("coral-readonly");this.component().toggleClass("coral-isLabel",c);if(this.textboxlistUl){if(c){this.textboxlistUl.find(".coral-textboxlist-item").css("max-width","")}else{this.textboxlistUl.find(".coral-textboxlist-item").css("max-width",b)}}}if(a==="readonly"&&typeof c==="boolean"){this.element.prop("readonly",c);this.valuebox.prop("readonly",c);this.component().removeClass("coral-isLabel");this.component().toggleClass("coral-readonly",c);if(this.textboxlistUl){if(c){this.textboxlistUl.find(".coral-textboxlist-item").css("max-width","")}else{this.textboxlistUl.find(".coral-textboxlist-item").css("max-width",b)}}}if(a==="source"){this._initSource()}if(a==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(a==="disabled"&&c&&this.xhr){this.xhr.abort()
}if(a==="value"){this.setValue(c)}},_appendTo:function(){var a=this.options.appendTo;if(a){a=a.jquery||a.nodeType?$(a):this.document.find(a).eq(0)}if(!a||!a[0]){a=this.element.closest(".coral-front")}if(!a.length){a=this.document[0].body}return a},_filter:function(c,b,a){a($.coral.autocomplete.filter(c,b.term,this.options.valueField,this.options.textField,this.options.searchField))},_initSource:function(){var c,a,b=this;if($.isArray(this.options.source)){c=this.options.source;this.source=function(e,d){b._filter(c,e,d)}}else{if(typeof this.options.source==="string"){a=this.options.source;this.source=function(e,d){if(b.xhr){b.xhr.abort()}if(this.element.attr("name")){e[this.element.attr("name")]=e.term}b.xhr=$.ajax({url:a,data:e,type:b.options.asyncType,dataType:"json",success:function(f){if(b.options.render!="tree"){d(f)}else{$(b.menu.element).tree("reload",f);d(f)}},error:function(){d([])}})}}else{this.source=this.options.source}}},_searchTimeout:function(a){clearTimeout(this.searching);this.searching=this._delay(function(){var c=this.term===this._term(),b=this.menu.element.is(":visible"),d=a.altKey||a.ctrlKey||a.metaKey||a.shiftKey;if(!c||(c&&!b&&!d)){this.selectedItem=null;this.search(null,a)}},this.options.delay)},_term:function(){if(this.options.multiLineLabel){return this.element.val()}return this.getText()},_updateTitle:function(d){var c=this,a,b=this.options;if(b.multiLineLabel){a=c.element.closest("ul")}else{a=c.element}if(b.title==true){a.attr("title",d)}else{if(b.title==false){a.attr("title","")}else{a.attr("title",b.title)}}},search:function(b,a){b=b!=null?b:this._term();this.term=this._term();if(b.length<this.options.minLength||(this.options.minLength>0&&$.trim(b)=="")){return this.close(a)}if(this._trigger("onSearch",a)===false){return}return this._search(b)},_search:function(a){this.pending++;this.element.addClass("coral-autocomplete-loading");this.cancelSearch=false;this.source({term:a},this._response())},_response:function(){var a=++this.requestIndex;
return $.proxy(function(b){if(a===this.requestIndex){this.__response(b)}this.pending--;if(!this.pending){this.element.removeClass("coral-autocomplete-loading")}},this)},__response:function(a){if(a){a=this._normalize(a)}this._trigger("onResponse",null,{content:a});if(!this.options.disabled&&a&&a.length&&!this.cancelSearch){this._suggest(a);this._trigger("onOpen")}else{this._close()}},close:function(a){this.cancelSearch=true;this._close(a)},_close:function(a){if(this.menu.element.is(":visible")){this.menu.element.hide();if(this.options.iframePanel){this.iframePanel.hide()}this.options.render!="tree"&&this.menu.blur();this.isNewMenu=true;this._trigger("onClose",a)}},_change:function(a){if(this.previous!==this.getValue()){this._trigger("onChange",a,{item:this.selectedItem,oldValue:this.previous,value:this.getValue(),text:this.getText(),lastSelectedItem:this.lastSelectedItem})}},_normalize:function(a){var b=this;if(a.length&&a[0][this.options.textField]&&a[0][this.options.valueField]){return a}return $.map(a,function(c){if(typeof c==="string"){return{label:c,value:c}}return $.extend({},c,{label:c.label||c.value,value:c.value||c.label})})},_suggest:function(c){var f=this.menu.element,e;var g=this.iframePanel||$();if(this.options.render=="tree"){}else{this.menu.element.empty();this._renderMenu(f,c);this.isNewMenu=true;this.menu.refresh()}this.responseItems=c;var a=f.height();g.css("height",a);f.show();g.show();var b=f.siblings(".coral-front:visible").map(function(){return +$(this).css("z-index")}).get(),d=Math.max.apply(null,b);if(d>=+f.css("z-index")){f.css("z-index",d+1);g.css("z-index",d)}g.outerWidth(Math.max(f.width("").outerWidth()+1,this.elementBorder.outerWidth()));this._resizeMenu();f.position($.extend({of:this.elementBorder},this.options.position));g.position($.extend({of:this.elementBorder},this.options.position));if(this.options.autoFocus){this.menu.next()}},_resizeMenu:function(){var a=this.menu.element;var b=this.iframePanel||$();a.outerWidth(Math.max(a.width("").outerWidth()+1,this.elementBorder.outerWidth()))
},_renderMenu:function(b,a){var c=this;$.each(a,function(d,e){c._renderItemData(b,e)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("coral-autocomplete-item",b)},_renderItem:function(h,l){var k=l[this.options.textField];var i,g="",a="",d=!!l.hidden==true?"hidden":"";var f=$.coral.toFunction(this.options.formatter),c;if($.isFunction(f)){k=f.apply(this.element[0],[{item:l}])}var e=$.coral.toFunction(this.options.itemattr);if($.isFunction(e)){var j=e.apply(this.element[0],[{item:l}]);if(!$.isEmptyObject(j)){if(j.hasOwnProperty("style")){a+=j.style;delete j.style}if(j.hasOwnProperty("class")){d+=" "+j["class"];delete j["class"]}try{delete j.role}catch(b){}for(i in j){if(j.hasOwnProperty(i)){g+=" "+i+"="+j[i]}}}return $('<li class="'+d+'"'+g+"style="+a+">").text(k).appendTo(h)}else{return $("<li>").addClass(d).text(k).appendTo(h)}},_move:function(b,a){if(!this.menu.element.is(":visible")){this.search(null,a);return}if(this.menu.isFirstItem()&&/^previous/.test(b)||this.menu.isLastItem()&&/^next/.test(b)){if(!this.options.multiLineLabel){this.setValue("",true);this.setText(this.term)}this.menu.blur();return}this.menu[b](a)},component:function(){return this.autocompleteWrapper},_setLastSelectedItem:function(){var a=this.options;var b=this.getValue(),c=this.getText();this.lastSelectedItem={};this.lastSelectedItem[a.valueField]=b;this.lastSelectedItem[a.textField]=c},_text:function(f){var e=this.options.maxLabelWidth,a=this.options.readonly,b=this.options.isLabel;if(this.options.multiLineLabel){if(f!=""&&!f){var d=[];$.each(this.textboxlistUl.find(".coral-textboxlist-item"),function(){d.push($(this).text())});return d.join(",")}var c="";if(f!=""&&!(f instanceof Array)){f=f.split(this.options.separator)}if(f instanceof Array){if(e=="auto"||b||a){$.each(f,function(g){f.splice(g,1,"<li tabindex='-1' class='coral-textboxlist-item'  title='"+this+"'>"+this+"<span class='coral-label-close cui-icon-cross2'></span></li>")})}else{$.each(f,function(g){f.splice(g,1,"<li tabindex='-1' class='coral-textboxlist-item'  style='  max-width:"+e+"px;' title='"+this+"'>"+this+"<span class='coral-label-close cui-icon-cross2'></span></li>")
})}c=f.join("")}else{if(e=="auto"||b||a){c="<li tabindex='-1' class='coral-textboxlist-item'   title='"+this+"' >"+f+"<span class='coral-label-close  cui-icon-cross2'></span></li>"}else{c="<li tabindex='-1' class='coral-textboxlist-item'  style='  max-width:"+e+"px;' title='"+this+"' >"+f+"<span class='coral-label-close cui-icon-cross2'></span></li>"}}if(f!=""){if(this.options.multiple){this.textboxlistUl.find(".coral-textboxlist-item").remove(".coral-textboxlist-item");this.textboxlistUl.find(".coral-textboxlist-inputLi").before(c)}else{this.textboxlistUl.find(".coral-textboxlist-item").remove(".coral-textboxlist-item");this.textboxlistUl.find(".coral-textboxlist-inputLi").before(c)}}else{this.textboxlistUl.find(".coral-textboxlist-item").remove(".coral-textboxlist-item")}}else{return this.textMethod.apply(this.element,arguments)}},getOldValue:function(){var c=this.options,b=[],e=[],a=0;if(!this.currentValues){return b}var e=this.currentValues.split(",");for(;a<e.length;a++){var d=e[a];b.push(d)}return b},setValue:function(a,c){a=a||"";var g=this,j,l,c,f;if(typeof a!=="string"){j=a.value;c=a.changed;f=a.removed}else{j=a}if(this.options.multiLineLabel){this.element.val("");this.element.css({width:"10px"})}this.previous=this.getValue();if(this.options.multiLineLabel){var g=this;var h=this.element.closest("li.coral-textboxlist-inputLi"),m=h.index(),e=m,k=this.valuebox.val(j)==""?[]:this.valuebox.val(j);if($.trim(j)==""){this.setText(j)}else{if("text"===this.options.postMode){this.setText(j)}else{if($.trim(j)!==""&&$.isArray(this.options.source)){var i=(this.options.render=="tree")?$(this.menu.element).tree("transformToArray",this.options.source.concat()):this.options.source,b=[],d=$.grep(j.split(","),function(o){var n=false;$.each(i,function(p){if(o==i[p][g.options.valueField]){b.push(i[p][g.options.textField]);return true}});return n});if(b.length){this.setText(b)}}}}if(j==""){k=[]}this.valuebox.val(j);this.currentValues=j}else{if($.trim(j)==""){this.setText(j)}else{if("text"===this.options.postMode){this.setText(j)
}else{if($.trim(j)!==""&&$.isArray(this.options.source)){var i=(this.options.render=="tree")?$(this.menu.element).tree("transformToArray",this.options.source.concat()):this.options.source,b=[],d=$.grep(j.split(","),function(o){var n=false;$.each(i,function(p){if(o==i[p][g.options.valueField]){b.push(i[p][g.options.textField]);return true}});return n});if(b.length){this.setText(b[0])}}}}this.valuebox.val(j)}c&&this._change(null)},setText:function(a){this._updateTitle(a);this._text(a);this._setLastSelectedItem()},getValue:function(){if(this.options.multiLineLabel){return this.valuebox.val()}else{return this.valueMethod.apply(this.valuebox)}},getText:function(){return this._text()},focus:function(){if(this.options.disabled||this.options.readonly||this.options.isLabel){return false}this.element.focus()},_keyEvent:function(b,a){if(!this.ismultiLineLabel||this.menu.element.is(":visible")){this._move(b,a);a.preventDefault()}},_removeLabel:function(f){var c=this.element.closest("li.coral-textboxlist-inputLi"),j=$(f.target).closest("li.coral-textboxlist-item"),g=$(f.target).closest("li.coral-textboxlist-item:last");c.insertAfter(g);var i=c.index();var b=j.index();var d=b;if(b>i){d=b-1}var a=this.getText().split(",");a.splice(d,1);j.remove();var h=this.getValue().split(",");h.splice(d,1);this.selectedItems.splice(d,1);this.selectedItem=null;this.setValue(h.join(","),true);if(typeof this.options.source=="string"){this.setText(a.join(","))}this._moveInput("last",f);this.element.val("");this.element.focus()},_moveInput:function(f,d){var a=this.element.closest("li.coral-textboxlist-inputLi");var b=$(d.target).closest("li.coral-textboxlist-item");var c=$(a).closest("li.coral-textboxlist-inputLi").nextAll("li.coral-textboxlist-item").last();switch(f){case"left":a.insertBefore(b);this.element.val("");this.element.focus();break;case"right":a.insertAfter(b);this.element.val("");this.element.focus();break;case"last":a.insertAfter(c);this.element.val("");break}},_moveItem:function(c,b){var a=this.element.closest("li.coral-textboxlist-inputLi");
if(c=="left"&&a.prev().length&&$(a.find("input")).caret()==0){this.element.val("");a.prev().focus()}if(c=="right"&&a.next().length&&$(a.find("input")).caret()==a.find("input").val().length){this.element.val("");a.next().focus()}}});$.extend($.coral.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(g,c,b,a,f){var d=this;var e=new RegExp($.coral.autocomplete.escapeRegex(c),"i");if(f){return $.grep(g,function(l){var j=e.test(l[a]||l[b]||l);var k=f.split(",");for(var h=0;h<k.length;h++){if(!j&&l[k[h]]){j=e.test(l[k[h]]);if(j){break}}}return j})}return $.grep(g,function(h){return e.test(h[a]||h[b]||h[f]||h)})}});$.component("coral.autocomplete",$.coral.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(b){var a;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(b&&b.length){a=this.options.messages.results(b.length)}else{a=this.options.messages.noResults}this.liveRegion.children().hide();$("<div>").text(a).appendTo(this.liveRegion)}});var autocomplete=$.coral.autocomplete;

$.component("coral.autocompletetree",$.coral.autocomplete,{requestIndex:0,pending:0,options:{allowPushParent:false,rootNode:false,multiLineLabel:false,radioType:"level",showRootNode:true,multiple:false,triggers:null,excluded:false},_create:function(){this.options.render="tree";this._super()},_filter:function(c,b,a){$(this.menu.element).tree("reload",c);$(this.menu.element).tree("filterNodesByParam",{name:b.term});a(c)},_initData:function(){var b=this;this.menu={};var a=$("<ul>")[0];$(a).uniqueId().addClass("coral-autocomplete-panel coral-front").appendTo(this._appendTo()).tree({showLine:false,showIcon:true,radioType:this.options.radioType,showRootNode:this.options.showRootNode,rootNode:this.options.rootNode,componentCls:"coral-autocomplete-tree",beforeClick:function(d,c){if(!b.options.allowPushParent&&c.isParent){return false}},onClick:function(c,d,f){var k=f,e=b.previous;if(b.element[0]!==b.document[0].activeElement){b.element.focus();b.previous=e;b._delay(function(){b.previous=e;b.selectedItem=k})}if(false!==b._trigger("beforeNodeClick",c,{item:k,value:b.getValue()})){b.selectedItem=k;b.selectedItems.push(k);var g=b.getValue(),j=b.getText(),h=g==""?[]:g.split(b.options.separator),i=j==""?[]:j.split(b.options.separator);if(b.options.multiple){if(!b.options.allowRepeat&&$.inArray(f.id,h)>-1){return}h.push(f.id);i.push(f.name)}else{h=[f.id];i=[f.name]}b.setText(i.join(b.options.separator));b.setValue(h.join(b.options.separator),true)}b._trigger("onNodeClick",c,{item:k,value:b.getValue()});b.term=b._text();b.close(c)}}).hide();this.menu.element=$(a);if(isNaN(this.options.panelHeight)){$(".coral-autocomplete-panel").css({"max-height":this.options.maxPanelHeight+"px"})}}});

window.PINYIN_DATA = {a:"啊阿吖嗄腌锕",ai:"爱埃挨哎唉哀皑癌蔼矮艾碍隘捱嗳嗌嫒瑷暧砹锿霭",an:"安案按鞍氨俺暗岸胺谙埯揞犴庵桉铵鹌黯",ang:"肮昂盎",ao:"凹敖熬翱袄傲奥懊澳坳拗嗷岙廒遨媪骜獒聱螯鏊鳌鏖",ba:"芭捌扒叭吧笆八疤巴拔跋靶把耙坝霸罢爸茇菝岜灞钯粑鲅魃",bai:"白柏百摆佰败拜稗捭掰",ban:"版般办斑班搬扳颁板扮拌伴瓣半绊阪坂钣瘢癍舨",bang:"帮邦梆榜膀绑棒磅蚌镑傍谤蒡浜",bao:"保报包苞胞褒剥薄雹堡饱宝抱暴豹鲍爆炮曝瀑勹葆孢煲鸨褓趵龅",bei:"北备杯碑悲卑辈背贝钡倍狈惫焙被孛陂邶蓓呗悖碚鹎褙鐾鞴",ben:"本奔苯笨夯畚坌锛",beng:"蚌崩绷甭泵蹦迸嘣甏",bi:"比必币毕逼鼻鄙笔彼碧蓖蔽毙毖庇痹闭敝弊辟壁臂避陛匕俾芘荜荸萆薜吡哔狴庳愎滗濞弼妣婢嬖璧贲睥畀铋秕裨筚箅篦舭襞跸髀",bian:"变编边便鞭贬扁卞辨辩辫遍匾弁苄忭汴缏煸砭碥窆褊蝙笾鳊",biao:"表标彪膘婊骠飑飙飚镖镳瘭裱鳔",bie:"别鳖憋瘪蹩",bin:"彬斌濒滨宾摈傧豳缤玢槟殡膑镔髌鬓",bing:"并兵冰柄丙秉饼炳病屏禀邴摒槟",bo:"播博柏剥薄玻菠拨钵波勃搏铂箔伯帛舶脖膊渤泊驳卜亳啵饽檗擘礴钹鹁簸跛踣",bu:"不布部步捕卜哺补埠簿怖埔卟逋瓿晡钚钸醭",ca:"擦嚓礤",cai:"才采材彩猜裁财睬踩菜蔡",can:"参餐蚕残惭惨灿孱骖璨粲黪",cang:"藏苍舱仓沧伧",cao:"操糙槽曹草嘈漕螬艚",ce:"册策测厕侧恻",ceng:"曾层蹭噌",cha:"查插叉茬茶碴搽察岔差诧刹喳嚓猹馇汊姹杈楂槎檫锸镲衩",chai:"差拆柴豺侪钗瘥虿",chan:"产搀掺蝉馋谗缠铲阐颤冁谄蒇廛忏潺澶孱羼婵骣觇禅蟾躔",chang:"场常长昌猖尝偿肠厂敞畅唱倡裳伥鬯苌菖徜怅惝阊娼嫦昶氅鲳",chao:"超抄钞朝嘲潮巢吵炒绰剿怊晁焯耖",che:"车扯撤掣彻澈坼砗",chen:"称郴臣辰尘晨忱沉陈趁衬沈谌谶抻嗔宸琛榇碜龀",cheng:"成程称城撑橙呈乘惩澄诚承逞骋秤丞埕枨柽塍瞠铖铛裎蛏酲",chi:"持吃痴匙池迟弛驰耻齿侈尺赤翅斥炽傺墀茌叱哧啻嗤彳饬媸敕眵鸱瘛褫蚩螭笞篪豉踟魑",chong:"重充冲虫崇宠茺忡憧铳舂艟",chou:"抽酬畴踌稠愁筹仇绸瞅丑臭俦帱惆瘳雠",chu:"出除处础初橱厨躇锄雏滁楚储矗搐触畜亍刍怵憷绌杵楮樗褚蜍蹰黜",chuai:"揣搋啜嘬膪踹",chuan:"传川穿椽船喘串舛遄氚钏舡",chuang:"创疮窗幢床闯怆",chui:"吹炊捶锤垂椎陲棰槌",chun:"春椿醇唇淳纯蠢莼鹑蝽",chuo:"戳绰啜辍踔龊",ci:"次此词差疵茨磁雌辞慈瓷刺赐茈祠鹚糍",cong:"从聪葱囱匆丛苁淙骢琮璁枞",cou:"凑楱辏腠",cu:"促粗醋簇卒蔟徂猝殂酢蹙蹴",cuan:"蹿篡窜攒汆撺爨镩",cui:"摧崔催脆瘁粹淬翠衰萃啐悴璀榱毳",cun:"存村寸忖皴",cuo:"错措磋撮搓挫厝嵯脞锉矬痤瘥鹾蹉",da:"大达打答搭瘩耷哒嗒囗怛妲沓褡笪靼鞑",dai:"代带呆歹傣戴殆贷袋待逮怠埭甙呔岱迨绐玳黛",dan:"单但耽担丹郸掸胆旦氮惮淡诞弹蛋石儋凼萏菪啖澹宕殚赕眈疸瘅聃箪",dang:"当挡党荡档谠砀铛裆",dao:"到道导刀捣蹈倒岛祷稻悼盗叨氘焘纛",de:"的地得德锝",deng:"等登蹬灯瞪凳邓噔嶝戥磴镫簦",di:"的地第底弟堤低滴迪敌笛狄涤翟嫡抵蒂帝递缔氐籴诋谛邸坻荻嘀娣柢棣觌祗砥碲睇镝羝骶",dian:"电点典店颠掂滇碘靛垫佃甸惦奠淀殿丶阽坫巅玷钿癜癫簟踮",diao:"调碉叼雕凋刁掉吊钓铞貂鲷",die:"跌爹碟蝶迭谍叠垤堞揲喋牒瓞耋鲽",ding:"定丁盯叮钉顶鼎锭订仃啶玎腚碇町疔耵酊",diu:"丢铥",dong:"动东冬董懂栋侗恫冻洞垌咚岽峒氡胨胴硐鸫",dou:"都兜抖斗陡豆逗痘蔸钭窦蚪篼",du:"都度读督毒犊独堵睹赌杜镀肚渡妒芏嘟渎椟牍蠹笃髑黩",duan:"断段短端锻缎椴煅簖",dui:"对堆兑队敦怼憝碓镦",dun:"墩吨蹲敦顿囤钝盾遁沌炖砘礅盹趸",duo:"多度掇哆夺垛躲朵跺舵剁惰堕咄哚沲缍铎裰踱",e:"阿蛾峨鹅俄额讹娥恶厄扼遏鄂饿哦噩谔垩苊莪萼呃愕屙婀轭腭锇锷鹗颚鳄",en:"恩蒽摁嗯",er:"而二儿耳尔饵洱贰迩珥铒鸸鲕",fa:"发法罚筏伐乏阀珐垡砝",fan:"范藩帆番翻樊矾钒繁凡烦反返贩犯饭泛蕃蘩幡夂梵攵燔畈蹯",fang:"方放访房坊芳肪防妨仿纺邡枋钫舫鲂",fei:"费非菲啡飞肥匪诽吠肺废沸芾狒悱淝妃绯榧腓斐扉砩镄痱蜚篚翡霏鲱",fen:"分份芬酚吩氛纷坟焚汾粉奋忿愤粪偾瀵棼鲼鼢",feng:"风丰封枫蜂峰锋疯烽逢冯缝讽奉凤俸酆葑唪沣砜",fo:"佛",fou:"否缶",fu:"服复府父负福富夫敷肤孵扶拂辐幅氟符伏俘浮涪袱弗甫抚辅俯釜斧脯腑腐赴副覆赋傅付阜腹讣附妇缚咐莆匐凫郛芙芾苻茯莩菔拊呋呒幞怫滏艴孚驸绂绋桴赙祓黻黼罘稃馥蚨蜉蝠蝮麸趺跗鲋鳆",ga:"噶嘎夹轧垓尬尕尜旮钆",gai:"改该概钙盖溉芥丐陔戤赅",gan:"感敢干甘杆柑竿肝赶秆赣坩苷尴擀泔淦澉绀橄旰矸疳酐",gang:"港冈刚钢缸肛纲岗杠戆罡筻",gao:"告高篙皋膏羔糕搞镐稿睾诰郜藁缟槔槁杲锆",ge:"个格合歌各革哥搁戈鸽胳疙割葛蛤阁隔铬咯鬲仡哿圪塥嗝纥搿膈硌镉袼颌虼舸骼",gei:"给",gen:"根跟亘茛哏艮",geng:"更耕庚羹埂耿梗哽赓绠鲠",gong:"公工供功共贡攻恭龚躬宫弓巩汞拱珙肱蚣觥",gou:"构够购钩勾沟苟狗垢佝诟岣遘媾缑枸觏彀笱篝鞲",gu:"告故辜菇咕箍估沽孤姑鼓古蛊骨谷股顾固雇贾嘏诂菰崮汩梏轱牯牿臌毂瞽罟钴锢鸪鹄痼蛄酤觚鲴鹘",gua:"刮瓜剐寡挂褂卦诖呱栝胍鸹",guai:"乖拐怪掴",guan:"关管观棺官冠馆罐惯灌贯纶倌莞掼涫盥鹳矜鳏",guang:"广光逛咣犷桄胱",gui:"规瑰圭硅归龟闺轨鬼诡癸桂柜跪贵刽匦刿庋宄妫桧炅晷皈簋鲑鳜",gun:"辊滚棍衮绲磙鲧",guo:"国过果锅郭裹馘埚掴呙帼崞猓椁虢聒蜾蝈",ha:"哈蛤铪",hai:"还海孩骸氦亥害骇嗨胲醢",han:"韩酣憨邯含涵寒函喊罕翰撼捍旱憾悍焊汗汉邗菡撖犴阚瀚晗焓顸颔蚶鼾",hang:"行杭夯航吭沆绗颃",hao:"好号壕嚎豪毫郝耗浩貉蒿薅嗥嚆濠灏昊皓颢蚝",he:"何合呵喝荷菏核禾和盒貉阂河涸赫褐鹤贺诃劾壑嗬阖曷盍颌蚵翮",hei:"嘿黑",hen:"很痕狠恨",heng:"哼亨横衡恒蘅珩桁",hong:"轰哄烘虹鸿洪宏弘红黉訇讧荭蕻薨闳泓",hou:"后候喉侯猴吼厚堠後逅瘊篌糇鲎骺",hu:"户护乎互和呼忽瑚壶葫胡蝴狐糊湖弧虎唬沪冱唿囫岵猢怙惚浒滹琥槲轷觳烀煳戽扈祜瓠鹄鹕鹱笏醐斛鹘",hua:"话华化划花哗猾滑画骅桦砉铧",huai:"槐徊怀淮坏踝",huan:"还欢环桓缓换患唤痪豢焕涣宦幻郇奂萑擐圜獾洹浣漶寰逭缳锾鲩鬟",huang:"荒慌黄磺蝗簧皇凰惶煌晃幌恍谎隍徨湟潢遑璜肓癀蟥篁鳇",hui:"会回恢挥灰辉徽蛔毁悔慧卉惠晦贿秽烩汇讳诲绘诙茴荟蕙咴喙隳洄彗缋珲桧晖恚虺蟪麾",hun:"荤昏婚魂浑混诨馄阍溷珲",huo:"活或获和豁伙火惑霍货祸劐藿攉嚯夥钬锪镬耠蠖",ji:"系己机技计级积际及基击记济辑即几继集极给绩激圾畸稽箕肌饥迹讥鸡姬缉吉棘籍急疾汲嫉挤脊蓟冀季伎祭剂悸寄寂既忌妓纪藉骑亟乩剞佶偈墼芨芰荠蒺蕺掎叽咭哜唧岌嵴洎屐骥畿玑楫殛戟戢赍觊犄齑矶羁嵇稷瘠虮笈笄暨跻跽霁鲚鲫髻麂",jia:"家加价佳嘉枷夹荚颊贾甲钾假稼架驾嫁茄伽郏葭岬浃迦珈戛胛恝铗镓痂瘕蛱笳袈跏",jian:"间件建简荐见健检坚监减键歼尖笺煎兼肩艰奸缄茧柬碱硷拣捡俭剪槛鉴践贱箭舰剑饯渐溅涧僭谏谫菅蒹搛囝湔蹇謇缣枧楗戋戬牮犍毽腱睑锏鹣裥笕翦踺鲣鞯",jiang:"江强僵姜将浆疆蒋桨奖讲匠酱降茳洚绛缰犟礓耩糨豇靓",jiao:"教交校较蕉椒礁焦胶郊浇骄娇嚼搅铰矫侥脚狡角饺缴绞剿酵轿叫窖佼僬艽茭挢噍峤徼湫姣敫皎鹪蛟醮跤鲛",jie:"接结解介界阶姐揭皆秸街截劫节桔杰捷睫竭洁戒藉芥借疥诫届讦诘拮喈嗟婕孑桀碣疖颉蚧羯鲒骱",jin:"进今金近仅津尽巾筋斤襟紧锦谨靳晋禁烬浸劲卺荩堇噤馑廑妗缙瑾槿赆觐衿矜",jing:"经京精境睛竞竟荆兢茎晶鲸惊粳井警景颈静敬镜径痉靖净刭儆阱菁獍憬泾迳弪婧肼胫腈旌箐",jiong:"炯窘迥扃",jiu:"就究酒揪纠玖韭久灸九厩救旧臼舅咎疚僦啾阄柩桕鸠鹫赳鬏",ju:"具且据车举巨鞠拘狙疽居驹菊局咀矩沮聚拒距踞锯俱句惧炬剧倨讵苣苴莒掬遽屦琚枸椐榘榉橘犋飓钜锔窭裾趄醵踽龃雎鞫",juan:"捐鹃娟倦眷卷绢鄄狷涓桊蠲锩镌隽",jue:"觉决绝嚼撅攫抉掘倔爵诀厥劂谲矍蕨噘噱崛獗孓珏桷橛爝镢蹶觖",jun:"均菌钧军君峻俊竣浚郡骏捃皲筠麇",ka:"喀咖卡咯佧咔胩",kai:"开揩楷凯慨剀垲蒈忾恺铠锎锴",kan:"看槛刊堪勘坎砍侃莰阚戡龛瞰",kang:"康慷糠扛抗亢炕伉闶钪",kao:"考拷烤靠尻栲犒铐",ke:"可科客课坷苛柯棵磕颗壳咳渴克刻嗑岢恪溘骒缂珂轲氪瞌钶锞稞疴窠颏蝌髁",ken:"肯啃垦恳裉龈",keng:"坑吭铿",kong:"控空恐孔倥崆箜",kou:"口抠扣寇芤蔻叩囗眍筘",ku:"枯哭窟苦酷库裤刳堀喾绔骷",kua:"夸垮挎跨胯侉",kuai:"会快块筷侩蒯郐哙狯浍脍",kuan:"款宽髋",kuang:"况匡筐狂框矿眶旷诓诳邝圹夼哐纩贶",kui:"亏盔岿窥葵奎魁傀馈愧溃馗匮夔隗蒉揆喹喟悝愦逵暌睽聩蝰篑跬",kun:"坤昆捆困悃阃琨锟醌鲲髡",kuo:"括扩廓阔蛞",la:"垃拉喇蜡腊辣啦落剌邋旯砬瘌",lai:"来莱赖崃徕涞濑赉睐铼癞籁",lan:"览蓝婪栏拦篮阑兰澜谰揽懒缆烂滥岚漤榄斓罱镧褴",lang:"琅榔狼廊郎朗浪蒗啷阆稂螂",lao:"老捞劳牢佬姥酪烙涝潦唠崂忉栳铑铹痨耢醪",le:"了乐勒仂叻泐鳓",lei:"类雷镭蕾磊累儡垒擂肋泪羸诔嘞嫘缧檑耒酹",leng:"棱楞冷塄愣",li:"理里力立历离利丽厘梨犁黎篱狸漓李鲤礼莉荔吏栗厉励砾傈例俐痢粒沥隶璃哩俪俚郦坜苈莅蓠藜呖唳喱猁溧澧逦娌嫠骊缡枥栎轹膦戾砺詈罹锂鹂疠疬蛎蜊蠡笠篥粝醴跞雳鲡鳢黧",lia:"俩",lian:"联链连练脸莲镰廉怜涟帘敛恋炼蔹奁潋濂琏楝殓臁裢裣蠊鲢",liang:"量两良亮俩粮凉梁粱辆晾谅墚莨椋锒踉靓魉",liao:"了料疗撩聊僚燎寥辽潦撂镣廖蓼尥嘹獠寮缭钌鹩",lie:"列裂烈劣猎冽埒捩咧洌趔躐鬣",lin:"琳林磷霖临邻鳞淋凛赁吝拎蔺啉嶙廪懔遴檩辚瞵粼躏麟",ling:"领另铃令玲菱零龄伶羚凌灵陵岭酃苓呤囹泠绫柃棂瓴聆蛉翎鲮",liu:"留浏流溜琉榴硫馏刘瘤柳六遛骝绺旒熘锍镏鹨鎏",long:"龙聋咙笼窿隆垄拢陇垅茏泷珑栊胧砻癃",lou:"楼娄搂篓漏陋露偻蒌喽嵝镂瘘耧蝼髅",lu:"录陆芦卢颅庐炉掳卤虏鲁麓碌露路赂鹿潞禄戮垆撸噜泸渌漉逯璐栌橹轳辂辘氇胪镥鸬鹭簏舻鲈",lv:"律旅虑驴吕铝侣履屡缕氯率滤绿偻捋闾榈膂稆褛",luan:"峦挛孪滦卵乱脔娈栾鸾銮",lue:"略掠锊",lun:"论抡轮伦仑沦纶囵",luo:"络咯烙萝螺罗逻锣箩骡裸落洛骆倮蠃荦摞猡泺漯珞椤脶镙瘰跞雒",ma:"码妈马麻玛蚂骂嘛吗抹唛犸杩蟆麽",mai:"买埋麦卖迈脉劢荬霾",man:"满瞒馒蛮蔓曼慢漫谩墁幔缦熳镘颟螨鳗鞔",mang:"芒茫盲氓忙莽邙漭硭蟒",mao:"贸猫茅锚毛矛铆卯茂冒帽貌袤茆峁泖瑁昴牦耄旄懋瞀蝥蟊髦",me:"么麽",mei:"没美每媒魅玫枚梅酶霉煤眉镁昧寐妹媚糜莓嵋猸浼湄楣镅鹛袂",men:"们门闷扪焖懑钔",meng:"盟萌蒙檬锰猛梦孟勐甍瞢懵朦礞虻蜢蠓艋艨",mi:"密眯醚靡糜迷谜弥米秘觅泌蜜幂芈谧咪嘧猕汨宓弭脒祢敉縻麋",mian:"面免棉眠绵冕勉娩缅沔渑湎腼眄",miao:"描苗瞄藐秒渺庙妙喵邈缈缪杪淼眇鹋",mie:"蔑灭乜咩蠛篾",min:"民抿皿敏悯闽苠岷闵泯缗玟珉愍黾鳘",ming:"明名命螟鸣铭冥茗溟暝瞑酩",miu:"谬缪",mo:"没模脉摸摹蘑膜磨摩魔抹末莫墨默沫漠寞陌谟茉蓦馍嫫嬷殁镆秣瘼耱貊貘麽",mou:"谋牟某侔哞缪眸蛑鍪",mu:"目母牟拇牡亩姆墓暮幕募慕木睦牧穆仫坶苜沐毪钼",na:"那拿哪呐钠娜纳讷捺肭镎衲",nai:"氖乃奶耐奈鼐佴艿萘柰",nan:"男南难喃囝囡楠腩蝻赧",nang:"囊攮囔馕曩",nao:"脑挠恼闹淖孬垴呶猱瑙硇铙蛲",ne:"呢讷",nei:"内馁",nen:"嫩恁",neng:"能",ni:"你妮霓倪泥尼拟匿腻逆溺伲坭蘼猊怩昵旎睨铌鲵",nian:"年蔫拈碾撵捻念粘廿埝辇黏鲇鲶",niang:"娘酿",niao:"鸟尿茑嬲脲袅",nie:"捏聂孽啮镊镍涅乜陧蘖嗫颞臬蹑",nin:"您",ning:"柠狞凝宁拧泞佞咛甯聍",niu:"牛扭钮纽拗狃忸妞",nong:"农脓浓弄侬哝",nu:"努奴怒弩胬孥驽",nv:"女恧钕衄",nuan:"暖",nue:"虐疟挪",nuo:"娜懦糯诺傩搦喏锘",o:"哦噢",ou:"欧鸥殴藕呕偶沤讴怄瓯耦",pa:"扒耙啪趴爬帕怕琶葩杷筢",pai:"牌派排拍徘湃俳蒎哌",pan:"攀潘盘磐盼畔判叛胖拚爿泮袢襻蟠蹒",pang:"磅乓庞旁耪胖彷夂滂逄攵螃",pao:"抛咆刨炮袍跑泡匏狍庖脬疱",pei:"培配呸胚裴赔陪佩沛辔帔旆锫醅霈",pen:"喷盆湓",peng:"朋砰抨烹澎彭蓬棚硼篷膨鹏捧碰堋嘭怦蟛",pi:"否被辟坯砒霹批披劈琵毗啤脾疲皮匹痞僻屁譬丕仳陴邳郫圮埤鼙芘擗噼庀淠媲纰枇甓罴铍癖疋蚍蜱貔",pian:"片便篇偏骗谝骈犏胼翩蹁",piao:"漂飘瓢票剽莩嘌嫖缥殍瞟螵",pie:"撇瞥丿苤彡氕",pin:"品频聘拼贫姘嫔榀牝颦",ping:"评平冯乒坪苹萍凭瓶屏俜娉枰鲆",po:"坡泼颇婆破魄迫粕叵鄱珀钋钷皤笸",pu:"普暴扑铺仆莆葡菩蒲埔朴圃浦谱曝瀑匍噗溥濮璞氆镤镨蹼",qi:"其企起期汽器启气奇缉欺栖戚妻七凄漆柒沏棋歧畦崎脐齐旗祈祁骑岂乞契砌迄弃泣讫亓俟圻芑芪萁萋葺蕲嘁屺岐汔淇骐绮琪琦杞桤槭耆祺憩碛颀蛴蜞綦鳍麒",qia:"夹掐恰洽葜袷髂",qian:"前钱牵扦钎铅千迁签仟谦乾黔钳潜遣浅谴堑嵌欠歉纤倩佥阡芊芡茜荨掮岍悭慊骞搴褰缱椠肷愆钤虔箝",qiang:"强将枪呛腔羌墙蔷抢戕嫱樯戗炝锖锵镪襁蜣羟跄",qiao:"壳橇锹敲悄桥瞧乔侨巧鞘撬翘峭俏窍削劁诮谯荞峤愀憔缲樵硗跷鞒",qie:"且切茄怯窃郄惬慊妾挈锲箧趄",qin:"亲钦侵秦琴勤芹擒禽寝沁芩揿吣嗪噙溱檎锓矜覃螓衾",qing:"情请庆轻青氢倾卿清擎晴氰顷苘圊檠磬蜻罄綮謦鲭黥",qiong:"琼穷邛茕穹蛩筇跫銎",qiu:"求球秋丘邱囚酋泅俅巯犰湫逑遒楸赇虬蚯蝤裘糗鳅鼽",qu:"区去取曲趋蛆躯屈驱渠娶龋趣诎劬苣蕖蘧岖衢阒璩觑氍朐祛磲鸲癯蛐蠼麴瞿黢",quan:"全权圈颧醛泉痊拳犬券劝诠荃犭悛绻辁畎铨蜷筌鬈",que:"确缺炔瘸却鹊榷雀阕阙悫",qun:"裙群逡麇",ran:"然燃冉染苒蚺髯",rang:"让瓤壤攘嚷禳穰",rao:"饶扰绕荛娆桡",re:"惹热喏",ren:"人任认壬仁忍韧刃妊纫仞荏饪轫稔衽",reng:"扔仍",ri:"日",rong:"容戎茸蓉荣融熔溶绒冗嵘狨榕肜蝾",rou:"揉柔肉糅蹂鞣",ru:"如入茹蠕儒孺辱乳汝褥蓐薷嚅洳溽濡缛铷襦颥",ruan:"软阮朊",rui:"蕊瑞锐芮蕤枘睿蚋",run:"闰润",ruo:"若弱偌箬",sa:"撒洒萨卅挲脎飒",sai:"赛腮鳃塞噻",san:"三叁伞散仨彡馓毵糁",sang:"桑嗓丧搡磉颡",sao:"搔骚扫嫂埽缫臊瘙鳋",se:"色塞瑟涩啬铯穑",sen:"森",seng:"僧",sha:"莎砂杀刹沙纱傻啥煞厦唼挲歃铩痧裟霎鲨",shai:"筛晒酾",shan:"删山珊苫杉煽衫闪陕擅赡膳善汕扇缮栅剡讪鄯埏芟潸姗嬗骟膻钐疝蟮舢跚鳝",shang:"上商尚赏墒伤晌裳垧泷绱殇熵觞",shao:"少绍鞘梢捎稍烧芍勺韶哨邵劭苕潲杓蛸筲艄",she:"设社奢赊蛇舌舍赦摄射慑涉厍佘揲猞滠歙畲麝",shen:"什身参深神甚申砷呻伸娠绅沈审婶肾慎渗诜谂莘葚哂渖椹胂矧蜃糁",sheng:"生声乘甥牲升绳省盛剩胜圣嵊渑晟眚笙",shi:"是时式什市实使事示始世施识视试师史十食势释失室匙狮湿诗尸虱石拾蚀矢屎驶士柿拭誓逝嗜噬适仕侍饰氏恃嘘谥埘莳蓍弑轼贳炻礻铈螫舐筮豕鲥鲺",shou:"手首受授收售守寿瘦兽狩绶艏",shu:"数术束输属殊述蔬枢梳抒叔舒淑疏书赎孰熟薯暑曙署蜀黍鼠树戍竖墅庶漱恕俞丨倏塾菽摅沭澍姝纾毹腧殳秫",shua:"刷耍唰",shuai:"率摔衰甩帅蟀",shuan:"栓拴闩涮",shuang:"霜双爽孀",shui:"说水谁睡税",shun:"吮瞬顺舜",shuo:"数说硕朔烁蒴搠妁槊铄",si:"司思似食四斯撕嘶私丝死肆寺嗣伺饲巳厮俟兕厶咝汜泗澌姒驷缌祀锶鸶耜蛳笥",song:"松送耸怂颂宋讼诵凇菘崧嵩忪悚淞竦",sou:"搜艘擞嗽叟薮嗖嗾馊溲飕瞍锼螋",su:"速诉苏素酥俗粟僳塑溯宿肃缩夙谡蔌嗉愫涑簌觫稣",suan:"算酸蒜狻",sui:"虽随隋绥髓碎岁穗遂隧祟谇荽濉邃燧眭睢",sun:"孙损笋荪狲飧榫隼",suo:"所索莎蓑梭唆缩琐锁唢嗦嗍娑桫挲睃羧",ta:"他它她塌塔獭挞蹋踏嗒闼溻漯遢榻沓铊趿鳎",tai:"大态台胎苔抬泰酞太汰邰薹骀肽炱钛跆鲐",tan:"坛弹坍摊贪瘫滩檀痰潭谭谈坦毯袒碳探叹炭郯澹昙忐钽锬覃",tang:"汤塘搪堂棠膛唐糖倘躺淌趟烫傥帑惝溏瑭樘铴镗耥螗螳羰醣",tao:"讨掏涛滔绦萄桃逃淘陶套鼗叨啕洮韬饕",te:"特忒忑慝铽",teng:"藤腾疼誊滕",ti:"题提体梯剔踢锑蹄啼替嚏惕涕剃屉倜荑悌逖绨缇鹈裼醍",tian:"天添填田甜恬舔腆掭忝阗殄畋",tiao:"调条挑迢眺跳佻苕祧窕蜩笤粜龆鲦髫",tie:"帖贴铁萜餮",ting:"庭听厅烃汀廷停亭挺艇莛葶婷梃铤蜓霆",tong:"同统通桐酮瞳铜彤童桶捅筒痛佟仝茼嗵恸潼砼",tou:"投头偷透骰",tu:"图突凸秃徒途涂屠土吐兔堍荼菟钍酴",tuan:"团湍抟彖疃",tui:"推颓腿蜕褪退忒煺",tun:"囤褪吞屯臀氽饨暾豚",tuo:"拖托脱鸵陀驮驼椭妥拓唾乇佗坨庹沱柝��橐砣箨酡跎鼍",wa:"挖哇蛙洼娃瓦袜佤娲腽",wai:"外歪崴",wan:"完湾万晚玩蔓豌弯顽丸烷碗挽皖惋宛婉腕剜芄莞菀纨绾琬脘畹蜿",wang:"网望汪王亡枉往旺忘妄罔惘辋魍",wei:"为位威未围维委巍微危韦违桅唯惟潍苇萎伟伪尾纬蔚味畏胃喂魏渭谓尉慰卫偎诿隈隗圩葳薇帏帷崴嵬猥猬闱沩洧涠逶娓玮韪軎炜煨痿艉鲔",wen:"文问闻稳瘟温蚊纹吻紊刎夂阌汶璺攵雯",weng:"嗡翁瓮蓊蕹",wo:"我挝蜗涡窝斡卧握沃倭莴喔幄渥肟硪龌",wu:"务无误物午恶巫呜钨乌污诬屋芜梧吾吴毋武五捂舞伍侮坞戊雾晤勿悟兀仵阢邬圬芴唔庑怃忤寤迕妩婺骛杌牾焐鹉鹜痦蜈鋈鼯",xi:"系息戏习希细西喜析栖昔熙硒矽晰嘻吸锡牺稀悉膝夕惜熄烯溪汐犀檄袭席媳铣洗隙僖兮隰郗茜菥葸蓰奚唏徙饩阋浠淅屣嬉玺樨曦觋欷歙熹禊禧皙穸裼蜥螅蟋舄舾羲粞翕醯蹊鼷",xia:"下瞎虾匣霞辖暇峡侠狭厦夏吓呷狎遐瑕柙硖罅黠",xian:"现限线显先见献衔险铣掀锨仙鲜纤咸贤舷闲涎弦嫌县腺馅羡宪陷冼苋莶藓岘猃暹娴氙燹祆鹇痫蚬筅籼酰跣跹霰",xiang:"相想项享详象响香像向降厢镶箱襄湘乡翔祥巷橡芗葙饷庠骧缃蟓鲞飨",xiao:"小销消效校萧硝霄削哮嚣宵淆晓孝肖啸笑哓崤潇逍骁绡枭枵蛸筱箫魈",xie:"些谢械楔歇蝎鞋协挟携邪斜胁谐写卸蟹懈泄泻屑偕亵勰燮薤撷獬廨渫瀣邂绁缬榭榍颉蹀躞",xin:"信新心欣薪芯锌辛忻衅囟馨莘昕歆镡鑫",xing:"行形型性幸姓省星腥猩惺兴刑邢醒杏陉荇荥擤饧悻硎",xiong:"兄凶胸匈汹雄熊芎",xiu:"修秀臭休羞朽嗅锈袖绣咻岫馐庥溴鸺貅髹",xu:"需许须序续墟戌虚嘘徐蓄酗叙旭畜恤絮婿绪吁诩勖圩蓿洫溆顼栩肷煦盱胥糈醑",xuan:"选宣轩喧悬旋玄癣眩绚儇谖萱揎泫渲漩璇楦暄炫煊碹铉镟痃",xue:"学削靴薛穴雪血谑噱泶踅鳕",xun:"询训讯迅寻浚勋熏循旬驯巡殉汛逊巽郇埙荀荨蕈薰峋徇獯恂洵浔曛窨醺鲟",ya:"压押鸦鸭呀丫芽牙蚜崖衙涯雅哑亚讶轧伢垭揠岈迓娅琊桠氩砑睚痖",yan:"言研验眼严颜焉咽阉烟淹盐蜒岩延阎炎沿奄掩衍演艳堰燕厌砚雁唁彦焰宴谚殷厣赝剡俨偃兖谳郾鄢埏芫菸崦恹闫阏湮滟妍嫣琰檐晏胭腌焱罨筵酽趼魇餍鼹",yang:"样央阳养殃鸯秧杨扬佯疡羊洋氧仰痒漾徉怏泱炀烊恙蛘鞅",yao:"要邀腰妖瑶摇尧遥窑谣姚咬舀药耀钥夭爻吆崾徭幺珧杳轺曜肴铫鹞窈繇鳐麽",ye:"业也页椰噎耶爷野冶掖叶曳腋夜液拽靥谒邺揶揲晔烨铘",yi:"一以已意易议医移艺益义艾蛇壹揖铱依伊衣颐夷遗仪胰疑沂宜姨彝椅蚁倚乙矣抑邑屹亿役臆逸肄疫亦裔毅忆溢诣谊译异翼翌绎刈劓佚佾诒圯埸懿苡荑薏弈奕挹弋呓咦咿嗌噫峄嶷猗饴怿怡悒漪迤驿缢殪轶贻欹旖熠眙钇镒镱痍瘗癔翊蜴舣羿翳酏黟",yin:"因音引银茵荫殷阴姻吟淫寅饮尹隐印胤鄞垠堙茚吲喑狺夤洇氤铟瘾窨蚓霪龈",ying:"影应营英迎樱婴鹰缨莹萤荧蝇赢盈颖硬映嬴郢茔荥莺萦蓥撄嘤膺滢潆瀛瑛璎楹媵鹦瘿颍罂",yo:"哟唷",yong:"用拥永佣臃痈庸雍踊蛹咏泳涌恿勇俑壅墉喁慵邕镛甬鳙饔",you:"有游由友优右邮幽悠忧尤铀犹油酉佑釉诱又幼卣攸侑莠莜莸尢呦囿宥柚猷牖铕疣蚰蚴蝣蝤繇鱿黝鼬",yu:"于育语域娱与遇尉迂淤盂榆虞愚舆余俞逾鱼愉渝渔隅予雨屿禹宇羽玉芋郁吁喻峪御愈欲狱誉浴寓裕预豫驭粥禺毓伛俣谀谕萸蓣揄圄圉嵛狳饫馀庾阈鬻妪妤纡瑜昱觎腴欤於煜熨燠聿畲钰鹆鹬瘐瘀窬窳蜮蝓竽臾舁雩龉",yuan:"员原源元院远鸳渊冤垣袁援辕园圆猿缘苑愿怨垸塬芫掾圜沅媛瑗橼爰眢鸢螈箢鼋",yue:"说乐阅越曰约跃钥岳粤月悦龠哕瀹栎樾刖钺",yun:"运耘云郧匀陨允蕴酝晕韵孕郓芸狁恽愠纭韫殒昀氲熨筠",za:"匝砸杂咋拶咂",zai:"在载子再栽哉灾宰崽甾",zan:"暂咱攒赞瓒昝簪糌趱錾",zang:"赃脏葬奘驵臧",zao:"造遭糟凿藻枣早澡蚤躁噪皂灶燥唣",ze:"责择则泽咋仄赜啧帻迮昃笮箦舴",zei:"贼",zen:"怎谮",zeng:"增综曾憎赠缯甑罾锃",zha:"扎喳渣札轧铡闸眨栅榨咋乍炸诈柞揸吒咤哳楂砟痄蚱齄",zhai:"翟摘斋宅窄债寨砦瘵",zhan:"站展战瞻毡詹粘沾盏斩辗崭蘸栈占湛绽谵搌旃",zhang:"章长张樟彰漳掌涨杖丈帐账仗胀瘴障仉鄣幛嶂獐嫜璋蟑",zhao:"着照找招朝昭沼赵罩兆肇召爪诏棹钊笊",zhe:"这者着浙遮折哲蛰辙锗蔗乇谪摺柘辄磔鹧褶蜇螫赭",zhen:"真圳珍斟甄砧臻贞针侦枕疹诊震振镇阵帧蓁浈缜桢椹榛轸赈胗朕祯畛稹鸩箴",zheng:"正政整证争蒸挣睁征狰怔拯症郑诤峥徵钲铮筝",zhi:"只之知制置址支直至织治质执职值致指志芝枝吱蜘肢脂汁植殖侄止趾旨纸挚掷帜峙智秩稚炙痔滞窒卮陟郅埴芷摭帙忮彘咫骘栉枳栀桎轵轾贽胝膣祉黹雉鸷痣蛭絷酯跖踬踯豸觯",zhong:"中种重终盅忠钟衷肿仲众冢忪锺螽舯踵",zhou:"州舟周洲诌粥轴肘帚咒皱宙昼骤荮啁妯纣绉胄碡籀繇酎",zhu:"注主助筑属珠株蛛朱猪诸诛逐竹烛煮拄瞩嘱著柱蛀贮铸住祝驻伫侏邾苎茱洙渚潴杼槠橥炷铢疰瘃竺箸舳翥躅麈",zhua:"挝抓爪",zhuai:"拽",zhuan:"专传转砖撰赚篆啭馔颛",zhuang:"状装幢桩庄妆撞壮僮",zhui:"椎锥追赘坠缀萑惴骓缒隹",zhun:"准屯谆肫窀",zhuo:"着捉拙卓桌琢茁酌啄灼浊倬诼擢浞涿濯禚斫镯",zi:"自资子字咨兹姿滋淄孜紫仔籽滓渍谘茈呲嵫姊孳缁梓辎赀恣眦锱秭耔笫粢趑觜訾龇鲻髭",zong:"综总鬃棕踪宗纵偬腙粽",zou:"邹走奏揍诹陬鄹驺鲰",zu:"组足租卒族祖诅阻俎菹镞",zuan:"钻纂攥缵躜",zui:"最嘴醉罪蕞觜",zun:"尊遵撙樽鳟",zuo:"作左昨佐柞做坐座阼唑嘬怍胙祚笮酢"};

var pinyinEngine=function(){return(this instanceof pinyinEngine)?this.resetCache():new pinyinEngine};pinyinEngine.prototype={search:function(c,h){var b=this._cache,g=this._history,f=[],e=0;c=c.toLowerCase();h=h||function(){};if(g.length&&c.indexOf(g.keyword)===1){b=g.content}for(var d=0,a=b.length;d<a;d++){if(b[d].tags.indexOf(c)!==-1){e++;f.push(b[d]);h(b[d].content)}}this._history={keyword:c,value:f,length:e};return f},setCache:function(c,f){var e,b="\u0001";e=c;for(var d=0,a=c.length;d<a;d++){e.push(pinyinEngine.toPinyin(c[d],false,b))}e=e.join(b);var g={tags:e,content:f};this._cache.push(g)},resetCache:function(){this._cache=[];this._history={}}};pinyinEngine.toPinyin=function(){var f=window.PINYIN_DATA;var b={},h,d,c,a;for(var d in f){h=f[d];c=0;a=h.length;for(;c<a;c++){var g=h.charAt(c);if(!b[g]){b[g]=[]}b[g].push(d)}}f=null;function e(w,v,n){var k=[],o,u=[];for(var t=0,q=w.length;t<q;t++){for(var s=0,p=v.length;s<p;s++){o=k[k.length]=(w[t] instanceof Array)?w[t].concat(v[s]):[].concat(w[t],v[s]);u.push(o.join(""))}}return{array:k,string:u.join(n||"")}}return function(n,t,j){var o,k,s,m,l,r;if(n==null||n.length==0){o=0}else{o=n.length}if(o===0){return t?"":[]}if(o===1){r=b[n];if(t){return r&&r[0]?r[0]:n}return r||[n]}else{var s=[];for(l=0;l<o;l++){r=b[n.charAt(l)];if(r){s[s.length]=t?r[0]:r}else{s[s.length]=t?n.charAt(l):[n.charAt(l)]}}if(t){return j==null?s:s.join(j||"")}k=s[0];m=s.length;var p,q;for(l=1;l<m;l++){p=e(k,s[l],j);k=p.array}return j==null?k:p.string}}}();

(function(){var c="loading",d={position:"overlay",text:"",loadingIcon:"coral-icon-loading",tpl:'<span class="loading-wrapper {wrapper}">{text}<span class="{loadingIcon}"></span></span>',disableSource:false,disableOthers:[]};function b(g,f){this.element=g;this.options=$.extend({},d,f);this._defaults=d;this._name=c;this._loader=null;this.init()}function a(){if(!$[c]){$.loading=function(f){$("body").loading(f)}}}b.prototype={init:function(){if($(this.element).is("body")){this.options.position="overlay"}this.show()},show:function(){var h=this,i=h.options.tpl.replace("{wrapper}"," loading-show ");i=i.replace("{loadingIcon}",h.options.loadingIcon);i=i.replace("{text}",(h.options.text!=="")?h.options.text+" ":"");h._loader=$(i);if($(h.element).is("input, textarea")&&true===h.options.disableSource){$(h.element).attr("disabled","disabled")}else{if(true===h.options.disableSource){$(h.element).addClass("disabled")}}switch(h.options.position){case"inside":$(h.element).append(h._loader);break;case"overlay":var g=null;if($(h.element).is("body")){g=$('<div class="coral-loading" style="position:fixed; left:0; top:0; z-index: 10001; width: 100%; height: '+$(window).height()+'px;" />');g.prepend("<div class ='coral-component-overlay'/>");$("body").prepend(g)}else{var k=$(h.element).css("position"),l={},f=$(h.element).outerHeight()+"px",j="100%";if("relative"===k||"absolute"===k){l={top:0,left:0}}else{l=$(h.element).position()}g=$('<div class="coral-loading" style="position:absolute; top: '+l.top+"px; left: "+l.left+"px; z-index: 10000; width: "+j+"; height: "+f+';" />');g.prepend("<div style='position:absolute;width:100%;height:100%;'><div class ='coral-component-overlay'style='position:relative;'></div></div>");$(h.element).prepend(g)}g.append(h._loader);h._loader.css({top:(g.outerHeight()/2-h._loader.outerHeight()/2)+"px"});break;default:$(h.element).after(h._loader);break}h.disableOthers()},refresh:function(){var g=null,h=this,j=$(h.element).css("position"),k={},f=$(h.element).outerHeight()+"px",i="100%";
if("relative"===j||"absolute"===j){k={top:0,left:0}}else{k=$(h.element).position()}g=$(h.element).find(".coral-loading");g.css({top:k.top,left:k.left,width:i,height:f});h._loader.css({top:(g.outerHeight()/2-h._loader.outerHeight()/2)+"px"})},hide:function(){if("overlay"===this.options.position){$(this.element).find(".coral-loading").first().remove()}else{$(this._loader).remove();$(this.element).text($(this.element).attr("data-loading-label"))}$(this.element).removeAttr("disabled").removeClass("disabled");this.enableOthers()},disableOthers:function(){$.each(this.options.disableOthers,function(g,h){var f=$(h);if(f.is("button, input, textarea")){f.attr("disabled","disabled")}else{f.addClass("disabled")}})},enableOthers:function(){$.each(this.options.disableOthers,function(g,h){var f=$(h);if(f.is("button, input, textarea")){f.removeAttr("disabled")}else{f.removeClass("disabled")}})}};var e=Array.prototype.slice;$.fn[c]=function(h){var i=this,g=e.call(arguments,1),f=typeof h==="string";return this.each(function(){if(f){if($.data(this,"plugin_"+c)){var k,j=$.data(this,"plugin_"+c);if(!$.isFunction(j[h])||h.charAt(0)==="_"){return $.error("no such method '"+h+"' for "+name+" component instance")}k=j[h].apply(j,g);if(k!==j&&k!==undefined){i=k&&k.jquery?i.pushStack(k.get()):k;return false}}}else{$.data(this,"plugin_"+c,new b(this,h))}})};a()})();

$(function(){$(document).tooltip({items:"[data-errors]",content:function(){var a=$(this);if(a.is("[data-errors]")){return a.attr("data-errors")}},show:{effect:"fadeIn",delay:300},tooltipClass:"coral-state-error",hide:{effect:"fadeOut",delay:0},position:{my:"left top",at:"left bottom+5"}})});

/*!
 * 组件库4.0：分栏符
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$.component("coral.subfield",{version:"4.0.1",options:{title:"",lineCls:null,textCls:null,onClick:null},_create:function(){if(!this.element.jquery){this.element=$(this.element)}this.element.addClass("coral-subfield");this.fieldset=$('<fieldset class="coral-subfield-fieldset"></fieldset>').appendTo(this.element);if(this.options.lineCls){this.fieldset.addClass(this.options.lineCls)}this.legend=$('<legend class="coral-subfield-legend">'+this.options.title+"</legend>").appendTo(this.fieldset);if(this.options.textCls){this.legend.addClass(this.options.textCls)}this._bindEvent()},_bindEvent:function(){var a=this;this.legend.bind("click"+this.eventNamespace,function(b){if(a.options.disabled){b.preventDefault();b.stopImmediatePropagation()}else{a._trigger("onClick")}})},_setOption:function(a,b){if(a==="title"){this.setTitle(b)}},_destroy:function(){this.uiTitle.remove()},component:function(){return this.element},show:function(){this.component().show()},hide:function(){this.component().hide()},setTitle:function(a){$("legend",this.fieldset).html(a);this.options.title=a},getTitle:function(){return this.options.title}});

/*!
 * jQuery Mousewheel 3.1.13
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 */
(function(){var c=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],j=("onwheel" in document||document.documentMode>=9)?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],g=Array.prototype.slice,h,b;if($.event.fixHooks){for(var d=c.length;d;){$.event.fixHooks[c[--d]]=$.event.mouseHooks}}var e=$.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener){for(var l=j.length;l;){this.addEventListener(j[--l],k,false)}}else{this.onmousewheel=k}$.data(this,"mousewheel-line-height",e.getLineHeight(this));$.data(this,"mousewheel-page-height",e.getPageHeight(this))},teardown:function(){if(this.removeEventListener){for(var l=j.length;l;){this.removeEventListener(j[--l],k,false)}}else{this.onmousewheel=null}$.removeData(this,"mousewheel-line-height");$.removeData(this,"mousewheel-page-height")},getLineHeight:function(l){var i=$(l),m=i["offsetParent" in $.fn?"offsetParent":"parent"]();if(!m.length){m=$("body")}return parseInt(m.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(i){return $(i).height()},settings:{adjustOldDeltas:true,normalizeOffset:true}};$.fn.extend({mousewheel:function(i){return i?this.bind("mousewheel",i):this.trigger("mousewheel")},unmousewheel:function(i){return this.unbind("mousewheel",i)}});function k(i){var n=i||window.event,t=g.call(arguments,1),v=0,p=0,o=0,s=0,r=0,q=0;i=$.event.fix(n);i.type="mousewheel";if("detail" in n){o=n.detail*-1}if("wheelDelta" in n){o=n.wheelDelta}if("wheelDeltaY" in n){o=n.wheelDeltaY}if("wheelDeltaX" in n){p=n.wheelDeltaX*-1}if("axis" in n&&n.axis===n.HORIZONTAL_AXIS){p=o*-1;o=0}v=o===0?p:o;if("deltaY" in n){o=n.deltaY*-1;v=o}if("deltaX" in n){p=n.deltaX;if(o===0){v=p*-1}}if(o===0&&p===0){return}if(n.deltaMode===1){var u=$.data(this,"mousewheel-line-height");v*=u;o*=u;p*=u}else{if(n.deltaMode===2){var m=$.data(this,"mousewheel-page-height");
v*=m;o*=m;p*=m}}s=Math.max(Math.abs(o),Math.abs(p));if(!b||s<b){b=s;if(a(n,s)){b/=40}}if(a(n,s)){v/=40;p/=40;o/=40}v=Math[v>=1?"floor":"ceil"](v/b);p=Math[p>=1?"floor":"ceil"](p/b);o=Math[o>=1?"floor":"ceil"](o/b);if(e.settings.normalizeOffset&&this.getBoundingClientRect){var l=this.getBoundingClientRect();r=i.clientX-l.left;q=i.clientY-l.top}i.deltaX=p;i.deltaY=o;i.deltaFactor=b;i.offsetX=r;i.offsetY=q;i.deltaMode=0;t.unshift(i,v,p,o);if(h){clearTimeout(h)}h=setTimeout(f,200);return($.event.dispatch||$.event.handle).apply(this,t)}function f(){b=null}function a(l,i){return e.settings.adjustOldDeltas&&l.type==="mousewheel"&&i%120===0}})();

$.component("coral.splitcontainer",{version:"4.1.4",options:{minWidth:"600"},_create:function(){var h=this,e,a=this.options,c=this.element,f=$(this.element),g=$(this.element).attr("id");f.addClass("coral-splitcontainer coral-splitcontainer-showhide");var k=$('<ul id="'+g+"_tree\" style='display:none'></ul>").appendTo("body");k.tree({},[{id:"appRoot",name:"appRoot",children:[{id:"appMaster",name:"appMaster",children:[]},{id:"appDetails",name:"appDetails",children:[]}]}]);this.curDetailNode;this.pageIdArray=[];this.historyIdArray=[];this.arr=[];var j=$("#"+g).children("div")[0],b=$("#"+g).children("div")[1];if(j.id==""){j.id="splitContainer-Master"}if(b.id==""){b.id="splitContainer-Detail"}$("#"+j.id).addClass("coral-nav coral-splitcontainer-master coral-splitcontainer-mastervisible");$("#"+b.id).addClass("coral-nav coral-splitcontainer-detail");var d=h.getTree().tree("getNodeByParam","id","appMaster"),i=h.getTree().tree("getNodeByParam","id","appDetails");this.curDetailNode=i;$("#"+j.id).children("div").each(function(m){a=$.parser.parseOptions(this,[]);var l=h._createView(this.id,a,$("#"+j.id),d);h.getTree().tree("addNodes",d,l);if(!h.options.initialMaster&&m==0){h.options.initialMaster=this.id}h.initialMaster=$("#"+h.options.initialMaster)});$("#"+b.id).children("div").each(function(m){a=$.parser.parseOptions(this,[]);var l=h._createView(this.id,a,$("#"+b.id),i);h.getTree().tree("addNodes",i,l);if(!h.options.initialDetail&&m==0){h.options.initialDetail=this.id}if(a.title){}h.initialDetail=$("#"+h.options.initialDetail)});e=i.children[0].id;i.viewId="view_"+e;this.addView(e,$("#"+e));this.toDetail(e);this.pageIdArray.push(e);this.historyIdArray.push(e);this._bindEvent()},addView:function(f,d){var a=$(this.element).attr("id"),e=$("#"+a).children("div")[1];var c=this.getTree().tree("getNodeByParam","id",f);if(c){if(d&&typeof d==="object"){if(d.url){$("#"+c.id).panel("reload",d.url)}else{if(d.content){$("#"+c.id).panel("setContent",d.content)}}}}else{var b=this._createView(f,d,$("#"+e.id),this.curDetailNode);
this.getTree().tree("addNodes",this.curDetailNode,b);c=this.getTree().tree("getNodeByParam","id",f)}this.curDetailNode=c;this.pageIdArray.push(c.id);this.historyIdArray.push(c.id);if(c.level-2===this.arr.length){this.arr.push(c)}return $("#"+c.id)},getCurrentView:function(a){return $("#"+this.curDetailNode.id)},toDetail:function(f,d){var c=this.options,a=$(this.element).attr("id"),e=$("#"+a).children("div")[1];var b=this.getTree().tree("getNodeByParam","id",f);if(b){$("#"+b.viewId).siblings().hide();$("#"+b.viewId).show()}b.data=d;$.coral.refreshAllComponent($("#"+f));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:b,toId:f,direction:"to"}])},NodeRadio:function(g,d,a,b,e,c){var f={};f.id=g;f.pId=d;f.name=g;f.isParent=a;f.open=b;f.icon=e;f.nocheck=c;return f},_createView:function(b,a,h,n){var j=this,g="",c=$("#"+b),f={},l,m,i,e=$.inArray(b,this.pageIdArray);if(c.length==0){c=$("<div id='"+b+"'></div>")}if(e>-1){i=this.getTree().tree("getNodeByParam","id",this.pageIdArray[e-1]);m=i.viewId;l=$("#"+m)}else{m="view_"+b;l=$("<div id='"+m+"' class='coral-nav-item' style='width:100%'></div>").appendTo(h)}c.appendTo(l);var d={type:"button",icons:"cui-icon-arrow-left3",label:"back",text:false,onClick:function(){j.backDetail()}},o={type:"html",content:a.title};a.toolbarOptions=a.toolbarOptions||{};a.toolbarOptions.data=a.toolbarOptions.data||[];a.toolbarOptions.data.unshift("->");if(a.showNavButton){a.toolbarOptions.data.unshift(d)}if(a.title){a.toolbarOptions.data.unshift("->");a.toolbarOptions.data.unshift(o)}$.each(a.toolbarOptions.data,function(q,r){if(this==="navBtn"){a.toolbarOptions.data[q]=d}});var p=$.extend({},{fit:true,componentCls:"coral-page",collapsible:false,},a);c.panel(p);var k=this.NodeRadio(b,n.id,false,true,null,false);k.viewId=m;return k},_bindEvent:function(){var b=this;var a=$(this.element).attr("id"),c=$("#"+a).children("div")[0];$(document).bind("click.splitcontainer",function(h){var g=$(h.target);var f=$(b.element).attr("id"),j=$("#"+f).children("div")[0];
var d=b.element.find(".coral-splitcontainer-master");var i=d.offset();if(h.pageX<i.left||h.pageX>i.left+d.width()||h.pageY<i.top||h.pageY>i.top+d.height()){if(!g.parent().is("button")&&$("#"+j.id).hasClass("showMaster")){b.hideMaster()}}})},showMaster:function(){var a=$(this.element).attr("id");var c=$("#"+a).children("div")[0],b=$("#"+a).children("div")[1];$("#"+c.id).addClass("showMaster")},hideMaster:function(){var a=$(this.element).attr("id");var c=$("#"+a).children("div")[0],b=$("#"+a).children("div")[1];$("#"+c.id).removeClass("showMaster")},maxDetail:function(b){var a=$(this.element).attr("id");var d=$("#"+a).children("div")[0],c=$("#"+a).children("div")[1];if(b=="max"){$("#"+a).removeClass("coral-splitcontainer-showhide").addClass("coral-splitcontainer-hidemode")}else{$("#"+a).removeClass("coral-splitcontainer-hidemode").addClass("coral-splitcontainer-showhide")}$("#"+d.id).removeClass("coral-splitcontainer-mastervisible showMaster").addClass("coral-splitcontainer-masterhidden");$.coral.refreshAllComponent($("#"+c.id))},refresh:function(){var d=this,a=$(this.element).attr("id"),c,f,b,g=$("#"+a).children("div")[0],e=$("#"+a).children("div")[1];if(this.initialDetail){f=$("#"+this.options.initialDetail).panel("option","title");if(f){c=$("#"+this.options.initialDetail).panel("toolbar")}}if($(window).width()<this.options.minWidth){$("#"+a).addClass("coral-splitcontainer-portrait");if(c){b=c.toolbar("isExist",this.options.id+"_detailMenu");if(!b){c.toolbar("add",0,{id:this.options.id+"_detailMenu",type:"button",onClick:function(){d.showMaster()},icons:"cui-icon-menu7",text:false,label:"菜单"})}}$("#"+g.id).removeClass("coral-splitcontainer-mastervisible showMaster").addClass("coral-splitcontainer-masterhidden")}else{$("#"+a).removeClass("coral-splitcontainer-portrait");$("#"+g.id).removeClass("coral-splitcontainer-masterhidden showMaster").addClass("coral-splitcontainer-mastervisible");if(c){b=c.toolbar("isExist",this.options.id+"_detailMenu");if(b){c.toolbar("remove",0)
}}}$.coral.refreshAllComponent($("#"+g.id));$.coral.refreshAllComponent($("#"+e.id))},backDetail:function(b){var a=$.inArray(this.curDetailNode.id,this.historyIdArray);if(a<=0){return}var e=this.getTree().tree("getNodeByParam","id",this.historyIdArray[a-1]);$("#"+e.viewId).siblings().hide();$("#"+e.viewId).show();e.backData=b;if(a>-1){var d=this.historyIdArray.length,c=d-a;this.historyIdArray.splice(a,c)}$.coral.refreshAllComponent($("#"+e.id));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:e,toId:e.id,direction:"back"}]);this.curDetailNode=e},backToView:function(d,b){var a=$.inArray(d,this.historyIdArray);if(a<0){return}var c=this.getTree().tree("getNodeByParam","id",d);$("#"+c.viewId).siblings().hide();$("#"+c.viewId).show();c.backData=b;$.coral.refreshAllComponent($("#"+d));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:c,toId:c.id,direction:"backToView"}])},backToTopDetail:function(b){var a=this.getTree().tree("getNodeByParam","id","appDetails");$("#"+a.viewId).siblings().hide();$("#"+a.viewId).show();a.backData=b;$.coral.refreshAllComponent($("#"+a.id));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:a,toId:a.id,direction:"backToTop"}])},reload:function(c,b){var a;if(b){}else{this.curDetailNode=a=this.getTree().tree("getNodeByParam","id","appDetails")}this.toDetail(c)},getTree:function(){return $("#"+$(this.element).attr("id")+"_tree")}});

$.component("coral.view",{version:"@version",options:{controllerName:null,heightStyle:"auto"},_create:function(f,d){var b=this;var a=this.options;this.element.addClass("coral-view coral-helper-reset");$.controller(this.options.controllerName,{view:this.element,controllerName:this.options.controllerName});var g=$.controller(b.options.controllerName);$.parseDone({fun:g.onInit,context:g,args:[f,d]});this._refresh()},_destroy:function(){},_setOption:function(a,b){this._super(a,b)},refresh:function(){this._refresh()},_refresh:function(){$.coral.refreshAllComponent(this.element)}});

}));
var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(b){this.initSWFUpload(b)}}SWFUpload.prototype.initSWFUpload=function(c){try{this.customSettings={};this.settings=c;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo()}catch(d){delete SWFUpload.instances[this.movieName];throw d}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(e){if(typeof(e)!=="string"||e.match(/^https?:\/\//i)||e.match(/^\//)){return e}var f=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");var d=window.location.pathname.lastIndexOf("/");if(d<=0){path="/"}else{path=window.location.pathname.substr(0,d)+"/"}return path+e};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(c,d){this.settings[c]=(this.settings[c]==undefined)?d:this.settings[c]};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);
this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime()}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);
this.settings.button_image_url=this.settings.button_image_url?SWFUpload.completeURL(this.settings.button_image_url):this.settings.button_image_url}delete this.ensureDefault};SWFUpload.prototype.loadFlash=function(){var d,c;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added"}d=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(d==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id}c=document.createElement("div");c.innerHTML=this.getFlashHTML();d.parentNode.replaceChild(c.firstChild,d);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement()}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="sameDomain"/>','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")};SWFUpload.prototype.getFlashVars=function(){var c=this.buildParamString();var d=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(d),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(c),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")
};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName)}if(this.movieElement===null){throw"Could not find Flash element"}return this.movieElement};SWFUpload.prototype.buildParamString=function(){var f=this.settings.post_params;var d=[];if(typeof(f)==="object"){for(var e in f){if(f.hasOwnProperty(e)){d.push(encodeURIComponent(e.toString())+"="+encodeURIComponent(f[e].toString()))}}}return d.join("&amp;")};SWFUpload.prototype.reduceUploadCount=function(){this.callFlash("reduceUploadCount")};SWFUpload.prototype.addUploadCount=function(){this.callFlash("addUploadCount")};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);this.callFlash("Destroy");var g=null;g=this.getMovieElement();if(g&&typeof(g.CallFunction)==="unknown"){for(var j in g){try{if(typeof(g[j])==="function"){g[j]=null}}catch(h){}}try{g.parentNode.removeChild(g)}catch(f){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true}catch(i){return false}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""))
};SWFUpload.prototype.addSetting=function(d,f,e){if(f==undefined){return(this.settings[d]=e)}else{return(this.settings[d]=f)}};SWFUpload.prototype.getSetting=function(b){if(this.settings[b]!=undefined){return this.settings[b]}return""};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement();var returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue)}return returnValue};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")};SWFUpload.prototype.startUpload=function(b){this.callFlash("StartUpload",[b])};SWFUpload.prototype.cancelUpload=function(d,c){if(c!==false){c=true}this.callFlash("CancelUpload",[d,c])};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")};SWFUpload.prototype.setStats=function(b){this.callFlash("SetStats",[b])};SWFUpload.prototype.getFile=function(b){if(typeof(b)==="number"){return this.callFlash("GetFileByIndex",[b])}else{return this.callFlash("GetFile",[b])}};SWFUpload.prototype.addFileParam=function(e,d,f){return this.callFlash("AddFileParam",[e,d,f])};SWFUpload.prototype.removeFileParam=function(d,c){this.callFlash("RemoveFileParam",[d,c])};SWFUpload.prototype.setUploadURL=function(b){this.settings.upload_url=b.toString();this.callFlash("SetUploadURL",[b])};SWFUpload.prototype.setPostParams=function(b){this.settings.post_params=b;this.callFlash("SetPostParams",[b])};SWFUpload.prototype.addPostParam=function(d,c){this.settings.post_params[d]=c;this.callFlash("SetPostParams",[this.settings.post_params])
};SWFUpload.prototype.removePostParam=function(b){delete this.settings.post_params[b];this.callFlash("SetPostParams",[this.settings.post_params])};SWFUpload.prototype.setFileTypes=function(d,c){this.settings.file_types=d;this.settings.file_types_description=c;this.callFlash("SetFileTypes",[d,c])};SWFUpload.prototype.setFileSizeLimit=function(b){this.settings.file_size_limit=b;this.callFlash("SetFileSizeLimit",[b])};SWFUpload.prototype.setFileUploadLimit=function(b){this.settings.file_upload_limit=b;this.callFlash("SetFileUploadLimit",[b])};SWFUpload.prototype.setFileQueueLimit=function(b){this.settings.file_queue_limit=b;this.callFlash("SetFileQueueLimit",[b])};SWFUpload.prototype.setFilePostName=function(b){this.settings.file_post_name=b;this.callFlash("SetFilePostName",[b])};SWFUpload.prototype.setUseQueryString=function(b){this.settings.use_query_string=b;this.callFlash("SetUseQueryString",[b])};SWFUpload.prototype.setRequeueOnError=function(b){this.settings.requeue_on_error=b;this.callFlash("SetRequeueOnError",[b])};SWFUpload.prototype.setHTTPSuccess=function(b){if(typeof b==="string"){b=b.replace(" ","").split(",")}this.settings.http_success=b;this.callFlash("SetHTTPSuccess",[b])};SWFUpload.prototype.setAssumeSuccessTimeout=function(b){this.settings.assume_success_timeout=b;this.callFlash("SetAssumeSuccessTimeout",[b])};SWFUpload.prototype.setDebugEnabled=function(b){this.settings.debug_enabled=b;this.callFlash("SetDebugEnabled",[b])};SWFUpload.prototype.setButtonImageURL=function(b){if(b==undefined){b=""}this.settings.button_image_url=b;this.callFlash("SetButtonImageURL",[b])};SWFUpload.prototype.setButtonDimensions=function(f,e){this.settings.button_width=f;this.settings.button_height=e;var d=this.getMovieElement();if(d!=undefined){d.style.width=f+"px";d.style.height=e+"px"}this.callFlash("SetButtonDimensions",[f,e])};SWFUpload.prototype.setButtonText=function(b){this.settings.button_text=b;this.callFlash("SetButtonText",[b])};SWFUpload.prototype.setButtonTextPadding=function(c,d){this.settings.button_text_top_padding=d;
this.settings.button_text_left_padding=c;this.callFlash("SetButtonTextPadding",[c,d])};SWFUpload.prototype.setButtonTextStyle=function(b){this.settings.button_text_style=b;this.callFlash("SetButtonTextStyle",[b])};SWFUpload.prototype.setButtonDisabled=function(b){this.settings.button_disabled=b;this.callFlash("SetButtonDisabled",[b])};SWFUpload.prototype.setButtonAction=function(b){this.settings.button_action=b;this.callFlash("SetButtonAction",[b])};SWFUpload.prototype.setButtonCursor=function(b){this.settings.button_cursor=b;this.callFlash("SetButtonCursor",[b])};SWFUpload.prototype.queueEvent=function(d,f){if(f==undefined){f=[]}else{if(!(f instanceof Array)){f=[f]}}var e=this;if(typeof this.settings[d]==="function"){this.eventQueue.push(function(){this.settings[d].apply(this,f)});setTimeout(function(){e.executeNextEvent()},0)}else{if(this.settings[d]!==null){throw"Event handler "+d+" is unknown or is not a function"}}};SWFUpload.prototype.executeNextEvent=function(){var b=this.eventQueue?this.eventQueue.shift():null;if(typeof(b)==="function"){b.apply(this)}};SWFUpload.prototype.unescapeFilePostParams=function(l){var j=/[$]([0-9a-f]{4})/i;var i={};var k;if(l!=undefined){for(var h in l.post){if(l.post.hasOwnProperty(h)){k=h;var g;while((g=j.exec(k))!==null){k=k.replace(g[0],String.fromCharCode(parseInt("0x"+g[1],16)))}i[k]=l.post[h]}}l.post=i}return l};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(b){return false}};SWFUpload.prototype.flashReady=function(){var b=this.getMovieElement();if(!b){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(b);this.queueEvent("swfupload_loaded_handler")};SWFUpload.prototype.cleanUp=function(c){try{if(this.movieElement&&typeof(c.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var a in c){try{if(typeof(c[a])==="function"&&a[0]>="A"&&a[0]<="Z"){c[a]=null
}}catch(d){}}}}catch(b){}window.__flash__removeCallback=function(g,e){try{if(g){g[e]=null}}catch(f){}}};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")};SWFUpload.prototype.fileQueued=function(b){b=this.unescapeFilePostParams(b);this.queueEvent("file_queued_handler",b)};SWFUpload.prototype.fileQueueError=function(e,f,d){e=this.unescapeFilePostParams(e);this.queueEvent("file_queue_error_handler",[e,f,d])};SWFUpload.prototype.fileDialogComplete=function(d,f,e){this.queueEvent("file_dialog_complete_handler",[d,f,e])};SWFUpload.prototype.uploadStart=function(b){b=this.unescapeFilePostParams(b);this.queueEvent("return_upload_start_handler",b)};SWFUpload.prototype.returnUploadStart=function(d){var c;if(typeof this.settings.upload_start_handler==="function"){d=this.unescapeFilePostParams(d);c=this.settings.upload_start_handler.call(this,d)}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function"}}if(c===undefined){c=true}c=!!c;this.callFlash("ReturnUploadStart",[c])};SWFUpload.prototype.uploadProgress=function(e,f,d){e=this.unescapeFilePostParams(e);this.queueEvent("upload_progress_handler",[e,f,d])};SWFUpload.prototype.uploadError=function(e,f,d){e=this.unescapeFilePostParams(e);this.queueEvent("upload_error_handler",[e,f,d])};SWFUpload.prototype.uploadSuccess=function(d,e,f){d=this.unescapeFilePostParams(d);this.queueEvent("upload_success_handler",[d,e,f])};SWFUpload.prototype.uploadComplete=function(b){b=this.unescapeFilePostParams(b);this.queueEvent("upload_complete_handler",b)};SWFUpload.prototype.debug=function(b){this.queueEvent("debug_handler",b)};SWFUpload.prototype.debugMessage=function(h){if(this.settings.debug){var f,g=[];if(typeof h==="object"&&typeof h.name==="string"&&typeof h.message==="string"){for(var e in h){if(h.hasOwnProperty(e)){g.push(e+": "+h[e])}}f=g.join("\n")||"";g=f.split("\n");f="EXCEPTION: "+g.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(f)}else{SWFUpload.Console.writeLine(h)
}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(g){var e,f;try{e=document.getElementById("SWFUpload_Console");if(!e){f=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(f);e=document.createElement("textarea");e.id="SWFUpload_Console";e.style.fontFamily="monospace";e.setAttribute("wrap","off");e.wrap="off";e.style.overflow="auto";e.style.width="700px";e.style.height="350px";e.style.margin="5px";f.appendChild(e)}e.value+=g+"\n";e.scrollTop=e.scrollHeight-e.clientHeight}catch(h){alert("Exception: "+h.name+" Message: "+h.message)}};

