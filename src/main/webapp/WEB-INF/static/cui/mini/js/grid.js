$.grid=$.grid||{};var grid=$.component("coral.grid",{version:"4.0.1",castProperties:["rowEditButtons","data","initData","rowList","pager","pagerTemplate","celloptions","colModel"],options:{},grid:{},diff:2,getScrollBarWidth:function(){var c=document.createElement("p");c.style.width="100%";c.style.height="200px";var d=document.createElement("div");d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.visibility="hidden";d.style.width="200px";d.style.height="150px";d.style.overflow="hidden";d.appendChild(c);document.body.appendChild(d);var b=c.offsetWidth;d.style.overflow="scroll";var a=c.offsetWidth;if(b==a){a=d.clientWidth}document.body.removeChild(d);return(b-a)+this.diff},_destroy:function(){var b="",a=$(this.element).attr("id");if(this.pagers){b=$(this.pagers).empty().addClass(a)}$(this.element).empty();this.element.removeClass("ctrl-init ctrl-init-grid");this.element.removeClass("coral-grid");this.element.removeClass(this.options.cls);this.component().replaceWith(this.element).append(b)},_create:function(){var l=this.options,g=this,h="coral-state-active",m="coral-state-focus",b=this.element.uniqueId().attr("id");l.id=b;var c={_index:{},altRows:false,altclass:" coral-priority-secondary ",ajaxGridOptions:{},asyncType:"post",autoSave:false,autoValid:true,autoWidth:true,allowSaveOnError:true,cls:"",caption:"",colModel:[],colNames:[],cellLayout:1,cellEdit:false,cellsubmit:"clientArray",clicksToEdit:2,data:[],datatype:"json",direction:"ltr",deselectAfterSort:true,emptyrecords:"无数据",ExpandColumn:null,height:150,idPrefix:"",initData:false,customPicgrid:$.noop(),gridview:false,grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],summary:[],summaryval:[],plusicon:"cui-icon-plus3",minusicon:"cui-icon-minus3",displayField:[],groupSummaryPos:[],formatDisplayField:[],_locgr:false},groupHeaders:[],groupHeader:false,fitStyle:"auto",forceFit:false,hoverrows:true,lastsort:0,loadonce:true,loadui:"enable",loadtext:"加载中，请耐心等候 ...",minWidth:false,multiselect:false,multiselectWidth:30,multiboxonly:false,multikey:"",clickRowToSelect:true,model:"grid",page:1,pager:"",pagerStyle:"flex",pginput:true,records:0,rninput:true,rowEditButtons:[],pgbuttons:true,picTemplate:"picTemplate",postData:{},prmNames:{page:"P_pageNumber",rows:"P_pagesize",sort:"P_orders",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},rowNum:20,rowNumMax:200,rownumbers:false,rownumWidth:35,rownumName:"",rowList:[10,20,30],savedRow:[],scrollOffset:this.getScrollBarWidth(),selarrrow:[],singleselect:false,sortorder:"asc",treeGrid:false,treeGridModel:"adjacency",treeReader:{},treeANode:-1,tree_root_level:0,onSortableColumns:false,sortableColumnsOptions:{},onSortableRows:false,beforeSortableRows:false,afterSortableRows:false,editableRows:false,containSortOrder:false,sortSeparator:" ",shrinkToFit:true,toppager:false,toolbar:[false,""],url:"",useProp:true,viewsortcols:[false,"vertical",true],viewrecords:true,minIndex:null,maxIndex:null,preIndex:null,beforePopulate:null};
l=$.extend(true,{},c,$.grid.defaults,this.options);if(l.model=="pic"){l.model="card"}this.options=l;this.options.isValid=true;l.postData=$.coral.toFunction(l.postData);l.localReader=$.extend(true,{root:"data",page:"pageNumber",total:"totalPages",records:"total",repeatitems:false,cell:"cell",id:"id",userData:"userData",subgrid:{root:"data",repeatitems:true,cell:"cell"}},l.localReader);l.jsonReader=$.extend(true,{root:"data",page:"pageNumber",total:"totalPages",records:"total",repeatitems:false,cell:"cell",id:"id",userData:"userData"},l.jsonReader);if(this.options.pivotData&&this.options.pivotData.length){this.jqPivot(this.options.pivotData,this.options.pivotOption,this.options.gridOption,this.options.ajaxOption)}if(this.options.data.length){this.normalizeData();this.refreshIndex()}this.id=b;var a={groupHeader:[],headers:[],cols:[],footers:[],dragStart:function(p,n,q){var o=this;this.resizing={idx:p,startX:n.clientX,sOL:q[0]};o.columnsView.style.cursor="col-resize";this.curGbox=$("#rs_m"+$.grid.coralID(g.options.id),"#"+$.grid.coralID(g.options.id));this.curGbox.css({display:"block",left:q[0],top:q[1],height:q[2]});g._trigger("onResizeStart",n,[{index:p}]);document.onselectstart=function(){return false}},dragMove:function(i){if(this.resizing){var q=i.clientX-this.resizing.startX,n=this.headers[this.resizing.idx],o=g.options.direction==="ltr"?n.width+q:n.width-q,r,p;$("#test").html(q);if(o>33){this.curGbox.css({left:this.resizing.sOL+q});if(g.options.forceFit===true){r=this.headers[this.resizing.idx+l.nv];p=g.options.direction==="ltr"?r.width-q:r.width+q;if(p>33){n.newWidth=o;r.newWidth=p}}else{this.newWidth=g.options.direction==="ltr"?g.options.tblwidth+q:g.options.tblwidth-q;n.newWidth=o}}}},dragEnd:function(){this.columnsView.style.cursor="default";if(this.resizing){var i=this.resizing.idx,n=this.headers[i].newWidth||this.headers[i].width;n=parseInt(n,10);this.resizing=false;$("#rs_m"+$.grid.coralID(g.options.id)).css("display","none");g.options.colModel[i].width=n;this.headers[i].width=n;
this.headers[i].el.style.width=n+"px";this.cols[i].style.width=n+"px";if($("table:first",this.rowsView).hasClass("coral-grid-btable-frozen")){$("tr.jqgfirstrow>td:eq("+i+")",$("table:first",this.rowsView))[0].style.width=n+"px"}var o=$("tr.jqg-first-row-header>th:eq("+i+")",$("table:first",this.columnsView));if(o.length>0){o[0].style.width=n+"px"}if(this.footers.length>0){this.footers[i].style.width=n+"px"}if(g.options.forceFit===true){n=this.headers[i+l.nv].newWidth||this.headers[i+l.nv].width;this.headers[i+l.nv].width=n;this.headers[i+l.nv].el.style.width=n+"px";this.cols[i+l.nv].style.width=n+"px";if(this.footers.length>0){this.footers[i+l.nv].style.width=n+"px"}g.options.colModel[i+l.nv].width=n;o=$("tr.jqg-first-row-header>th:eq("+(i+l.nv)+")",$("table:first",this.columnsView));if(o.length>0){o[0].style.width=n+"px"}}else{g.options.tblwidth=this.newWidth||g.options.tblwidth;$("table",this.rowsView).css("width",g.options.tblwidth+"px");$("table:first",this.columnsView).css("width",g.options.tblwidth+"px");this.columnsView.scrollLeft=this.rowsView.scrollLeft;if(g.options.footerrow){$("table:first",this.sDiv).css("width",c.tblwidth+"px");this.sDiv.scrollLeft=this.rowsView.scrollLeft}}g._trigger("onResizeStop",null,[{newWidth:n,index:i,headers:this.headers}])}this.curGbox=null;document.onselectstart=function(){return true}},selectionPreserver:function(p){var o=p.options,n=o.selrow,i=o.selarrrow?$.makeArray(o.selarrrow):null,r=p.grid.rowsView.scrollLeft,q=function(){var s;o.selrow=null;o.selarrrow=[];if(o.multiselect&&i&&i.length>0){for(s=0;s<i.length;s++){if(i[s]!=n){$(p.element).grid("setSelection",i[s],false,null)}}}if(n){$(p.element).grid("setSelection",n,false,null)}p.grid.rowsView.scrollLeft=r;$(p.element).unbind(".selectionPreserver",q)};$(p.element).bind("gridoncomplete.selectionPreserver",q)}};this.grid=a;var e=this.element.find(">div").filter(function(){if($(this).hasClass(g.options.id)){return false}return true}),d=$("<div class='coral-grid-rows'></div>");
if(e.length==0){this.element.prepend("<div></div>");e=this.element.find(">div").filter(function(){if($(this).hasClass(g.id)){return false}return true})}g.gridRows=d;g.gridColumns=e;g._analyzeColumns(e);e.addClass("coral-grid-columns").after(d);a.rowsView=document.createElement("div");$(a.rowsView).addClass("coral-grid-rows-view").appendTo(d);$("<span class='coral-grid-noRecordsTips' id='noRecordsTips_"+$.grid.coralID(g.options.id)+"'>"+g.options.emptyrecords+"</span>").appendTo($(a.rowsView));a.columnsView=document.createElement("div");$(a.columnsView).addClass("coral-state-default coral-grid-columns-view").appendTo(e).append("<div class='coral-grid-topRightCell'></div>");g.pic=$("<ul class='coral-pic'></ul>");e.addClass("coral-grid-columns").after(g.pic);if(g.options.grouping===true){g.options.scroll=false;g.options.rownumbers=false;g.options.treeGrid=false;g.options.gridview=true}if(this.options.treeGrid===true){try{$(g.element).grid("setTreeGrid")}catch(j){}if(g.options.datatype!="local"){g.options.localReader={id:"_id_"}}}if(this.options.subGrid){try{$(g.element).grid("setSubGrid")}catch(k){}}if(this.options.multiselect){this.options.singleselect=false}if(!this.options.keyName){this.options.keyName=false}for(var f=0;f<this.options.colModel.length;f++){this.options.colModel[f]=$.extend(true,{},this.options.cmTemplate,this.options.colModel[f].template||{},this.options.colModel[f]);if(this.options.keyName===false&&this.options.colModel[f].key===true){this.options.keyName=this.options.colModel[f].name}}if(this.options.multiselect){this.options.colNames.unshift("<input role='checkbox' id='cb_"+this.options.id+"' class='cbox' type='checkbox'/>");this.options.colModel.unshift({name:"cb",width:g.options.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}else{if(this.options.singleselect){this.options.colNames.unshift("");this.options.colModel.unshift({name:"cb",width:g.options.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})
}}if(this.options.rownumbers){this.options.colNames.unshift(g.options.rownumName);this.options.colModel.unshift({name:"rn",width:g.options.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}g._transToGrid();g._transToPicgrid();g._transPagers();g._cvH=$(a.columnsView).height();if("fill"!==l.fitStyle){}g._setGridHeight(g.options.height);if(l.model=="grid"){g.pic.hide()}else{if(l.model=="card"){g.gridRows.hide();g.gridColumns.hide()}}g.setFrozenColumns();this.component().addClass(l.componentCls);this._populate();g._setUpEvent();$(window).unload(function(){g=null});this._on(this.document,{mousedown:function(i){if(this.options.autoSave&&this._closeOnDocumentClick(i)){this.restoreAll(i)}}})},_closeOnDocumentClick:function(a){return !$(a.target).closest(".coral-grid").length},_transPagers:function(){var a=this;this.pagers=$("."+this.id);if(this.options.pager==true){this.options.pager=$("<div id='pager_0_"+this.id+"'></div>");this.options.pager.addClass("coral-grid-pager").removeClass(a.id).appendTo(this.element);a._setPager(this.options.pager[0].id,"")}else{this.pagers.each(function(b){$(this).addClass("coral-grid-pager").removeClass(a.id).attr("id","pager_"+b+++"_"+a.id)});if(this.pagers){this.pagers.each(function(b){a._setPager(a.pagers[b].id,"")})}}a.options.pager="."+a.id},toolbar:function(){return $(".pager-toolbar",this.element)},_transToPicgrid:function(){var a=this;a.pic.css({height:230,overflow:"auto"})},_transToGrid:function(){var b=this,a=this.options;if($.inArray(b.options.multikey,b._sortkeys)==-1){b.options.multikey=false}b.options.sortorder=b.options.sortorder.toLowerCase();this.element.addClass("coral-grid");this.element.addClass(b.options.cls);b._transGridView()},_transGridView:function(){var n=this,j=this.options,b=this.grid,k=j.rownumbers===true?1:0,B=j.multiselect===true?1:(j.singleselect===true?1:0),F=j.subGrid===true?1:0;var u=j.direction,v;var A="<thead><tr class='coral-grid-labels' role='rowheader'>",g,x,p,I,D,o,c,d,s,H="",a="";
if(j.shrinkToFit===true&&j.forceFit===true){for(v=j.colModel.length-1;v>=0;v--){if(!j.colModel[v].hidden){j.colModel[v].resizable=false;break}}}$.each(this.options.colModel,function(){if(typeof this.hidden==="undefined"){this.hidden=false}});s="<span class='s-ico' style='display:none'><span sort='asc' class='coral-grid-ico-sort coral-icon-asc"+H+" coral-state-disabled cui-icon-arrow-up5 coral-sort-"+u+"'></span>";s+="<span sort='desc' class='coral-grid-ico-sort coral-icon-desc"+a+" coral-state-disabled cui-icon-arrow-down5 coral-sort-"+u+"'></span></span>";for(v=0;v<j.colNames.length;v++){var l=n.options.headertitles?(' title="'+$.grid.stripHtml(n.options.colNames[v])+'"'):"";var r=j.colModel[v].columnSortable?"coral-columnSortable-disabled":"";A+="<th id='"+j.id+"_"+j.colModel[v].name+"' role='columnheader' class='coral-state-default "+r+" coral-th-column coral-th-"+u+"'"+l+">";x=j.colModel[v].index||j.colModel[v].name;if(v<k+F+B){A+="<div id='jqgh_"+j.id+"_"+j.colModel[v].name+"' "+g+">"+j.colNames[v]}else{A+="<div id='jqgh_"+j.id+"_"+j.colModel[v].name+"'  title='"+j.colNames[v]+"'"+g+">"+j.colNames[v]}if(!j.colModel[v].width){j.colModel[v].width=150}else{j.colModel[v].width=parseInt(j.colModel[v].width,10)}if(typeof(j.colModel[v].title)!=="boolean"){j.colModel[v].title=true}if(x==j.sortname){j.lastsort=v}A+=s+"</div></th>"}A+="</tr></thead>";s=null;var z=$("<table class='coral-grid-htable' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(A);n.gridColumns.find(".coral-grid-columns-view").append(z);$("thead tr:first th",b.columnsView).hover(function(){$(this).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover")});n._setMultiselect();var G;if(typeof(j.width)!=="undefined"){if(typeof(j.width)=="string"&&j.width=="auto"){var t=$(n.element).innerWidth();n.options.width=t>0?t:"nw";G=t}else{G=j.width}}n._trigger("beforePopulate",null,[]);this._setColWidth();$(n.element).append("<div class='coral-grid-resize-mark' id='rs_m"+n.options.id+"'>&#160;</div>");
A=$("thead:first",n.element).get(0);var q="";if(n.options.footerrow){q+="<table role='grid' style='width:"+n.options.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow'>"}var h=$("tr:first",A),E="<tr class='jqgfirstrow' role='row' style='height:auto'>";$("th",h).each(function(i){p=j.colModel[i].width;if(typeof j.colModel[i].resizable==="undefined"){j.colModel[i].resizable=true}if(j.colModel[i].resizable){I=document.createElement("span");$(I).html("&#160;").addClass("coral-grid-resize coral-grid-resize-"+u);$(I).css("cursor","col-resize");$(this).addClass(j.resizeclass)}else{I=""}$(this).css("width",p+"px").prepend(I);var w="";if(j.colModel[i].hidden){$(this).css("display","none");w="display:none;"}E+="<td role='gridcell' style='height:0px;width:"+p+"px;"+w+"'></td>";b.headers[i]={width:p,el:this};D=j.colModel[i].sortable;if(typeof D!=="boolean"){j.colModel[i].sortable=true;D=true}var e=j.colModel[i].name;if(!(e=="cb"||e=="subgrid"||e=="rn")){if(j.viewsortcols[2]){$(">div",this).addClass("coral-grid-sortable")}}if(D){if(j.viewsortcols[0]){$("div span.s-ico",this).show();if(i==j.lastsort){$("div span.coral-icon-"+j.sortorder,this).removeClass("coral-state-disabled")}}else{if(i==j.lastsort){$("div span.s-ico",this).show();$("div span.coral-icon-"+j.sortorder,this).removeClass("coral-state-disabled")}}}if(j.footerrow){q+="<td role='gridcell' "+n._formatCol(i,0,"",null,"",false)+">&#160;</td>"}}).mousedown(function(w){if($(w.target).closest("th>span.coral-grid-resize").length!=1){return}var i=n._getColumnHeaderIndex(this);if(j.forceFit===true){j.nv=n._nextVisible(i)}b.dragStart(i,w,n._getOffset(i));return false}).click(function(L){if(j.disableClick){j.disableClick=false;return false}var J="th>div.coral-grid-sortable",K,M;if(!j.viewsortcols[2]){J="th>div>span>span.coral-grid-ico-sort"}var w=$(L.target).closest(J);if(w.length!=1){return}var i=n._getColumnHeaderIndex(this);if(!j.viewsortcols[2]){K=true;
M=w.attr("sort")}n._sortData($("div",this)[0].id,i,K,M,this);return false});if(n.options.onSortableColumns&&$.fn.sortable){try{$(n.element).grid("sortableColumns",h)}catch(C){}}if(n.options.footerrow){q+="</tr></tbody></table>"}E+="</tr>";var f=$("<table id='"+n.options.id+"_table' class='coral-grid-btable' role='grid' cellspacing='0' cellpadding='0' border='0'></table>").append(E);n.gridRows.find(".coral-grid-rows-view").append(f);this.rows=n.gridRows.find(".coral-grid-btable")[0].rows;this.element.prepend("<div class='coral-grid-view'></div>");var m;if(n.options.footerrow){b.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];m=$("<div class='ui-jqgrid-hbox'></div>");$(b.sDiv).append(m).width(b.width).insertAfter(n.gridColumns);$(m).append(q);b.footers=$(".ui-jqgrid-ftable",b.sDiv)[0].rows[0].cells;if(n.options.rownumbers){b.footers[0].className="ui-state-default jqgrid-rownum"}}m=null;if(n.options.caption.length>0){b.caption=document.createElement("div");b.caption.className="coral-grid-caption";$(b.caption).html(n.options.caption);this.element.prepend(b.caption)}$(b.columnsView).add(b.rowsView).parent().appendTo(this.element.find(".coral-grid-view"));if(j.shrinkToFit===true&&j.forceFit===true){$("table:first",b.rowsView).css("width",n.grid.width+"px");$("table:first",b.columnsView).css("width",n.grid.width+"px")}else{if(j.shrinkToFit===false){$("table:first",b.rowsView).css("width",n.options.tblwidth+"px");$("table:first",b.columnsView).css("width",n.options.tblwidth+"px")}}n._setOption("width",G);this.grid.cols=this.rows[0].cells;if(j.groupHeader){this.setGroupHeaders({useColSpanStyle:true,groupHeaders:j.groupHeaders});var y=$("tr.jqg-third-row-header",A);if(n.options.sortable&&$.fn.sortable){try{$(n.element).grid("sortableColumns",y)}catch(C){}}}A=null;z=null;f=null},_sortkeys:["shiftKey","altKey","ctrlKey"],_getColumnHeaderIndex:function(d){var c=this;var b,e=c.grid.headers,a=$.grid.getCellIndex(d);if(this.grid.rightfhDiv){a=e.length-a-1}for(b=0;b<e.length;b++){if(d===e[b].el){a=b;
break}}return a},_analyzeColumns:function(d){var e=this,c=0,b=this.options;if(this.options.colModel.length<=0){d.children().each(function(g){var h=$.parser.parseOptions(this,null,["data"]);if(typeof(h.name)!="undefined"){b.colModel.push(h);b.colNames.push(h.label||$(this).html())}else{if(typeof(h.header)!="undefined"){var f=0;var j;$(this).children().each(function(k){var l=$.parser.parseOptions(this,null,["data"]);b.colModel.push(l);b.colNames.push(l.label||$(this).html());f++;k==0&&(j=l)});b.groupHeaders.push({startColumnName:j.name,numberOfColumns:f,titleText:h.header})}}})}for(c=0;c<this.options.colModel.length;c++){var a=this.options.colModel[c];if(a.formatter=="combobox"||a.formatter=="combotree"||a.formatter=="combogrid"){if(a.revertCode!=false){a.revertCode=true}}a.postMode=a.postMode||"value";if(a.edittype=="combobox"||a.edittype=="combotree"||a.edittype=="autocomplete"||a.edittype=="combogrid"){(a.edittype=="combotree")&&(a.dataStructure="tree");a.formatter=a.formatter||"convertCode"}}if(this.options.colNames.length===0){for(c=0;c<this.options.colModel.length;c++){this.options.colNames[c]=this.options.colModel[c].label||this.options.colModel[c].name}}if(this.options.colNames.length!==this.options.colModel.length){alert("errors! colNames not equals to colModel!");return}d.children().not(".coral-grid-columns-view").remove()},_updateMultiSelectIndexsOption:function(b){var d=b.minIndex,c=b.maxIndex,e=b.preIndex,a=b.curIndex;if(null==d){d=c=e=(null==e?a:e)}if(a<=d){d=a;c=e}else{if(a>d&&a<c){d=Math.min(a,e);c=Math.max(a,e)}else{if(a>c){c=a;d=e}}}return{minIndex:d,maxIndex:c,preIndex:e}},_addShiftKeySelect:function(h,k){var g=this,a=g.options;if(!k.rowId){return}var j=$(g.element),c=false,m=j.find(".coral-grid-btable")[0].rows,b=m.namedItem(k.rowId).rowIndex;if(h.shiftKey){var f=g._updateMultiSelectIndexsOption({maxIndex:a.maxIndex,minIndex:a.minIndex,preIndex:a.preIndex,curIndex:b});a.minIndex=f.minIndex;a.maxIndex=f.maxIndex;a.preIndex=f.preIndex;j.grid("resetSelection");
for(var d=a.minIndex;d<=a.maxIndex;d++){var l=false;if(d==a.maxIndex){l=true}j.grid("setSelection",m[d].id,l)}if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){window.getSelection().removeAllRanges()}}c=true}else{a.minIndex=a.maxIndex=null;a.preIndex=b}return c},_setUpEvent:function(){var f=this,e=this.grid,c=this.options;var a,d,b,h,g;if(f.options.cellEdit===false&&f.options.hoverrows===true){$(f.element).bind("mouseover",function(j){var i=!!(f.options.model=="card");if(i){g=$(j.target,f.pic).closest("li.gridPanel").find(".rowgrid");if($(g).attr("class")!=="coral-subgrid"){$(g).addClass("coral-state-hover")}}else{g=$(j.target,f.rows).closest("tr.jqgrow");if($(g).attr("class")!=="coral-subgrid"){$(g).addClass("coral-state-hover")}}}).bind("mouseout",function(j){var i=!!(f.options.model=="card");if(i){g=$(j.target,f.pic).closest("li.gridPanel ").find(".rowgrid")}else{g=$(j.target,f.rows).closest("tr.jqgrow")}$(g).removeClass("coral-state-hover")})}$(e.rowsView).scroll(function(m){if(c.scroll){var l=$(e.rowsView)[0].scrollTop;if(e.scrollTop===undefined){e.scrollTop=0}if(l!=e.scrollTop){e.scrollTop=l;if(e.timer){clearTimeout(e.timer)}e.timer=setTimeout(e.populateVisible,c.scrollTimeout)}}$(e.columnsView)[0].scrollLeft=$(e.rowsView)[0].scrollLeft;var k=$(e.rowsView)[0].scrollTop;$(".coral-grid-btable-frozen").css("left",-$(e.rowsView)[0].scrollLeft+"px");var i=$(".row-editable",f.element),j=$(f.element).grid("getInd",f.editRowIndex,true);if(i.length>0){f.editButtonsPos(f.editRowIndex,i)}if(c.footerrow){e.sDiv.scrollLeft=$(e.rowsView)[0].scrollLeft}});$(".coral-grid-btable",f.element).add(f.pic).click(function(p){var i=!!(f.options.model=="card");var o;h=p.target;if(i){g=$(h,f.pic).closest("li.gridPanel")}else{g=$(h,f.rows).closest("tr.jqgrow")}if($(g).length===0||g[0].className.indexOf("coral-state-disabled")>-1||$(h,f.element).closest("table.coral-grid-btable").length<0){return this}var j=$(h).hasClass("cbox"),l=f._trigger("beforeSelectRow",p,[{rowId:g[0].id}]);
l=(l===false||l==="stop")?false:true;if(h.tagName=="A"||((h.tagName=="INPUT"||h.tagName=="TEXTAREA"||h.tagName=="OPTION"||h.tagName=="SELECT")&&!j)){return}if(l===true){o=g[0].id;b=$(h).closest("td,th").html();if(!i){d=$.grid.getCellIndex(h);if(f._addShiftKeySelect(p,{rowId:g[0].id})){return}f._trigger("onSelectCell",p,[{rowId:o,rowIndex:g[0].rowIndex,cellIndex:d,cellHtml:b}])}if(f.options.editableRows&&f.options.clicksToEdit==1&&c.editrow!=o){f.restoreRow(c.editrow);if(f.rowEditButtons){f.rowEditButtons.remove()}}if(f.options.editableRows&&f.options.clicksToEdit==1&&!j){c.editrow=g[0].id;f.editRow(g[0].id,true)}if(f.options.cellEdit===true&&f.options.clicksToEdit==1){var m=f.options.colModel[d].editable;var n=f.options.multiselect||f.options.singleselect;if((n&&j&&f.options.clickRowToSelect)||(n&&!m&&!f.options.multikey)){$(f.element).grid("setSelection",o,true,p)}else{if(!i){try{$(f.element).grid("editCell",g[0].rowIndex,d,true)}catch(k){}}}}else{if(!f.options.multikey){f.selectMultikey(f,p,o)}else{if(p[f.options.multikey]){$(f.element).grid("setSelection",o,true,p)}else{if((f.options.multiselect||f.options.singleselect)&&j){$(f.element).grid("setSelection",o,true,p);if(!j){f._cancelCheckAll()}}else{f.options.multiboxonly=true;f.selectMultikey(f,p,o)}}}}}});$(f.element).dblclick(function(l){h=l.target;g=$(h,f.rows).closest("tr.jqgrow");if($(g).length===0){return}if(f.options.editableRows&&c.editrow!=g[0].id){f.restoreRow(c.editrow);if(f.rowEditButtons){f.rowEditButtons.remove()}}var i=g[0].rowIndex;var k=$.grid.getCellIndex(h);if(f.options.editableRows&&f.options.clicksToEdit==2){c.editrow=g[0].id;f.editRow(g[0].id,true)}if(f.options.cellEdit===true&&f.options.clicksToEdit==2){i=g[0].rowIndex;try{$(f.element).grid("editCell",i,k,true)}catch(j){}}f._trigger("onDblClickRow",null,[{rowId:g[0].id,rowIndex:i,cellIndex:k}])}).bind("contextmenu",function(i){h=i.target;g=$(h,f.rows).closest("tr.jqgrow");if($(g).length===0){return}if(!f.options.multiselect){$(f.element).grid("setSelection",g[0].id,true,i)
}a=g[0].rowIndex;d=$.grid.getCellIndex(h);f._trigger("onRightClickRow",null,[{rowId:g[0].id,rowIndex:a,cellIndex:d}])});$(e.columnsView).mousemove(function(i){if(e.resizing){e.dragMove(i);return false}});$(".coral-grid-labels",e.columnsView).bind("selectstart",function(){return false});$(document).mouseup(function(){if(e.resizing){e.dragEnd();return false}return true});this._off($(".coral-paginator-page"));this._on({"click.coral-paginator-page":function(j){var i=f._intNum($(j.target).html(),1);f.options.page=i;if(!f._clearVals(this.id)){return false}f._populate();return false}})},selectMultikey:function(c,f,d){var g=f.target;var a=$(g).hasClass("cbox");if(c.options.multiselect&&c.options.multiboxonly){if(a){$(c.element).grid("setSelection",d,true,f)}else{var b=c.options.frozenColumns?c.options.id+"_frozen":"";if(c.options.clickRowToSelect){$(c.options.selarrrow).each(function(e,j){var h=c.rows.namedItem(j);$(h).removeClass("coral-state-highlight");$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(j))[c.options.useProp?"prop":"attr"]("checked",false);if(b){$("#"+$.grid.coralID(j),"#"+$.grid.coralID(b)).removeClass("coral-state-highlight");$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(j),"#"+$.grid.coralID(b))[c.options.useProp?"prop":"attr"]("checked",false)}});c.options.selarrrow=[];$(c.element).grid("setSelection",d,true,f)}}}else{if(a||c.options.clickRowToSelect){$(c.element).grid("setSelection",d,true,f)}}},restoreAll:function(){if(this.options.editableRows){this.restoreRow(this.options.editrow);if(this.rowEditButtons){this.rowEditButtons.remove()}}if(this.options.savedRow.length>0){if(!$(this.element).grid("saveCell",this.options.savedRow[0].id,this.options.savedRow[0].ic)){return}}},setSelectAll:function(d){var c=this,f,h,b=(this.options.model==="card");if(b){f=c.element.find(".coral-pic>li")}else{f=c.rows}if(this.options.multiselect){var g=[],a;var e=c.options.frozenColumns===true?c.options.id+"_frozen":"";if(d){$(f).each(function(k){h=b?k>=0:k>0;
if(h>0){if(!$(this).hasClass("coral-subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass("coral-state-disabled")){var j=$.inArray(this.id,c.options.selarrrow);if(j===-1){if(b){$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",true);$(f).find(".rowgrid").addClass("coral-state-highlight").attr("aria-selected","true")}else{$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",true);c._setHeadCheckBox(true);$(this).addClass("coral-state-highlight").attr("aria-selected","true");if(e){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv)[c.options.useProp?"prop":"attr"]("checked",true);$("#"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv).addClass("coral-state-highlight");if(c.grid.fhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv)[c.options.useProp?"prop":"attr"]("checked",true);$("#"+$.grid.coralID(c.rows[k].id),c.grid.fbDiv).addClass("coral-state-highlight")}else{if(c.grid.rightfhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[k].id),c.grid.rightfbDiv)[c.options.useProp?"prop":"attr"]("checked",true);$("#"+$.grid.coralID(c.rows[k].id),c.grid.rightfbDiv).addClass("coral-state-highlight")}}}}c.options.selarrrow.push(this.id);c.options.selrow=this.id}}}});a=true;g=[]}else{c.options.selarrrow=[];$(f).each(function(j){h=b?j>=0:j>0;if(h){if(!$(this).hasClass("coral-subgrid")&&!$(this).hasClass("coral-state-disabled")){if(b){$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",false);$(f).find(".rowgrid").removeClass("coral-state-highlight").attr("aria-selected","false")}else{$(f).find("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(this.id))[c.options.useProp?"prop":"attr"]("checked",false);c._setHeadCheckBox(false);$(this).removeClass("coral-state-highlight").attr("aria-selected","false");
if(e){if(c.grid.fhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[j].id),c.grid.fbDiv)[c.options.useProp?"prop":"attr"]("checked",false);$("#"+$.grid.coralID(c.rows[j].id),c.grid.fbDiv).removeClass("coral-state-highlight")}else{if(c.grid.rightfhDiv){$("#jqg_"+$.grid.coralID(c.options.id)+"_"+$.grid.coralID(c.rows[j].id),c.grid.rightfbDiv)[c.options.useProp?"prop":"attr"]("checked",false);$("#"+$.grid.coralID(c.rows[j].id),c.grid.rightfbDiv).removeClass("coral-state-highlight")}}}}g.push(this.id)}}});c.options.selrow=null;a=false}c._trigger("onSelectAll",null,[{aRowIds:a?c.options.selarrrow:g,status:a}])}},_setMultiselect:function(){var b=this;if(this.options.multiselect){var c=[],a;$("#cb_"+$.grid.coralID(b.options.id),this.grid.columnsView).bind("click",function(d){b.setSelectAll(this.checked)})}},_refresh:function(a,b){},reload:function(a){var d=this,b=this.grid,c={},g=false,f=[];if(typeof(a)==="undefined"){a=this.options.orgdatatype==="json"?this.options.url:this.options.data}if(!a&&!this.options.url){a=[]}else{if(!a&&this.options.url){a=this.options.url}}if(typeof(a)!=="string"){c=a;if(c.data){f=c.data}else{if(c.url){a=c.url;g=true}else{if(a instanceof Array){f=a}else{if(!c.url&&!c.data&&!this.options.url){f=this.options.data}else{if(!c.url&&!c.data&&this.options.url){a=this.options.url;g=true}}}}}}else{g=true}if(d.options.treeGrid===true){d.options.datatype=d.options.treedatatype}if(c&&c.current){d.grid.selectionPreserver(d)}if(d.options.datatype=="local"){$(d.element).grid("resetSelection");if(d.options.data.length){d.normalizeData();d.refreshIndex()}}else{if(!d.options.treeGrid){d.options.selrow=null;if(d.options.multiselect){d.options.selarrrow=[];d._setHeadCheckBox(false)}d.options.savedRow=[]}}if(d.options.scroll){emptyRows(d.grid.rowsView,true,false)}if(c&&c.page){var e=c.page;if(e>d.options.lastpage){e=d.options.lastpage}if(e<1){e=1}d.options.page=e;if(d.grid.prevRowHeight){d.grid.rowsView.scrollTop=(e-1)*d.grid.prevRowHeight*d.options.rowNum
}else{d.grid.rowsView.scrollTop=0}}if(d.grid.prevRowHeight&&d.options.scroll){delete d.options.lastpage;d._populateVisible()}else{if(d.options.localonce==true){d.options.search=true}else{d.options.search=false;if(!g){d.options.datatype="local";delete d.options.orgdatatype;d.options.data=f}else{d.options.datatype="json";delete d.options.orgdatatype;d.options.url=a}}d._populate();d.options.localonce=false}return false},resetFrozen:function(){if(!this._hasHorizontalScrollBar()){$(this.grid.rightfbDiv).hide();$(this.grid.rightfhDiv).hide()}else{$(this.grid.rightfbDiv).show();$(this.grid.rightfhDiv).show()}},refresh:function(f){var e,d=this,b=this.options,a=b.fitStyle,c=this.element.parent();e=c.height();d.resetFrozen();this.element.siblings(":visible").each(function(){var h=$(this),g=h.css("position");if(g==="absolute"||g==="fixed"){return}e-=h.outerHeight(true)});if(!$("#"+d.element[0].id).length){return}if(a==="fill"){$.coral.fitParent(this.component(),true);$(d.element).grid("option","height",e);$(d.element).grid("option","width",d.element.innerWidth()>0?d.element.innerWidth():0)}else{if(a==="width"){$(d.element).grid("option","width",d.element.innerWidth()>0?d.element.innerWidth():0);$(d.element).grid("option","height",d.options.height)}else{if(a==="height"){$.coral.fitParent(this.component(),true);$(d.element).grid("option","height",e)}else{if(a==="auto"){$(d.element).grid("option","height",d.options.height)}}}}d.refreshPager();d._noRecordsTipsPositon();if(d.options.frozenColumns===true){d.resizeFrozen()}if(this.element.find(".loading-overlay").length){switch(this.options.loadui){case"disable":break;case"enable":case"block":$(this.element).loading("refresh");break}}$.coral.refreshAllComponent(this.element)},refreshPager:function(){var a=this;if(this.pagers){this.pagers.each(function(d){var c=$(".paginator-left",a.element).outerWidth()+5;var b=$("#"+a.pagers[d].id).width();$(".toolbarpanel",a.element).css({left:c+"px",position:"absolute",top:0,width:(b-c)+"px"})});a.options.pager="."+a.id;
if($(".ctrl-init-toolbar",a.element).length){$(".ctrl-init-toolbar",a.element).toolbar("refresh")}}},setSelectionAll:function(){if(!$("#cb_"+this.options.id).prop("checked")){$("#cb_"+this.options.id).trigger("click")}},setSelection:function(j,m,h){var g=this,f,k=(this.options.model==="card"),l,i,c,b,d;if(j===undefined){return}m=m===false?false:true;if(k){l=this.element.find(".coral-pic #"+j)[0]}else{l=this.rows.namedItem(j+"")}if(!l||!l.className||l.className.indexOf("coral-state-disabled")>-1){return}function a(p){var o=$(g.grid.rowsView)[0].clientHeight,n=$(g.grid.rowsView)[0].scrollTop,q=g.rows[p].offsetTop,e=g.rows[p].clientHeight;if(q+e>=o+n){$(g.grid.rowsView)[0].scrollTop=q-(o+n)+e+n}else{if(q<o+n){if(q<n){$(g.grid.rowsView)[0].scrollTop=q}}}}if(this.options.scrollrows===true){i=this.rows.namedItem(j).rowIndex;if(i>=0){a(i)}}if(this.options.frozenColumns===true){d=this.options.id+"_frozen"}if(!this.options.multiselect){if(l.className!=="coral-subgrid"){if(this.options.selrow!=l.id){if(k){this.element.find("#"+this.options.selrow+">ul").removeClass("coral-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(l).find(".rowgrid").addClass("coral-state-highlight").attr({"aria-selected":"true",tabindex:"0"});if(d){$("#"+$.grid.coralID(this.options.selrow),"#"+$.grid.coralID(d)).find(".rowgrid").removeClass("coral-state-highlight");$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).find(".rowgrid").addClass("coral-state-highlight")}}else{$(this.rows.namedItem(this.options.selrow)).removeClass("coral-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(l).addClass("coral-state-highlight").attr({"aria-selected":"true",tabindex:"0"});if(d){$("#"+$.grid.coralID(this.options.selrow),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight");$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).addClass("coral-state-highlight")}}f=true;$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(l.id),$(l))[this.options.useProp?"prop":"attr"]("checked",f);
if(d){$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(j),"#"+$.grid.coralID(d))[this.options.useProp?"prop":"attr"]("checked",f)}}else{f=false}this.options.selrow=l.id;if(m){this._trigger("onSelectRow",h,[{rowId:l.id,status:f}])}}}else{this._setHeadCheckBox(false);this.options.selrow=l.id;c=$.inArray(this.options.selrow,this.options.selarrrow);if(c===-1){if(k){if(l.className!=="coral-subgrid"){$(l).find(".rowgrid").addClass("coral-state-highlight").attr("aria-selected","true")}}else{if(l.className!=="coral-subgrid"){$(l).addClass("coral-state-highlight").attr("aria-selected","true")}}f=true;this.options.selarrrow.push(this.options.selrow)}else{if(k){if(l.className!=="coral-subgrid"){$(l).find(".rowgrid").removeClass("coral-state-highlight").attr("aria-selected","false")}}else{if(l.className!=="coral-subgrid"){$(l).removeClass("coral-state-highlight").attr("aria-selected","false")}}f=false;this.options.selarrrow.splice(c,1);b=this.options.selarrrow[0];this.options.selrow=(b===undefined)?null:b}if(this.rows.length-1===this.options.selarrrow.length){this._setHeadCheckBox(true)}$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(l.id),$(l))[this.options.useProp?"prop":"attr"]("checked",f);if(d){if(k){if(c===-1){$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).find(".rowgrid").addClass("coral-state-highlight")}else{$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).find(".rowgrid").removeClass("coral-state-highlight")}}else{if(c===-1){$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).addClass("coral-state-highlight")}else{$("#"+$.grid.coralID(j),"#"+$.grid.coralID(d)).removeClass("coral-state-highlight")}}$("#jqg_"+$.grid.coralID(this.options.id)+"_"+$.grid.coralID(j),"#"+$.grid.coralID(d))[this.options.useProp?"prop":"attr"]("checked",f)}if(m){this._trigger("onSelectRow",h,[{rowId:l.id,status:f}])}}},_setHeadCheckBox:function(b){var a=this;$("#cb_"+$.grid.coralID(a.options.id),a.grid.columnsView)[a.options.useProp?"prop":"attr"]("checked",b);var c=a.options.frozenColumns?a.options.id+"_frozen":"";
if(c){$("#cb_"+$.grid.coralID(a.options.id),a.grid.fhDiv)[a.options.useProp?"prop":"attr"]("checked",b)}},setFrozenRows:function(f){var e=this,d=e.grid;e.destroyFrozenRows();e.rowsView2=$(d.rowsView);if(!e.rowsView2.children("table.coral-grid-btable-frozen").length){$(e.rowsView2).prepend('<table class="coral-grid-btable-frozen" cellspacing="0" cellpadding="0"></table>');e.rowsView2.children("table.coral-grid-btable-frozen").css({position:"absolute",left:0,top:$(d.columnsView).height()+"px"})}var g=e.element.find(".coral-grid-rows-view").height();b(false);c(false);var a=e.rowsView2.find("table.coral-grid-btable-frozen").outerHeight();e.rowsView2.css({"margin-top":a+"px",height:(g-a)+"px"});e.rowsView2.find(".coral-grid-btable-frozen").css({left:-$(d.rowsView)[0].scrollLeft+"px",width:e.rowsView2.find(".coral-grid-btable").width()+"px","table-layout":"fixed"});function b(h){var i=e.rowsView2.find(".coral-grid-btable")[0].rows[0];(h?e.rowsView1:e.rowsView2).children("table.coral-grid-btable-frozen").append($(i).clone())}function c(i){var h=e.rowsView2.find(".coral-grid-btable tr").filter(function(k){if(k==0){return false}if(k<=f){return true}});var j=e.rowsView2.find(".coral-grid-btable")[0].rows[1];(i?e.rowsView1:e.rowsView2).children("table.coral-grid-btable-frozen").append(h)}},destroyFrozenRows:function(){var d=this,b=d.grid;d.rowsView2=$(b.rowsView);if(!d.rowsView2.children("table.coral-grid-btable-frozen").length){$(d.rowsView2).prepend('<table class="coral-grid-btable-frozen" cellspacing="0" cellpadding="0"></table>');d.rowsView2.children("table.coral-grid-btable-frozen").css({position:"absolute",left:0,top:0})}var f=d.element.find(".coral-grid-rows-view").height();var a=d.rowsView2.find("table.coral-grid-btable-frozen").outerHeight();e(false);c(false);d.rowsView2.css({"margin-top":0,height:(f+a)+"px"});function e(g){var i=d.rowsView2.find("table.coral-grid-btable-frozen tr").filter(function(j){if(j==0){return false}return true});var h=(g?d.rowsView1:d.rowsView2).children("table.coral-grid-btable-frozen")[0].rows[1];
$(d.rowsView2.find(".coral-grid-btable tbody:first tr:first")[0]).after(i)}function c(g){(g?d.rowsView1:d.rowsView2).children("table.coral-grid-btable-frozen").remove()}},showHideCol:function(f,c){var e=this,g=false,h=$.support.boxSizing?0:this._intNum(this.options.cellLayout,0),b;if(!e.grid){return}if(typeof f==="string"){f=[f]}c=c!="none"?"":"none";var a=c===""?true:false,d=e.options.groupHeader&&(typeof e.options.groupHeader==="object"||$.isFunction(e.options.groupHeader));if(d){$(e.element).grid("destroyGroupHeader",false)}$(this.options.colModel).each(function(j){if($.inArray(this.name,f)!==-1&&this.hidden===a){if(e.options.frozenColumns===true&&this.frozen===true){}$("tr",e.grid.columnsView).each(function(){$(this.cells[j]).css("display",c)});$(e.rows).each(function(){if(!$(this).hasClass("jqgroup")){$(this.cells[j]).css("display",c)}});if(e.options.footerrow){$("tr.footrow td:eq("+j+")",e.grid.sDiv).css("display",c)}b=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(c==="none"){e.options.tblwidth-=b+h}else{e.options.tblwidth+=b+h}this.hidden=!a;g=true;e._trigger("onShowHideCol",null,[{show:a,name:this.name,index:j}])}});if(g===true){if(e.options.shrinkToFit===true&&!isNaN(e.options.height)){e.options.tblwidth+=parseInt(e.options.scrollOffset,10)}e._setGridWidth(e.options.shrinkToFit===true?e.options.tblwidth:e.options.width)}if(d){$(e.element).grid("setGroupHeaders",e.options.groupHeader)}},hideCol:function(a){return $(this.element).grid("showHideCol",a,"none")},showCol:function(a){return $(this.element).grid("showHideCol",a,"")},remapColumns:function(c,f,e){function b(g){var h;if(g.length){h=$.makeArray(g)}else{h=$.extend({},g)}$.each(c,function(j){g[j]=h[this]})}var d=this;function a(h,g){$(">tr"+(g||""),h).each(function(){var j=this;var i=$.makeArray(j.cells);$.each(c,function(){var k=i[this];if(k){j.appendChild(k)}})})}b(d.options.colModel);b(d.options.colNames);b(d.grid.headers);a($("thead:first",d.grid.columnsView),e&&":not(.coral-grid-labels)");if(f){a($("#"+$.grid.coralID(d.options.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")
}if(d.options.footerrow){a($("tbody:first",d.grid.sDiv))}if(d.options.remapColumns){if(!d.options.remapColumns.length){d.options.remapColumns=$.makeArray(c)}else{b(d.options.remapColumns)}}d.options.lastsort=$.inArray(d.options.lastsort,c);if(d.options.treeGrid){d.options.expColInd=$.inArray(d.options.expColInd,c)}$(d).triggerHandler("gridRemapColumns",[c,f,e])},sortableColumns:function(b){var c=this,e=$.grid.coralID(c.options.id);function f(){c.options.disableClick=true}var d={tolerance:"pointer",axis:"x",cancel:".coral-columnSortable-disabled",scrollSensitivity:"1",helper:function(h,g){return g.clone()},items:">th:not(:has(#jqgh_"+e+"_cb,#jqgh_"+e+"_rn,#jqgh_"+e+"_subgrid),:hidden, .coral-columnSortable-disabled)",placeholder:{element:function(h){var i=typeof(h.attr("rowspan"))=="undefined"?"1":"2",j=typeof(h.attr("colspan"))=="undefined"?"1":"2";var g=$(document.createElement(h[0].nodeName)).addClass(h[0].className+" coral-sortable-placeholder coral-state-highlight").removeClass("coral-sortable-helper").attr("rowspan",i).attr("colspan",j)[0];return g},update:function(g,h){h.height(g.currentItem.innerHeight()-parseInt(g.currentItem.css("paddingTop")||0,10)-parseInt(g.currentItem.css("paddingBottom")||0,10));h.width(g.currentItem.innerWidth()-parseInt(g.currentItem.css("paddingLeft")||0,10)-parseInt(g.currentItem.css("paddingRight")||0,10))}},update:function(h,l){var i=$(l.item).parent(),j=$(">th",i),n=c.options.colModel,g={},k=c.options.id+"_";l.itemId=[];$.each(n,function(p){g[this.name]=p});var m=[];var o=[];j.each(function(){var p=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(k,"");if(p in g){m.push(g[p]);o.push(p)}});$.each(l.item,function(p){l.itemId.push(l.item[p].id.replace(/^jqgh_/,"").replace(k,""))});l.prevItemId=$(l.item[0]).prev("th").attr("id").replace(/^jqgh_/,"").replace(k,"");l.nextItemId=$(l.item[0]).next("th").attr("id").replace(/^jqgh_/,"").replace(k,"");l.targetId=l.position.left>l.originalPosition.left?l.prevItemId:l.nextItemId;$(c.element).grid("remapColumns",m,true,true);
l.permutation=m;l.permutationOfId=o;c._trigger("onSortableColumns",h,[l]);setTimeout(function(){c.options.disableClick=false},50)}};$.extend(d,c.options.sortableColumnsOptions);if(d.beforesortablecolumns){var a=d.beforesortablecolumns;d.start=function(h,g){f();a.call(this,h,g)}}else{d.start=f}if(c.options.sortableColumnsOptions.exclude){d.items+=":not("+c.options.sortableColumnsOptions.exclude+")"}b.sortable(d).data("sortable").floating=true},setCaption:function(a){this.options.caption=a;$("span.coral-grid-title, span.coral-grid-title-rtl",this.grid.caption).html(a);$(this.grid.cDiv).show()},setLabel:function(f,b,h,d){var c=this,g=-1;if(!c.grid){return}if(typeof(f)!="undefined"){$(c.options.colModel).each(function(j){if(this.name==f){g=j;return false}})}else{return}if(g>=0){var a=$("tr.coral-grid-labels th:eq("+g+")",c.grid.columnsViews);if(b){var e=$(".s-ico",a);$("[id^=jqgh_]",a).empty().html(b).append(e);c.options.colNames[g]=b}if(h){if(typeof h==="string"){$(a).addClass(h)}else{$(a).css(h)}}if(typeof d==="object"){$(a).attr(d)}}},setCell:function(b,h,e,f,p,c){var j=this,k=-1,o,m;if(!j.grid){return}if(isNaN(h)){$(j.options.colModel).each(function(q){if(this.name==h){k=q;return false}})}else{k=parseInt(h,10)}if(k>=0){var d=j.rows.namedItem(b);var a=$(j.element).grid("getRowData",b);if(d){var l=$("td:eq("+k+")",d);if(e!==""||c===true){o=j._formatter(b,e,k,a,"edit");m=j.options.colModel[k].title?{title:$.grid.stripHtml(o)}:{};if(j.options.treeGrid&&$(".tree-wrap",$(l)).length>0){$("span",$(l)).html(o).attr(m)}else{$(l).html(o).attr(m)}$.fn.afterFmatter.call(j);if(j.options.datatype=="local"){var n=j.options.colModel[k],i;var g=$.coral.toFunction(n.formatter);if($.isFunction(g)){e=g.apply(this.element[0])}else{e=n.formatter&&typeof(n.formatter)==="string"&&n.formatter=="date"?$.unformat.date.call(j,e,n):e}i=j.options._index[b];if(typeof i!="undefined"){j.options.data[i][n.name]=e}}}if(typeof f==="string"){$(l).addClass(f)}else{if(f){$(l).css(f)}}if(typeof p==="object"){$(l).attr(p)
}}}},getCell:function(c,b){var a=false;var h=this,g=-1;if(!h.grid){return}if(isNaN(b)){$(h.options.colModel).each(function(e){if(this.name===b){g=e;return false}})}else{g=parseInt(b,10)}if(g>=0){var d=h.rows.namedItem(c);if(d){try{a=$.unformat.call(h,$("td:eq("+g+")",d),{rowId:d.id,colModel:h.options.colModel[g]},g)}catch(f){a=$.grid.htmlDecode($("td:eq("+g+")",d).html())}}}return a},getCol:function(b,g,p){var k=[],a,h=0,c,n,o;g=typeof(g)!="boolean"?false:g;if(typeof p=="undefined"){p=false}var f=this,m=-1;if(!f.grid){return}if(isNaN(b)){$(f.options.colModel).each(function(e){if(f.options.colModel[e].name===b){m=e;return false}})}else{m=parseInt(b,10)}if(m>=0){var l=f.rows.length,d=0;if(l&&l>0){while(d<l){if($(f.rows[d]).hasClass("jqgrow")){try{a=$.unformat.call(f,$(f.rows[d].cells[m]),{rowId:f.rows[d].id,colModel:f.options.colModel[m]},m)}catch(j){a=$.grid.htmlDecode(f.rows[d].cells[m].innerHTML)}if(p){o=parseFloat(a);h+=o;if(d===0){c=o;n=o}else{c=Math.min(c,o);n=Math.max(n,o)}}else{if(g){k.push({id:f.rows[d].id,value:a})}else{k.push(a)}}}d++}if(p){switch(p.toLowerCase()){case"sum":k=h;break;case"avg":k=h/l;break;case"count":k=l;break;case"min":k=c;break;case"max":k=n;break}}}}return k},getCellComponent:function(a,e,c,d,j,b){var f=this,g=-1,i,h;if(!f.grid){return}return $("#"+a).find("[aria-describedby$="+e+"]").find(".ctrl-init")},_formatter:function(b,d,c,i,f){var g=this.options.colModel[c],h;if(typeof g.formatter!=="undefined"){var a={rowId:b,colModel:g,gid:this.options.id,pos:c,model:this.options.model};var e=$.coral.toFunction(g.formatter);if($.isFunction(e)){h=e.apply(this.element[0],[d,a,i,f])}else{if($.fmatter){h=$.fn.fmatter.call(this,g.formatter,d,a,i,f)}else{h=this._cellVal(d)}}}else{h=this._cellVal(d)}return h},_getOffset:function(b){var e=this;var c,a={},d=$.support.boxSizing?0:e.options.cellLayout;a[0]=a[1]=a[2]=0;for(c=0;c<=b;c++){if(e.options.colModel[c].hidden===false||typeof(e.options.colModel[c].hidden)=="undefined"){a[0]+=e.options.colModel[c].width+d
}}a[0]=a[0]-e.grid.rowsView.scrollLeft;a[2]+=$(e.grid.rowsView).height()+$(e.grid.columnsView).height();return a},_sortData:function(j,g,b,f,h){var i=this;if(!this.options.colModel[g].sortable){return}i.options.b_sortdata=true;var d;if(this.options.savedRow.length>0){return}if(!b){if(this.options.lastsort==g){if(this.options.sortorder=="asc"){this.options.sortorder="desc"}else{if(this.options.sortorder=="desc"){this.options.sortorder="asc"}}}else{this.options.sortorder=this.options.colModel[g].firstsortorder||"asc"}this.options.page=1}if(f){if(this.options.lastsort==g&&this.options.sortorder==f&&!b){return}else{i.options.sortorder=f}}var c=this.grid.headers[this.options.lastsort].el,a=this.options.frozenColumns?h:this.grid.headers[g].el;$("span.coral-grid-ico-sort",c).addClass("coral-state-disabled");$(c).attr("aria-selected","false");if(this.options.frozenColumns){if(this.grid.fhDiv){this.grid.fhDiv.find("span.coral-grid-ico-sort").addClass("coral-state-disabled");this.grid.fhDiv.find("th").attr("aria-selected","false")}else{if(this.grid.rightfhDiv){this.grid.rightfhDiv.find("span.coral-grid-ico-sort").addClass("coral-state-disabled");this.grid.rightfhDiv.find("th").attr("aria-selected","false")}}}$("span.coral-icon-"+this.options.sortorder,a).removeClass("coral-state-disabled");$(a).attr("aria-selected","true");if(!this.options.viewsortcols[0]){if(this.options.lastsort!=g){if(this.options.frozenColumns){if(this.grid.fhDiv){this.grid.fhDiv.find("span.s-ico").hide()}else{if(this.grid.rightfhDiv){this.grid.rightfhDiv.find("span.s-ico").hide()}}}$("span.s-ico",c).hide();$("span.s-ico",a).show()}else{if(this.options.sortname===""){$("span.s-ico",a).show()}}}j=j.substring(5+this.options.id.length+1);this.options.sortname=this.options.colModel[g].index||j;d=this.options.sortorder;if(i._trigger("onSortCol",null,[{id:j,colIndex:g,sortorder:d}])==="stop"){this.options.lastsort=g;return}if(this.options.datatype=="local"){if(this.options.deselectAfterSort){$(this.element).grid("resetSelection")
}}else{this.options.selrow=null;if(this.options.multiselect){i._setHeadCheckBox(false)}this.options.selarrrow=[];this.options.savedRow=[]}if(this.options.scroll){var e=this.grid.rowsView.scrollLeft;emptyRows(this.grid.rowsView,true,false);this.grid.columnsView.scrollLeft=e}if(this.options.subGrid&&this.options.datatype=="local"){$("td.sgexpanded","#"+$.grid.coralID(this.options.id)).each(function(){$(this).trigger("click")})}this._populate();this.options.lastsort=g;if(this.options.sortname!=j&&g){this.options.lastsort=g}i.options.b_sortdata=false},_intNum:function(b,a){b=parseInt(b,10);if(isNaN(b)){return a?a:0}else{return b}},_beginReq:function(){var a=$("#noRecordsTips_"+$.grid.coralID(this.options.id));if(a.is(":visible")){a.hide()}this.refresh();this.grid.columnsView.loading=true;if(this.options.hiddengrid){return}switch(this.options.loadui){case"disable":break;case"enable":$(this.element).loading({position:"overlay",text:this.options.loadtext});break;case"block":$("#lui_"+$.grid.coralID(this.options.id)).show();$(this.element).loading({position:"overlay",text:this.options.loadtext});break}},_endReq:function(){var a=this;this._delay(function(){a.refreshPager()},300);this.grid.columnsView.loading=false;switch(this.options.loadui){case"disable":break;case"enable":$(this.element).loading("hide");break;case"block":$("#lui_"+$.grid.coralID(this.options.id)).hide();$(this.element).loading("hide");break}this.element.find(".coral-grid-htable,.coral-grid-btable").css({"table-layout":"fixed"});if($(a.grid.rowsView).find(".jqgrow").length==0){a._noRecordsTipsPositon();$("#noRecordsTips_"+$.grid.coralID(a.options.id)).css("display","inline-block");$(a.grid.fhDiv).css("display","none");$(a.grid.fhDiv).css("display","none")}else{$("#noRecordsTips_"+$.grid.coralID(a.options.id)).css("display","none");$(a.grid.fhDiv).css("display","block");$(a.grid.fhDiv).css("display","block")}},_noRecordsTipsPositon:function(){var b=this;var e=this.element.width(),a=this.gridRows.height(),d=$("#noRecordsTips_"+$.grid.coralID(b.options.id)).width(),c=$("#noRecordsTips_"+$.grid.coralID(b.options.id)).height();
$("#noRecordsTips_"+$.grid.coralID(b.options.id)).css({"margin-top":(a-c)/2+"px","margin-left":e/2+"px"})},_setColWidth:function(){var h=this;var a=this.grid;var d=0,e=$.support.boxSizing?0:this._intNum(this.options.cellLayout,0),j=0,c,f=this._intNum(this.options.scrollOffset,0),g,k=false,b,m=0,l=0,i;$.each(this.options.colModel,function(){if(h.options.grouping&&h.options.autowidth){var n=$.inArray(this.name,h.options.groupingView.groupField);if(n>=0&&h.options.groupingView.groupColumnShow.length>n){this.hidden=!h.options.groupingView.groupColumnShow[n]}}this.widthOrg=g=h._intNum(this.width,0);if((this.hidden===false||typeof(this.hidden)=="undefined")){d+=g+e;if(this.fixed){m+=g+e}else{j++}l++}});if(isNaN(h.options.width)){h.options.width=a.width=d}else{a.width=h.options.width}h.options.tblwidth=d;if(h.options.shrinkToFit===false&&h.options.forceFit===true){h.options.forceFit=false}if(h.options.shrinkToFit===true&&j>0){b=a.width-e*j-m;if(!isNaN(this.options.height)){b-=f;k=true}d=0;$.each(h.options.colModel,function(n){if((this.hidden===false||typeof(this.hidden)=="undefined")&&!this.fixed){g=Math.round(b*this.width/(h.options.tblwidth-e*j-m));this.width=g;d+=g;c=n}});i=0;if(k){if(a.width-m-(d+e*j)!==f){i=a.width-m-(d+e*j)-f}}else{if(!k&&Math.abs(a.width-m-(d+e*j))!==1){i=a.width-m-(d+e*j)-1}}h.options.colModel[c].width+=i;h.options.tblwidth=d+i+e*j+m;if(h.options.tblwidth>h.options.width){h.options.colModel[c].width-=(h.options.tblwidth-parseInt(h.options.width,10));h.options.tblwidth=h.options.width}h.options.tblwidth}},_nextVisible:function(c){var b=c,a=c,d;for(d=c+1;d<this.options.colModel.length;d++){if(this.options.colModel[d].hidden!==true){a=d;break}}return a-b},_formatCol:function(e,l,p,q,i,f){var g=this;if(g.options.model=="card"){return""}var a=g.grid;var h=g.options.colModel[e],k=h.align,j='style="',b=h.cls,c=h.name,r,o=[],d="";if(k){j+="text-align:"+k+";"}if(h.hidden===true){j+="display:none;"}var m=$.coral.toFunction(h.cellattr);if(l===0){j+="width: "+a.headers[e].width+"px;"
}else{if($.isFunction(m)){r=m.apply(g.element[0],[{rowId:i,value:p,rawObject:q,colModel:h,rowData:f}]);if(r&&typeof(r)==="string"){r=r.replace(/style/i,"style").replace(/title/i,"title");if(r.indexOf("title")>-1){h.title=false}if(r.indexOf("class")>-1){b=undefined}o=r.split("style");if(o.length===2){o[1]=$.trim(o[1].replace("=",""));if(o[1].indexOf("'")===0||o[1].indexOf('"')===0){o[1]=o[1].substring(1)}j+=o[1].replace(/'/gi,'"')}else{j+='"'}}}}if(q){var n=q[c]||"";n=$.grid.htmlEncode(n);d+="data-org='"+n+"'"}if(!o.length){o[0]="";j+='"'}j+=(b!==undefined?(' class="'+b+'"'):"")+((h.title&&p)?(' title="'+$.grid.stripHtml(p)+'"'):"");j+=' aria-describedby="'+g.options.id+"_"+c+'"';return j+o[0]+d},findTextByValue:function(d,c){var b=c.colModel.editoptions.data;if(!b){return d}for(var a=0;a<b.length;a++){if(b[a].text==d){return b[a].value}else{}}return d},_cellVal:function(a){return a===undefined||a===null||a===""?"&#160;":(this.options.autoencode?$.grid.htmlEncode(a):a+"")},_addCell:function(f,a,h,d,c,g){if(this.options.model=="card"){var b,e;b=this._formatter(f,a,h,c,"add");e=this._formatCol(h,d,b,c,f,g);return'<div role="gridcell" '+e+">"+b+"</div>"}var b,e;b=this._formatter(f,a,h,c,"add");e=this._formatCol(h,d,b,c,f,g);return'<td role="gridcell" '+e+">"+b+"</td>"},_orderedCols:function(c){var b=this;var a=b.options.remapColumns;if(!a||!a.length){a=$.map(b.options.colModel,function(d,e){return e})}if(c){a=$.map(a,function(d){return d<c?null:d-c})}return a},emptyRows:function(d,a,f){var e=this,b=!!(e.options.model=="card");if(b){$("#"+$.grid.coralID(e.options.id)+" .coral-pic").children().remove()}else{if(e.options.deepempty){$("#"+$.grid.coralID(e.options.id)+" tbody:first tr:gt(0)").remove()}else{var c=$("#"+$.grid.coralID(e.options.id)+" tbody:first tr:first")[0];$("#"+$.grid.coralID(e.options.id)+" tbody:first").empty().append(c)}if(a&&e.options.scroll){$(">div:first",d).css({height:"auto"}).children("div:first").css({height:0,display:"none"});d.scrollTop=0}if(f===true){if(e.options.treeGrid===true){e.options.data=[];
e.options._index={}}}}},normalizeData:function(){var k=this.options,w=k.data,d=w.length,q,o,a,r,m,s,f,l,n=k.localReader,e=k.colModel,g=n.cell,u=(k.multiselect===true?1:0)+(k.subGrid===true?1:0)+(k.rownumbers===true?1:0),t=k.scroll?$.jgrid.randId():1,b,c,h;if(k.datatype!=="local"||n.repeatitems!==true){return}b=this._orderedCols(u);c=this._reader("local");r=k.keyName===false?($.isFunction(n.id)?n.id.call(ts,w):n.id):k.keyName;for(q=0;q<d;q++){a=w[q];m=$.grid.getAccessor(a,r);if(m===undefined){if(typeof r==="number"&&e[r+u]!=null){m=$.grid.getAccessor(a,e[r+u].name)}if(m===undefined){m=t+q;if(g){s=$.grid.getAccessor(a,g)||a;m=s!=null&&s[r]!==undefined?s[r]:m;s=null}}}l={};l[n.id]=m;if(g){a=$.grid.getAccessor(a,g)||a}h=$.isArray(a)?b:c;for(o=0;o<h.length;o++){f=$.grid.getAccessor(a,h[o]);l[e[o+u].name]=f}$.extend(true,w[q],l)}},refreshIndex:function(){var c=this;var e=c.options.data.length,b,a,d;if(c.options.keyName===false||c.options.loadonce===true){b=c.options.localReader.id}else{b=c.options.keyName}for(a=0;a<e;a++){d=$.grid.getAccessor(c.options.data[a],b);c.options._index[d]=a}},constructPanel:function(b,f,h,j,i){var e="-1",d="",g,a=f?"display:none;":"",c="gridPanel coral-row-"+this.options.direction+h;return'<li role="row" id="'+b+'" tabindex="'+e+'" class="'+c+'"'+(a===""?"":' style="'+a+'"')+d+">"},constructTr:function(d,i,m,o,n,g){var h="-1",f="",l,b=i?"display:none;":"",a,e="coral-component-content jqgrow coral-row-"+this.options.direction+m+(g?" coral-state-highlight":"");if(this.options.treeGrid){var k=this.options.treeReader.parent_id_field;if(n[k]!==null&&String(n[k]).toLowerCase()!="null"){e+=" treeGridRow "}}var j=$.coral.toFunction(this.options.rowattr);a=$.isFunction(j)?j.apply(this.element[0],[{rowId:d,rowData:o,currentObj:n}]):{};if(!$.isEmptyObject(a)){if(a.hasOwnProperty("id")){d=a.id;delete a.id}if(a.hasOwnProperty("tabindex")){h=a.tabindex;delete a.tabindex}if(a.hasOwnProperty("style")){b+=a.style;delete a.style}if(a.hasOwnProperty("class")){e+=" "+a["class"];
delete a["class"]}try{delete a.role}catch(c){}for(l in a){if(a.hasOwnProperty(l)){f+=" "+l+"="+a[l]}}}return'<tr role="row" id="'+d+'" tabindex="'+h+'" class="'+e+'"'+(b===""?"":' style="'+b+'"')+f+">"},_clearVals:function(b){var c=this,a;a=c._trigger("onPaging",null,[{pgButton:b}]);if(!a){return false}c.options.selrow=null;c.options.editrow=null;if(c.options.multiselect){c.options.selarrrow=[];c._setHeadCheckBox(false)}c.options.savedRow=[];return true},_getPagination:function(){},_setPager:function(z,J){var y=this,b="<span class='paginator-left'>{viewrecords}</span><span class='paginator-center'>{prev}{links}{next}{pginput}{navbar}{description}</span><span class='paginator-right'><em>每页</em>{rninput}<em>条</em></span>",a="<div class='paginator-left'>{viewrecords}{rowlist}{first}{prev}{pginput}{next}{last}{navbar}{description}</div><div class='toolbarpanel'>{toolbar}</div>";J+="_"+z;var F=false;if($.isFunction(y.options.pagerTemplate)){F=y.options.pagerTemplate.call(y)}var G=this.options.direction;var g=["first"+J,"prev"+J,"next"+J,"last"+J];if(G=="rtl"){g.reverse()}var l="",u="",d="",n="",q="",B="",m="",e="",x="<span class='coral-paginator-pages'></span>",p="<em>第</em><input type='text' class='coral-pg-input'/><em>页</em>",H="<button class='reload-button' id='_reloadGrid' type='button' data-options='customData:{gridId:\""+y.options.id+'"},label:"刷新",text: false,icons: "cui-icon-loop3",onClick: function( e, ui ){$( "#'+y.options.id+'" ).grid( "reload" );}\'>reload</button>',f="<span id='"+g[0]+"' class='coral-paginator-first coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-first2' title='第一页'></span></span>",k="<span id='"+g[3]+"' class='coral-paginator-last coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-last2' title='最后一页'></span></span>",c="<span id='"+g[2]+"' class='coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3' title='下一页'></span></span>",s="<span id='"+g[1]+"' class='coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3' title='前一页'></span></span>",r="<span>|</span>",o="<span class='pager-navbar'></span>",j="<span class='pager-toolbar'></span>",h="<span class='pager-description'></span>",t,K,A,I,w,v,C;
t="pg_"+z;K=z+"_left";A=z+"_center";I=z+"_right";d+="<input type='text' class='coral-rn-input' val=''/>";if(!y.options.rninput){}else{if(y.options.rowList.length>0){}}n+="<span class='coral-paginator-combobox'><select class='coral-pg-selbox' role='listbox'>";for(C=0;C<y.options.rowList.length;C++){n+='<option role="option" value="'+y.options.rowList[C]+'"'+((y.options.rowNum==y.options.rowList[C])?' selected="selected"':"")+">"+y.options.rowList[C]+"</option>"}n+="</select></span>";if(y.options.viewrecords){q+="<span class='coral-paging-info'></span>";B+="<span class='coral-paging-totalpage'></span>"}if(y.options.pginput===true){l="<td dir='"+G+"'>"+$.grid.format(y.options.pgtext||"","<input class='coral-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.grid.coralID(z)+"'></span>")+"</td>"}if(y.options.pagerStyle=="flex"){if(F){b=F}e="<span id='"+g[1]+"' class='coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3'>p</span></span><span class='coral-paginator-pages'></span><span id='"+g[2]+"' class='coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3'>p</span></span><em>第</em><input type='text' class='coral-pg-input'/><em>页</em>";m=b.replace(/\{viewrecords\}/g,q).replace(/\{navbar\}/g,o).replace(/\{reload\}/g,H).replace(/\{-\}/g,r).replace(/\{first\}/g,f).replace(/\{last\}/g,k).replace(/\{next\}/g,c).replace(/\{totalPage\}/g,B).replace(/\{prev\}/g,s).replace(/\{links\}/g,x).replace(/\{pginput\}/g,p).replace(/\{toolbar\}/g,j).replace(/\{description\}/g,h).replace(/\{rowlist\}/g,n).replace(/\{rninput\}/g,d);$("#"+$.grid.coralID(z)).addClass("coral-pager-flex");$("#"+$.grid.coralID(z)).append("<div id='"+t+"' class='coral-paginator' role='group'>"+m+"</div>");y._bindpager(z,J)}else{if(y.options.pagerStyle=="tradition"){if(F){a=F}e="<span id='"+g[0]+"' class='coral-paginator-first coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-first2'></span></span><span id='"+g[1]+"' class='coral-paginator-prev coral-corner-all' tabindex='0'><span class='cui-icon-arrow-left3'></span></span><em>第</em><input type='text' class='coral-pg-input'/><em>页</em><span id='"+g[2]+"' class='coral-paginator-next coral-corner-all' tabindex='0'><span class='cui-icon-arrow-right3'></span></span><span id='"+g[3]+"' class='coral-paginator-last coral-state-default coral-corner-all' tabindex='0'><span class='cui-icon-last2'></span></span>";
m=a.replace(/\{viewrecords\}/g,q).replace(/\{navbar\}/g,o).replace(/\{reload\}/g,H).replace(/\{-\}/g,r).replace(/\{first\}/g,f).replace(/\{last\}/g,k).replace(/\{next\}/g,c).replace(/\{prev\}/g,s).replace(/\{links\}/g,x).replace(/\{totalPage\}/g,B).replace(/\{pginput\}/g,p).replace(/\{toolbar\}/g,j).replace(/\{description\}/g,h).replace(/\{rowlist\}/g,n).replace(/\{rninput\}/g,d);$("#"+$.grid.coralID(z)).addClass("coral-pager-tradition");$("#"+$.grid.coralID(z)).append("<div id='"+t+"' class='coral-paginator' role='group'>"+m+"</div>");y._bindpagerTradition(z,J)}else{}}var D=$.parser.parseOptions($("#"+$.grid.coralID(z))[0],null);y.options.toolbarOptions=D.toolbarOptions;y.options.description=D.description;var E=y.options.navbarOptions||{};D.toolbarOptions=D.toolbarOptions||{};$(".reload-button",y.element).button();if($(".pager-toolbar",y.element).length){$(".pager-toolbar",y.element).toolbar(D.toolbarOptions)}if(y.options.description){$(".pager-description",y.element).html(y.options.description)}},_bindpagerTradition:function(c,b){var a=this;$("input.coral-pg-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"pg",onKeyPress:function(i,g){var d=i.charCode?i.charCode:i.keyCode?i.keyCode:0;if(d==13){var f=a._intNum(a.options.lastpage,1);var h=a._intNum(g.text,1);if(h>f){a.options.page=f;$(this).textbox("setValue",a.options.page)}else{a.options.page=(g.text>0)?g.text:a.options.page}if(!a._clearVals("user")){return false}a._populate();return false}return this},onBlur:function(){var d=a._intNum(a.options.lastpage,1);var e=$(this).textbox("getValue");if(e!==a.options.page){$(this).textbox("setValue",a.options.page)}}});$("input.coral-rn-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"rn",onKeyPress:function(g,f){var d=g.charCode?g.charCode:g.keyCode?g.keyCode:0;if(d==13){a.options.rowNum=(f.text>0)?(f.text<a.options.rowNumMax?f.text:a.options.rowNumMax):a.options.rowNum;if(!a._clearVals("records")){return false}a._populate();return false}return this}});$(".coral-pg-selbox",$("#"+$.grid.coralID(c))).combobox({componentCls:"rn",panelHeight:"auto",onChange:function(d,e){a.options.page=Math.round(a.options.rowNum*(a.options.page-1)/e.value-0.5)+1;
a.options.rowNum=e.value;if(!a._clearVals("records")){return false}a._populate();return false}});$("#first"+$.grid.coralID(b)+", #prev"+$.grid.coralID(b)+", #next"+$.grid.coralID(b)+", #last"+$.grid.coralID(b)).click(function(){var i=a._intNum(a.options.page,1),g=a._intNum(a.options.lastpage,1),j=false,e=true,d=true,h=true,f=true;if(g===0||g===1){e=false;d=false;h=false;f=false}else{if(g>1&&i>=1){if(i===1){e=false;d=false}else{if(i===g){h=false;f=false}}}else{if(g>1&&i===0){h=false;f=false;i=g-1}}}if(this.id==="first"+b&&e){a.options.page=1;j=true}if(this.id==="prev"+b&&d){a.options.page=(i-1);j=true}if(this.id==="next"+b&&h){a.options.page=(i+1);j=true}if(this.id==="last"+b&&f){a.options.page=g;j=true}if(j){if(!a._clearVals(this.id)){return false}a._populate()}return false})},_bindpager:function(c,b){var a=this;$("input.coral-pg-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"pg",onKeyPress:function(i,g){var d=i.charCode?i.charCode:i.keyCode?i.keyCode:0;if(d==13){var f=a._intNum(a.options.lastpage,1);var h=a._intNum(g.text,1);if(h>f){a.options.page=f;$(this).textbox("setValue",a.options.page)}else{a.options.page=(g.text>0)?g.text:a.options.page}if(!a._clearVals("user")){return false}a._populate();return false}return this},onBlur:function(){var d=a._intNum(a.options.lastpage,1);var e=$(this).textbox("getValue");if(e!==a.options.page){$(this).textbox("setValue",a.options.page)}}});$("input.coral-rn-input",$("#"+$.grid.coralID(c))).textbox({componentCls:"rn",onKeyPress:function(g,f){var d=g.charCode?g.charCode:g.keyCode?g.keyCode:0;if(d==13){a.options.rowNum=(f.text>0)?(f.text<a.options.rowNumMax?f.text:a.options.rowNumMax):a.options.rowNum;if(!a._clearVals("records")){return false}a._populate();return false}return this}});$(".coral-pg-selbox",$("#"+$.grid.coralID(c))).combobox({componentCls:"rn",panelHeight:"auto",onChange:function(d,e){a.options.page=Math.round(a.options.rowNum*(a.options.page-1)/e.newValue-0.5)+1;a.options.rowNum=e.newValue;if(!a._clearVals("records")){return false
}a._populate();return false}});$(".coral-textbox-btn-ico-search",$("#"+$.grid.coralID(c))).click(function(d){a.options.page=($(this).prev().val()>0)?$(this).prev().val():a.options.page;if(!a._clearVals("user")){return false}a._populate();return false});this._off($(".coral-paginator-page"));this._on({"click.coral-paginator-page":function(d){var f=d.target;if($(f).hasClass("coral-state-disabled")){f.style.cursor="default"}else{$(f).addClass("coral-state-hover");f.style.cursor="pointer"}}});this._on({"mouseenter.coral-paginator-page":function(d){var f=d.target;if($(f).hasClass("coral-state-disabled")){f.style.cursor="default"}else{$(f).addClass("coral-state-hover");f.style.cursor="pointer"}},"mouseleave.coral-paginator-page":function(d){var f=d.target;if(!$(f).hasClass("coral-state-disabled")){$(f).removeClass("coral-state-hover");f.style.cursor="default"}}});$("#first"+$.grid.coralID(b)+", #prev"+$.grid.coralID(b)+", #next"+$.grid.coralID(b)+", #last"+$.grid.coralID(b)).click(function(){var i=a._intNum(a.options.page,1),g=a._intNum(a.options.lastpage,1),j=false,e=true,d=true,h=true,f=true;if(g===0||g===1){e=false;d=false;h=false;f=false}else{if(g>1&&i>=1){if(i===1){e=false;d=false}else{if(i===g){h=false;f=false}}}else{if(g>1&&i===0){h=false;f=false;i=g-1}}}if(this.id==="first"+b&&e){a.options.page=1;j=true}if(this.id==="prev"+b&&d){a.options.page=(i-1);j=true}if(this.id==="next"+b&&h){a.options.page=(i+1);j=true}if(this.id==="last"+b&&f){a.options.page=g;j=true}if(j){if(!a._clearVals(this.id)){return false}a._populate()}return false})},_updatepager:function(j,q){var g=this;var f,h,e,s,d,k,c,r="",a,t,b,v=g.options.pager?"_"+$.grid.coralID(g.options.pager.substr(1)):"",u=g.options.toppager?"_"+g.options.toppager.substr(1):"";e=parseInt(g.options.page,10)-1;if(e<0){e=0}e=e*parseInt(g.options.rowNum,10);d=e+g.options.reccount;if(g.options.scroll){var i=$("tbody:first > tr:gt(0)",g.grid.rowsView);e=d-i.length;g.options.reccount=i.length;var n=i.outerHeight()||g.grid.prevRowHeight;
if(n){var l=e*n;var m=parseInt(g.options.records,10)*n;$(">div:first",g.grid.rowsView).css({height:m}).children("div:first").css({height:l,display:l?"":"none"})}g.grid.rowsView.scrollLeft=g.grid.columnsView.scrollLeft}if(g.options.treeGrid){var i=$("tbody:first > tr:not(.treeGridRow,.jqgfirstrow)",g.grid.rowsView);g.options.reccount=i.length;d=e+g.options.reccount}r=$(g.element).find(".coral-grid-pager");if(r.length>0){c=$.grid.formatter.integer||{};f=g._intNum(g.options.page);h=g._intNum(g.options.lastpage);$(".selbox",r)[this.options.useProp?"prop":"attr"]("disabled",false);if($(".coral-pg-input",r).length>0){$(".coral-pg-input",r).val(g.options.page);a=g.options.toppager?"#sp_1"+v+",#sp_1"+u:"#sp_1"+v;$(a).html($.fmatter?$.fmatter.util.NumberFormat(g.options.lastpage,c):g.options.lastpage)}if(g.options.rninput===true){$(".coral-rn-input",r).val(g.options.rowNum)}if(g.options.viewrecords){if(g.options.reccount===0){$(".coral-paging-info",r).html("");$(".coral-paging-totalpage",r).html("")}else{s=e+1;k=g.options.records;t=g.options.reccount;if(k%t==0){b=parseInt(k/t)}else{b=parseInt(k/t)+1}if($.fmatter){s=$.fmatter.util.NumberFormat(s,c);d=$.fmatter.util.NumberFormat(d,c);k=$.fmatter.util.NumberFormat(k,c);t=$.fmatter.util.NumberFormat(t,c);b=$.fmatter.util.NumberFormat(b,c)}$(".coral-paging-info",r).html($.grid.format(g.options.recordtext,s,d,k));$(".coral-paging-totalpage",r).html($.grid.format(g.options.pagetext,b))}}if(g.options.pgbuttons===true){var o=[],p=[];g.pagers.each(function(){o.push("#first_"+this.id);o.push("#prev_"+this.id);p.push("#next_"+this.id);p.push("#last_"+this.id)});if(f<=0){f=h=0}if(f==1||f===0){$(o.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover");if(g.options.toppager){$("#first_t"+u+", #prev_t"+u).addClass("coral-state-disabled").removeClass("coral-state-hover")}}else{$(o.join(",")).removeClass("coral-state-disabled");if(g.options.toppager){$("#first_t"+u+", #prev_t"+u).removeClass("coral-state-disabled")}}if(f==h||f===0){$(p.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover");
if(g.options.toppager){$("#next_t"+u+", #last_t"+u).addClass("coral-state-disabled").removeClass("coral-state-hover")}}else{$(p.join(",")).removeClass("coral-state-disabled");if(g.options.toppager){$("#next_t"+u+", #last_t"+u).removeClass("coral-state-disabled")}}if(0==h){$(p.join(",")).addClass("coral-state-disabled").removeClass("coral-state-hover")}}g._paginators()}if(j===true&&g.options.rownumbers===true){$("td.grid-rownum",g.rows).each(function(w){$(this).html(e+1+w)})}if(q&&g.options.jqgdnd){$(g.element).grid("gridDnD","updateDnD")}g._trigger("onComplete",null,[]);g._trigger("afterComplete",null,[])},_paginators:function(){var g=this;var h=g._intNum(g.options.page,1),j=g._intNum(g.options.lastpage,1),b=false;var a=3,c=h>2?h+2-a:1,e,d="";e=a+c>j?j+1:a+c;if(c>3&&e<=j+2){c=e-a}if(h>2&&j>a){if(c>=2){d+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>1</span>"}if(c>=3){d+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>2</span>"}if(c!=3&&c!=1&&c!=2){d+="<span class='coral-page-pointer'>...</span>"}}for(var f=c;f<e;f++){if(h==f){d+="<span class='coral-paginator-page coral-state-default coral-state-active coral-corner-all'  tabindex='0'>"+f+"</span>"}else{d+="<span class='coral-paginator-page coral-state-default coral-corner-all'  tabindex='0'>"+f+"</span>"}}if(e==j){d+="<span class='coral-paginator-page coral-state-default coral-corner-all'>"+j+"</span>"}else{if(e<=j){d+="<span class='coral-page-pointer'>...</span><span class='coral-paginator-page coral-state-default coral-corner-all'>"+j+"</span>"}}$(".coral-paginator-pages",g.element).html(d)},_populate:function(c){var g=this,p=!!(g.options.model=="card");var a=g.grid;if(true){var d=g.options.scroll&&c===false,i={},m,l,j=g.options.prmNames;if(g.options.page<=0){g.options.page=1}if(j.search!==null){i[j.search]=g.options.search}if(j.nd!==null){i[j.nd]=new Date().getTime()}if(j.rows!==null){i[j.rows]=g.options.rowNum}if(j.page!==null){i[j.page]=g.options.page
}if(j.sort!==null){i[j.sort]=g.options.sortname}if(j.order!==null){i[j.order]=g.options.sortorder}if(g.options.rowTotal!==null&&j.totalrows!==null){i[j.totalrows]=g.options.rowTotal}var o=function(t){g._trigger("onLoad",null,[t]);if(g.options.afterSortableRows&&$.fn.sortable){try{$(g.element).grid("sortableRows")}catch(u){}}};var q=0;c=c||1;if(c>1){if(j.npage!==null){i[j.npage]=c;q=c-1;c=1}else{o=function(t){g.options.page++;a.columnsView.loading=false;g._trigger("onLoad",null,[t]);g._populate(c-1)}}}else{if(j.npage!==null){delete g.options.postData[j.npage]}}if(g.options.grouping){this.groupingSetup();var h=g.options.groupingView,s,n="";for(s=0;s<h.groupField.length;s++){var e=h.groupField[s];$.each(g.options.colModel,function(t,u){if(u.name===e&&u.index){e=u.index}});n+=e+" "+h.groupOrder[s]+", "}i[j.sort]=n+i[j.sort]}if(g.options.containSortOrder&&i[j.sort]&&i[j.order]){i[j.sort]=i[j.sort]+g.options.sortSeparator+i[j.order]}$.extend(g.options.postData,i);var r=!g.options.scroll?1:g.rows.length-1;var k=g._trigger("beforeRequest",null,[]);if(k===false||k==="stop"){return}if($.isFunction(g.options.datatype)){g.options.datatype.call(g,g.options.postData,"load_"+g.options.id);return}m=g.options.datatype.toLowerCase();if(!(g.options.b_sortdata&&g.options.b_sortdata===true)&&g.options.orgdatatype){m=g.options.orgdatatype;g.options.datatype=m}if(g.options.localonce){m="local"}if(g.options.initData){m="initinlocal"}var f=function(w,u,x){if(g.options.loadonce){g.options.orgdatatype=m}if(!g._trigger("beforeProcessing",null,[{content:w,state:u,xhr:x}])){g._endReq();return}else{g._addJSONData(w,a.rowsView,r,c>1,q)}if(!p){g._hasScrollOffset()}if(o){o.call(g,w)}g._trigger("afterLoad",null,[{content:w}]);if(d){a.populateVisible()}if(g.options.loadonce||g.options.treeGrid){g.options.datatype="local";g.options.orgpage=g.options.page}if(c===1){g._endReq()}var v,t;if(g.options.orgdatatype=="local"){v=g.options.localReader}else{v=g.options.jsonReader}t=$.grid.getAccessor(w,v.root);if(t.length==0&&parseInt(g.options.page)!=1&&parseInt(g.options.lastpage)<parseInt(g.options.page)){$(g.element).grid("reload",{page:g.options.lastpage})
}w=null;g.refresh()};switch(m){case"initinlocal":m="json";f(g.options.initData,null,null);this.options.initData=false;break;case"json":case"jsonp":if(this.xhr){this.xhr.abort()}this.xhr=$.ajax(this._ajaxSettings());this.xhr.success(function(u,t,v){f(u,t,v)}).error(function(v,t,u){g._trigger("onLoadError",null,[{xhr:v,st:t,err:u}]);if(c===1){g._endReq()}v=null;g.refresh()}).complete(function(u,t){if(u===g.xhr){g.xhr=null}});break;case"local":case"clientside":g._beginReq();g.options.datatype="local";var b=g._addLocalData();this._addJSONData(b,a.rowsView,r,c>1,q);if(!g.options.b_sortdata){g.refresh();if(o){o.call(g,b)}g._trigger("AfterLoad",null,[b]);if(d){a.populateVisible()}}g._endReq();if(g.options.frozenColumns){g._setFrozenHeight()}break}}},_setFrozenHeight:function(){var b=this,e="",d=0,a=0,c=0;if(this.grid.fhDiv){d=this.grid.fhDiv.height();this.grid.fbDiv.css("top",d);$("tr",b.grid.fbDiv).slice(1).each(function(){e=$(this).attr("id");a=parseFloat($("td:first",this).height());c=parseFloat($("#"+e,b.gridRows).find("td:first").height());if(a<c){$("td",this).each(function(){$(this).height(c)})}else{if(a>c){$("td",$("#"+e,b.gridRows)).each(function(){$(this).height(a)})}}})}if(this.grid.rightfhDiv){d=this.grid.rightfhDiv.height();this.grid.rightfbDiv.css("top",d);$("tr",b.grid.rightfbDiv).slice(1).each(function(){e=$(this).attr("id");a=parseFloat($("td:first",this).height());c=parseFloat($("#"+e,b.gridRows).find("td:first").height());if(a<c){$("td",this).each(function(){$(this).height(c)})}else{if(a>c){$("td",$("#"+e,b.gridRows)).each(function(){$(this).height(a)})}}})}},_ajaxSettings:function(){var b=this,a=this.options;return $.extend({url:a.url,type:a.asyncType,beforeSend:function(e,d){var c=true;c=b._trigger("beforeSend",null,{xhr:e,settings:d});if(c===undefined){c=true}if(c===false){return false}else{b._beginReq()}},data:$.isFunction(a.serializeGridData)?a.serializeGridData.call(this,a.postData):a.postData,dataType:"json"},$.grid.ajaxOptions,a.ajaxGridOptions)},_reader:function(c){var d=this;
var g,e=[],a=0,b;for(b=0;b<this.options.colModel.length;b++){g=this.options.colModel[b];if(g.name!=="cb"&&g.name!=="subgrid"&&g.name!=="rn"){e[a]=c=="local"?g.name:((c=="xml"||c==="xmlstring")?g.xmlmap||g.name:g.jsonmap||g.name);if(d.options.keyName!==false&&g.key===true){d.options.keyName=e[a]}a++}}return e},_addMulti:function(f,h,c,e){var d=this,a=!!(d.options.model=="card"),b='<input role="checkbox" type="checkbox" id="jqg_'+d.options.id+"_"+f+'" class="cbox" name="jqg_'+d.options.id+"_"+f+'"'+(e?'checked="checked"':"")+"/>",g=d._formatCol(h,c,"",null,f,true);if(a){return b}return'<td role="gridcell" '+g+">"+b+"</td>"},_addSingle:function(e,g,c){var d=this,a=!!(d.options.model=="card"),b='<input role="radio" type="radio" id="jqg_'+d.options.id+"_"+e+'" class="cbox" name="jqg_'+d.options.id+'"/>',f=d._formatCol(g,c,"",null,e,true);if(a){return b}return'<td role="gridcell" '+f+">"+b+"</td>"},_addRowNum:function(f,b,e,c){var a=(parseInt(e,10)-1)*parseInt(c,10)+1+b,d=this._formatCol(f,b,a,null,b,true);return'<td role="gridcell" class="coral-state-default grid-rownum" '+d+">"+a+"</td>"},_customPanel:function(l,c,b){var f=this,k={},d="",e="",j="",g="";var h=$.coral.toFunction(f.options.picTemplate);if($.isFunction(h)){k=h.apply(f.element[0],[{rowData:l,ni:c,muti:b,getData:true}])}if(typeof(k)=="undefined"){return""}var a=k.src;if(!a){a="src"}d=k.coreData||(l.src?"<img src='"+l.src+"'/>":"");e=k.itemData||"";j=k.toolbarsData||"";g=k.buttonsData||"";var i=[];i.push("<ul class='rowgrid coral-component-content coral-corner-all'>");if(d.length>0){i.push("<li class='gridModel1 gridModel'>");i.push(d);i.push("<div class='valigh-fix'></div>");if(j.length>0){i.push("<div class='gridtoolbars'><div class='bgopacity'>&#160;</div>"+j+"</div>")}i.push("</li>")}if(e.length>0){i.push("<li class='gridModel2 gridModel'>");i.push("<div class='griditem'>"+e+"</div>");i.push("</li>")}if(k.muti&&b.length>0||g.length>0){i.push("<li class='gridModel3 gridModel'>");if(e.length>0||g.length>0){i.push("<ul class='griditem'>");
if(b.length>0&&k.muti){i.push("<li class='gridCheckbox'>"+b+"</li>")}if(g.length>0){i.push("<li class='gridbuttons'>"+g+"</li>")}i.push("</ul>")}i.push("</li>")}i.push("</ul>");return i.join("")},_addJSONData:function(ab,O,n,J,W){var L=this,Q=!!(L.options.model=="card");var g=new Date();if(ab){if(L.options.treeANode===-1&&!L.options.scroll){L.emptyRows(O,false,true);n=1}else{n=n>1?n:1}}else{return}var b,o="_id_",Z,z=(L.options.datatype!="local"&&L.options.loadonce)||L.options.datatype=="jsonstring";if(z){L.options.data=[];L.options._index={};L.options.localReader.id=o}L.options.reccount=0;if(L.options.datatype=="local"){b=L.options.localReader;Z="local"}else{b=L.options.jsonReader;Z="json"}var m=this,D=0,N,V,U,X=[],q,k,s=L.options.multiselect?1:0,u=L.options.subGrid?1:0,ae=L.options.rownumbers===true?1:0,w,E,c,M={},A,a,R=[],y=[],ac=[],C=(L.options.altRows===true)?" "+L.options.altclass:"",h,H;if(s==0){s=L.options.singleselect?1:0}L.options.page=$.grid.getAccessor(ab,b.page)||0;H=$.grid.getAccessor(ab,b.total);L.options.lastpage=H===undefined?1:H;L.options.records=$.grid.getAccessor(ab,b.records)||0;L.options.total=$.grid.getAccessor(ab,b.total)||0;L.options.userData=$.grid.getAccessor(ab,b.userData)||{};if(!b.repeatitems){q=X=L._reader(Z)}if(L.options.keyName===false){c=$.isFunction(b.id)?b.id.call(L,ab):b.id}else{c=L.options.keyName}if(X.length>0&&!isNaN(c)){if(L.options.remapColumns&&L.options.remapColumns.length){c=$.inArray(c,L.options.remapColumns)}c=X[c]}E=$.grid.getAccessor(ab,b.root);if(!E){E=[]}w=E.length;V=0;if(w>0&&L.options.page<=0){L.options.page=1}var K=parseInt(L.options.rowNum,10),S=L.options.scroll?$.grid.randId():1,p,G=false,d;if(W){K*=W+1}if(L.options.datatype==="local"&&!L.options.deselectAfterSort){G=true}var aa=$.isFunction(L.options.afterInsertRow),x=[],T=false,B;if(L.options.grouping){T=L.options.groupingView.groupCollapse===true;B=this.groupingPrepare}while(V<w){k=E[V];a=$.grid.getAccessor(k,c);if(a===undefined){a=S+V;if(X.length===0){if(b.cell){var P=$.grid.getAccessor(k,b.cell);
a=P!==undefined?P[c]||a:a;P=null}}}a=L.options.idPrefix+a;p=n===1?0:n;h=(p+V)%2==1?C:"";if(G){if(L.options.multiselect){d=($.inArray(a,L.options.selarrrow)!==-1)}else{d=(a===L.options.selrow)}}var I=R.length;var l=y.length;R.push("");if(ae){R.push(L._addRowNum(0,V,L.options.page,L.options.rowNum))}if(s){if(L.options.singleselect){R.push(L._addSingle(a,ae,V,d));ac.push(L._addSingle(a,ae,V,d))}else{R.push(L._addMulti(a,ae,V,d));ac.push(L._addMulti(a,ae,V,d))}}if(u){R.push($(L.element).grid("addSubGridCell",s+ae,V+n))}if(b.repeatitems){if(b.cell){k=$.grid.getAccessor(k,b.cell)}if(!q){q=this._orderedCols(s+u+ae)}}for(U=0;U<q.length;U++){N=$.grid.getAccessor(k,q[U]);M[L.options.colModel[U+s+u+ae].name]=N;R.push(this._addCell(a,N,U+s+u+ae,V+n,k,M))}if(L.options.model=="card"){y[I]=L.constructPanel(a,T,h,M,k);y.push(L._customPanel(M,ae,ac));y.push("</li>")}else{R[I]=L.constructTr(a,T,h,M,k,d);R.push("</tr>")}if(L.options.grouping){x.push(R);if(!L.options.groupingView._locgr){B.call(m,M,V)}R=[]}if(z||L.options.treeGrid===true){M[o]=a;L.options.data.push(M);L.options._index[a]=L.options.data.length-1}if(L.options.gridview===false){if(Q){$("#"+$.grid.coralID(L.options.id)+" .coral-pic").append(y.join(""))}else{$("#"+$.grid.coralID(L.options.id)+" .coral-grid-btable tbody:first").append(R.join(""))}$(L).triggerHandler("gridAfterInsertRow",[a,M,k]);if(aa){L.options.afterInsertRow.call(L,a,M,k)}R=[];y=[];ac=[]}$.fn.afterFmatter.call(L);M={};D++;V++;if(D==K){break}}if(L.options.gridview===true){A=L.options.treeANode>-1?L.options.treeANode:0;if(L.options.grouping){if(!z){this.groupingRender(x,L.options.colModel.length,L.options.page,K);x=null}}else{if(L.options.treeGrid===true&&A>0){$(L.rows[A]).after(R.join(""))}else{$("#"+$.grid.coralID(L.options.id)+" tbody:first").append(R.join(""))}}}if(L.options.subGrid===true){try{$(L.element).grid("addSubGrid",s+ae)}catch(ad){}}L.options.totaltime=new Date()-g;if(D>0){if(L.options.records===0){L.options.records=w}}R=null;if(L.options.treeGrid===true){try{$(L.element).grid("setTreeNode",A+1,D+A+1)
}catch(Y){}}if(!L.options.treeGrid&&!L.options.scroll&&!Q){L.grid.rowsView.scrollTop=0}L.options.reccount=D;L.options.treeANode=-1;if(L.options.userDataOnFooter){$(L.element).grid("footerData",L.options.userData,true)}if(z&&!L.options.orgdatatype){L.options.records=w;L.options.lastpage=Math.ceil(w/K)}if(!J){L._updatepager(false,true)}if(z){while(D<w&&E[D]){k=E[D];a=$.grid.getAccessor(k,c);if(a===undefined){a=S+D;if(X.length===0){if(b.cell){var r=$.grid.getAccessor(k,b.cell);a=r[c]||a;r=null}}}if(k){a=L.options.idPrefix+a;if(b.repeatitems){if(b.cell){k=$.grid.getAccessor(k,b.cell)}if(!q){q=L._orderedCols(s+u+ae)}}for(U=0;U<q.length;U++){N=$.grid.getAccessor(k,q[U]);M[L.options.colModel[U+s+u+ae].name]=N}M[o]=a;if(L.options.grouping){B.call(m,M,D)}L.options.data.push(M);L.options._index[a]=L.options.data.length-1;M={}}D++}if(L.options.grouping){L.options.groupingView._locgr=true;this.groupingRender(x,L.options.colModel.length,L.options.page,K);x=null}}},_addLocalData:function(){var i=this;var r,m=false,v={},f=[],e=[],p,b,x;if(!$.isArray(i.options.data)){return}var l=i.options.grouping?i.options.groupingView:false,g,k;$.each(i.options.colModel,function(){b=this.sorttype||"text";if(b=="date"||b=="datetime"){if(this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"){if(this.formatoptions&&this.formatoptions.srcformat){p=this.formatoptions.srcformat}else{p=$.grid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){x=this.formatoptions.newformat}else{x=$.grid.formatter.date.newformat}}else{p=x=this.datefmt||"Y-m-d"}v[this.name]={stype:b,srcfmt:p,newfmt:x}}else{v[this.name]={stype:b,srcfmt:"",newfmt:""}}if(i.options.grouping){for(k=0,g=l.groupField.length;k<g;k++){if(this.name===l.groupField[k]){var j=this.name;if(this.index){j=this.index}f[k]=v[j];e[k]=j}}}if(!m&&(this.index==i.options.sortname||this.name==i.options.sortname)){r=this.name;m=true}});if(i.options.treeGrid){$(i.element).grid("sortTree",r,i.options.sortorder,v[r].stype,v[r].srcfmt);
return}var B={eq:function(j){return j.equals},ne:function(j){return j.notEquals},lt:function(j){return j.less},le:function(j){return j.lessOrEquals},gt:function(j){return j.greater},ge:function(j){return j.greaterOrEquals},cn:function(j){return j.contains},nc:function(j,D){return D==="OR"?j.orNot().contains:j.andNot().contains},bw:function(j){return j.startsWith},bn:function(j,D){return D==="OR"?j.orNot().startsWith:j.andNot().startsWith},en:function(j,D){return D==="OR"?j.orNot().endsWith:j.andNot().endsWith},ew:function(j){return j.endsWith},ni:function(j,D){return D==="OR"?j.orNot().equals:j.andNot().equals},"in":function(j){return j.equals},nu:function(j){return j.isNull},nn:function(j,D){return D==="OR"?j.orNot().isNull:j.andNot().isNull}},d=$.grid.from(i.options.data);if(i.options.ignoreCase){d=d.ignoreCase()}function y(J){var L=0,F,I,D,j,H;if(J.groups!==undefined){I=J.groups.length&&J.groupOp.toString().toUpperCase()==="OR";if(I){d.orBegin()}for(F=0;F<J.groups.length;F++){if(L>0&&I){d.or()}try{y(J.groups[F])}catch(G){alert(G)}L++}if(I){d.orEnd()}}if(J.rules!==undefined){if(L>0){var K=d.select();d=$.grid.from(K);if(i.options.ignoreCase){d=d.ignoreCase()}}try{D=J.rules.length&&J.groupOp.toString().toUpperCase()==="OR";if(D){d.orBegin()}for(F=0;F<J.rules.length;F++){H=J.rules[F];j=J.groupOp.toString().toUpperCase();if(B[H.op]&&H.field){if(L>0&&j&&j==="OR"){d=d.or()}d=B[H.op](d,j)(H.field,H.data,v[H.field])}L++}if(D){d.orEnd()}}catch(E){alert(E)}}}if(i.options.search===true){var n=i.options.postData.filters;if(n){if(typeof n=="string"){n=$.grid.parse(n)}y(n)}else{try{d=B[i.options.postData.searchOper](d)(i.options.postData.searchField,i.options.postData.searchString,v[i.options.postData.searchField])}catch(C){}}}if(i.options.grouping){for(k=0;k<g;k++){d.orderBy(e[k],l.groupOrder[k],f[k].stype,f[k].srcfmt)}}if(r&&i.options.sortorder&&m&&i.options.sortname){if(i.options.sortorder.toUpperCase()=="DESC"){d.orderBy(i.options.sortname,"d",v[r].stype,v[r].srcfmt)}else{d.orderBy(i.options.sortname,"a",v[r].stype,v[r].srcfmt)
}}var a=d.select(),w=i._trigger("afterFilter",null,[{queryResults:d.select(),getData:true}])["result"];if(w){a=w}var h=parseInt(i.options.rowNum,10),A=a.length,c=parseInt(i.options.page,10),s=Math.ceil(A/h),u={};if((i.options.search||i.options.resetsearch)&&i.options.grouping&&i.options.groupingView._locgr){i.options.groupingView.groups=[];var t,o=i.groupingPrepare,z,q;if(i.options.footerrow&&i.options.userDataOnFooter){for(z in i.options.userData){if(i.options.userData.hasOwnProperty(z)){i.options.userData[z]=0}}q=true}for(t=0;t<A;t++){if(q){for(z in i.options.userData){i.options.userData[z]+=parseFloat(a[t][z]||0)}}o.call($(this),a[t],t,h)}}a=a.slice((c-1)*h,c*h);d=null;v=null;if(i.options.orgdatatype){u[i.options.localReader.total]=i.options.lastpage;u[i.options.localReader.page]=i.options.orgpage;u[i.options.localReader.records]=i.options.records}else{u[i.options.localReader.total]=s;u[i.options.localReader.page]=c;u[i.options.localReader.records]=A}u[i.options.localReader.root]=a;u[i.options.localReader.userData]=i.options.userData;a=null;return u},getColProp:function(d){var a={},c=this;if(!c.grid){return false}var e=c.options.colModel;for(var b=0;b<e.length;b++){if(e[b].name==d){a=e[b];break}}return a},setColProp:function(c,b){if(this.grid){if(b){var d=this.options.colModel;for(var a=0;a<d.length;a++){if(d[a].name==c){$.extend(this.options.colModel[a],b);break}}}}},destroyGroupHeader:function(j){if(typeof(j)=="undefined"){j=true}var k=this,h,f,d,b,o,c,a=k.grid,m=$("table.coral-grid-htable thead",a.columnsView),n=k.options.colModel,g;if(!a){return}$(this.element).unbind(".setGroupHeaders");h=$("<tr>",{role:"rowheader"}).addClass("coral-grid-labels");b=a.headers;for(f=0,d=b.length;f<d;f++){g=n[f].hidden?"none":"";o=$(b[f].el).width(b[f].width).css("display",g);try{o.removeAttr("rowSpan")}catch(e){o.attr("rowSpan",1)}h.append(o);c=o.children("span.coral-grid-resize");if(c.length>0){c[0].style.height=""}o.children("div")[0].style.top=""}$(m).children("tr.coral-grid-labels").remove();
$(m).prepend(h);if(j===true){$(k.element).grid("option",{groupHeader:null})}},setGroupHeaders:function(t){t=$.extend({useColSpanStyle:false,groupHeaders:[]},t||{});this.options.groupHeader=t;var h=this,y,u,v=0,A,m,f,c,e,d,z,p,n,s,l=h.options.colModel,q=l.length,a=h.grid.headers,x=$("table.coral-grid-htable",h.grid.columnsView),b=x.children("thead").children("tr.coral-grid-labels:last").addClass("jqg-second-row-header"),k=x.children("thead"),r,j=x.find(".jqg-first-row-header");if(j[0]===undefined){j=$("<tr>",{role:"row","aria-hidden":"true"}).addClass("jqg-first-row-header").css("height","auto")}else{j.empty()}var g,w=function(D,B){var o=0,C=B.length;for(;o<C;o++){if(B[o].startColumnName===D){return o}}return -1};h.element.find(".coral-grid-columns-view>table").prepend(k);A=$("<tr>",{role:"rowheader"}).addClass("coral-gird-labels jqg-third-row-header");for(y=0;y<q;y++){f=a[y].el;c=$(f);u=l[y];e={height:"0px",width:a[y].width+"px",display:(u.hidden?"none":"")};$("<th>",{role:"gridcell"}).css(e).addClass("coral-first-th-"+h.options.direction).appendTo(j);f.style.width="";d=w(u.name,t.groupHeaders);if(d>=0){z=t.groupHeaders[d];p=z.numberOfColumns;n=z.titleText;for(s=0,d=0;d<p&&(y+d<q);d++){if(!l[y+d].hidden){s++}}m=$("<th>").attr({role:"columnheader"}).addClass("coral-state-default coral-th-column-header coral-th-"+h.options.direction).css({"border-top":"0px none"}).html(n);if(s>0){m.attr("colspan",String(s))}if(h.options.headertitles){m.attr("title",m.text())}if(s===0){m.hide()}c.before(m);A.append(f);v=p-1}else{if(v===0){if(t.useColSpanStyle){c.attr("rowspan","2")}else{$("<th>",{role:"columnheader"}).addClass("coral-state-default coral-th-column-header coral-th-"+h.options.direction).css({display:u.hidden?"none":"","border-top":"0px none"}).insertBefore(c);A.append(f)}}else{A.append(f);v--}}}r=$(h.element).find(".coral-grid-htable").children("thead");r.prepend(j);A.insertAfter(b);x.append(r);if(t.useColSpanStyle){x.find("span.coral-gird-resize").each(function(){var i=$(this).parent();
if(i.is(":visible")){this.style.cssText="height: "+i.height()+"px !important; cursor: col-resize;"}});x.find("div.coral-gird-sortable").each(function(){var i=$(this),o=i.parent();if(o.is(":visible")&&o.is(":has(span.coral-gird-resize)")){i.css("top",(o.height()-i.outerHeight())/2+"px")}})}g=r.find("tr.jqg-first-row-header");$(h.element).bind("gridonresizestop.setGroupHeaders",function(B,o,i){g.find("th").eq(i).width(o)})},getGridParam:function(a){var b=this;if(!b||!b.grid){return}if(!a){return b.p}else{return typeof(b.options[a])!="undefined"?b.options[a]:null}},setGridParam:function(a){if(this.grid&&typeof(a)==="object"){$.extend(true,this.options,a)}},_setOption:function(b,d){var c=this,a=this.options;if(this.grid){$.extend(true,a[b],d)}if(b=="height"){c._setGridHeight(d);c._hasScrollOffset()}if(b=="width"){c._setGridWidth(d);c._hasScrollOffset()}if(b=="model"){if(d=="grid"){c.pic.hide();c.gridRows.show();c.gridColumns.show()}else{if(d=="card"){c.gridRows.hide();c.gridColumns.hide();c.pic.show()}}}if(b=="datatype"){this.options.orgdatatype=d}this._super(b,d)},_hasScrollOffset:function(){var b=this,a=this.grid;if(a.rowsView.style.overflow!="hidden"&&a.rowsView.scroll!="no"&&a.rowsView.scrollHeight>a.rowsView.offsetHeight){$(a.columnsView).css("padding-right",b.options.scrollOffset+"px");return true}else{$(a.columnsView).css("padding-right","");$(a.rowsView).css("padding-right","");return false}},_hasHorizontalScrollBar:function(){var b=this,a=this.grid;var c=b.rightFrozenWidth;if(a.rowsView.style.overflow!="hidden"&&a.rowsView.scroll!="no"&&(a.rowsView.scrollWidth-a.rowsView.clientWidth)>0){return true}else{return false}},_setGridWidth:function(d,l){if(!this.grid||d==0||!this.rows){return}var g=this,a=this.grid,e,c=0,p=$.support.boxSizing?0:g.options.cellLayout,o,b=0,r=false,n=g.options.scrollOffset,j,k=0,i=0,f;if(typeof l!="boolean"){l=g.options.shrinkToFit}if(isNaN(d)){return}else{d=parseInt(d,10);g.grid.width=g.options.width=d}if(g.options.footerrow){$(g.grid.sDiv).css("width",d+"px")
}if(l===false&&g.options.forceFit===true){g.options.forceFit=false}$.each(g.options.colModel,function(){if((this.hidden===false||typeof(this.hidden)=="undefined")){e=this.widthOrg?this.widthOrg:parseInt(this.width,10);c+=e+p;if(this.fixed){k+=e+p}else{b++}i++}});var m=false;if(g.options.minWidth&&c>$(g.element).width()){m=true}if(l===true||m){if(b===0){return}g.options.tblwidth=c;j=d-p*b-k;if(!isNaN(g.options.height)){if($(g.grid.rowsView)[0].clientHeight<$(g.grid.rowsView)[0].scrollHeight||g.rows.length===1){r=true;j-=n}}c=0;var h=g.grid.cols.length>0;$.each(g.options.colModel,function(t){if((this.hidden===false||typeof(this.hidden)=="undefined")&&!this.fixed){e=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(!m){e=Math.round(j*e/(g.options.tblwidth-p*b-k))}if(e<0){return}this.width=e;c+=e;g.grid.headers[t].width=e;g.grid.headers[t].el.style.width=e+"px";var s=$("tr.jqg-first-row-header>th:eq("+t+")",$("table:first",g.grid.columnsView));if(s.length>0){s[0].style.width=e+"px"}if(g.options.footerrow){g.grid.footers[t].style.width=e+"px"}if(h){g.grid.cols[t].style.width=(e)+"px"}o=t}});if(!o){return}f=0;if(!m){if(r){if(d-k-(c+p*b)!==n){f=d-k-(c+p*b)-n}}else{if(Math.abs(d-k-(c+p*b))!==1){f=d-k-(c+p*b)}}g.options.colModel[o].width+=(f-1)}else{f=g.options.colModel[o].width}g.options.tblwidth=c+f+p*b+k;if(g.options.tblwidth>d){var q=g.options.tblwidth-parseInt(d,10);g.options.tblwidth=d;e=g.options.colModel[o].width=g.options.colModel[o].width-q}else{e=g.options.colModel[o].width}g.grid.headers[o].width=e;g.grid.headers[o].el.style.width=e+"px";if(h){g.grid.cols[o].style.width=e+"px"}if(g.options.footerrow){g.grid.footers[o].style.width=e+"px"}}$(a.rowsView).width(d);$(a.columnsView).width(d);if(g.options.tblwidth){$("table:first",a.rowsView).css("width",g.options.tblwidth+"px");$("table:first",a.columnsView).css("width",g.options.tblwidth+"px");g.grid.columnsView.scrollLeft=g.grid.rowsView.scrollLeft;if(g.options.footerrow){$("table:first",g.grid.sDiv).css("width",g.options.tblwidth+"px")
}}},_setGridHeight:function(d){var e=this,c=e.grid,b=!!(e.options.model=="card");if(!e.grid){return}var f=$(e.grid.rowsView);if(e.options.frozenColumns===true){$("#"+$.grid.coralID(e.options.id)+"_frozen").parent().height(f.height()-16)}var a="auto";if(String(d).toLowerCase()==="auto"){d="auto";a="auto";e.pic.css({height:"auto"});f.css({height:"auto"})}else{a=d-e.element.find(".coral-grid-pager").height()-$(c.caption).height();e.pic.css({height:a+(isNaN(a)?"":"px")});a=d-$(c.columnsView).outerHeight(true)-e.element.find(".coral-grid-pager").outerHeight(true)-$(c.caption).height();f.css({height:a+(isNaN(a)?"":"px")})}e.options.height=d;if(e.options.scroll){e.grid.populateVisible()}},getDataIDs:function(){var d=[],c=0,a,b=0;a=this.rows.length;if(a&&a>0){while(c<a){if($(this.rows[c]).hasClass("jqgrow")){d[b]=this.rows[c].id;b++}c++}}return d},setRowData:function(b,g,f){var h=this,q,n=true,l;if(!this.grid){return false}var p=this,d,c,j=typeof f,o={};c=p.rows.namedItem(b);if(!c){return false}if(g){try{$(this.options.colModel).each(function(e){q=this.name;if(g[q]!==undefined){o[q]=this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"?$.unformat.date.call(p,g[q],this):g[q];d=p._formatter(b,g[q],e,g,"edit");l=this.title?{title:$.grid.stripHtml(d)}:{};if(p.options.treeGrid===true&&q==p.options.ExpandColumn){$("td:eq("+e+") > span:first",c).html(d).attr(l)}else{$("td:eq("+e+")",c).html(d).attr(l)}$.fn.afterFmatter.call(h)}});if(p.options.datatype=="local"){var a=$.grid.stripPref(p.options.idPrefix,b),k=p.options._index[a];if(p.options.treeGrid){for(var m in p.options.treeReader){if(o.hasOwnProperty(p.options.treeReader[m])){delete o[p.options.treeReader[m]]}}}if(typeof(k)!="undefined"){p.options.data[k]=$.extend(true,p.options.data[k],o)}o=null}}catch(i){n=false}}if(n){if(j==="string"){$(c).addClass(f)}else{if(j==="object"){$(c).css(f)}}p._trigger("aftercomplete")}return n},delRowData:function(b){var k=false,e,c,i;var f=this;var j=!!(f.options.model=="card");
if(j){e=f.pic.children("#"+b)[0];if(!e){return false}else{$(e).remove();f.options.records--;f.options.reccount--;f._updatepager(true,false);k=true;if(f.options.multiselect){c=$.inArray(b,f.options.selarrrow);if(c!=-1){f.options.selarrrow.splice(c,1)}}if(b==f.options.selrow){f.options.selrow=null}}if(f.options.datatype=="local"){var a=$.grid.stripPref(f.options.idPrefix,b),g=f.options._index[a];if(typeof(g)!="undefined"){f.options.data.splice(g,1);f.refreshIndex()}}}else{e=f.rows.namedItem(b);if(!e){return false}else{i=e.rowIndex;$(e).remove();f.options.records--;f.options.reccount--;f._updatepager(true,false);k=true;if(f.options.multiselect){c=$.inArray(b,f.options.selarrrow);if(c!=-1){f.options.selarrrow.splice(c,1)}}if(b==f.options.selrow){f.options.selrow=null}if(b==f.options.editrow){f.options.editrow=null;f.rowEditButtons.remove()}var d=$.each(f.options.savedRow,function(m,l){if(l.id==b){c=m;return true}});if(d.length){if(c!=-1){f.options.savedRow.splice(c,1)}}}if(f.options.datatype=="local"){var a=$.grid.stripPref(f.options.idPrefix,b),g=f.options._index[a];if(typeof(g)!="undefined"){f.options.data.splice(g,1);f.refreshIndex()}}if(f.options.altRows===true&&k){var h=f.options.altclass;$(f.rows).each(function(l){if(l%2==1){$(this).addClass(h)}else{$(this).removeClass(h)}})}if(!f.getDataIDs().length){f._cancelCheckAll()}if(this.options.frozenColumns){this._setFrozenHeight()}return k}},_cancelCheckAll:function(){var a=this;if(a.options.multiselect){$("#cb_"+$.grid.coralID(a.options.id),a.grid.columnsView)[a.options.useProp?"prop":"attr"]("checked",false)}},resetSelection:function(c){var a=this,d,b,e;if(a.options.frozenColumns===true){e=a.options.id+"_frozen"}if(typeof(c)!=="undefined"){b=c===a.options.selrow?a.options.selrow:c;$("#"+$.grid.coralID(a.options.id)+" tbody:first tr#"+$.grid.coralID(b)).removeClass("coral-state-highlight").attr("aria-selected","false");if(e){$("#"+$.grid.coralID(b),"#"+$.grid.coralID(e)).removeClass("coral-state-highlight")}if(a.options.multiselect){$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(b),"#"+$.grid.coralID(a.options.id))[a.options.useProp?"prop":"attr"]("checked",false);
if(e){$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(b),"#"+$.grid.coralID(e))[a.options.useProp?"prop":"attr"]("checked",false)}a._setHeadCheckBox(false)}b=null}else{if(!a.options.multiselect){if(a.options.selrow){$("#"+$.grid.coralID(a.options.id)+" tbody:first tr#"+$.grid.coralID(a.options.selrow)).removeClass("coral-state-highlight").attr("aria-selected","false");if(e){$("#"+$.grid.coralID(a.options.selrow),"#"+$.grid.coralID(e)).removeClass("coral-state-highlight")}a.options.selrow=null}}else{$(a.options.selarrrow).each(function(f,g){d=a.rows.namedItem(g);$(d).removeClass("coral-state-highlight").attr("aria-selected","false");$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(g))[a.options.useProp?"prop":"attr"]("checked",false);if(e){$("#"+$.grid.coralID(g),"#"+$.grid.coralID(e)).removeClass("coral-state-highlight");$("#jqg_"+$.grid.coralID(a.options.id)+"_"+$.grid.coralID(g),"#"+$.grid.coralID(e))[a.options.useProp?"prop":"attr"]("checked",false)}});a._setHeadCheckBox(false);a.options.selarrrow=[]}}if(a.options.cellEdit===true){if(parseInt(a.options.iCol,10)>=0&&parseInt(a.options.iRow,10)>=0){$("td:eq("+a.options.iCol+")",a.rows[a.options.iRow]).removeClass("edit-cell coral-state-highlight");$(a.rows[a.options.iRow]).removeClass("selected-row coral-state-hover")}}a.options.savedRow=[]},getRowData:function(a){var i={},m,e=false,h,f=0;var g=this,n,b;var l=!!(g.options.model=="card");if(l){if(typeof(a)=="undefined"){e=true;m=[];h=g.pic.children("li").length}else{b=g.pic.children("#"+a)[0];if(!b){return i}h=2}var d="_id_";while(f<h){if(e){b=g.pic.children("li")[f]}if($(b).hasClass("gridPanel")){for(var c=0;c<g.options.data.length;c++){if(g.options.data[c][d]==b.id){i=g.options.data[c]}}if(e){m.push(i);i={}}}f++}}else{if(typeof(a)=="undefined"){e=true;m=[];h=g.rows.length}else{b=g.rows.namedItem(a);if(!b){return i}h=2}while(f<h){if(e){b=g.rows[f]}if($(b).hasClass("jqgrow")){$('td[role="gridcell"]',b).each(function(j){n=g.options.colModel[j].name;
if(n!=="cb"&&n!=="subgrid"&&n!=="rn"){if(g.options.treeGrid===true&&n==g.options.ExpandColumn){i[n]=$.grid.htmlDecode($("span:first",this).html())}else{try{i[n]=$.unformat.call(g,this,{rowId:b.id,colModel:g.options.colModel[j]},j,"get")}catch(k){i[n]=$.grid.htmlDecode($(this).html())}}}});if(e){m.push(i);i={}}}f++}}return m?m:i},addRowData:function(j,h,f,l){if(!f){f="last"}var m=false,a,g,E,I,B,F,c,u,A,r,p="",q,D,n,H,o,w;if(h){if($.isArray(h)){q=true;D=j}else{h=[h];q=false}var s=this,x=h.length;var z=!!(s.options.model=="card");c=s.options.rownumbers===true?1:0;B=s.options.multiselect===true?1:(s.options.singleselect===true?1:0);F=s.options.subGrid===true?1:0;if(!q){if(typeof(j)!="undefined"){j=j+""}else{j=$.grid.randId();if(s.options.keyName!==false){D=s.options.keyName;if(typeof h[0][D]!="undefined"){j=h[0][D]}}}}n=s.options.altclass;var y=0,b="",d={},G=$.isFunction(s.options.afterInsertRow)?true:false;while(y<x){H=h[y];g=[];I=[];E=[];if(q){try{j=H[D]}catch(C){j=$.grid.randId()}b=s.options.altRows===true?(s.rows.length-1)%2===0?n:"":""}b+=" new-row ";w=j;j=s.options.idPrefix+j;if(c){p=s._formatCol(0,1,"",null,j,true);g[g.length]='<td role="gridcell" aria-describedby="'+s.options.id+'_rn" class="coral-state-default grid-rownum" '+p+">0</td>"}if(B){if(this.options.singleselect){r='<input role="radio" type="radio" id="jqg_'+s.options.id+"_"+j+'" name="jqg_'+s.options.id+'" class="cbox"/>'}else{r='<input role="checkbox" type="checkbox" id="jqg_'+s.options.id+"_"+j+'" name="jqg_'+s.options.id+"_"+j+'" class="cbox"/>'}p=s._formatCol(c,1,"",null,j,true);g[g.length]='<td role="gridcell" aria-describedby="'+s.options.id+'_cb" '+p+">"+r+"</td>";I.push(r)}if(F){g[g.length]=$(s).grid("addSubGridCell",B+c,1)}for(A=B+F+c;A<s.options.colModel.length;A++){o=s.options.colModel[A];a=o.name;d[a]=o.formatter&&typeof(o.formatter)==="string"&&o.formatter=="date"?$.unformat.date.call(s,H[a],o):H[a];r=s._formatter(j,$.grid.getAccessor(H,a),A,H);p=s._formatCol(A,1,r,H,j,true);g[g.length]='<td role="gridcell" aria-describedby="'+s.options.id+"_"+a+'" '+p+">"+r+"</td>"
}if(z){E.unshift(s.constructPanel(j,false,b,d,d));E.push(s._customPanel(d,c,I));E.push("</li>")}else{g.unshift(s.constructTr(j,false,b,d,d,false));g[g.length]="</tr>"}if(z){$("#"+$.grid.coralID(s.options.id)+" .coral-pic").append(E.join(""))}else{if(s.rows.length===0){$("table:first",s.grid.rowsView).append(g.join(""))}else{switch(f){case"last":$(s.rows[s.rows.length-1]).after(g.join(""));u=s.rows.length-1;break;case"first":$(s.rows[0]).after(g.join(""));u=1;break;case"after":u=s.rows.namedItem(l);if(u){if($(s.rows[u.rowIndex+1]).hasClass("coral-subgrid")){$(s.rows[u.rowIndex+1]).after(g)}else{$(u).after(g.join(""))}}u++;break;case"before":u=s.rows.namedItem(l);if(u){$(u).before(g.join(""));u=u.rowIndex}u--;break}}}if(s.options.subGrid===true){$(s).grid("addSubGrid",B+c,u)}s.options.records++;s.options.reccount++;$(s).triggerHandler("gridAfterInsertRow",[j,H,H]);if(G){s.options.afterInsertRow.call(s,j,H,H)}y++;if(s.options.datatype=="local"){d[s.options.localReader.id]=w;s.options._index[w]=s.options.data.length;s.options.data.push(d);d={}}}if(s.options.altRows===true&&!q){if(f=="last"){if((s.rows.length-1)%2==1){$(s.rows[s.rows.length-1]).addClass(n)}}else{$(s.rows).each(function(e){if(e%2==1){$(this).addClass(n)}else{$(this).removeClass(n)}})}}s._updatepager(true,true);m=true;$("#noRecordsTips_"+$.grid.coralID(s.options.id)).hide();$.fn.afterFmatter.call(s)}if(this.options.frozenColumns){this._setFrozenHeight()}return m},footerData:function(d,g){var j,b="set",h=false,e={},f;function c(l){var k;for(k in l){if(l.hasOwnProperty(k)){return false}}return true}if(d==undefined){b="get"}if(typeof g!=="boolean"){g=true}b=b.toLowerCase();var i=this,a;if(!i.grid||!i.options.footerrow){return false}if(b==="set"){if(c(d)){return false}}h=true;$(this.options.colModel).each(function(k){j=this.name;if(b==="set"){if(d[j]!==undefined){a=g?i._formatter("",d[j],k,d,"edit"):d[j];f=this.title?{title:$.grid.stripHtml(a)}:{};$("tr.footrow td:eq("+k+")",i.grid.sDiv).html(a).attr(f);h=true}}else{if(b==="get"){e[j]=$("tr.footrow td:eq("+k+")",i.grid.sDiv).html()
}}});$.fn.afterFmatter.call(i);return b==="get"?e:h},clearGridData:function(d){var c=this;var a=!!(c.options.model=="card");if(!c.grid){return}if(typeof d!="boolean"){d=false}if(a){$("#"+$.grid.coralID(c.options.id)+" .coral-pic").empty()}else{if(c.options.deepempty){$("#"+$.grid.coralID(c.options.id)+" tbody:first tr:gt(0)").remove()}else{var b=$(" tbody:first tr:first",c.element)[0];$(" tbody:first",c.element).empty().append(b)}}if(c.options.footerrow&&d){$(".coral-grid-ftable td",c.grid.sDiv).html("&#160;")}c.options.selrow=null;c.options.selarrrow=[];c.options.savedRow=[];c.options.records=0;c.options.page=1;c.options.lastpage=0;c.options.reccount=0;c.options.data=[];c.options._index={};c._updatepager(true,false);c._cancelCheckAll()},sortableRows:function(){var c={},a=0;if(c.sortableRowsOptions){$.extend(c,c.sortableRowsOptions)}var b=this;if(!b.grid){return}if(b.options.treeGrid){return}if($.fn.sortable){c=$.extend({cursor:"move",axis:"y",items:".jqgrow"},c||{});c.change=function(f,d){d.prevItemId=$(d.placeholder[0]).prev("tr").attr("id");d.nextItemId=$(d.placeholder[0]).next("tr").attr("id");d.targetId=d.position.top>d.originalPosition.top?d.prevItemId:d.nextItemId;$("#"+b.id+" #"+d.targetId).siblings().removeClass("coral-state-target");$("#"+b.id+" #"+d.targetId).addClass("coral-state-target");b._trigger("onSortableRows",f,[d])};c.start=function(g,f){$(f.item).css("border-width","0px");f.originalPermutation=[];if(f.item.is("tr")){$("td",f.item).each(function(e){this.style.width=b.grid.cols[e].style.width})}else{$("td",f.item.find("tr:first")).each(function(e){this.style.width=b.grid.cols[e].style.width})}if(b.options.subGrid){var d=$(f.item).attr("id");try{$(b).grid("collapseSubGridRow",d)}catch(g){}}$("tr.jqgrow",b.element.find(".coral-grid-btable")).each(function(){this.id!==""&&f.originalPermutation.push(this.id)});b.sortableRowOriginalPermutation=f.originalPermutation;b._trigger("beforeSortableRows",g,[f])};c.update=function(j,g){$(g.item).css("border-width","");
g.itemId=[];g.permutation=[];g.originalPermutation=b.sortableRowOriginalPermutation||[];if(b.options.rownumbers===true){$("td.grid-rownum",b.rows).each(function(e){$(this).html(e+1+(parseInt(b.options.page,10)-1)*parseInt(b.options.rowNum,10));g.permutation.push(b.rows[e+1].id)})}else{$("tr.jqgrow",b.grid.rowsView).each(function(e){g.permutation.push(this.id)})}$.each(g.item,function(e){g.itemId.push(g.item[e].id)});g.prevItemId=$(g.item[0]).prev("tr").attr("id");g.nextItemId=$(g.item[0]).next("tr").attr("id");g.targetId=g.position.top>g.originalPosition.top?g.prevItemId:g.nextItemId;var h=$.data(b.element[0],"dns-ref");if(h){var f=$.data(h,"dns");if(f.dragToSort){g.item.remove();f.dragToSort=false;var d=0;if(g.targetId){for(;d<f.dataItems.length;d++){$(h).grid("delRowData",f.dataItems[d].id)}b.element.grid("addRowData",f.rowid,f.dataItems,"after",g.targetId)}}}$("#"+b.id+" #"+g.targetId).removeClass("coral-state-target");b._trigger("afterSortableRows",j,[g])};$("tbody:first",b.grid.rowsView).sortable(c)}},destroySortableRows:function(b){var a=this;if(!a.grid){return}if($.fn.sortable){$("tbody:first",a.grid.rowsView).sortable("destroy")}},gridDnS:function(b){var e=this,j=0,f=[];if(!e.grid){return}if(e.options.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}var h="<table id='grid_dns' class='coral-grid-dns'></table>";if($("#grid_dns")[0]===undefined){$("body").append(h)}if(!b.connectWith){return}b.connectWith=b.connectWith.split(",");b.connectWith=$.map(b.connectWith,function(i){return $.trim(i)});var d=b.connectWith.join(" .coral-grid-btable>tbody, ")+" .coral-grid-btable>tbody";b=$.extend({onstart:null,onstop:null,beforedrop:null,ondrop:null,dragcopy:false,dropbyname:false,droppos:"first",autoid:true,rowid:"id",dataItems:[],autoidprefix:"dns_"},b||{});$.data(e.element[0],"dns",b);if(e.options.reccount!="0"&&!e.options.jqgdns){var a=$.data(e.element,"dns");$("tr.jqgrow:not(.coral-draggable)",e.element).draggable({revert:"invalid",helper:function(o,n){var p=$(o.target).parent("tr")[0].id,l=0,k=$("<div></div>"),m=e.element.grid("option","selarrrow").concat();
$.data(e.element[0],"dns").dataItems=[];if($.inArray(p,m)>-1){for(l;l<m.length;l++){$.data(e.element[0],"dns").dataItems.push($(e.element).grid("getRowData",m[l]));k.append($(".coral-grid-btable>tbody #"+m[l],e.element).clone())}return k}else{$.data(e.element[0],"dns").dataItems.push(e.element.grid("getRowData",p));k.append($(o.target).parent("tr").clone());return k}},connectToSortable:d,cursor:"move",appendTo:"#grid_dns",zIndex:5000,start:function(m,n){if(e.options.subGrid){var k=$(n.helper).attr("id");try{$(e.element).grid("collapseSubGridRow",k)}catch(o){}}$.data(e.element[0],"dns").dragToSort=true;for(var l=0;l<$.data(e.element[0],"dns").connectWith.length;l++){if($($.data(e.element[0],"dns").connectWith[l]).grid("option","reccount")=="0"){$($.data(e.element[0],"dns").connectWith[l]).grid("addRowData","jqg_empty_row",{})}}n.helper.addClass("coral-state-highlight");$("td",n.helper.find("tr:first")).each(function(p){this.style.width=e.grid.headers[p].width+"px"});if(b.onstart&&$.isFunction(b.onstart)){b.onstart.call($($t),m,n)}},stop:function(m,n){if(n.helper.dropped&&!b.dragcopy){var l=$(n.helper).attr("id");if(l===undefined){l=$(this).attr("id")}$(e.element).grid("delRowData",l)}for(var k=0;k<$.data(e.element[0],"dns").connectWith.length;k++){$($.data(e.element[0],"dns").connectWith[k]).grid("delRowData","jqg_empty_row")}if(b.onstop&&$.isFunction(b.onstop)){b.onstop.call($($t),m,n)}}})}e.options.jqgdns=true;for(var c=0;c<b.connectWith.length;c++){var g=b.connectWith[c];$.data($(g)[0],"dns-ref",e.element[0])}},gridDnD:function(e){var d=this;if(!d.grid){return}if(d.options.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}function f(){var h=$.data(d.element,"dnd");$("tr.jqgrow:not(.coral-draggable)",d.element).draggable($.isFunction(h.drag)?h.drag.call($(d.element),h):h.drag)}var b="<table id='jqgrid_dnd' class='coral-grid-dnd'></table>";if($("#jqgrid_dnd")[0]===undefined){$("body").append(b)}if(typeof e=="string"&&e=="updateDnD"&&d.options.jqgdnd===true){f();
return}if(!e.connectWith){return}e.connectWith=e.connectWith.split(",");e.connectWith=$.map(e.connectWith,function(h){return $.trim(h)});var a=e.connectWith.join(" .coral-grid-btable>tbody, ")+" .coral-grid-btable>tbody";e=$.extend({drag:function(h){return $.extend({start:function(l,m){if(d.options.subGrid){var j=$(m.helper).attr("id");try{$(d.element).grid("collapseSubGridRow",j)}catch(n){}}for(var k=0;k<$.data(d.element,"dnd").connectWith.length;k++){if($($.data(d.element,"dnd").connectWith[k]).grid("option","reccount")=="0"){$($.data(d.element,"dnd").connectWith[k]).grid("addRowData","jqg_empty_row",{})}}m.helper.addClass("coral-state-highlight");$("td",m.helper).each(function(o){this.style.width=d.grid.headers[o].width+"px"});if(h.onstart&&$.isFunction(h.onstart)){h.onstart.call($($t),l,m)}},stop:function(l,m){if(m.helper.dropped&&!h.dragcopy){var k=$(m.helper).attr("id");if(k===undefined){k=$(this).attr("id")}$(d.element).grid("delRowData",k)}for(var j=0;j<$.data(d.element,"dnd").connectWith.length;j++){$($.data(d.element,"dnd").connectWith[j]).grid("delRowData","jqg_empty_row")}if(h.onstop&&$.isFunction(h.onstop)){h.onstop.call($($t),l,m)}}},h.drag_opts||{})},drop:function(h){return $.extend({accept:function(j){if(!$(j).hasClass("jqgrow")){return j}var i=$(j).closest("table.coral-grid-btable");if(i.length>0&&$.data(d.element,"dnd")!==undefined){var k=$.data(d.element,"dnd").connectWith;return $.inArray("#"+$.grid.coralID(this.id),k)!=-1?true:false}return false},drop:function(r,q){if(!$(q.draggable).hasClass("jqgrow")){return}var n=$(q.draggable).attr("id");var l=q.draggable.parents(".coral-grid").grid("getRowData",n);if(!h.dropbyname){var o=0,k={},u;var s=$("#"+$.grid.coralID(this.id)).grid("option","colModel");try{for(var t in l){if(l.hasOwnProperty(t)){u=s[o].name;if(!(u=="cb"||u=="rn"||u=="subgrid")){if(l.hasOwnProperty(t)&&s[o]){k[u]=l[t]}}else{o++}o++}}l=k}catch(p){}}q.helper.dropped=true;if(h.beforedrop&&$.isFunction(h.beforedrop)){var m=h.beforedrop.call(this,r,q,l,$("#"+$.grid.coralID(d.options.id)),$(this));
if(typeof m!="undefined"&&m!==null&&typeof m=="object"){l=m}}if(q.helper.dropped){var i;if(h.autoid){if($.isFunction(h.autoid)){i=h.autoid.call(this,l)}else{i=Math.ceil(Math.random()*1000);i=h.autoidprefix+i}}$("#"+$.grid.coralID(this.id)).grid("addRowData",i,l,h.droppos)}if(h.ondrop&&$.isFunction(h.ondrop)){h.ondrop.call(this,r,q,l)}}},h.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"coral-state-active",hoverClass:"coral-state-hover"},drag_opts:{revert:"invalid",helper:"clone",connectToSortable:a,cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5000},dragcopy:false,dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},e||{});$.data(d.element,"dnd",e);if(d.options.reccount!="0"&&!d.options.jqgdnd){f()}d.options.jqgdnd=true;for(var c=0;c<e.connectWith.length;c++){var g=e.connectWith[c];$(g).droppable($.isFunction(e.drop)?e.drop.call($(d),e):e.drop)}},getInd:function(b,c){var a=false,d;d=this.rows.namedItem(b);if(d){a=c===true?d:d.rowIndex}return a}});$.extend($.grid,{htmlDecode:function(a){if(a&&(a=="&nbsp;"||a=="&#160;"||(a.length===1&&a.charCodeAt(0)===160))){return""}return !a?a:String(a).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/\'/g,"&acute;")},htmlEncode:function(a){return !a?a:String(a).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&acute;")},format:function(b){var a=$.makeArray(arguments).slice(1);if(b===undefined){b=""}return b.replace(/\{(\d+)\}/g,function(c,d){return a[d]})},getCellIndex:function(a){var b=$(a);if(b.is("tr")){return -1}b=(!b.is("td")&&!b.is("th")?b.closest("td,th"):b)[0];return b.cellIndex},stripHtml:function(a){a=a+"";var b=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(a){a=a.replace(b,"");return(a&&a!=="&nbsp;"&&a!=="&#160;")?a.replace(/\"/g,"'"):""}else{return a}},stripPref:function(a,c){var b=$.type(a);if(b=="string"||b=="number"){a=String(a);c=a!==""?String(c).replace(String(a),""):c}return c
},stringToDoc:function(c){var a;if(typeof c!=="string"){return c}try{var d=new DOMParser();a=d.parseFromString(c,"text/xml")}catch(b){a=new ActiveXObject("Microsoft.XMLDOM");a.async=false;a.loadXML(c)}return(a&&a.documentElement&&a.documentElement.tagName!="parsererror")?a:null},parse:function(jsonString){var js=jsonString;if(js.substr(0,9)=="while(1);"){js=js.substr(9)}if(js.substr(0,2)=="/*"){js=js.substr(2,js.length-4)}if(!js){js="{}"}return($.grid.useJSON===true&&typeof(JSON)==="object"&&typeof(JSON.parse)==="function")?JSON.parse(js):eval("("+js+")")},parseDate:function(i,e){var f={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},g,c,j,b=/[\\\/:_;.,\t\T\s-]/;if(e&&e!==null&&e!==undefined){e=$.trim(e);e=e.split(b);if($.grid.formatter.date.masks[i]!==undefined){i=$.grid.formatter.date.masks[i]}i=i.split(b);var a=$.grid.formatter.date.monthNames;var l=$.grid.formatter.date.AmPm;var d=function(k,m){if(k===0){if(m===12){m=0}}else{if(m!==12){m+=12}}return m};for(g=0,c=i.length;g<c;g++){if(i[g]=="M"){j=$.inArray(e[g],a);if(j!==-1&&j<12){e[g]=j+1;f.m=e[g]}}if(i[g]=="F"){j=$.inArray(e[g],a);if(j!==-1&&j>11){e[g]=j+1-12;f.m=e[g]}}if(i[g]=="a"){j=$.inArray(e[g],l);if(j!==-1&&j<2&&e[g]==l[j]){e[g]=j;f.h=d(e[g],f.h)}}if(i[g]=="A"){j=$.inArray(e[g],l);if(j!==-1&&j>1&&e[g]==l[j]){e[g]=j-2;f.h=d(e[g],f.h)}}if(e[g]!==undefined){f[i[g].toLowerCase()]=parseInt(e[g],10)}}f.m=parseInt(f.m,10)-1;var h=f.y;if(h>=70&&h<=99){f.y=1900+f.y}else{if(h>=0&&h<=69){f.y=2000+f.y}}if(f.j!==undefined){f.d=f.j}if(f.n!==undefined){f.m=parseInt(f.n,10)-1}}return new Date(f.y,f.m,f.d,f.h,f.i,f.s,f.u)},coralID:function(a){return String(a).replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"coralg",randId:function(a){return(a?a:$.grid.uidPref)+($.grid.guid++)},getAccessor:function(h,g){var b,f,a=[],c;if(typeof g==="function"){return g(h)}b=h[g];if(b===undefined){try{if(typeof g==="string"){a=g.split(".")}c=a.length;if(c){b=h;while(b&&c--){f=a.shift();b=b[f]}}}catch(d){}}return b},ajaxOptions:{},from:function(source){var QueryObject=function(d,q){if(typeof(d)=="string"){d=$.data(d)
}var self=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_orDepth=0,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true,_usePinyin=true;if(typeof(d)=="object"&&d.push){if(d.length>0){if(typeof(d[0])!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array"}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(s){var phrase=[];if(_trim){phrase.push("jQuery.trim(")}phrase.push("String("+s+")");if(_trim){phrase.push(")")}if(!_usecase){phrase.push(".toLowerCase()")}return phrase.join("")};this._strComp=function(val){if(typeof(val)=="string"){return".toString()"}else{return""}};this._group=function(f,u){return({field:f.toString(),unique:u,items:[]})};this._toStr=function(phrase){if(_trim){phrase=$.trim(phrase)}phrase=phrase.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return _usecase?phrase:phrase.toLowerCase()};this._funcLoop=function(func){var results=[];$.each(_data,function(i,v){results.push(func(v))});return results};this._append=function(s){var i;if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}for(i=0;i<_orDepth;i++){_query+="("}if(_negate){_query+="!"}_query+="("+s+")";_negate=false;_queuedOperator="";_orDepth=0};this._setCommand=function(f,c){_lastCommand=f;_lastField=c};this._resetNegate=function(){_negate=false};this._repeatCommand=function(f,v){if(_lastCommand===null){return self}if(f!==null&&v!==null){return _lastCommand(f,v)}if(_lastField===null){return _lastCommand(f)}if(!_useProperties){return _lastCommand(f)}return _lastCommand(_lastField,f)};this._equals=function(a,b){return(self._compare(a,b,1)===0)};this._compare=function(a,b,d){var toString=Object.prototype.toString;if(d===undefined){d=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return -1}if(toString.call(a)==="[object Date]"&&toString.call(b)==="[object Date]"){if(a<b){return -d
}if(a>b){return d}return 0}if(!_usecase&&typeof(a)!=="number"&&typeof(b)!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return -d}if(a>b){return d}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=self._doSort(_data,0)};this._doSort=function(d,q){var by=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt;if(q==_sorting.length-1){return self._getOrder(d,by,dir,type,dfmt)}q++;var values=self._getGroup(d,by,dir,type,dfmt);var results=[];for(var i=0;i<values.length;i++){var sorted=self._doSort(values[i].items,q);for(var j=0;j<sorted.length;j++){results.push(sorted[j])}}return results};this._getOrder=function(data,by,dir,type,dfmt){var sortData=[],_sortData=[],newDir=dir=="a"?1:-1,i,ab,j,findSortKey;if(type===undefined){type="text"}if(type=="float"||type=="number"||type=="currency"||type=="numeric"){findSortKey=function($cell){var key=parseFloat(String($cell).replace(_stripNum,""));return isNaN(key)?0:key}}else{if(type=="int"||type=="integer"){findSortKey=function($cell){return $cell?parseFloat(String($cell).replace(_stripNum,"")):0}}else{if(type=="date"||type=="datetime"){findSortKey=function($cell){return $.grid.parseDate(dfmt,$cell).getTime()}}else{if($.isFunction(type)){findSortKey=type}else{findSortKey=function($cell){if(!$cell){$cell=""}return $.trim(String($cell).toUpperCase())}}}}}$.each(data,function(i,v){ab=by!==""?$.grid.getAccessor(v,by):v;if(ab===undefined){ab=""}ab=findSortKey(ab,v);_sortData.push({vSort:ab,index:i})});_sortData.sort(function(a,b){a=a.vSort;b=b.vSort;return self._compare(a,b,newDir)});j=0;var nrec=data.length;while(j<nrec){i=_sortData[j].index;sortData.push(data[i]);j++}return sortData};this._getGroup=function(data,by,dir,type,dfmt){var results=[],group=null,last=null,val;$.each(self._getOrder(data,by,dir,type,dfmt),function(i,v){val=$.grid.getAccessor(v,by);if(val===undefined){val=""}if(!self._equals(last,val)){last=val;if(group!==null){results.push(group)}group=self._group(by,val)
}group.items.push(v)});if(group!==null){results.push(group)}return results};this.ignoreCase=function(){_usecase=false;return self};this.useCase=function(){_usecase=true;return self};this.trim=function(){_trim=true;return self};this.noTrim=function(){_trim=false;return self};this.execute=function(){var match=_query,results=[];if(match===null){return self}$.each(_data,function(){if(eval(match)){results.push(this)}});_data=results;return self};this.data=function(){return _data};this.select=function(f){self._performSort();if(!self._hasData()){return[]}self.execute();if($.isFunction(f)){var results=[];$.each(_data,function(i,v){results.push(f(v))});return results}return _data};this.hasMatch=function(){if(!self._hasData()){return false}self.execute();return _data.length>0};this.andNot=function(f,v,x){_negate=!_negate;return self.and(f,v,x)};this.orNot=function(f,v,x){_negate=!_negate;return self.or(f,v,x)};this.not=function(f,v,x){return self.andNot(f,v,x)};this.and=function(f,v,x){_queuedOperator=" && ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.or=function(f,v,x){_queuedOperator=" || ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.orBegin=function(){_orDepth++;return self};this.orEnd=function(){if(_query!==null){_query+=")"}return self};this.isNot=function(f){_negate=!_negate;return self.is(f)};this.is=function(f){self._append("this."+f);self._resetNegate();return self};this._compareValues=function(func,f,v,how,t){var fld;if(_useProperties){fld="jQuery.grid.getAccessor(this,'"+f+"')"}else{fld="this"}if(v===undefined){v=null}var val=v,swst=t.stype===undefined?"text":t.stype;if(v!==null){switch(swst){case"int":case"integer":val=(isNaN(Number(val))||val==="")?"0":val;fld="parseInt("+fld+",10)";val="parseInt("+val+",10)";break;case"float":case"number":case"numeric":val=String(val).replace(_stripNum,"");val=(isNaN(Number(val))||val==="")?"0":val;fld="parseFloat("+fld+")";val="parseFloat("+val+")";break;case"date":case"datetime":val=String($.grid.parseDate(t.newfmt||"Y-m-d",val).getTime());
fld='jQuery.grid.parseDate("'+t.srcfmt+'",'+fld+").getTime()";break;default:fld=self._getStr(fld);val=self._getStr('"'+self._toStr(val)+'"')}}self._append(fld+" "+how+" "+val+" || pinyinEngine.toPinyin("+fld+', false, "") '+how+" "+val);self._setCommand(func,f);self._resetNegate();return self};this.equals=function(f,v,t){return self._compareValues(self.equals,f,v,"==",t)};this.notEquals=function(f,v,t){return self._compareValues(self.equals,f,v,"!==",t)};this.isNull=function(f,v,t){return self._compareValues(self.equals,f,null,"===",t)};this.greater=function(f,v,t){return self._compareValues(self.greater,f,v,">",t)};this.less=function(f,v,t){return self._compareValues(self.less,f,v,"<",t)};this.greaterOrEquals=function(f,v,t){return self._compareValues(self.greaterOrEquals,f,v,">=",t)};this.lessOrEquals=function(f,v,t){return self._compareValues(self.lessOrEquals,f,v,"<=",t)};this.startsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(v)+'"'))}else{length=_trim?$.trim(v.toString()).length:v.toString().length;self._append(self._getStr("this")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(f)+'"'))}self._setCommand(self.startsWith,f);self._resetNegate();return self};this.endsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+".substr("+self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+".length-"+length+","+length+') == "'+self._toStr(v)+'"')}else{self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"')}self._setCommand(self.endsWith,f);self._resetNegate();return self};this.contains=function(f,v){if(_useProperties){if(_usePinyin){self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1 || '+self._getStr("pinyinEngine.toPinyin(jQuery.grid.getAccessor(this,'"+f+'\'), false, "")')+'.indexOf("'+self._toStr(v)+'",0) > -1')
}else{self._append(self._getStr("jQuery.grid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1')}}else{if(_usePinyin){self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1 || '+pinyinEngine.toPinyin(self._getStr("this"),false,"")+'.indexOf("'+self._toStr(v)+'",0) > -1')}else{self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1')}}self._setCommand(self.contains,f);self._resetNegate();return self};this.groupBy=function(by,dir,type,datefmt){if(!self._hasData()){return null}return self._getGroup(_data,by,dir,type,datefmt)};this.orderBy=function(by,dir,stype,dfmt){dir=dir===undefined||dir===null?"a":$.trim(dir.toString().toLowerCase());if(stype===null||stype===undefined){stype="text"}if(dfmt===null||dfmt===undefined){dfmt="Y-m-d"}if(dir=="desc"||dir=="descending"){dir="d"}if(dir=="asc"||dir=="ascending"){dir="a"}_sorting.push({by:by,dir:dir,type:stype,datefmt:dfmt});return self};return self};return new QueryObject(source,null)},getMethod:function(a){return this.getAccessor($.fn.grid,a)},extend:function(a){$.extend($.fn.grid,a);if(!this.no_legacy_api){$.fn.extend(a)}}});grid=$.component("coral.grid",$.coral.grid,{setTreeNode:function(n,p){var d=this;if(!d.grid||!d.options.treeGrid){return}var h=d.options.expColInd,k=d.options.treeReader.expanded_field,s=d.options.treeReader.leaf_field,a=d.options.treeReader.level_field,r=d.options.treeReader.icon_field,m=d.options.treeReader.loaded,u,j,b,f,l,v,t,g;while(n<p){var e=d.rows[n].id,c=d.options._index[e],q;t=d.options.data[c];if(d.options.treeGridModel=="nested"){if(!t[s]){u=parseInt(t[d.options.treeReader.left_field],10);j=parseInt(t[d.options.treeReader.right_field],10);t[s]=(j===u+1)?"true":"false";d.rows[n].cells[d.options._treeleafpos].innerHTML=t[s]}}b=parseInt(t[a],10);if(d.options.tree_root_level===0){f=b+1;l=b}else{f=b;l=b-1}v="<div class='tree-wrap tree-wrap-"+d.options.direction+"' style='width:"+(f*18)+"px;'>";v+="<div style='"+(d.options.direction=="rtl"?"right:":"left:")+(l*18)+"px;' class=' ";
if(t[m]!==undefined){if(t[m]=="true"||t[m]===true){t[m]=true}else{t[m]=false}}if(t[s]=="true"||t[s]===true){v+=((t[r]!==undefined&&t[r]!=="")?t[r]:d.options.treeIcons.leaf)+" tree-leaf treeclick";t[s]=true;g="leaf"}else{t[s]=false;g=""}t[k]=((t[k]=="true"||t[k]===true)?true:false)&&t[m];if(t[k]===false){v+=((t[s]===true)?"'":d.options.treeIcons.plus+" tree-plus treeclick'")}else{v+=((t[s]===true)?"'":d.options.treeIcons.minus+" tree-minus treeclick'")}v+="></div></div>";$(d.rows[n].cells[h]).wrapInner("<span class='cell-wrapper"+g+"'></span>").prepend(v);if(b!==parseInt(d.options.tree_root_level,10)){var o=$(d.element).grid("getNodeParent",t);q=o&&o.hasOwnProperty(k)?o[k]:true;if(!q){$(d.rows[n]).css("display","none")}}$(d.rows[n].cells[h]).find("div.treeclick").bind("click",function(w){var i=w.target||w.srcElement,y=$(i,d.rows).closest("tr.jqgrow")[0].id,x=d.options._index[y];if(!d.options.data[x][s]){if(d.options.data[x][k]){$(d.element).grid("collapseRow",d.options.data[x]);$(d.element).grid("collapseNode",d.options.data[x])}else{$(d.element).grid("expandRow",d.options.data[x]);$(d.element).grid("expandNode",d.options.data[x])}}return false});if(d.options.ExpandColClick===true){$(d.rows[n].cells[h]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(w){var i=w.target||w.srcElement,y=$(i,d.rows).closest("tr.jqgrow")[0].id,x=d.options._index[y];if(!d.options.data[x][s]){if(d.options.data[x][k]){$(d.element).grid("collapseRow",d.options.data[x]);$(d.element).grid("collapseNode",d.options.data[x])}else{$(d.element).grid("expandRow",d.options.data[x]);$(d.element).grid("expandNode",d.options.data[x])}}$(d.element).grid("setSelection",y);return false})}n++}},setTreeGrid:function(){var f=this,e=0,c,h=false,b,d,a=[];if(!f.options.treeGrid){return}if(!f.options.treedatatype){$.extend(f.options,{treedatatype:f.options.datatype})}f.options.subGrid=false;f.options.altRows=false;f.options.gridview=true;if(f.options.rowTotal===null){f.options.rowNum=10000}f.options.multiselect=false;
f.options.rowList=[];f.options.expColInd=0;c="coral-icon-triangle-1-"+(f.options.direction=="rtl"?"w":"e");f.options.treeIcons=$.extend({plus:"cui-icon-arrow-right3",minus:"cui-icon-arrow-down3",leaf:"cui-icon-file-empty2"},f.options.treeIcons||{});if(f.options.treeGridModel=="nested"){f.options.treeReader=$.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},f.options.treeReader)}else{if(f.options.treeGridModel=="adjacency"){f.options.treeReader=$.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},f.options.treeReader)}}for(d in f.options.colModel){if(f.options.colModel.hasOwnProperty(d)){b=f.options.colModel[d].name;if(b==f.options.ExpandColumn&&!h){h=true;f.options.expColInd=e}e++;for(var g in f.options.treeReader){if(f.options.treeReader[g]==b){a.push(b)}}}}$.each(f.options.treeReader,function(i,k){if(k&&$.inArray(k,a)===-1){if(i==="leaf_field"){f.options._treeleafpos=e}e++;f.options.colNames.push(k);f.options.colModel.push({name:k,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})},expandRow:function(a){var d=this;if(!d.grid||!d.options.treeGrid){return}var c=$(d.element).grid("getNodeChildren",a),b=d.options.treeReader.expanded_field,e=d.rows;$(c).each(function(){var f=$.grid.getAccessor(this,d.options.localReader.id);$(e.namedItem(f)).css("display","");if(this[b]){$(d.element).grid("expandRow",this)}})},collapseRow:function(a){var d=this;if(!d.grid||!d.options.treeGrid){return}var c=$(d.element).grid("getNodeChildren",a),b=d.options.treeReader.expanded_field,e=d.rows;$(c).each(function(){var f=$.grid.getAccessor(this,d.options.localReader.id);$(e.namedItem(f)).css("display","none");if(this[b]){$(d.element).grid("collapseRow",this)}})},getRootNodes:function(){var a=[];var b=this;if(!b.grid||!b.options.treeGrid){return}switch(b.options.treeGridModel){case"nested":var d=b.options.treeReader.level_field;
$(b.options.data).each(function(){if(parseInt(this[d],10)===parseInt(b.options.tree_root_level,10)){a.push(this)}});break;case"adjacency":var c=b.options.treeReader.parent_id_field;$(b.options.data).each(function(){if(this[c]===null||String(this[c]).toLowerCase()=="null"){a.push(this)}});break}return a},getNodeDepth:function(b){var a=null;this.each(function(){if(!this.grid||!this.options.treeGrid){return}var d=this;switch(that.options.treeGridModel){case"nested":var c=that.options.treeReader.level_field;a=parseInt(b[c],10)-parseInt(that.options.tree_root_level,10);break;case"adjacency":a=$(d).grid("getNodeAncestors",b).length;break}});return a},getNodeParent:function(a){var k=null;var e=this;if(!e.grid||!e.options.treeGrid){return}switch(e.options.treeGridModel){case"nested":var d=e.options.treeReader.left_field,j=e.options.treeReader.right_field,f=e.options.treeReader.level_field,i=parseInt(a[d],10),h=parseInt(a[j],10),b=parseInt(a[f],10);$(e.options.data).each(function(){if(parseInt(this[f],10)===b-1&&parseInt(this[d],10)<i&&parseInt(this[j],10)>h){k=this;return false}});break;case"adjacency":var g=e.options.treeReader.parent_id_field,c=e.options.localReader.id;$(e.options.data).each(function(){if(this[c]==a[g]){k=this;return false}});break}return k},getNodeChildren:function(a){var k=[];var e=this;if(!e.grid||!e.options.treeGrid){return}switch(e.options.treeGridModel){case"nested":var d=e.options.treeReader.left_field,j=e.options.treeReader.right_field,f=e.options.treeReader.level_field,i=parseInt(a[d],10),h=parseInt(a[j],10),b=parseInt(a[f],10);$(this.options.data).each(function(){if(parseInt(this[f],10)===b+1&&parseInt(this[d],10)>i&&parseInt(this[j],10)<h){k.push(this)}});break;case"adjacency":var g=e.options.treeReader.parent_id_field,c=e.options.localReader.id;$(this.options.data).each(function(){if(this[g]==a[c]){k.push(this)}});break}return k},getFullTreeNode:function(b){var a=[];this.each(function(){var f=this,g;if(!f.grid||!that.options.treeGrid){return}switch(that.options.treeGridModel){case"nested":var e=that.options.treeReader.left_field,l=that.options.treeReader.right_field,h=that.options.treeReader.level_field,k=parseInt(b[e],10),j=parseInt(b[l],10),c=parseInt(b[h],10);
$(this.options.data).each(function(){if(parseInt(this[h],10)>=c&&parseInt(this[e],10)>=k&&parseInt(this[e],10)<=j){a.push(this)}});break;case"adjacency":if(b){a.push(b);var i=that.options.treeReader.parent_id_field,d=that.options.localReader.id;$(this.options.data).each(function(m){g=a.length;for(m=0;m<g;m++){if(a[m][d]==this[i]){a.push(this);break}}})}break}});return a},getNodeAncestors:function(b){var a=[];this.each(function(){if(!this.grid||!this.options.treeGrid){return}var c=$(this).grid("getNodeParent",b);while(c){a.push(c);c=$(this).grid("getNodeParent",c)}});return a},isVisibleNode:function(b){var a=true;this.each(function(){var e=this;if(!e.grid||!that.options.treeGrid){return}var d=$(e).grid("getNodeAncestors",b),c=that.options.treeReader.expanded_field;$(d).each(function(){a=a&&this[c];if(!a){return false}})});return a},isNodeLoaded:function(d){var a;var c=this;if(!c.grid||!c.options.treeGrid){return}var b=c.options.treeReader.leaf_field;if(d!==undefined){if(d.loaded!==undefined){a=d.loaded}else{if(d[b]||$(c.element).grid("getNodeChildren",d).length>0){a=true}else{a=false}}}else{a=false}return a},expandNode:function(a){if(!this.grid||!this.options.treeGrid){return}var g=this.options.treeReader.expanded_field,h=this.options.treeReader.parent_id_field,e=this.options.treeReader.loaded,b=this.options.treeReader.level_field,j=this.options.treeReader.left_field,i=this.options.treeReader.right_field;if(!a[g]){var c=$.grid.getAccessor(a,this.options.localReader.id);var d=$("#"+$.grid.coralID(c),this.grid.rowsView)[0];var f=this.options._index[c];if($(this.element).grid("isNodeLoaded",this.options.data[f])){a[g]=true;$("div.treeclick",d).removeClass(this.options.treeIcons.plus+" tree-plus").addClass(this.options.treeIcons.minus+" tree-minus")}else{if(!this.grid.columnsView.loading){a[g]=true;$("div.treeclick",d).removeClass(this.options.treeIcons.plus+" tree-plus").addClass(this.options.treeIcons.minus+" tree-minus");this.options.treeANode=d.rowIndex;this.options.datatype=this.options.treedatatype;
if(this.options.treeGridModel=="nested"){$(this.element).grid("option",{postData:{nodeid:c,n_left:a[j],n_right:a[i],n_level:a[b]}})}else{$(this.element).grid("option",{postData:{nodeid:c,parentid:a[h],n_level:a[b]}})}$(this.element).grid("reload");a[e]=true;if(this.options.treeGridModel=="nested"){$(this.element).grid("option",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}})}else{$(this.element).grid("option",{postData:{nodeid:"",parentid:"",n_level:""}})}}}}},collapseNode:function(c){if(!this.grid||!this.options.treeGrid){return}var b=this.options.treeReader.expanded_field;if(c[b]){c[b]=false;var d=$.grid.getAccessor(c,this.options.localReader.id);var a=$("#"+$.grid.coralID(d),this.grid.rowsView)[0];$("div.treeclick",a).removeClass(this.options.treeIcons.minus+" tree-minus").addClass(this.options.treeIcons.plus+" tree-plus")}},sortTree:function(f,a,m,k){if(!this.grid||!this.options.treeGrid){return}var e,h,d,b=[],g=this,j,l,c=$(g.element).grid("getRootNodes");j=$.grid.from(c);j.orderBy(f,a,m,k);l=j.select();for(e=0,h=l.length;e<h;e++){d=l[e];b.push(d);$(g.element).grid("collectChildrenSortTree",b,d,f,a,m,k)}$.each(b,function(i){var n=$.grid.getAccessor(this,g.options.localReader.id);$("#"+$.grid.coralID(g.options.id)+" tbody tr:eq("+i+")").after($("tr#"+$.grid.coralID(n),g.grid.rowsView))});j=null;l=null;b=null},collectChildrenSortTree:function(e,f,h,d,m,l){if(!this.grid||!this.options.treeGrid){return}var g,j,c,a,k,b;a=$(this.element).grid("getNodeChildren",f);k=$.grid.from(a);k.orderBy(h,d,m,l);b=k.select();for(g=0,j=b.length;g<j;g++){c=b[g];e.push(c);$(this.element).grid("collectChildrenSortTree",e,c,h,d,m,l)}},setTreeRow:function(a,b){var c=false;this.each(function(){var d=this;if(!d.grid||!d.options.treeGrid){return}c=$(d).grid("setRowData",a,b)});return c},delTreeNode:function(a){return this.each(function(){var h=this,m=that.options.localReader.id,f=that.options.treeReader.left_field,k=that.options.treeReader.right_field,c,d,j,l;if(!h.grid||!that.options.treeGrid){return
}var b=that.options._index[a];if(b!==undefined){c=parseInt(that.options.data[b][k],10);d=c-parseInt(that.options.data[b][f],10)+1;var e=$(h).grid("getFullTreeNode",that.options.data[b]);if(e.length>0){for(var g=0;g<e.length;g++){$(h).grid("delRowData",e[g][m])}}if(that.options.treeGridModel==="nested"){j=$.grid.from(that.options.data).greater(f,c,{stype:"integer"}).select();if(j.length){for(l in j){if(j.hasOwnProperty(l)){j[l][f]=parseInt(j[l][f],10)-d}}}j=$.grid.from(that.options.data).greater(k,c,{stype:"integer"}).select();if(j.length){for(l in j){if(j.hasOwnProperty(l)){j[l][k]=parseInt(j[l][k],10)-d}}}}}})},addChildNode:function(f,l,x){var r=this[0];if(x){var m=that.options.treeReader.expanded_field,u=that.options.treeReader.leaf_field,a=that.options.treeReader.level_field,g=that.options.treeReader.parent_id_field,c=that.options.treeReader.left_field,v=that.options.treeReader.right_field,n=that.options.treeReader.loaded,b,w,h,k,p,q,o=0,j=l,t,s;if(typeof f==="undefined"||f===null){p=that.options.data.length-1;if(p>=0){while(p>=0){o=Math.max(o,parseInt(that.options.data[p][that.options.localReader.id],10));p--}}f=o+1}var A=$(r).grid("getInd",l);t=false;if(l===undefined||l===null||l===""){l=null;j=null;b="last";k=that.options.tree_root_level;p=that.options.data.length+1}else{b="after";w=that.options._index[l];h=that.options.data[w];l=h[that.options.localReader.id];k=parseInt(h[a],10)+1;var d=$(r).grid("getFullTreeNode",h);if(d.length){p=d[d.length-1][that.options.localReader.id];j=p;p=$(r).grid("getInd",j)+1}else{p=$(r).grid("getInd",l)+1}if(h[u]){t=true;h[m]=true;$(r.rows[A]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(that.options.treeIcons.leaf+" tree-leaf").addClass(that.options.treeIcons.minus+" tree-minus");that.options.data[w][u]=false;h[n]=true}}q=p+1;x[m]=false;x[n]=true;x[a]=k;x[u]=true;if(that.options.treeGridModel==="adjacency"){x[g]=l}if(that.options.treeGridModel==="nested"){var e,z,y;
if(l!==null){s=parseInt(h[v],10);e=$.grid.from(that.options.data);e=e.greaterOrEquals(v,s,{stype:"integer"});z=e.select();if(z.length){for(y in z){if(z.hasOwnProperty(y)){z[y][c]=z[y][c]>s?parseInt(z[y][c],10)+2:z[y][c];z[y][v]=z[y][v]>=s?parseInt(z[y][v],10)+2:z[y][v]}}}x[c]=s;x[v]=s+1}else{s=parseInt($(r).grid("getCol",v,false,"max"),10);z=$.grid.from(that.options.data).greater(c,s,{stype:"integer"}).select();if(z.length){for(y in z){if(z.hasOwnProperty(y)){z[y][c]=parseInt(z[y][c],10)+2}}}z=$.grid.from(that.options.data).greater(v,s,{stype:"integer"}).select();if(z.length){for(y in z){if(z.hasOwnProperty(y)){z[y][v]=parseInt(z[y][v],10)+2}}}x[c]=s+1;x[v]=s+2}}if(l===null||$(r).grid("isNodeLoaded",h)||t){$(r).grid("addRowData",f,x,b,j);$(r).grid("setTreeNode",p,q)}if(h&&!h[m]){$(r.rows[A]).find("div.treeclick").click()}}},refreshDescription:function(a){if(this.options.toolbarOptions){if(this.options.description){$(".pager-description",this.element).html(a)}}},hideGridHeader:function(){this.element.find(".coral-grid-columns").hide()},showGridHeader:function(){this.element.find(".coral-grid-columns").show()},valid:function(b,g){var k={},m,e=false,i,f=0;var h=this,l,d,c;h.errorResults=[];var a;if(typeof(b)=="undefined"||!b){e=true;m=[];i=h.rows.length}else{c=h.rows.namedItem(b);if(!c){return k}i=2}while(f<i){if(e){c=h.rows[f]}if($(c).hasClass("jqgrow")){$('td[role="gridcell"]',c).each(function(n){l=h.options.colModel[n].name;d=h.options.colModel[n].editable;if(!g||(g&&l==g)){if(l!=="cb"&&l!=="subgrid"&&l!=="rn"){if(h.options.treeGrid===true&&l==h.options.ExpandColumn){k[l]=$.grid.htmlDecode($("span:first",this).html())}else{try{var s=$.grep(h.options.savedRow,function(t){return t.id==c.id||h.rows[t.id].id==c.id});if(h.options.savedRow.length&&s.length&&d){a="edittype"}else{a=null}k[l]=$.unformat.call(h,this,{rowId:c.id,colModel:h.options.colModel[n]},n,"get",a)}catch(r){k[l]=$.grid.htmlDecode($(this).html())}}var q=$.extend(h.options.colModel[n].formatoptions||{},h.options.colModel[n].editoptions||{});
var o=$.Event();o.target=this;var p={validoptions:q,notComponent:!(a=="edittype"),showRequiredMark:$.noop,hasTips:false,component:(a=="edittype")?h.getCellComponent(c.id,l):$(this),element:$(this).find(".ctrl-init").length>0?$(this).find(".ctrl-init"):$(this),value:k[l]};var j=$.validate.validateField(o,p);if(j.length){if(h.options.allowSaveOnError){$(this).addClass("coral-gridcell-error").attr("data-errors",j)}else{$(this).addClass("coral-gridcell-error")}h.errorResults.push({rowId:c.id,rowIndex:f,cellIndex:n,errors:j})}else{$(this).removeClass("coral-gridcell-error").removeAttr("data-errors")}}}});if(e){m.push(k);k={}}}f++}this.options.isValid=!(this.errorResults.length>0);return this.options.isValid},clearErrors:function(a,g){var l={},n,e=false,i,f=0;var h=this,m,c,b;this.errorResults=this.errorResults||[];if(typeof(a)=="undefined"||!a){e=true;n=[];i=h.rows.length;h.errorResults=[]}else{b=h.rows.namedItem(a);if(!b){return l}i=2;var d=h.errorResults.length;for(d;d>0;d--){if(h.errorResults[d-1].rowId==b.id){h.errorResults.splice(d-1,1)}}}while(f<i){if(e){b=h.rows[f]}if($(b).hasClass("jqgrow")){$('td[role="gridcell"]',b).each(function(j){$(this).removeClass("coral-gridcell-error coral-validate-error").removeAttr("data-errors")})}f++}this.options.isValid=!(this.errorResults.length>0)},getCellErrors:function(){return that.errorResults},resizeFrozen:function(){var c=this.options.caption?$(this.grid.cDiv).outerHeight():0,b=$(".coral-grid-htable","#"+$.grid.coralID(this.options.id)).outerHeight();if(this.options.toppager){c=c+$($t.grid.topDiv).outerHeight()}if(this.options.toolbar[0]===true){if(this.options.toolbar[1]!="bottom"){c=c+$(this.grid.uDiv).outerHeight()}}if(this.grid.fhDiv){var a=$("th",this.grid.columnsView).height();$(this.grid.fhDiv).css({top:c});$("th",this.grid.fhDiv).each(function(){$(this).height(a)});$(this.grid.fbDiv).css({top:(parseInt(c,10)+parseInt(b,10))});$(this.grid.fbDiv).height($(this.grid.rowsView).height()-this.getScrollBarWidth()+2)}if(this.grid.rightfhDiv){var a=$("th",this.grid.columnsView).height();
$("th",this.grid.rightfhDiv).each(function(){$(this).height(a)});$(this.grid.rightfhDiv).css({top:c});$(this.grid.rightfbDiv).css({top:(parseInt(c,10)+parseInt(b,10))});$(this.grid.rightfbDiv).height($(this.grid.rowsView).height()-this.getScrollBarWidth()+2)}},setFrozenColumns:function(){if(!this.grid){return}var k=this,r=k.options.colModel,l=0,n=r.length,h=n-1,d=-1,q=-1,a=false;if(k.options.subGrid===true||k.options.treeGrid===true||k.options.cellEdit===true||k.options.sortable||k.options.scroll||k.options.grouping){return}if(k.options.rownumbers){l++}if(k.options.multiselect||k.options.singleselect){l++}while(l<n){if(r[l].frozen===true){a=true;q=l}else{break}l++}while(h>0){if(r[h].frozen===true){a=true;d=h}else{break}h--}if(d>0){q=-1}if(a){var p=k.options.caption?$(k.grid.cDiv).outerHeight():0,o=$(".coral-grid-htable","#"+$.grid.coralID(k.options.id)).outerHeight();if(k.options.toppager){p=p+$(k.grid.topDiv).outerHeight()}if(k.options.toolbar[0]===true){if(k.options.toolbar[1]!="bottom"){p=p+$(k.grid.uDiv).outerHeight()}}if(q>=0){k.grid.fhDiv=$('<div style="position:absolute;left:0px;top:'+p+'px;" class="frozen-div-left coral-state-default coral-grid-columns coral-grid-columns-view"></div>');k.grid.fbDiv=$('<div style="position:absolute;left:0px;top:'+(parseInt(p,10)+parseInt(o,10))+'px;overflow-y:hidden" class="frozen-bdiv coral-grid-rows coral-grid-rows-view"></div>');$("#"+$.grid.coralID(k.options.id)).append(k.grid.fhDiv)}if(d>=0){k.grid.rightfhDiv=$('<div style="position:absolute;right:0;top:'+p+'px;" class="frozen-div-right coral-state-default coral-grid-columns coral-grid-columns-view"></div>');k.grid.rightfbDiv=$('<div style="position:absolute;right:0;top:'+(parseInt(p,10)+parseInt(o,10))+'px;overflow-y:hidden" class="frozen-bdiv coral-grid-rows coral-grid-rows-view"></div>');$("#"+$.grid.coralID(k.options.id)).append(k.grid.rightfhDiv)}var f=$(".coral-grid-htable","#"+$.grid.coralID(k.options.id)).clone(true);var m=$(".coral-grid-htable","#"+$.grid.coralID(k.options.id)).clone(true);
k.rightFrozenWidth=0;if(k.options.groupHeader){if(q>=0){$("tr.jqg-first-row-header, tr.jqg-third-row-header",f).each(function(){$("th:gt("+q+")",this).remove()})}if(d>=0){$("tr.jqg-first-row-header, tr.jqg-third-row-header",m).each(function(){$("th:lt("+d+")",this).remove()})}var b=-1,e=-1;$("tr.jqg-second-row-header th",f).each(function(){var i=parseInt($(this).attr("colspan"),10);if(i){b=b+i;e++}if(b===q){return false}});if(b!==q){e=q}$("tr.jqg-second-row-header",f).each(function(){$("th:gt("+e+")",this).remove()})}else{if(q>=0){$("tr",f).each(function(){$("th:gt("+q+")",this).remove()})}if(d>=0){$("tr",m).each(function(){$("th:lt("+d+")",this).remove();var i=k.getScrollBarWidth()-2;$(this).append("<th style='width:"+i+"px;' class='coral-state-default'>&nbsp;</th>")})}}$(f).width(1);$(m).width(1);if(q>=0){$(k.grid.fhDiv).append(f).mousemove(function(i){if(k.grid.resizing){k.grid.dragMove(i);return false}})}if(d>=0){$(k.grid.rightfhDiv).append(m).mousemove(function(i){if(k.grid.resizing){k.grid.dragMove(i);return false}})}$(k.element).bind("gridonresizestop.setFrozenColumns",function(x,v){var t=v.index,i=v.newWidth;if(q>=0){var u=$(".coral-grid-htable",k.grid.fhDiv);$("th:eq("+t+")",u).width(i);var j=$(".coral-grid-btable",k.grid.fbDiv);$("tr:first td:eq("+t+")",j).width(i)}if(d>=0){var u=$(".coral-grid-htable",k.grid.rightfhDiv);$("th:eq("+(n-t-1)+")",u).width(i);var j=$(".coral-grid-btable",k.grid.rightfbDiv);$("tr:first td:eq("+(n-t-1)+")",j).width(i);k.resetFrozen()}});$(k.element).bind("gridonsortcol.setFrozenColumns",function(u,v){var j=v.id,w=v.colIndex;if(q>=0){var i=$("tr.coral-grid-labels:last th:eq("+k.options.lastsort+")",k.grid.fhDiv),t=$("tr.coral-grid-labels:last th:eq("+w+")",k.grid.fhDiv);$("span.coral-grid-ico-sort",i).addClass("coral-state-disabled");$(i).attr("aria-selected","false");$("span.coral-icon-"+k.options.sortorder,t).removeClass("coral-state-disabled");$(t).attr("aria-selected","true");if(!k.options.viewsortcols[0]){if(k.options.lastsort!=w){$("span.s-ico",i).hide();
$("span.s-ico",t).show()}}}if(d>=0){w=k.grid.headers.length-w-1;var i=$("tr.coral-grid-labels:last th:eq("+k.options.lastsort+")",k.grid.rightfhDiv),t=$("tr.coral-grid-labels:last th:eq("+w+")",k.grid.rightfhDiv);$("span.coral-grid-ico-sort",i).addClass("coral-state-disabled");$(i).attr("aria-selected","false");$("span.coral-icon-"+k.options.sortorder,t).removeClass("coral-state-disabled");$(t).attr("aria-selected","true");if(!k.options.viewsortcols[0]){if(k.options.lastsort!=w){$("span.s-ico",i).hide();$("span.s-ico",t).show()}}}});if(q>=0){$("#"+$.grid.coralID(k.options.id)).append(k.grid.fbDiv)}if(d>=0){$("#"+$.grid.coralID(k.options.id)).append(k.grid.rightfbDiv)}jQuery(k.grid.rowsView).scroll(function(){if(q>=0){jQuery(k.grid.fbDiv).scrollTop(jQuery(this).scrollTop())}if(d>=0){jQuery(k.grid.rightfbDiv).scrollTop(jQuery(this).scrollTop())}});var c=0,g=0,s=0;if(q>=0){$(k.grid.fbDiv).mousewheel(function(j,t){var i=-(j.deltaY*j.deltaFactor);g=$(k.grid.rowsView).scrollTop();c=g;c=c+i;$(k.grid.rowsView).scrollTop(c);s=$(k.grid.rowsView).scrollTop();if(s==g){c=c-i}else{j.preventDefault()}})}if(d>=0){$(k.grid.rightfbDiv).mousewheel(function(j,t){var i=-(j.deltaY*j.deltaFactor);g=$(k.grid.rowsView).scrollTop();c=g;c=c+i;$(k.grid.rowsView).scrollTop(c);s=$(k.grid.rowsView).scrollTop();if(s==g){c=c-i}else{j.preventDefault()}})}if(k.options.hoverrows===true){$("#"+$.grid.coralID(k.options.id)).unbind("mouseover").unbind("mouseout")}$(k.element).bind("gridaftercomplete.setFrozenColumns",function(){$("#"+$.grid.coralID(k.options.id)+"_frozen").remove();var i,j;if(q>=0){i=$("#"+$.grid.coralID(k.options.id)+"_table").clone(true);jQuery(k.grid.fbDiv).height(jQuery(k.grid.rowsView).height()-k.getScrollBarWidth()+2);$("tr",i).each(function(){$("td:gt("+q+")",this).remove();!k.options.singleselect||$("td:eq(0)>input",this).attr("name",$("td:eq(0)>input",this).attr("name")+"_forzen")});$(i).width(1).attr("id",k.options.id+"_frozen");$(k.grid.fbDiv).append(i);if(k.options.hoverrows===true){$("tr.jqgrow",i).hover(function(){$(this).addClass("coral-state-hover");
$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).removeClass("coral-state-hover")});$("tr.jqgrow","#"+$.grid.coralID(k.options.id)).hover(function(){$(this).addClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").removeClass("coral-state-hover")})}i=null}if(d>=0){if(($(k.grid.rowsView)[0].scrollHeight-$(k.grid.rowsView)[0].clientHeight)>0){k.grid.rightfbDiv.css({right:(k.getScrollBarWidth()-2)+"px"})}j=$("#"+$.grid.coralID(k.options.id)+"_table").clone(true);jQuery(k.grid.rightfbDiv).height(jQuery(k.grid.rowsView).height()-k.getScrollBarWidth()+2);$("tr",j).each(function(){$("td:lt("+d+")",this).remove();!k.options.singleselect||$("td:eq(0)>input",this).attr("name",$("td:eq(0)>input",this).attr("name")+"_forzen")});$(j).width(1).attr("id",k.options.id+"_frozen");$(k.grid.rightfbDiv).append(j);if(k.options.hoverrows===true){$("tr.jqgrow",j).hover(function(){$(this).addClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)).removeClass("coral-state-hover")});$("tr.jqgrow","#"+$.grid.coralID(k.options.id)).hover(function(){$(this).addClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").addClass("coral-state-hover")},function(){$(this).removeClass("coral-state-hover");$("#"+$.grid.coralID(this.id),"#"+$.grid.coralID(k.options.id)+"_frozen").removeClass("coral-state-hover")})}j=null}});k.options.frozenColumns=true}},destroyFrozenColumns:function(){if(!this.grid){return}if(this.options.frozenColumns===true){var b=this;
$(b.grid.fhDiv).remove();$(b.grid.fbDiv).remove();$(b.grid.rightfhDiv).remove();$(b.grid.rightfbDiv).remove();b.grid.fhDiv=null;b.grid.fbDiv=null;b.grid.rightfhDiv=null;b.grid.rightfbDiv=null;$(this.element).unbind(".setFrozenColumns");if(b.options.hoverrows===true){var a;$("#"+$.grid.coralID(b.options.id)).bind("mouseover",function(c){a=$(c.target).closest("tr.jqgrow");if($(a).attr("class")!=="coral-subgrid"){$(a).addClass("coral-state-hover")}}).bind("mouseout",function(c){a=$(c.target).closest("tr.jqgrow");$(a).removeClass("coral-state-hover")})}this.options.frozenColumns=false}}});$.extend($.grid,{template:function(d){var b=$.makeArray(arguments).slice(1),a,c=b.length;if(d==null){d=""}return d.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(e,h){if(!isNaN(parseInt(h,10))){return b[parseInt(h,10)]}for(a=0;a<c;a++){if($.isArray(b[a])){var g=b[a],f=g.length;while(f--){if(h===g[f].nm){return g[f].v}}}}})}});grid=$.component("coral.grid",$.coral.grid,{groupingSetup:function(){var e=this,d,c,f,b=e.options.colModel,a=e.options.groupingView;if(a!==null&&((typeof a==="object")||$.isFunction(a))){if(!a.groupField.length){e.options.grouping=false}else{if(a.visibiltyOnNextGrouping===undefined){a.visibiltyOnNextGrouping=[]}a.lastvalues=[];if(!a._locgr){a.groups=[]}a.counters=[];for(d=0;d<a.groupField.length;d++){if(!a.groupOrder[d]){a.groupOrder[d]="asc"}if(!a.groupText[d]){a.groupText[d]="{0}"}if(typeof a.groupColumnShow[d]!=="boolean"){a.groupColumnShow[d]=true}if(typeof a.groupSummary[d]!=="boolean"){a.groupSummary[d]=false}if(!a.groupSummaryPos[d]){a.groupSummaryPos[d]="footer"}if(a.groupColumnShow[d]===true){a.visibiltyOnNextGrouping[d]=true;$(this.element).grid("showCol",a.groupField[d])}else{a.visibiltyOnNextGrouping[d]=$("#"+$.grid.coralID(e.options.id+"_"+a.groupField[d])).is(":visible");$(this.element).grid("hideCol",a.groupField[d])}}a.summary=[];if(a.hideFirstGroupCol){a.formatDisplayField[0]=function(g){return g}}for(c=0,f=b.length;c<f;c++){if(a.hideFirstGroupCol){if(!b[c].hidden&&a.groupField[0]===b[c].name){b[c].formatter=function(){return""
}}}if(b[c].summaryType){if(b[c].summaryDivider){a.summary.push({nm:b[c].name,st:b[c].summaryType,v:"",sd:b[c].summaryDivider,vd:"",sr:b[c].summaryRound,srt:b[c].summaryRoundType||"round"})}else{a.summary.push({nm:b[c].name,st:b[c].summaryType,v:"",sr:b[c].summaryRound,srt:b[c].summaryRoundType||"round"})}}}}}else{this.options.grouping=false}},groupingPrepare:function(c,e){var d=this,k=this.options.groupingView,b,j=k.groupField.length,l,h,g,f,a=0;for(b=0;b<j;b++){l=k.groupField[b];g=k.displayField[b];h=c[l];f=g==null?null:c[g];if(f==null){f=h}if(h!==undefined){if(e===0){k.groups.push({idx:b,dataIndex:l,value:h,displayValue:f,startRow:e,cnt:1,summary:[]});k.lastvalues[b]=h;k.counters[b]={cnt:1,pos:k.groups.length-1,summary:$.extend(true,[],k.summary)};$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}else{if(typeof h!=="object"&&($.isArray(k.isInTheSameGroup)&&$.isFunction(k.isInTheSameGroup[b])?!k.isInTheSameGroup[b].call(this,k.lastvalues[b],h,b,k):k.lastvalues[b]!==h)){k.groups.push({idx:b,dataIndex:l,value:h,displayValue:f,startRow:e,cnt:1,summary:[]});k.lastvalues[b]=h;a=1;k.counters[b]={cnt:1,pos:k.groups.length-1,summary:$.extend(true,[],k.summary)};$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}else{if(a===1){k.groups.push({idx:b,dataIndex:l,value:h,displayValue:f,startRow:e,cnt:1,summary:[]});k.lastvalues[b]=h;
k.counters[b]={cnt:1,pos:k.groups.length-1,summary:$.extend(true,[],k.summary)};$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}else{k.counters[b].cnt+=1;k.groups[k.counters[b].pos].cnt=k.counters[b].cnt;$.each(k.counters[b].summary,function(){if($.isFunction(this.st)){this.v=this.st.call(this,this.v,this.nm,c)}else{this.v=d.groupingCalculations.handler(this.st,this.v,this.nm,this.sr,this.srt,c);if(this.st.toLowerCase()==="avg"&&this.sd){this.vd=d.groupingCalculations.handler(this.st,this.vd,this.sd,this.sr,this.srt,c)}}});k.groups[k.counters[b].pos].summary=k.counters[b].summary}}}}}return this},groupingToggle:function(b){var e=this,g=e.options.groupingView,s=b.split("_"),f=parseInt(s[s.length-2],10);s.splice(s.length-2,2);var d=s.join("_"),a=g.minusicon,q=g.plusicon,p=$("#"+$.grid.coralID(b)),j=p.length?p[0].nextSibling:null,h=$("#"+$.grid.coralID(b)+" span.tree-wrap-"+e.options.direction),o=function(r){var t=$.map(r.split(" "),function(u){if(u.substring(0,d.length+1)===d+"_"){return parseInt(u.substring(d.length+1),10)}});return t.length>0?t[0]:undefined},n,i,c=false,k=e.options.frozenColumns?e.options.id+"_frozen":false,l=k?$("#"+$.grid.coralID(b),"#"+$.grid.coralID(k)):false,m=(l&&l.length)?l[0].nextSibling:null;if(h.hasClass(a)){if(g.showSummaryOnHide){if(j){while(j){n=o(j.className);if(n!==undefined&&n<=f){break}$(j).hide();j=j.nextSibling;if(k){$(m).hide();m=m.nextSibling}}}}else{if(j){while(j){n=o(j.className);if(n!==undefined&&n<=f){break}$(j).hide();j=j.nextSibling;if(k){$(m).hide();m=m.nextSibling}}}}h.removeClass(a).addClass(q);c=true}else{if(j){i=undefined;while(j){n=o(j.className);if(i===undefined){i=n===undefined}if(n!==undefined){if(n<=f){break
}if(n===f+1){$(j).show().find(">td>span.tree-wrap-"+e.options.direction).removeClass(a).addClass(q);if(k){$(m).show().find(">td>span.tree-wrap-"+e.options.direction).removeClass(a).addClass(q)}}}else{if(i){$(j).show();if(k){$(m).show()}}}j=j.nextSibling;if(k){m=m.nextSibling}}}h.removeClass(q).addClass(a)}this._trigger("onClickGroup",null,[{headId:b,collapsed:c}]);return false},groupingRender:function(s,g,d,j){var h=this,i=h.options.groupingView,o="",r="",c,b,l=i.groupCollapse?i.plusicon:i.minusicon,k,f=[],p=i.groupField.length;l+=" tree-wrap-"+h.options.direction;$.each(h.options.colModel,function(t,v){var u;for(u=0;u<p;u++){if(i.groupField[u]===v.name){f[u]=t;break}}});var m=0;function e(w,x,t){var u=false,v;if(x===0){u=t[w]}else{var y=t[w].idx;if(y===0){u=t[w]}else{for(v=w;v>=0;v--){if(t[v].idx===y-x){u=t[v];break}}}}return u}function a(v,A,D,y){var w=e(v,A,D),B=h.options.colModel,z,C=w.cnt,x="",u;for(u=y;u<g;u++){var t="<td "+h._formatCol(u,1,"")+">&#160;</td>",E="{0}";$.each(w.summary,function(){if(this.nm===B[u].name){if(B[u].summaryTpl){E=B[u].summaryTpl}if(typeof this.st==="string"&&this.st.toLowerCase()==="avg"){if(this.sd&&this.vd){this.v=(this.v/this.vd)}else{if(this.v&&C>0){this.v=(this.v/C)}}}try{this.groupCount=w.cnt;this.groupIndex=w.dataIndex;this.groupValue=w.value;z=this.formatter("",this.v,u,this)}catch(F){z=this.v}t="<td "+h._formatCol(u,1,"")+">"+$.grid.format(E,z)+"</td>";return false}});x+=t}return x}var n=$.makeArray(i.groupSummary),q;n.reverse();q=h.options.multiselect?' colspan="2"':"";$.each(i.groups,function(y,v){if(i._locgr){if(!(v.startRow+v.cnt>(d-1)*j&&v.startRow<d*j)){return true}}m++;b=h.options.id+"ghead_"+v.idx;c=b+"_"+y;r="<span style='cursor:pointer;' class='icon "+l+"' onclick=\"jQuery('#"+$.grid.coralID(h.options.id)+"').grid('groupingToggle','"+c+"');return false;\"></span>";try{if($.isArray(i.formatDisplayField)&&$.isFunction(i.formatDisplayField[v.idx])){v.displayValue=i.formatDisplayField[v.idx].call(this,v.displayValue,v.value,h.options.colModel[f[v.idx]],v.idx,i);
k=v.displayValue}else{k=this.formatter(c,v.displayValue,f[v.idx],v.value)}}catch(E){k=v.displayValue}if(i.groupSummaryPos[v.idx]==="header"){o+='<tr id="'+c+'"'+(i.groupCollapse&&v.idx>0?' style="display:none;" ':" ")+'role="row" class= "coral-component-content jqgroup coral-row-'+h.options.direction+" "+b+'"><td style="padding-left:'+(v.idx*12)+'px;"'+q+">"+r+$.grid.template(i.groupText[v.idx],k,v.cnt,v.summary)+"</td>";o+=a(y,0,i.groups,i.groupColumnShow[v.idx]===false?(q===""?2:3):((q==="")?1:2));o+="</tr>"}else{o+='<tr id="'+c+'"'+(i.groupCollapse&&v.idx>0?' style="display:none;" ':" ")+'role="row" class= "coral-component-content jqgroup coral-row-'+h.options.direction+" "+b+'"><td style="padding-left:'+(v.idx*12)+'px;" colspan="'+(i.groupColumnShow[v.idx]===false?g-1:g)+'">'+r+$.grid.template(i.groupText[v.idx],k,v.cnt,v.summary)+"</td></tr>"}var A=p-1===v.idx;if(A){var B=i.groups[y+1],t,D,x=0,u=v.startRow,w=B!==undefined?B.startRow:i.groups[y].startRow+i.groups[y].cnt;if(i._locgr){x=(d-1)*j;if(x>v.startRow){u=x}}for(t=u;t<w;t++){if(!s[t-x]){break}o+=s[t-x].join("")}if(i.groupSummaryPos[v.idx]!=="header"){var z;if(B!==undefined){for(z=0;z<i.groupField.length;z++){if(B.dataIndex===i.groupField[z]){break}}m=i.groupField.length-z}for(D=0;D<m;D++){if(!n[D]){continue}var C="";if(i.groupCollapse&&!i.showSummaryOnHide){C=' style="display:none;"'}o+="<tr"+C+' jqfootlevel="'+(v.idx-D)+'" role="row" class="coral-component-content jqfoot coral-row-'+h.options.direction+'">';o+=a(y,D,i.groups,0);o+="</tr>"}m=z}}});$("#"+$.grid.coralID(h.options.id)+" tbody:first").append(o);o=null},groupingGroupBy:function(c,b){var e=this;if(typeof c==="string"){c=[c]}var a=e.options.groupingView;e.options.grouping=true;if(a.visibiltyOnNextGrouping===undefined){a.visibiltyOnNextGrouping=[]}var d;for(d=0;d<a.groupField.length;d++){if(!a.groupColumnShow[d]&&a.visibiltyOnNextGrouping[d]){$(this).grid("showCol",a.groupField[d])}}for(d=0;d<c.length;d++){a.visibiltyOnNextGrouping[d]=$("#"+$.grid.coralID(e.options.id)+"_"+$.grid.coralID(c[d])).is(":visible")
}e.options.groupingView=$.extend(e.options.groupingView,b||{});a.groupField=c;$(this).trigger("reloadGrid")},groupingRemove:function(d){var c=this;if(d===undefined){d=true}c.options.grouping=false;if(d===true){var a=c.options.groupingView,b;for(b=0;b<a.groupField.length;b++){if(!a.groupColumnShow[b]&&a.visibiltyOnNextGrouping[b]){$(this).grid("showCol",a.groupField)}}$("tr.jqgroup, tr.jqfoot","#"+$.grid.coralID(c.options.id)+" tbody:first").remove();$("tr.jqgrow:hidden","#"+$.grid.coralID(c.options.id)+" tbody:first").show()}else{$(this).trigger("reloadGrid")}},groupingCalculations:{handler:function(e,h,f,i,g,a){var b={sum:function(){return parseFloat(h||0)+parseFloat((a[f]||0))},min:function(){if(h===""){return parseFloat(a[f]||0)}return Math.min(parseFloat(h),parseFloat(a[f]||0))},max:function(){if(h===""){return parseFloat(a[f]||0)}return Math.max(parseFloat(h),parseFloat(a[f]||0))},count:function(){if(h===""){h=0}if(a.hasOwnProperty(f)){return h+1}return 0},avg:function(){return b.sum()}};if(!b[e]){throw ("grid Grouping No such method: "+e)}var d=b[e]();if(i!=null){if(g==="fixed"){d=d.toFixed(i)}else{var c=Math.pow(10,i);d=Math.round(d*c)/c}}return d}}});