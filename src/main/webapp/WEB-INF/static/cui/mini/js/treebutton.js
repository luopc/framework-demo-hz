/*!
 * 组件库4.0：下拉树按钮
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$.component("coral.treebutton",$.coral.button,{version:$.coral.version,castProperties:["treeOptions"],options:{id:null,name:null,label:null,cls:null,position:{my:"left top",at:"left bottom",collision:"none"},width:null,text:true,disabled:false,multiple:false,treeOptions:{id:null,name:null,data:null,showLine:false,showIcon:false,checkable:true},onCreate:null,onClick:null,onCheck:null,onSelect:null},tree:function(){return this.uiTree},_create:function(){var a=this;this._super();this._initElements()},_initElements:function(){var c=this,b=this.options,d=this.options.treeOptions;this.element.addClass("coral-treebutton-element").uniqueId();this.uiTree=$("<ul>").attr("id",$(this.element).attr("id")+"_tree").addClass("coral-treebutton-panel coral-front").appendTo("body");this.element.on("click",function(g,f){c._showtree()});this._on(this.document,{mousedown:function(e){if(e.isDefaultPrevented()){return}c._hidetree()}});this.uiTree.unbind().bind("mousedown",function(f){f.preventDefault()});var a={checkable:this.options.multiple};d=$.extend({},a,b.treeOptions,{id:$(this.element).attr("id")+"_tree"});this.uiTree.tree(d)},_bindEvents:function(){},_setOption:function(a,c){var b=this;this._super(a,c)},_showtree:function(b){var d=this.uiTree;d.show();var a=d.siblings(".coral-front:visible").map(function(){return +$(this).css("z-index")}).get(),c=Math.max.apply(null,a);if(c>=+d.css("z-index")){d.css("z-index",c+1)}d.position($.extend({of:this.element},this.options.position))},_hidetree:function(){this.uiTree.hide()},disabledNode:function(d){var b=this.uiTree.tree("getNodesByParam","id",d);for(var c=0,a=b.length;c<a;c++){this.uiTree.tree("setChkDisabled",b[0],true)}},undisabledNode:function(d){var b=this.uiTree.tree("getNodesByParam","id",d);for(var c=0,a=b.length;c<a;c++){this.uiTree.tree("setChkDisabled",b[0],false)}},_destroy:function(){this.uiTree.remove();this.element.removeClass("ctrl-init ctrl-init-treebutton coral-treebutton-element")
}});