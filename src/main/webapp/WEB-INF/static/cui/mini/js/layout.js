$.component("coral.layout",{version:"4.1.4",options:{onCreate:null,fit:false},layoutPanelDefault:{region:null,split:false,showSplitIcon:false,collapsedSize:30,minWidth:10,minHeight:10,maxWidth:10000,maxHeight:10000},resizing:false,_resizeLayout:function(){var i=this,b=this.element,n=i.options,h=i.panels,d=$(b);if(b[0].tagName.toLowerCase()=="body"){this._fit()}else{n.fit?d.css(this._fit()):this._fit(false)}var f=d.find(">.coral-layout-split-north").height()||0,c=d.find(">.coral-layout-split-south").height()||0,a=d.find(">.coral-layout-split-west").width()||0,m=d.find(">.coral-layout-split-east").width()||0;var j={top:0,left:0,width:d.width()-a-m,height:d.height()-c-f};k(this._isPanelVisible(h.expandNorth)?h.expandNorth:h.north,"n");k(this._isPanelVisible(h.expandSouth)?h.expandSouth:h.south,"s");g(this._isPanelVisible(h.expandEast)?h.expandEast:h.east,"e");g(this._isPanelVisible(h.expandWest)?h.expandWest:h.west,"w");h.center.panel("resize",j);function e(o){var p=o.panel("getOptions");return Math.min(Math.max(p.height,p.minHeight),p.maxHeight)}function l(p){var o=p.panel("getOptions");return Math.min(Math.max(o.width,o.minWidth),o.maxWidth)}function k(p,r){if(!p.length||!i._isPanelVisible(p)){return}var t=p.panel("getOptions"),u=e(p),s=(r=="n"?"north":"south"),q=d.find(">.coral-layout-panel-"+s).children(".ctrl-init-panel"),v=q.panel("getOptions");j.height-=u;if(r=="n"){var w=d.find(">.coral-layout-split-north");j.top+=u+f;if(!v.split&&t.border){j.top--}w.css({top:u,left:0})}else{var o=d.find(">.coral-layout-split-south");o.css({top:d.height()-u-c,left:0})}p.panel("resize",{width:d.width(),height:u,left:0,top:(r=="n"?0:d.height()-u)});if(!v.split&&t.border){j.height++}if(t.border&&!$.support.boxSizing){j.height-2}}function g(o,q){if(!o.length||!i._isPanelVisible(o)){return}var v=o.panel("getOptions"),u=(q=="e"?"east":"west"),p=d.find(">.coral-layout-panel-"+u).children(".ctrl-init-panel"),w=p.panel("getOptions");var r=l(o);o.panel("resize",{width:r,height:j.height,left:(q=="e"?d.width()-r:0),top:j.top});
j.width-=r;if(q=="w"){var t=d.find(">.coral-layout-split-west");j.left+=r+a;t.css({height:j.height,top:j.top,left:r});if(!w.split&&v.border){j.left--}}else{var s=d.find(">.coral-layout-split-east");s.css({height:j.height,top:j.top,left:d.width()-r-m})}if(!w.split&&v.border){j.width++}if(!$.support.boxSizing){j.width-2}}},_splitLayout:function(e,c){var d=$(this.element).layout("panel",e);d.panel("options").split=c;var a="layout-split-"+e;var b=d.panel("panel").removeClass(a);if(c){b.addClass(a)}b.resizable({disabled:(!c)});this._resizeLayout()},_create:function(){this.panels={center:$(),north:$(),south:$(),east:$(),west:$()};var b=this;var a=this.element;var d=$(a);d.addClass("coral-layout");function c(e){e.children("div").each(function(){var f=$.parser.parseOptions(this,[]);if("north,south,east,west,center".indexOf(f.region)>=0){b._addPanel(a,f,this);var g=e.layout("panel",f.region);if(g.panel("option").split){b._addSplitIcon(a,f,this)}}})}d.children("form").length?c(d.children("form")):c(d);d.append('<div class="coral-layout-split-proxy-h"></div><div class="coral-layout-split-proxy-v"></div>');this._resizeLayout();this._initCollapse();this._on({"click.splitIcon":function(g){var f=$(g.target).attr("data-dir");if(b.panels[f].is(":visible")){this._collapse(f)}else{this._expand(f)}return false}})},_addSplitIcon:function(c,q,i){var j=this,f=$(c),g=q.region,b=f.layout("panel",g),d=$(i),l=$(i).parent(),n=d.panel("component"),h="coral-layout-split-"+g,a="<div id='layout-split-"+g+"Id' class='layout-split "+h+"'>",e={north:"up5",south:"down5",east:"right5",west:"left5"};if(!e[g]){return}if(!d.length){l=f.find(">.coral-layout-panel-"+g)}if(b.panel("option").showSplitIcon){var m="splitIcon cui-icon-arrow-"+e[g],o="<div class='"+m+"' data-dir='"+g+"'></div>";a+=o+"</div>"}else{a+="</div>"}var k=$(a);l.after(k)},_addPanel:function(a,n,m){var f=this;n.region=n.region||"center";var g=this.panels;var d=$(a);var e=n.region;if(g[e].length){return}var b=$(m);if(!b.length){b=$("<div></div>").appendTo(d)
}var c={north:"up3",south:"down3",east:"right3",west:"left3"};var h="cui-icon-arrow-"+c[e];var k=["title","->"];var c={north:"up3",south:"down3",east:"right3",west:"left3"};var h="cui-icon-arrow-"+c[e];if(c[e]){k.push({icons:h,label:e,text:false,onClick:function(o){f._collapse(e)}})}var l=$.extend({},this.layoutPanelDefault,{width:(b.length?parseInt(b[0].style.width)||b.outerWidth():"auto"),height:(b.length?parseInt(b[0].style.height)||b.outerHeight():"auto"),doSize:false,componentCls:("coral-layout-panel coral-layout-panel-"+e),bodyCls:"coral-layout-body",toolbarOptions:{data:k},onOpen:function(){}},n);if(l.region==="center"){l.split=false}b.panel(l);g[e]=b;var j=b.panel("component");var i={north:"s",south:"n",east:"w",west:"e"};if(b.panel("option").split){j.resizable($.extend({handles:(i[e]||""),disabled:(!b.panel("option").split),start:function(q){f.resizing=true;if(e=="north"||e=="south"){var o=$(">div.coral-layout-split-proxy-v",a)}else{var o=$(">div.coral-layout-split-proxy-h",a)}var p=0,r={display:"block"};if(e=="north"){r.top=parseInt(j.css("top"))+j.outerHeight()-o.height();r.left=parseInt(j.css("left"));r.width=j.outerWidth();r.height=o.height()}else{if(e=="south"){r.top=parseInt(j.css("top"));r.left=parseInt(j.css("left"));r.width=j.outerWidth();r.height=o.height()}else{if(e=="east"){r.top=parseInt(j.css("top"))||0;r.left=parseInt(j.css("left"))||0;r.width=o.width();r.height=j.outerHeight()}else{if(e=="west"){r.top=parseInt(j.css("top"))||0;r.left=j.outerWidth()-o.width();r.width=o.width();r.height=j.outerHeight()}}}}o.css(r);$('<div class="coral-layout-mask"></div>').css({left:0,top:0,width:d.width(),height:d.height()}).appendTo(d)},resize:function(p){if(e=="north"||e=="south"){var o=$(">div.coral-layout-split-proxy-v",a);o.css("top",p.pageY-$(a).offset().top-o.height()/2)}else{var o=$(">div.coral-layout-split-proxy-h",a);o.css("left",p.pageX-$(a).offset().left-o.width()/2)}return false},helper:"coral-resizable-helper",stop:function(p,o){d.children("div.coral-layout-split-proxy-v,div.coral-layout-split-proxy-h").hide();
b.panel("resize",o.size);f._resizeLayout();f.resizing=false;d.find(">div.coral-layout-mask").remove()}},n))}},_remove:function(d){var a=this.panels,b=this.element;var f=$(b).find(".coral-layout-split-"+d),c=f.find(".splitIcon");if(a[d].length){a[d].panel("destroy");$(a[d]).remove();a[d]=$();var e="expand"+d.substring(0,1).toUpperCase()+d.substring(1);if(a[e]){a[e].panel("destroy");$(a[d]).remove();a[e]=undefined}if(f.length){$(f).remove();f=$()}}},_collapseSplitIcon:function(i,a){var g=this,k,d=this.element,c=this.panels[i],j=c.panel("getOptions"),e=j.collapsedSize;var f=$(d).find(".coral-layout-split-"+i),b=f.find(".splitIcon");if(i=="east"){k="cui-icon-arrow-left5";b.removeClass("cui-icon-arrow-right5").addClass(k);f.css({left:a.expandP.left-f.width()})}else{if(i=="west"){k="cui-icon-arrow-right5";b.removeClass("cui-icon-arrow-left5").addClass(k);f.css({left:a.expandP.width})}else{if(i=="north"){k="cui-icon-arrow-down5";b.removeClass("cui-icon-arrow-up5").addClass(k);f.css({top:a.expandP.height});$(d).find(".coral-layout-split-west").css({top:a.expandP.height+f.height(),height:a.resizeC.height});$(d).find(".coral-layout-split-east").css({top:a.expandP.height+f.height(),height:a.resizeC.height})}else{if(i=="south"){k="cui-icon-arrow-up5";b.removeClass("cui-icon-arrow-down5").addClass(k);var h=a.expandP.top-f.height();f.css({top:h});$(d).find(".coral-layout-split-west").css({height:a.resizeC.height});$(d).find(".coral-layout-split-east").css({height:a.resizeC.height})}}}}},_collapse:function(j,e){var h=this,c=this.element;if(e==undefined){e="normal"}var i=this.panels;var b=i[j];var k=b.panel("getOptions");if(k.beforeCollapse.call(b)==false){return}var f="expand"+j.substring(0,1).toUpperCase()+j.substring(1);if(!i[f]){i[f]=d(j);i[f].panel("component").bind("click",function(l){if($(l.target).closest(".collapseIcon").length){return false}var m=g();b.panel("expand",false).panel("open").panel("resize",m.collapse);b.panel("component").animate(m.expand,function(){$(this).unbind(".layout").bind("mouseleave.layout",{region:j},function(n){if(h.resizing==true){return
}h._collapse(n.data.region)})});return false})}var a=g();if(!this._isPanelVisible(i[f])){i.center.panel("resize",a.resizeC)}b.panel("component").animate(a.collapse,e,function(){b.panel("collapse",false).panel("close");i[f].panel("open").panel("resize",a.expandP);$(this).unbind(".layout")});this._collapseSplitIcon(j,a);function d(m){var l="";if(m=="east"){l+="cui-icon-arrow-left3"}else{if(m=="west"){l+="cui-icon-arrow-right3"}else{if(m=="north"){l+="cui-icon-arrow-down3"}else{if(m=="south"){l+="cui-icon-arrow-up3"}}}}var o=$("<div></div>").appendTo(c);var n=["->","->",{icons:l,componentCls:"collapseIcon",label:j,text:false,onClick:function(p){h._expand(j)}}];if(m=="east"||m=="west"){n=[{icons:l,componentCls:"collapseIcon",label:j,text:false,onClick:function(p){h._expand(j)}}]}o.panel($.extend({},h.layoutPanelDefault,{componentCls:("coral-layout-expand coral-layout-expand-"+m),title:"&nbsp;",showTitle:false,closed:true,minWidth:0,minHeight:0,doSize:false,toolbarOptions:{isOverflow:false,data:n}}));o.panel("component").hover(function(){$(this).addClass("coral-layout-expand-over")},function(){$(this).removeClass("coral-layout-expand-over")});return o}function g(){var t=$(c);var m=i.center.panel("getOptions");var l=k.collapsedSize;if(j=="east"){var r=m.width+k.width-l;var o=0;if(!k.split){o=1}return{resizeC:{width:r},expand:{left:t.width()-k.width},expandP:{top:m.top,left:t.width()-l,width:l,height:m.height},collapse:{left:t.width(),top:m.top,height:m.height}}}else{if(j=="west"){var r=m.width+k.width-l;var q=t.find(">.coral-layout-split-west");var o=0;if(!k.split){o=1}return{resizeC:{width:r,left:l+q.width()-o},expand:{left:0},expandP:{left:0,top:m.top,width:l,height:m.height},collapse:{left:-k.width,top:m.top,height:m.height}}}else{if(j=="north"){var n=m.height;var p=t.find(">.coral-layout-split-north");if(!h._isPanelVisible(i.expandNorth)){n+=k.height-l}i.east.add(i.west).add(i.expandEast).add(i.expandWest).panel("resize",{top:l+p.height(),height:n});return{resizeC:{top:l+p.height(),height:n},expand:{top:0},expandP:{top:0,left:0,width:t.width(),height:l},collapse:{top:-k.height,width:t.width()}}
}else{if(j=="south"){var n=m.height;if(!h._isPanelVisible(i.expandSouth)){n+=k.height-l}i.east.add(i.west).add(i.expandEast).add(i.expandWest).panel("resize",{height:n});return{resizeC:{height:n},expand:{top:t.height()-k.height},expandP:{top:t.height()-l,left:0,width:t.width(),height:l},collapse:{top:t.height(),width:t.width()}}}}}}}},_expandSplitIcon:function(e){var d=this,a,b=this.element;var f=$(b).find(".coral-layout-split-"+e),c=f.find(".splitIcon");if(e=="east"){a="cui-icon-arrow-right5";c.removeClass("cui-icon-arrow-left5").addClass(a)}else{if(e=="west"){a="cui-icon-arrow-left5";c.removeClass("cui-icon-arrow-right5").addClass(a)}else{if(e=="north"){a="cui-icon-arrow-up5";c.removeClass("cui-icon-arrow-down5").addClass(a)}else{if(e=="south"){a="cui-icon-arrow-down5";c.removeClass("cui-icon-arrow-up5").addClass(a)}}}}},_expand:function(g){var e=this,b=this.element,f=this.panels,a=f[g],h=a.panel("getOptions");if(h.beforeExpand.call(a)==false){return}var i=d();var c="expand"+g.substring(0,1).toUpperCase()+g.substring(1);if(f[c]){f[c].panel("close");a.panel("component").stop(true,true);a.panel("expand",false).panel("open").panel("resize",i.collapse);a.panel("component").animate(i.expand,function(){e._resizeLayout()});this._expandSplitIcon(g)}function d(){var k=$(b);var j=f.center.panel("getOptions");if(g=="east"&&f.expandEast){return{collapse:{left:k.width(),top:j.top,height:j.height},expand:{left:k.width()-f.east.panel("getOptions").width}}}else{if(g=="west"&&f.expandWest){return{collapse:{left:-f.west.panel("getOptions").width,top:j.top,height:j.height},expand:{left:0}}}else{if(g=="north"&&f.expandNorth){return{collapse:{top:-f.north.panel("getOptions").height,width:k.width()},expand:{top:0}}}else{if(g=="south"&&f.expandSouth){return{collapse:{top:k.height(),width:k.width()},expand:{top:k.height()-f.south.panel("getOptions").height,height:f.south.panel("getOptions").height}}}}}}}},_isPanelVisible:function(a){if(!a){return false}if(a.length){return a.panel("component").is(":visible")
}else{return false}},_initCollapse:function(){var a=this.panels;if(a.east.length&&a.east.panel("getOptions").collapsed){this._collapse("east",0)}if(a.west.length&&a.west.panel("getOptions").collapsed){this._collapse("west",0)}if(a.north.length&&a.north.panel("getOptions").collapsed){this._collapse("north",0)}if(a.south.length&&a.south.panel("getOptions").collapsed){this._collapse("south",0)}},_fit:function(a){return $.coral.panel.fit(this.element,a)},_destroy:function(){this.element.children().remove();this.element.detach()},refresh:function(){this._resizeLayout()},panel:function(a){return this.panels[a]},collapse:function(a){this._collapse(a)},expand:function(a){this._expand(a)},add:function(a){this._addPanel(this.element,a);this._addSplitIcon(this.element,a);this._resizeLayout();if(this.panels[a.region].panel("getOptions").collapsed){this._collapse(a.region,0)}},remove:function(a){this._remove(a);this._resizeLayout()},split:function(a){this._splitLayout(a,true)},unsplit:function(a){this._splitLayout(a,false)},resize:function(g,h){var f=g;var b=this.element;if(h!==undefined){var c=this.panels[h];var i=c.panel("component").outerHeight();var d=c.panel("component").outerWidth();c.panel("resize",g);var a=c.panel("component").outerHeight();var e=c.panel("component").outerWidth();f.height=$(b).height()+a-i;f.width=$(b).width()+e-d}$(b).css(f);this._resizeLayout()}});