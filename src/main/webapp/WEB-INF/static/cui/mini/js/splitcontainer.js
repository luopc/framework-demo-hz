$.component("coral.splitcontainer",{version:"4.1.4",options:{minWidth:"600"},_create:function(){var h=this,e,a=this.options,c=this.element,f=$(this.element),g=$(this.element).attr("id");f.addClass("coral-splitcontainer coral-splitcontainer-showhide");var k=$('<ul id="'+g+"_tree\" style='display:none'></ul>").appendTo("body");k.tree({},[{id:"appRoot",name:"appRoot",children:[{id:"appMaster",name:"appMaster",children:[]},{id:"appDetails",name:"appDetails",children:[]}]}]);this.curDetailNode;this.pageIdArray=[];this.historyIdArray=[];this.arr=[];var j=$("#"+g).children("div")[0],b=$("#"+g).children("div")[1];if(j.id==""){j.id="splitContainer-Master"}if(b.id==""){b.id="splitContainer-Detail"}$("#"+j.id).addClass("coral-nav coral-splitcontainer-master coral-splitcontainer-mastervisible");$("#"+b.id).addClass("coral-nav coral-splitcontainer-detail");var d=h.getTree().tree("getNodeByParam","id","appMaster"),i=h.getTree().tree("getNodeByParam","id","appDetails");this.curDetailNode=i;$("#"+j.id).children("div").each(function(m){a=$.parser.parseOptions(this,[]);var l=h._createView(this.id,a,$("#"+j.id),d);h.getTree().tree("addNodes",d,l);if(!h.options.initialMaster&&m==0){h.options.initialMaster=this.id}h.initialMaster=$("#"+h.options.initialMaster)});$("#"+b.id).children("div").each(function(m){a=$.parser.parseOptions(this,[]);var l=h._createView(this.id,a,$("#"+b.id),i);h.getTree().tree("addNodes",i,l);if(!h.options.initialDetail&&m==0){h.options.initialDetail=this.id}if(a.title){}h.initialDetail=$("#"+h.options.initialDetail)});e=i.children[0].id;i.viewId="view_"+e;this.addView(e,$("#"+e));this.toDetail(e);this.pageIdArray.push(e);this.historyIdArray.push(e);this._bindEvent()},addView:function(f,d){var a=$(this.element).attr("id"),e=$("#"+a).children("div")[1];var c=this.getTree().tree("getNodeByParam","id",f);if(c){if(d&&typeof d==="object"){if(d.url){$("#"+c.id).panel("reload",d.url)}else{if(d.content){$("#"+c.id).panel("setContent",d.content)}}}}else{var b=this._createView(f,d,$("#"+e.id),this.curDetailNode);
this.getTree().tree("addNodes",this.curDetailNode,b);c=this.getTree().tree("getNodeByParam","id",f)}this.curDetailNode=c;this.pageIdArray.push(c.id);this.historyIdArray.push(c.id);if(c.level-2===this.arr.length){this.arr.push(c)}return $("#"+c.id)},getCurrentView:function(a){return $("#"+this.curDetailNode.id)},toDetail:function(f,d){var c=this.options,a=$(this.element).attr("id"),e=$("#"+a).children("div")[1];var b=this.getTree().tree("getNodeByParam","id",f);if(b){$("#"+b.viewId).siblings().hide();$("#"+b.viewId).show()}b.data=d;$.coral.refreshAllComponent($("#"+f));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:b,toId:f,direction:"to"}])},NodeRadio:function(g,d,a,b,e,c){var f={};f.id=g;f.pId=d;f.name=g;f.isParent=a;f.open=b;f.icon=e;f.nocheck=c;return f},_createView:function(b,a,h,n){var j=this,g="",c=$("#"+b),f={},l,m,i,e=$.inArray(b,this.pageIdArray);if(c.length==0){c=$("<div id='"+b+"'></div>")}if(e>-1){i=this.getTree().tree("getNodeByParam","id",this.pageIdArray[e-1]);m=i.viewId;l=$("#"+m)}else{m="view_"+b;l=$("<div id='"+m+"' class='coral-nav-item' style='width:100%'></div>").appendTo(h)}c.appendTo(l);var d={type:"button",icons:"cui-icon-arrow-left3",label:"back",text:false,onClick:function(){j.backDetail()}},o={type:"html",content:a.title};a.toolbarOptions=a.toolbarOptions||{};a.toolbarOptions.data=a.toolbarOptions.data||[];a.toolbarOptions.data.unshift("->");if(a.showNavButton){a.toolbarOptions.data.unshift(d)}if(a.title){a.toolbarOptions.data.unshift("->");a.toolbarOptions.data.unshift(o)}$.each(a.toolbarOptions.data,function(q,r){if(this==="navBtn"){a.toolbarOptions.data[q]=d}});var p=$.extend({},{fit:true,componentCls:"coral-page",collapsible:false,},a);c.panel(p);var k=this.NodeRadio(b,n.id,false,true,null,false);k.viewId=m;return k},_bindEvent:function(){var b=this;var a=$(this.element).attr("id"),c=$("#"+a).children("div")[0];$(document).bind("click.splitcontainer",function(h){var g=$(h.target);var f=$(b.element).attr("id"),j=$("#"+f).children("div")[0];
var d=b.element.find(".coral-splitcontainer-master");var i=d.offset();if(h.pageX<i.left||h.pageX>i.left+d.width()||h.pageY<i.top||h.pageY>i.top+d.height()){if(!g.parent().is("button")&&$("#"+j.id).hasClass("showMaster")){b.hideMaster()}}})},showMaster:function(){var a=$(this.element).attr("id");var c=$("#"+a).children("div")[0],b=$("#"+a).children("div")[1];$("#"+c.id).addClass("showMaster")},hideMaster:function(){var a=$(this.element).attr("id");var c=$("#"+a).children("div")[0],b=$("#"+a).children("div")[1];$("#"+c.id).removeClass("showMaster")},maxDetail:function(b){var a=$(this.element).attr("id");var d=$("#"+a).children("div")[0],c=$("#"+a).children("div")[1];if(b=="max"){$("#"+a).removeClass("coral-splitcontainer-showhide").addClass("coral-splitcontainer-hidemode")}else{$("#"+a).removeClass("coral-splitcontainer-hidemode").addClass("coral-splitcontainer-showhide")}$("#"+d.id).removeClass("coral-splitcontainer-mastervisible showMaster").addClass("coral-splitcontainer-masterhidden");$.coral.refreshAllComponent($("#"+c.id))},refresh:function(){var d=this,a=$(this.element).attr("id"),c,f,b,g=$("#"+a).children("div")[0],e=$("#"+a).children("div")[1];if(this.initialDetail){f=$("#"+this.options.initialDetail).panel("option","title");if(f){c=$("#"+this.options.initialDetail).panel("toolbar")}}if($(window).width()<this.options.minWidth){$("#"+a).addClass("coral-splitcontainer-portrait");if(c){b=c.toolbar("isExist",this.options.id+"_detailMenu");if(!b){c.toolbar("add",0,{id:this.options.id+"_detailMenu",type:"button",onClick:function(){d.showMaster()},icons:"cui-icon-menu7",text:false,label:"菜单"})}}$("#"+g.id).removeClass("coral-splitcontainer-mastervisible showMaster").addClass("coral-splitcontainer-masterhidden")}else{$("#"+a).removeClass("coral-splitcontainer-portrait");$("#"+g.id).removeClass("coral-splitcontainer-masterhidden showMaster").addClass("coral-splitcontainer-mastervisible");if(c){b=c.toolbar("isExist",this.options.id+"_detailMenu");if(b){c.toolbar("remove",0)
}}}$.coral.refreshAllComponent($("#"+g.id));$.coral.refreshAllComponent($("#"+e.id))},backDetail:function(b){var a=$.inArray(this.curDetailNode.id,this.historyIdArray);if(a<=0){return}var e=this.getTree().tree("getNodeByParam","id",this.historyIdArray[a-1]);$("#"+e.viewId).siblings().hide();$("#"+e.viewId).show();e.backData=b;if(a>-1){var d=this.historyIdArray.length,c=d-a;this.historyIdArray.splice(a,c)}$.coral.refreshAllComponent($("#"+e.id));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:e,toId:e.id,direction:"back"}]);this.curDetailNode=e},backToView:function(d,b){var a=$.inArray(d,this.historyIdArray);if(a<0){return}var c=this.getTree().tree("getNodeByParam","id",d);$("#"+c.viewId).siblings().hide();$("#"+c.viewId).show();c.backData=b;$.coral.refreshAllComponent($("#"+d));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:c,toId:c.id,direction:"backToView"}])},backToTopDetail:function(b){var a=this.getTree().tree("getNodeByParam","id","appDetails");$("#"+a.viewId).siblings().hide();$("#"+a.viewId).show();a.backData=b;$.coral.refreshAllComponent($("#"+a.id));this._trigger("onDetailNavigate",null,[{from:this.curDetailNode,fromId:this.curDetailNode.id,to:a,toId:a.id,direction:"backToTop"}])},reload:function(c,b){var a;if(b){}else{this.curDetailNode=a=this.getTree().tree("getNodeByParam","id","appDetails")}this.toDetail(c)},getTree:function(){return $("#"+$(this.element).attr("id")+"_tree")}});