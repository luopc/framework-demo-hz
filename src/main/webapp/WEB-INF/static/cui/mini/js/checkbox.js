/*!
 * 组件库4.0：下拉框
 * 
 * 依赖JS文件：
 *    jquery.coral.core.js
 *    jquery.coral.component.js
 */
$.component("coral.checkbox",$.coral.formelement,{version:"4.0.1",castProperties:["triggers"],options:{showStar:true,id:null,name:null,value:"",label:"",maxLabelWidth:"auto",labelField:null,starBefore:false,title:"",width:"auto",height:null,disabled:false,required:false,readonly:false,checked:false,errMsg:null,errMsgPosition:"leftBottom",onValidError:null,onKeyDown:null,onValidSuccess:null,onChange:$.noop,triggers:null,excluded:false},_create:function(){var d=this,c=this.options,e=c.maxLabelWidth,b=c.label;d.originalValue="";if(!d.element.jquery){d.element=$(d.element)}d.element.addClass("coral-form-element-checkbox tabbable");d.element.addClass("coral-validation-checkbox");typeof d.element.attr("id")=="undefined"&&!!d.options.id&&d.element.attr("id",d.options.id);d.options.id=d.element.uniqueId().attr("id");var a=d.element.attr("name");typeof a!="undefined"?(d.options.name=a):(d.element.attr("name",d.options.name));if($.trim(d.element.val())!=""&&$.trim(d.element.val())!="on"){d.options.value=d.element.val()}else{if(d.options.value){d.element.val(d.options.value)}}if(d.options.name){d.nameMark="coral-checkbox-element-"+d._hashCode(d.options.name);d.element.addClass(d.nameMark)}d.uiCheckbox=$('<span class="coral-checkbox"></span>');d.uiLabel=$('<label class="coral-checkbox-label" for=\''+d.options.id+"'></label>");d.uiIcon=$('<span class="coral-checkbox-icon"></span>');if(e=="auto"){d.uiText=$('<span class="coral-checkbox-text"></span>')}else{d.uiText=$("<span class='coral-checkbox-text'  title='"+b+"' style='max-width:"+e+"px;'></span>")}d.uiLabel.append(d.uiIcon);d.uiLabel.append(this.uiText);if(d.options.label){d.uiText.append(d.options.label)}if(d.options.title){d.uiLabel.attr("title",d.options.title)}if(d.options.checked){d.uiIcon.addClass("cui-icon-checkbox-checked coral-checkbox-hightlight");d.element.prop("checked",true)}else{d.uiIcon.addClass("cui-icon-checkbox-unchecked");
d.element.prop("checked",false)}d.element.after(d.uiCheckbox);d.uiCheckbox.append(d.element).append(d.uiLabel);if(c.labelField){this.uiLabelField=$('<label class="coral-label">'+c.labelField+"</label>");this.uiCheckbox.prepend(this.uiLabelField);this.uiCheckbox.addClass("coral-hasLabel")}if((d.element)[0].checked===true){d.originalValue=d.options.value}d._bindEvent();d._trigger("onCreate",null,[])},reset:function(){if(this.originalValue===""){this.uncheck()}else{this.check()}},_getCheckboxs:function(){var b=this,a=b.element.closest("form");if(!b.nameMark){return b.element}if(a.length>0){return a.find($("."+b.nameMark))}else{return $("."+b.nameMark)}},_setDisabled:function(a){if(a){this.element.prop("disabled",true);this.uiCheckbox.addClass("coral-state-disabled")}else{this.element.prop("disabled",false);this.uiCheckbox.removeClass("coral-state-disabled")}this.options.disabled=(a?true:false)},_setReadonly:function(a){if(a){this.element.prop("readonly",true);this.uiCheckbox.addClass("coral-readonly")}else{this.element.prop("readonly",false);this.uiCheckbox.removeClass("coral-readonly")}this.options.readonly=!!a},focus:function(){var a=this;if(this.options.disabled||this.options.readonly){return false}this.element.focus();return true},_bindEvent:function(){var a=this;if(this.options.disabled){this._setDisabled(this.options.disabled)}this.element.bind("change",function(b){if($(this).prop("checked")){a.uiIcon.removeClass("cui-icon-checkbox-unchecked ").addClass("cui-icon-checkbox-checked coral-checkbox-hightlight")}else{a.uiIcon.removeClass("cui-icon-checkbox-checked coral-checkbox-hightlight").addClass("cui-icon-checkbox-unchecked")}a._trigger("onChange",b,[{checked:!!a.element.prop("checked")}])}).bind("focus",function(b){a.uiCheckbox.addClass("coral-checkbox-highlight")}).bind("blur",function(){a.uiCheckbox.removeClass("coral-checkbox-highlight")}).bind("keydown"+this.eventNamespace,function(b){a._trigger("onKeyDown",b,{})});this.uiCheckbox.bind("mouseenter"+this.eventNamespace,function(){if(a.options.disabled||a.uiCheckbox.hasClass("coral-checkbox-highlight")||a.uiCheckbox.hasClass("coral-checkbox-highlight")){return
}$(this).addClass("coral-checkbox-hover")}).bind("mouseleave"+this.eventNamespace,function(){if(a.options.disabled){return}$(this).removeClass("coral-checkbox-hover")});this.uiLabel.bind("click",function(b){if(a.options.readonly||a.options.isLabel){return false}a._trigger("onClick",b,{})})},_setOption:function(a,b){if(a==="id"||a==="name"){return}if(a==="readonly"){this._setReadonly(b)}if(a==="disabled"){this._setDisabled(b)}if(a==="label"){this.uiText.html(b)}if(a==="maxLabelWidth"){var c=b;if(b!="auto"){c=c+"px";this.uiText.attr("title",this.options.label)}else{c="";this.uiText.attr("title","")}this.uiText.css("max-width",c)}this._super(a,b)},_destroy:function(){this.uiCheckbox.replaceWith(this.element);this.uncheck();this.element.removeAttr("value");this.element.removeClass("coral-form-element-checkbox");this.element.removeClass("coral-validation-checkbox");this.element.removeClass(this.nameMark)},_hashCode:function(e){if(!e){return 0}e=""+e;var c=0,d=0,a=e.length;for(var b=0;b<a;b++){c=31*c+e.charCodeAt(d++);if(c>2147483647||c<2147483648){c=c&4294967295}}return c},component:function(){return this.uiCheckbox},disable:function(){this._setDisabled(true)},readonly:function(){this._setReadonly(true)},enable:function(){this._setDisabled(false)},show:function(){this.component().show()},hide:function(){this.component().hide()},check:function(){if(!this.uiIcon.hasClass("coral-checkbox-hightlight")){this.uiIcon.removeClass("cui-icon-checkbox-unchecked").addClass("cui-icon-checkbox-checked coral-checkbox-hightlight");this.element.prop("checked",true)}},uncheck:function(){if(this.uiIcon.hasClass("coral-checkbox-hightlight")){this.uiIcon.removeClass("cui-icon-checkbox-checked coral-checkbox-hightlight").addClass("cui-icon-checkbox-unchecked");this.element.prop("checked",false)}},isChecked:function(){return this.element.prop("checked")},getValue:function(){return this.getValues().join(",")},getValues:function(){var b=this,a=[];b._getCheckboxs().each(function(){var c=$(this);if(c.checkbox("isChecked")){a.push(c.val())
}});return a},refresh:function(){this._destroy();this._create()}});