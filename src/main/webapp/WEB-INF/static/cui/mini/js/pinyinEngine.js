var pinyinEngine=function(){return(this instanceof pinyinEngine)?this.resetCache():new pinyinEngine};pinyinEngine.prototype={search:function(c,h){var b=this._cache,g=this._history,f=[],e=0;c=c.toLowerCase();h=h||function(){};if(g.length&&c.indexOf(g.keyword)===1){b=g.content}for(var d=0,a=b.length;d<a;d++){if(b[d].tags.indexOf(c)!==-1){e++;f.push(b[d]);h(b[d].content)}}this._history={keyword:c,value:f,length:e};return f},setCache:function(c,f){var e,b="\u0001";e=c;for(var d=0,a=c.length;d<a;d++){e.push(pinyinEngine.toPinyin(c[d],false,b))}e=e.join(b);var g={tags:e,content:f};this._cache.push(g)},resetCache:function(){this._cache=[];this._history={}}};pinyinEngine.toPinyin=function(){var f=window.PINYIN_DATA;var b={},h,d,c,a;for(var d in f){h=f[d];c=0;a=h.length;for(;c<a;c++){var g=h.charAt(c);if(!b[g]){b[g]=[]}b[g].push(d)}}f=null;function e(w,v,n){var k=[],o,u=[];for(var t=0,q=w.length;t<q;t++){for(var s=0,p=v.length;s<p;s++){o=k[k.length]=(w[t] instanceof Array)?w[t].concat(v[s]):[].concat(w[t],v[s]);u.push(o.join(""))}}return{array:k,string:u.join(n||"")}}return function(n,t,j){var o,k,s,m,l,r;if(n==null||n.length==0){o=0}else{o=n.length}if(o===0){return t?"":[]}if(o===1){r=b[n];if(t){return r&&r[0]?r[0]:n}return r||[n]}else{var s=[];for(l=0;l<o;l++){r=b[n.charAt(l)];if(r){s[s.length]=t?r[0]:r}else{s[s.length]=t?n.charAt(l):[n.charAt(l)]}}if(t){return j==null?s:s.join(j||"")}k=s[0];m=s.length;var p,q;for(l=1;l<m;l++){p=e(k,s[l],j);k=p.array}return j==null?k:p.string}}}();