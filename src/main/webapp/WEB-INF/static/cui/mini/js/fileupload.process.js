(function(){var a=$.blueimp.fileupload.prototype.options.add;$.component("blueimp.fileupload",$.blueimp.fileupload,{options:{processQueue:[],add:function(d,b){var c=$(this);b.process(function(){return c.fileupload("process",b)});a.call(this,d,b)}},processActions:{},_processFile:function(f,e){var d=this,b=$.Deferred().resolveWith(d,[f]),c=b.promise();this._trigger("process",null,f);$.each(f.processQueue,function(g,h){var j=function(i){if(e.errorThrown){return $.Deferred().rejectWith(d,[e]).promise()}return d.processActions[h.action].call(d,i,h)};c=c.pipe(j,h.always&&j)});c.done(function(){d._trigger("onProcessDone",null,f);d._trigger("onProcessAlways",null,f)}).fail(function(){d._trigger("onProcessFail",null,f);d._trigger("onProcessAlways",null,f)});return c},_transformProcessQueue:function(b){var c=[];$.each(b.processQueue,function(){var d={},f=this.action,e=this.prefix===true?f:this.prefix;$.each(this,function(g,h){if($.type(h)==="string"&&h.charAt(0)==="@"){d[g]=b[h.slice(1)||(e?e+g.charAt(0).toUpperCase()+g.slice(1):g)]}else{d[g]=h}});c.push(d)});b.processQueue=c},processing:function(){return this._processing},process:function(d){var c=this,b=$.extend({},this.options,d);if(b.processQueue&&b.processQueue.length){this._transformProcessQueue(b);if(this._processing===0){this._trigger("onProcessStart")}$.each(d.files,function(e){var g=e?$.extend({},b):b,f=function(){if(d.errorThrown){return $.Deferred().rejectWith(c,[d]).promise()}return c._processFile(g,d)};g.index=e;c._processing+=1;c._processingQueue=c._processingQueue.pipe(f,f).always(function(){c._processing-=1;if(c._processing===0){c._trigger("onProcessStop")}})})}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=$.Deferred().resolveWith(this).promise()}})})();