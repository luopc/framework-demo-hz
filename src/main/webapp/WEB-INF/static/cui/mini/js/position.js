/*!
 * 组件库4.0：元素位置辅助工具
 */
(function(){$.coral=$.coral||{};var h,k,i=Math.max,n=Math.abs,l=Math.round,c=/left|center|right/,f=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,j=/^\w+/,b=/%$/,e=$.fn.position;function m(q,p,o){return[parseFloat(q[0])*(b.test(q[0])?p/100:1),parseFloat(q[1])*(b.test(q[1])?o/100:1)]}function g(o,p){return parseInt($.css(o,p),10)||0}function d(p){var o=p[0];if(o.nodeType===9){return{width:p.width(),height:p.height(),offset:{top:0,left:0}}}if($.isWindow(o)){return{width:p.width(),height:p.height(),offset:{top:p.scrollTop(),left:p.scrollLeft()}}}if(o.preventDefault){return{width:0,height:0,offset:{top:o.pageY,left:o.pageX}}}return{width:p.outerWidth(),height:p.outerHeight(),offset:p.offset()}}$.position={scrollbarWidth:function(){if(h!==undefined){return h}var p,o,r=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),q=r.children()[0];$("body").append(r);p=q.offsetWidth;r.css("overflow","scroll");o=q.offsetWidth;if(p===o){o=r[0].clientWidth}r.remove();return(h=p-o)},getScrollInfo:function(s){var r=s.isWindow||s.isDocument?"":s.element.css("overflow-x"),q=s.isWindow||s.isDocument?"":s.element.css("overflow-y"),p=r==="scroll"||(r==="auto"&&s.width<s.element[0].scrollWidth),o=q==="scroll"||(q==="auto"&&s.height<s.element[0].scrollHeight);return{width:o?$.position.scrollbarWidth():0,height:p?$.position.scrollbarWidth():0}},getWithinInfo:function(p){var q=$(p||window),o=$.isWindow(q[0]),r=!!q[0]&&q[0].nodeType===9;return{element:q,isWindow:o,isDocument:r,offset:q.offset()||{left:0,top:0},scrollLeft:q.scrollLeft(),scrollTop:q.scrollTop(),width:o||r?q.width():q.outerWidth(),height:o||r?q.height():q.outerHeight()}}};$.fn.position=function(y){if(!y||!y.of){return e.apply(this,arguments)}y=$.extend({},y);var z,v,t,x,s,o,u=$(y.of),r=$.position.getWithinInfo(y.within),p=$.position.getScrollInfo(r),w=(y.collision||"flip").split(" "),q={};o=d(u);if(u[0].preventDefault){y.at="left top"
}v=o.width;t=o.height;x=o.offset;s=$.extend({},x);$.each(["my","at"],function(){var C=(y[this]||"").split(" "),B,A;if(C.length===1){C=c.test(C[0])?C.concat(["center"]):f.test(C[0])?["center"].concat(C):["center","center"]}C[0]=c.test(C[0])?C[0]:"center";C[1]=f.test(C[1])?C[1]:"center";B=a.exec(C[0]);A=a.exec(C[1]);q[this]=[B?B[0]:0,A?A[0]:0];y[this]=[j.exec(C[0])[0],j.exec(C[1])[0]]});if(w.length===1){w[1]=w[0]}if(y.at[0]==="right"){s.left+=v}else{if(y.at[0]==="center"){s.left+=v/2}}if(y.at[1]==="bottom"){s.top+=t}else{if(y.at[1]==="center"){s.top+=t/2}}z=m(q.at,v,t);s.left+=z[0];s.top+=z[1];return this.each(function(){var B,K,D=$(this),F=D.outerWidth(),C=D.outerHeight(),E=g(this,"marginLeft"),A=g(this,"marginTop"),J=F+E+g(this,"marginRight")+p.width,I=C+A+g(this,"marginBottom")+p.height,G=$.extend({},s),H=m(q.my,D.outerWidth(),D.outerHeight());if(y.my[0]==="right"){G.left-=F}else{if(y.my[0]==="center"){G.left-=F/2}}if(y.my[1]==="bottom"){G.top-=C}else{if(y.my[1]==="center"){G.top-=C/2}}G.left+=H[0];G.top+=H[1];if(!k){G.left=l(G.left);G.top=l(G.top)}B={marginLeft:E,marginTop:A};$.each(["left","top"],function(M,L){if($.coral.position[w[M]]){$.coral.position[w[M]][L](G,{targetWidth:v,targetHeight:t,elemWidth:F,elemHeight:C,collisionPosition:B,collisionWidth:J,collisionHeight:I,offset:[z[0]+H[0],z[1]+H[1]],my:y.my,at:y.at,within:r,elem:D})}});if(y.using){K=function(O){var Q=x.left-G.left,N=Q+v-F,P=x.top-G.top,M=P+t-C,L={target:{element:u,left:x.left,top:x.top,width:v,height:t},element:{element:D,left:G.left,top:G.top,width:F,height:C},horizontal:N<0?"left":Q>0?"right":"center",vertical:M<0?"top":P>0?"bottom":"middle"};if(v<F&&n(Q+N)<v){L.horizontal="center"}if(t<C&&n(P+M)<t){L.vertical="middle"}if(i(n(Q),n(N))>i(n(P),n(M))){L.important="horizontal"}else{L.important="vertical"}y.using.call(this,O,L)}}D.offset($.extend(G,{using:K}))})};$.coral.position={fit:{left:function(s,r){var q=r.within,u=q.isWindow?q.scrollLeft:q.offset.left,w=q.width,t=s.left-r.collisionPosition.marginLeft,v=u-t,p=t+r.collisionWidth-w-u,o;
if(r.collisionWidth>w){if(v>0&&p<=0){o=s.left+v+r.collisionWidth-w-u;s.left+=v-o}else{if(p>0&&v<=0){s.left=u}else{if(v>p){s.left=u+w-r.collisionWidth}else{s.left=u}}}}else{if(v>0){s.left+=v}else{if(p>0){s.left-=p}else{s.left=i(s.left-t,s.left)}}}},top:function(r,q){var p=q.within,v=p.isWindow?p.scrollTop:p.offset.top,w=q.within.height,t=r.top-q.collisionPosition.marginTop,u=v-t,s=t+q.collisionHeight-w-v,o;if(q.collisionHeight>w){if(u>0&&s<=0){o=r.top+u+q.collisionHeight-w-v;r.top+=u-o}else{if(s>0&&u<=0){r.top=v}else{if(u>s){r.top=v+w-q.collisionHeight}else{r.top=v}}}}else{if(u>0){r.top+=u}else{if(s>0){r.top-=s}else{r.top=i(r.top-t,r.top)}}}}},flip:{left:function(u,t){var s=t.within,y=s.offset.left+s.scrollLeft,B=s.width,q=s.isWindow?s.scrollLeft:s.offset.left,v=u.left-t.collisionPosition.marginLeft,z=v-q,p=v+t.collisionWidth-B-q,x=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,A=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,r=-2*t.offset[0],o,w;if(z<0){o=u.left+x+A+r+t.collisionWidth-B-y;if(o<0||o<n(z)){u.left+=x+A+r}}else{if(p>0){w=u.left-t.collisionPosition.marginLeft+x+A+r-q;if(w>0||n(w)<p){u.left+=x+A+r}}}},top:function(t,s){var r=s.within,A=r.offset.top+r.scrollTop,B=r.height,o=r.isWindow?r.scrollTop:r.offset.top,v=t.top-s.collisionPosition.marginTop,x=v-o,u=v+s.collisionHeight-B-o,y=s.my[1]==="top",w=y?-s.elemHeight:s.my[1]==="bottom"?s.elemHeight:0,C=s.at[1]==="top"?s.targetHeight:s.at[1]==="bottom"?-s.targetHeight:0,q=-2*s.offset[1],z,p;if(x<0){p=t.top+w+C+q+s.collisionHeight-B-A;if((t.top+w+C+q)>x&&(p<0||p<n(x))){t.top+=w+C+q}}else{if(u>0){z=t.top-s.collisionPosition.marginTop+w+C+q-o;if((t.top+w+C+q)>u&&(z>0||n(z)<u)){t.top+=w+C+q}}}}},flipfit:{left:function(){$.coral.position.flip.left.apply(this,arguments);$.coral.position.fit.left.apply(this,arguments)},top:function(){$.coral.position.flip.top.apply(this,arguments);$.coral.position.fit.top.apply(this,arguments)}}};(function(){var s,u,p,r,q,o=document.getElementsByTagName("body")[0],t=document.createElement("div");
s=document.createElement(o?"div":"body");p={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(o){$.extend(p,{position:"absolute",left:"-1000px",top:"-1000px"})}for(q in p){s.style[q]=p[q]}s.appendChild(t);u=o||document.documentElement;u.insertBefore(s,u.firstChild);t.style.cssText="position: absolute; left: 10.7432222px;";r=$(t).offset().left;k=r>10&&r<11;s.innerHTML="";u.removeChild(s)})()}());